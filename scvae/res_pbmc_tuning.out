## SLURM PROLOG ###############################################################
##    Job ID : 9888935
##  Job Name : scvae_pbmc_tuning
##  Nodelist : gpu2003
##      CPUs : 
##  Mem/Node : 81920 MB
## Directory : /gpfs/scratch/srajakum/Structure_VAE_scRNA_Simulator/Models/scvae
##   Job Started : Mon May  8 22:03:49 EDT 2023
###############################################################################
valid data shape: (10288, 2000)
train data shape: (48005, 2000)

tuning kl weight

kl weight in args dict: 0.1715379298112556
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 40
kl weight: 0.1715379298112556
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (44 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (3.94 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.65 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 40
    hidden sizes: 252, 162, 153, 66
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 0.1715379298112556
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 3 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 252)
    ENCODER/1/DENSE/biases:0             (252,)
    ENCODER/1/BATCH_NORM/beta:0          (252,)
    ENCODER/2/DENSE/weights:0            (252, 162)
    ENCODER/2/DENSE/biases:0             (162,)
    ENCODER/2/BATCH_NORM/beta:0          (162,)
    ENCODER/3/DENSE/weights:0            (162, 153)
    ENCODER/3/DENSE/biases:0             (153,)
    ENCODER/3/BATCH_NORM/beta:0          (153,)
    ENCODER/4/DENSE/weights:0            (153, 66)
    ENCODER/4/DENSE/biases:0             (66,)
    ENCODER/4/BATCH_NORM/beta:0          (66,)
    POSTERIOR/MU/DENSE/weights:0         (66, 40)
    POSTERIOR/MU/DENSE/biases:0          (40,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (66, 40)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (40,)
    DECODER/4/DENSE/weights:0            (40, 66)
    DECODER/4/DENSE/biases:0             (66,)
    DECODER/4/BATCH_NORM/beta:0          (66,)
    DECODER/3/DENSE/weights:0            (66, 153)
    DECODER/3/DENSE/biases:0             (153,)
    DECODER/3/BATCH_NORM/beta:0          (153,)
    DECODER/2/DENSE/weights:0            (153, 162)
    DECODER/2/DENSE/biases:0             (162,)
    DECODER/2/BATCH_NORM/beta:0          (162,)
    DECODER/1/DENSE/weights:0            (162, 252)
    DECODER/1/DENSE/biases:0             (252,)
    DECODER/1/BATCH_NORM/beta:0          (252,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (252, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (491 ms).

Training model for 50 epochs on original values.

Step 38 (32 ms): -2064.
Step 75 (33 ms): -1579.7.
Step 113 (32 ms): -1207.9.
Step 150 (31 ms): -1004.7.
Step 188 (31 ms): -862.65.
Step 226 (31 ms): -737.74.
Step 263 (32 ms): -656.39.
Step 301 (32 ms): -580.13.
Step 338 (31 ms): -532.51.
Step 376 (17 ms): -480.26.

Epoch 1 (14.6 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.38 s): ELBO: -1709.6, ENRE: -1687.7, KL: 21.892.
    Saving model parameters.
    Model parameters saved (188 ms).

Step 414 (32 ms): -509.53.
Step 451 (32 ms): -460.14.
Step 489 (33 ms): -442.8.
Step 526 (31 ms): -421.61.
Step 564 (31 ms): -386.66.
Step 602 (32 ms): -377.25.
Step 639 (32 ms): -375.37.
Step 677 (32 ms): -354.52.
Step 714 (32 ms): -336.83.
Step 752 (16 ms): -399.82.

Epoch 2 (12 s):
    Warm-up weight: 0.33
    Evaluating model.
    Full set (5.8 s): ELBO: -951.64, ENRE: -918.06, KL: 33.581.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 790 (32 ms): -321.37.
Step 827 (31 ms): -321.57.
Step 865 (31 ms): -304.34.
Step 902 (32 ms): -276.77.
Step 940 (32 ms): -310.69.
Step 978 (32 ms): -289.36.
Step 1015 (32 ms): -275.11.
Step 1053 (31 ms): -274.82.
Step 1090 (32 ms): -251.62.
Step 1128 (15 ms): -266.16.

Epoch 3 (12 s):
    Warm-up weight: 0.67
    Evaluating model.
    Full set (5.79 s): ELBO: -521.89, ENRE: -498.66, KL: 23.225.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 1166 (31 ms): -263.36.
Step 1203 (32 ms): -278.19.
Step 1241 (32 ms): -261.35.
Step 1278 (31 ms): -254.11.
Step 1316 (32 ms): -244.49.
Step 1354 (32 ms): -264.99.
Step 1391 (32 ms): -251.57.
Step 1429 (32 ms): -248.17.
Step 1466 (32 ms): -253.74.
Step 1504 (15 ms): -222.4.

Epoch 4 (12 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -356.52, ENRE: -334.47, KL: 22.043.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 1542 (32 ms): -251.97.
Step 1579 (32 ms): -253.13.
Step 1617 (32 ms): -245.54.
Step 1654 (31 ms): -256.92.
Step 1692 (32 ms): -253.65.
Step 1730 (32 ms): -252.71.
Step 1767 (32 ms): -238.01.
Step 1805 (32 ms): -237.25.
Step 1842 (32 ms): -233.8.
Step 1880 (16 ms): -261.31.

Epoch 5 (12 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -294.46, ENRE: -272.45, KL: 22.008.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 1918 (32 ms): -256.63.
Step 1955 (32 ms): -236.04.
Step 1993 (32 ms): -243.78.
Step 2030 (32 ms): -235.53.
Step 2068 (32 ms): -239.83.
Step 2106 (32 ms): -230.66.
Step 2143 (32 ms): -235.64.
Step 2181 (32 ms): -244.38.
Step 2218 (31 ms): -239.22.
Step 2256 (17 ms): -269.41.

Epoch 6 (12 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -266, ENRE: -242.94, KL: 23.067.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 2294 (32 ms): -231.98.
Step 2331 (32 ms): -232.26.
Step 2369 (32 ms): -248.42.
Step 2406 (32 ms): -222.93.
Step 2444 (32 ms): -254.89.
Step 2482 (32 ms): -225.81.
Step 2519 (32 ms): -237.94.
Step 2557 (33 ms): -235.58.
Step 2594 (32 ms): -232.28.
Step 2632 (15 ms): -237.16.

Epoch 7 (12 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -251.1, ENRE: -227.96, KL: 23.142.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 2670 (32 ms): -217.9.
Step 2707 (33 ms): -224.47.
Step 2745 (32 ms): -220.41.
Step 2782 (32 ms): -224.67.
Step 2820 (32 ms): -223.18.
Step 2858 (32 ms): -218.24.
Step 2895 (32 ms): -219.54.
Step 2933 (32 ms): -247.65.
Step 2970 (32 ms): -235.36.
Step 3008 (15 ms): -296.02.

Epoch 8 (12 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -240.83, ENRE: -218.25, KL: 22.578.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 3046 (32 ms): -230.45.
Step 3083 (32 ms): -246.84.
Step 3121 (32 ms): -235.09.
Step 3158 (32 ms): -219.2.
Step 3196 (32 ms): -246.36.
Step 3234 (32 ms): -239.67.
Step 3271 (32 ms): -220.31.
Step 3309 (32 ms): -224.35.
Step 3346 (32 ms): -214.26.
Step 3384 (15 ms): -224.5.

Epoch 9 (12 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -233.53, ENRE: -210.71, KL: 22.824.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 3422 (32 ms): -225.08.
Step 3459 (32 ms): -214.1.
Step 3497 (32 ms): -227.34.
Step 3534 (32 ms): -212.34.
Step 3572 (31 ms): -221.98.
Step 3610 (32 ms): -230.9.
Step 3647 (32 ms): -217.65.
Step 3685 (33 ms): -227.61.
Step 3722 (32 ms): -231.84.
Step 3760 (15 ms): -257.81.

Epoch 10 (12 s):
    Evaluating model.
    Full set (5.76 s): ELBO: -230, ENRE: -206.38, KL: 23.618.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 3798 (32 ms): -242.48.
Step 3835 (32 ms): -213.76.
Step 3873 (32 ms): -215.89.
Step 3910 (32 ms): -240.77.
Step 3948 (32 ms): -219.42.
Step 3986 (32 ms): -224.73.
Step 4023 (32 ms): -225.05.
Step 4061 (32 ms): -229.28.
Step 4098 (32 ms): -222.87.
Step 4136 (15 ms): -321.67.

Epoch 11 (12 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -227.66, ENRE: -204.56, KL: 23.098.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 4174 (32 ms): -214.18.
Step 4211 (32 ms): -232.04.
Step 4249 (32 ms): -230.19.
Step 4286 (32 ms): -217.03.
Step 4324 (32 ms): -227.73.
Step 4362 (32 ms): -233.75.
Step 4399 (32 ms): -213.33.
Step 4437 (32 ms): -227.38.
Step 4474 (32 ms): -238.55.
Step 4512 (16 ms): -208.79.

Epoch 12 (12 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -226.27, ENRE: -203.33, KL: 22.935.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 4550 (32 ms): -215.15.
Step 4587 (32 ms): -228.56.
Step 4625 (32 ms): -217.67.
Step 4662 (32 ms): -231.57.
Step 4700 (32 ms): -215.52.
Step 4738 (32 ms): -211.62.
Step 4775 (32 ms): -231.53.
Step 4813 (33 ms): -213.74.
Step 4850 (32 ms): -217.62.
Step 4888 (15 ms): -218.48.

Epoch 13 (12.1 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -224.35, ENRE: -200.48, KL: 23.862.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 4926 (32 ms): -217.54.
Step 4963 (32 ms): -231.32.
Step 5001 (32 ms): -221.22.
Step 5038 (32 ms): -216.82.
Step 5076 (32 ms): -243.75.
Step 5114 (33 ms): -224.26.
Step 5151 (32 ms): -217.92.
Step 5189 (32 ms): -233.83.
Step 5226 (31 ms): -209.92.
Step 5264 (15 ms): -451.64.

Epoch 14 (12 s):
    Evaluating model.
    Full set (5.76 s): ELBO: -222.89, ENRE: -198.67, KL: 24.222.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 5302 (32 ms): -226.
Step 5339 (32 ms): -227.34.
Step 5377 (32 ms): -216.39.
Step 5414 (32 ms): -219.48.
Step 5452 (32 ms): -210.41.
Step 5490 (32 ms): -228.2.
Step 5527 (33 ms): -218.01.
Step 5565 (32 ms): -226.7.
Step 5602 (32 ms): -207.78.
Step 5640 (15 ms): -238.

Epoch 15 (12 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -222.06, ENRE: -198.09, KL: 23.972.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 5678 (32 ms): -206.81.
Step 5715 (32 ms): -221.29.
Step 5753 (33 ms): -208.98.
Step 5790 (32 ms): -211.1.
Step 5828 (32 ms): -222.
Step 5866 (31 ms): -211.16.
Step 5903 (32 ms): -215.6.
Step 5941 (32 ms): -226.17.
Step 5978 (32 ms): -228.5.
Step 6016 (15 ms): -198.93.

Epoch 16 (12 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -220.52, ENRE: -196.64, KL: 23.88.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 6054 (31 ms): -225.38.
Step 6091 (32 ms): -206.97.
Step 6129 (32 ms): -222.76.
Step 6166 (32 ms): -218.43.
Step 6204 (32 ms): -225.26.
Step 6242 (32 ms): -217.46.
Step 6279 (32 ms): -219.83.
Step 6317 (32 ms): -227.83.
Step 6354 (32 ms): -235.08.
Step 6392 (16 ms): -258.71.

Epoch 17 (12.1 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -220.43, ENRE: -196, KL: 24.43.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 6430 (32 ms): -219.13.
Step 6467 (32 ms): -212.08.
Step 6505 (32 ms): -219.8.
Step 6542 (32 ms): -226.88.
Step 6580 (31 ms): -228.17.
Step 6618 (32 ms): -220.4.
Step 6655 (32 ms): -226.57.
Step 6693 (32 ms): -216.68.
Step 6730 (31 ms): -207.56.
Step 6768 (15 ms): -323.

Epoch 18 (12 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -219.74, ENRE: -195.12, KL: 24.624.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 6806 (32 ms): -224.32.
Step 6843 (32 ms): -209.98.
Step 6881 (32 ms): -231.73.
Step 6918 (32 ms): -225.5.
Step 6956 (32 ms): -236.17.
Step 6994 (32 ms): -206.37.
Step 7031 (33 ms): -233.93.
Step 7069 (32 ms): -217.87.
Step 7106 (32 ms): -230.05.
Step 7144 (15 ms): -245.27.

Epoch 19 (12.1 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -219.66, ENRE: -194.89, KL: 24.777.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 7182 (32 ms): -221.47.
Step 7219 (32 ms): -213.51.
Step 7257 (33 ms): -207.99.
Step 7294 (32 ms): -218.33.
Step 7332 (32 ms): -219.59.
Step 7370 (32 ms): -214.31.
Step 7407 (33 ms): -227.79.
Step 7445 (32 ms): -213.51.
Step 7482 (32 ms): -219.98.
Step 7520 (15 ms): -334.5.

Epoch 20 (12.1 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -219.78, ENRE: -194.57, KL: 25.212.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 7558 (32 ms): -212.34.
Step 7595 (32 ms): -224.02.
Step 7633 (32 ms): -220.07.
Step 7670 (32 ms): -228.57.
Step 7708 (33 ms): -214.05.
Step 7746 (32 ms): -225.97.
Step 7783 (32 ms): -237.33.
Step 7821 (32 ms): -221.93.
Step 7858 (33 ms): -229.91.
Step 7896 (15 ms): -229.96.

Epoch 21 (12.1 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -218.93, ENRE: -193.87, KL: 25.064.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 7934 (32 ms): -211.79.
Step 7971 (33 ms): -220.65.
Step 8009 (32 ms): -226.61.
Step 8046 (31 ms): -203.81.
Step 8084 (32 ms): -232.45.
Step 8122 (32 ms): -208.43.
Step 8159 (32 ms): -210.79.
Step 8197 (32 ms): -211.9.
Step 8234 (32 ms): -219.51.
Step 8272 (15 ms): -205.12.

Epoch 22 (12.1 s):
    Evaluating model.
    Full set (5.76 s): ELBO: -218.5, ENRE: -193.45, KL: 25.05.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 8310 (32 ms): -213.25.
Step 8347 (32 ms): -221.85.
Step 8385 (33 ms): -220.91.
Step 8422 (32 ms): -210.09.
Step 8460 (32 ms): -212.15.
Step 8498 (33 ms): -213.05.
Step 8535 (32 ms): -228.31.
Step 8573 (32 ms): -213.16.
Step 8610 (32 ms): -205.68.
Step 8648 (15 ms): -204.04.

Epoch 23 (12.1 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -218.07, ENRE: -192.88, KL: 25.18.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 8686 (32 ms): -218.44.
Step 8723 (32 ms): -214.66.
Step 8761 (32 ms): -208.15.
Step 8798 (32 ms): -226.08.
Step 8836 (32 ms): -210.27.
Step 8874 (32 ms): -214.39.
Step 8911 (32 ms): -205.51.
Step 8949 (32 ms): -209.23.
Step 8986 (32 ms): -219.37.
Step 9024 (15 ms): -236.36.

Epoch 24 (12 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -217.18, ENRE: -191.98, KL: 25.197.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 9062 (32 ms): -231.21.
Step 9099 (32 ms): -208.76.
Step 9137 (32 ms): -202.85.
Step 9174 (32 ms): -203.88.
Step 9212 (32 ms): -221.16.
Step 9250 (32 ms): -212.2.
Step 9287 (32 ms): -218.1.
Step 9325 (32 ms): -217.18.
Step 9362 (32 ms): -207.75.
Step 9400 (15 ms): -265.33.

Epoch 25 (12.1 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -217.48, ENRE: -192.3, KL: 25.18.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 9438 (32 ms): -223.
Step 9475 (32 ms): -205.63.
Step 9513 (33 ms): -222.1.
Step 9550 (31 ms): -207.94.
Step 9588 (32 ms): -218.5.
Step 9626 (32 ms): -225.43.
Step 9663 (32 ms): -213.29.
Step 9701 (32 ms): -223.75.
Step 9738 (32 ms): -221.21.
Step 9776 (15 ms): -208.28.

Epoch 26 (12 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -216.37, ENRE: -191.36, KL: 25.013.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 9814 (32 ms): -210.37.
Step 9851 (32 ms): -217.57.
Step 9889 (32 ms): -213.11.
Step 9926 (32 ms): -216.82.
Step 9964 (32 ms): -220.61.
Step 10002 (32 ms): -215.37.
Step 10039 (32 ms): -197.53.
Step 10077 (32 ms): -208.14.
Step 10114 (32 ms): -223.91.
Step 10152 (15 ms): -228.03.

Epoch 27 (12.1 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -215.55, ENRE: -190.93, KL: 24.618.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 10190 (32 ms): -209.42.
Step 10227 (32 ms): -217.73.
Step 10265 (32 ms): -223.86.
Step 10302 (33 ms): -229.86.
Step 10340 (32 ms): -216.65.
Step 10378 (32 ms): -231.81.
Step 10415 (32 ms): -216.31.
Step 10453 (32 ms): -218.87.
Step 10490 (32 ms): -224.96.
Step 10528 (15 ms): -273.47.

Epoch 28 (12.1 s):
    Evaluating model.
    Full set (5.76 s): ELBO: -215.28, ENRE: -190.99, KL: 24.298.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 10566 (32 ms): -215.67.
Step 10603 (33 ms): -219.5.
Step 10641 (32 ms): -208.09.
Step 10678 (32 ms): -222.65.
Step 10716 (32 ms): -209.83.
Step 10754 (32 ms): -212.74.
Step 10791 (32 ms): -216.99.
Step 10829 (32 ms): -210.13.
Step 10866 (32 ms): -214.15.
Step 10904 (15 ms): -278.51.

Epoch 29 (12.1 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -215.01, ENRE: -190.52, KL: 24.484.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 10942 (31 ms): -212.65.
Step 10979 (32 ms): -231.38.
Step 11017 (32 ms): -221.36.
Step 11054 (32 ms): -207.75.
Step 11092 (32 ms): -208.08.
Step 11130 (32 ms): -209.85.
Step 11167 (32 ms): -211.76.
Step 11205 (32 ms): -213.41.
Step 11242 (31 ms): -219.79.
Step 11280 (16 ms): -448.42.

Epoch 30 (12 s):
    Evaluating model.
    Full set (5.76 s): ELBO: -214.64, ENRE: -190.31, KL: 24.333.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 11318 (32 ms): -217.4.
Step 11355 (32 ms): -218.58.
Step 11393 (32 ms): -208.25.
Step 11430 (32 ms): -203.51.
Step 11468 (32 ms): -209.52.
Step 11506 (32 ms): -219.86.
Step 11543 (33 ms): -211.61.
Step 11581 (32 ms): -217.1.
Step 11618 (32 ms): -214.78.
Step 11656 (15 ms): -203.6.

Epoch 31 (12.1 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -214.03, ENRE: -190.13, KL: 23.899.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 11694 (32 ms): -219.12.
Step 11731 (32 ms): -211.73.
Step 11769 (32 ms): -206.78.
Step 11806 (32 ms): -205.91.
Step 11844 (32 ms): -212.87.
Step 11882 (32 ms): -221.9.
Step 11919 (32 ms): -214.3.
Step 11957 (32 ms): -227.74.
Step 11994 (32 ms): -206.77.
Step 12032 (15 ms): -254.1.

Epoch 32 (12 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -213.41, ENRE: -189.76, KL: 23.655.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 12070 (32 ms): -203.62.
Step 12107 (32 ms): -217.7.
Step 12145 (32 ms): -197.3.
Step 12182 (32 ms): -226.09.
Step 12220 (32 ms): -213.84.
Step 12258 (32 ms): -205.09.
Step 12295 (32 ms): -225.52.
Step 12333 (32 ms): -214.09.
Step 12370 (32 ms): -205.57.
Step 12408 (15 ms): -271.82.

Epoch 33 (12.1 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -213.16, ENRE: -189.44, KL: 23.715.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 12446 (32 ms): -209.09.
Step 12483 (33 ms): -214.53.
Step 12521 (32 ms): -211.04.
Step 12558 (32 ms): -203.26.
Step 12596 (32 ms): -210.55.
Step 12634 (31 ms): -219.84.
Step 12671 (32 ms): -214.49.
Step 12709 (32 ms): -206.95.
Step 12746 (32 ms): -203.32.
Step 12784 (15 ms): -255.61.

Epoch 34 (12 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -212.7, ENRE: -189.24, KL: 23.466.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 12822 (32 ms): -215.21.
Step 12859 (32 ms): -231.52.
Step 12897 (32 ms): -209.17.
Step 12934 (32 ms): -214.54.
Step 12972 (32 ms): -216.38.
Step 13010 (32 ms): -212.01.
Step 13047 (32 ms): -210.26.
Step 13085 (32 ms): -204.34.
Step 13122 (33 ms): -228.33.
Step 13160 (15 ms): -304.36.

Epoch 35 (12.2 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -212.77, ENRE: -189.34, KL: 23.434.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 13198 (32 ms): -215.53.
Step 13235 (32 ms): -207.47.
Step 13273 (32 ms): -210.9.
Step 13310 (31 ms): -215.35.
Step 13348 (31 ms): -226.64.
Step 13386 (32 ms): -224.94.
Step 13423 (32 ms): -205.61.
Step 13461 (32 ms): -211.33.
Step 13498 (31 ms): -214.83.
Step 13536 (15 ms): -265.44.

Epoch 36 (12 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -212.55, ENRE: -189.02, KL: 23.53.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 13574 (32 ms): -216.87.
Step 13611 (32 ms): -209.4.
Step 13649 (33 ms): -211.37.
Step 13686 (32 ms): -223.33.
Step 13724 (32 ms): -216.77.
Step 13762 (32 ms): -224.32.
Step 13799 (32 ms): -201.84.
Step 13837 (32 ms): -207.18.
Step 13874 (33 ms): -209.39.
Step 13912 (15 ms): -219.77.

Epoch 37 (12.1 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -211.84, ENRE: -188.45, KL: 23.398.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 13950 (32 ms): -211.77.
Step 13987 (32 ms): -206.23.
Step 14025 (32 ms): -205.31.
Step 14062 (31 ms): -203.5.
Step 14100 (32 ms): -199.77.
Step 14138 (32 ms): -204.11.
Step 14175 (32 ms): -206.89.
Step 14213 (32 ms): -209.73.
Step 14250 (32 ms): -211.85.
Step 14288 (16 ms): -356.35.

Epoch 38 (12 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -211.42, ENRE: -188.34, KL: 23.076.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 14326 (32 ms): -205.64.
Step 14363 (33 ms): -215.47.
Step 14401 (32 ms): -210.86.
Step 14438 (32 ms): -204.09.
Step 14476 (32 ms): -207.92.
Step 14514 (32 ms): -219.77.
Step 14551 (32 ms): -219.14.
Step 14589 (32 ms): -212.05.
Step 14626 (32 ms): -205.63.
Step 14664 (15 ms): -235.59.

Epoch 39 (12.1 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -211.24, ENRE: -188.38, KL: 22.861.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 14702 (32 ms): -225.1.
Step 14739 (32 ms): -214.48.
Step 14777 (32 ms): -216.22.
Step 14814 (31 ms): -218.42.
Step 14852 (32 ms): -206.63.
Step 14890 (32 ms): -218.92.
Step 14927 (32 ms): -212.49.
Step 14965 (32 ms): -210.98.
Step 15002 (31 ms): -218.52.
Step 15040 (15 ms): -252.2.

Epoch 40 (12 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -211.05, ENRE: -188.17, KL: 22.876.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 15078 (32 ms): -206.22.
Step 15115 (32 ms): -205.43.
Step 15153 (32 ms): -211.05.
Step 15190 (33 ms): -211.48.
Step 15228 (32 ms): -206.24.
Step 15266 (32 ms): -200.05.
Step 15303 (32 ms): -203.64.
Step 15341 (32 ms): -209.7.
Step 15378 (32 ms): -220.74.
Step 15416 (15 ms): -396.18.

Epoch 41 (12.1 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -210.47, ENRE: -187.68, KL: 22.785.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 15454 (32 ms): -215.83.
Step 15491 (32 ms): -211.56.
Step 15529 (32 ms): -211.6.
Step 15566 (31 ms): -206.09.
Step 15604 (32 ms): -208.43.
Step 15642 (32 ms): -214.97.
Step 15679 (32 ms): -213.55.
Step 15717 (32 ms): -209.78.
Step 15754 (32 ms): -226.45.
Step 15792 (15 ms): -207.06.

Epoch 42 (12 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -210.52, ENRE: -187.64, KL: 22.877.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 15830 (32 ms): -220.51.
Step 15867 (32 ms): -216.12.
Step 15905 (32 ms): -211.21.
Step 15942 (32 ms): -205.96.
Step 15980 (32 ms): -214.31.
Step 16018 (33 ms): -216.53.
Step 16055 (32 ms): -207.56.
Step 16093 (32 ms): -213.99.
Step 16130 (32 ms): -211.57.
Step 16168 (15 ms): -214.58.

Epoch 43 (12.1 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -210.2, ENRE: -187.63, KL: 22.578.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 16206 (32 ms): -215.31.
Step 16243 (33 ms): -196.85.
Step 16281 (32 ms): -218.57.
Step 16318 (32 ms): -210.74.
Step 16356 (31 ms): -221.07.
Step 16394 (32 ms): -201.63.
Step 16431 (32 ms): -219.59.
Step 16469 (33 ms): -211.95.
Step 16506 (32 ms): -204.17.
Step 16544 (15 ms): -237.68.

Epoch 44 (12 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -209.89, ENRE: -187.4, KL: 22.486.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 16582 (32 ms): -213.71.
Step 16619 (32 ms): -212.52.
Step 16657 (32 ms): -205.89.
Step 16694 (32 ms): -216.41.
Step 16732 (32 ms): -203.11.
Step 16770 (32 ms): -202.47.
Step 16807 (32 ms): -227.09.
Step 16845 (32 ms): -207.16.
Step 16882 (32 ms): -211.09.
Step 16920 (15 ms): -212.34.

Epoch 45 (12.1 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -209.92, ENRE: -187.38, KL: 22.538.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 16958 (32 ms): -211.37.
Step 16995 (31 ms): -200.81.
Step 17033 (31 ms): -210.31.
Step 17070 (31 ms): -211.98.
Step 17108 (31 ms): -213.66.
Step 17146 (31 ms): -208.63.
Step 17183 (32 ms): -205.36.
Step 17221 (32 ms): -221.37.
Step 17258 (32 ms): -206.28.
Step 17296 (15 ms): -179.21.

Epoch 46 (12 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -209.37, ENRE: -187.05, KL: 22.312.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 17334 (33 ms): -207.8.
Step 17371 (32 ms): -193.46.
Step 17409 (32 ms): -215.14.
Step 17446 (32 ms): -205.75.
Step 17484 (32 ms): -200.65.
Step 17522 (32 ms): -231.88.
Step 17559 (32 ms): -198.16.
Step 17597 (32 ms): -208.18.
Step 17634 (32 ms): -219.82.
Step 17672 (15 ms): -264.3.

Epoch 47 (12.1 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -209.07, ENRE: -186.98, KL: 22.094.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 17710 (31 ms): -209.65.
Step 17747 (32 ms): -212.93.
Step 17785 (32 ms): -205.72.
Step 17822 (32 ms): -213.77.
Step 17860 (31 ms): -211.77.
Step 17898 (31 ms): -214.27.
Step 17935 (32 ms): -207.96.
Step 17973 (33 ms): -215.39.
Step 18010 (32 ms): -203.55.
Step 18048 (15 ms): -219.97.

Epoch 48 (12 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -208.64, ENRE: -186.7, KL: 21.937.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 18086 (33 ms): -208.32.
Step 18123 (32 ms): -198.05.
Step 18161 (32 ms): -206.24.
Step 18198 (32 ms): -203.74.
Step 18236 (32 ms): -202.11.
Step 18274 (32 ms): -207.92.
Step 18311 (32 ms): -202.22.
Step 18349 (32 ms): -203.28.
Step 18386 (32 ms): -212.29.
Step 18424 (15 ms): -243.1.

Epoch 49 (12.1 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -208.26, ENRE: -186.6, KL: 21.661.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 18462 (32 ms): -206.08.
Step 18499 (32 ms): -210.42.
Step 18537 (32 ms): -208.74.
Step 18574 (32 ms): -217.69.
Step 18612 (32 ms): -210.5.
Step 18650 (32 ms): -209.74.
Step 18687 (32 ms): -219.24.
Step 18725 (33 ms): -221.52.
Step 18762 (32 ms): -198.06.
Step 18800 (15 ms): -221.04.

Epoch 50 (12 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -208.51, ENRE: -186.87, KL: 21.642.
    Saving model parameters.
    Model parameters saved (111 ms).

Model trained for 50 epochs (15m 3s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (14 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (863 ms).

Converting data set value array to sparse matrix.
Data set value array converted (268 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2.04 s):  ELBO: -445.34, ENRE: -423.77, KL: 21.57.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (675 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.2831998347211253
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 40
kl weight: 1.2831998347211253
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (47 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (3.94 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.65 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 40
    hidden sizes: 97, 268, 110
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.2831998347211253
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 5 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 97)
    ENCODER/1/DENSE/biases:0             (97,)
    ENCODER/1/BATCH_NORM/beta:0          (97,)
    ENCODER/2/DENSE/weights:0            (97, 268)
    ENCODER/2/DENSE/biases:0             (268,)
    ENCODER/2/BATCH_NORM/beta:0          (268,)
    ENCODER/3/DENSE/weights:0            (268, 110)
    ENCODER/3/DENSE/biases:0             (110,)
    ENCODER/3/BATCH_NORM/beta:0          (110,)
    POSTERIOR/MU/DENSE/weights:0         (110, 40)
    POSTERIOR/MU/DENSE/biases:0          (40,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (110, 40)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (40,)
    DECODER/3/DENSE/weights:0            (40, 110)
    DECODER/3/DENSE/biases:0             (110,)
    DECODER/3/BATCH_NORM/beta:0          (110,)
    DECODER/2/DENSE/weights:0            (110, 268)
    DECODER/2/DENSE/biases:0             (268,)
    DECODER/2/BATCH_NORM/beta:0          (268,)
    DECODER/1/DENSE/weights:0            (268, 97)
    DECODER/1/DENSE/biases:0             (97,)
    DECODER/1/BATCH_NORM/beta:0          (97,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (97, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (375 ms).

Training model for 50 epochs on original values.

Step 38 (26 ms): -2316.7.
Step 75 (26 ms): -2055.3.
Step 113 (27 ms): -1799.9.
Step 150 (26 ms): -1618.9.
Step 188 (26 ms): -1471.1.
Step 226 (26 ms): -1289.6.
Step 263 (26 ms): -1227.2.
Step 301 (26 ms): -1088.8.
Step 338 (26 ms): -992.41.
Step 376 (13 ms): -874.85.

Epoch 1 (12 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (5.62 s): ELBO: -1782.2, ENRE: -1750.9, KL: 31.275.
    Saving model parameters.
    Model parameters saved (146 ms).

Step 414 (27 ms): -819.42.
Step 451 (27 ms): -753.31.
Step 489 (27 ms): -685.8.
Step 526 (26 ms): -621.31.
Step 564 (27 ms): -570.86.
Step 602 (27 ms): -536.35.
Step 639 (27 ms): -497.87.
Step 677 (27 ms): -475.83.
Step 714 (27 ms): -475.6.
Step 752 (13 ms): -430.67.

Epoch 2 (10.1 s):
    Warm-up weight: 0.2
    Evaluating model.
    Full set (5.17 s): ELBO: -985.93, ENRE: -959.89, KL: 26.048.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 790 (27 ms): -431.31.
Step 827 (27 ms): -415.06.
Step 865 (27 ms): -402.59.
Step 902 (27 ms): -411.95.
Step 940 (26 ms): -369.33.
Step 978 (27 ms): -370.02.
Step 1015 (26 ms): -362.57.
Step 1053 (27 ms): -361.7.
Step 1090 (27 ms): -327.71.
Step 1128 (12 ms): -436.43.

Epoch 3 (10.1 s):
    Warm-up weight: 0.4
    Evaluating model.
    Full set (5.14 s): ELBO: -617.96, ENRE: -603.03, KL: 14.932.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 1166 (27 ms): -320.9.
Step 1203 (27 ms): -320.82.
Step 1241 (27 ms): -335.26.
Step 1278 (27 ms): -325.96.
Step 1316 (26 ms): -312.46.
Step 1354 (27 ms): -279.81.
Step 1391 (26 ms): -288.89.
Step 1429 (27 ms): -297.04.
Step 1466 (26 ms): -284.03.
Step 1504 (12 ms): -397.08.

Epoch 4 (10.1 s):
    Warm-up weight: 0.6
    Evaluating model.
    Full set (5.18 s): ELBO: -437.97, ENRE: -426.92, KL: 11.048.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 1542 (27 ms): -274.87.
Step 1579 (27 ms): -272.44.
Step 1617 (27 ms): -279.11.
Step 1654 (26 ms): -284.15.
Step 1692 (27 ms): -274.78.
Step 1730 (28 ms): -256.53.
Step 1767 (27 ms): -266.08.
Step 1805 (26 ms): -279.43.
Step 1842 (27 ms): -257.85.
Step 1880 (12 ms): -228.14.

Epoch 5 (10.1 s):
    Warm-up weight: 0.8
    Evaluating model.
    Full set (5.12 s): ELBO: -342.9, ENRE: -333.53, KL: 9.3702.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 1918 (26 ms): -242.3.
Step 1955 (27 ms): -271.91.
Step 1993 (27 ms): -257.14.
Step 2030 (27 ms): -252.47.
Step 2068 (27 ms): -300.19.
Step 2106 (27 ms): -256.42.
Step 2143 (27 ms): -235.01.
Step 2181 (27 ms): -237.09.
Step 2218 (27 ms): -250.73.
Step 2256 (12 ms): -289.

Epoch 6 (10 s):
    Evaluating model.
    Full set (5.18 s): ELBO: -301.67, ENRE: -293.65, KL: 8.0106.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 2294 (26 ms): -241.48.
Step 2331 (27 ms): -237.86.
Step 2369 (27 ms): -231.43.
Step 2406 (27 ms): -234.51.
Step 2444 (27 ms): -266.41.
Step 2482 (27 ms): -232.04.
Step 2519 (27 ms): -235.16.
Step 2557 (27 ms): -230.42.
Step 2594 (26 ms): -235.08.
Step 2632 (12 ms): -253.65.

Epoch 7 (10.1 s):
    Evaluating model.
    Full set (5.19 s): ELBO: -271.29, ENRE: -263.54, KL: 7.7477.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 2670 (26 ms): -237.91.
Step 2707 (27 ms): -226.72.
Step 2745 (26 ms): -237.75.
Step 2782 (27 ms): -234.76.
Step 2820 (26 ms): -237.21.
Step 2858 (26 ms): -221.29.
Step 2895 (27 ms): -227.32.
Step 2933 (27 ms): -236.04.
Step 2970 (28 ms): -248.32.
Step 3008 (12 ms): -264.67.

Epoch 8 (10 s):
    Evaluating model.
    Full set (5.19 s): ELBO: -252.42, ENRE: -244.95, KL: 7.4716.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 3046 (26 ms): -236.71.
Step 3083 (27 ms): -249.9.
Step 3121 (27 ms): -216.98.
Step 3158 (27 ms): -218.92.
Step 3196 (27 ms): -227.82.
Step 3234 (26 ms): -218.18.
Step 3271 (27 ms): -235.88.
Step 3309 (27 ms): -223.35.
Step 3346 (26 ms): -220.65.
Step 3384 (12 ms): -362.2.

Epoch 9 (10.1 s):
    Evaluating model.
    Full set (5.19 s): ELBO: -237.97, ENRE: -230.24, KL: 7.7309.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 3422 (26 ms): -218.83.
Step 3459 (27 ms): -255.31.
Step 3497 (27 ms): -228.75.
Step 3534 (27 ms): -215.5.
Step 3572 (27 ms): -210.43.
Step 3610 (26 ms): -224.41.
Step 3647 (26 ms): -213.35.
Step 3685 (27 ms): -246.02.
Step 3722 (27 ms): -233.3.
Step 3760 (12 ms): -228.29.

Epoch 10 (10.1 s):
    Evaluating model.
    Full set (5.17 s): ELBO: -231.32, ENRE: -223.79, KL: 7.5267.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 3798 (27 ms): -213.32.
Step 3835 (27 ms): -221.87.
Step 3873 (27 ms): -232.06.
Step 3910 (27 ms): -218.26.
Step 3948 (26 ms): -218.22.
Step 3986 (26 ms): -222.42.
Step 4023 (27 ms): -220.59.
Step 4061 (27 ms): -230.12.
Step 4098 (27 ms): -221.75.
Step 4136 (12 ms): -292.19.

Epoch 11 (10.1 s):
    Evaluating model.
    Full set (5.18 s): ELBO: -225.53, ENRE: -218.12, KL: 7.4116.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 4174 (27 ms): -215.14.
Step 4211 (27 ms): -222.13.
Step 4249 (27 ms): -212.54.
Step 4286 (27 ms): -215.08.
Step 4324 (27 ms): -238.
Step 4362 (27 ms): -225.98.
Step 4399 (27 ms): -213.98.
Step 4437 (27 ms): -212.15.
Step 4474 (27 ms): -225.51.
Step 4512 (12 ms): -359.3.

Epoch 12 (10.1 s):
    Evaluating model.
    Full set (5.11 s): ELBO: -221, ENRE: -213.84, KL: 7.1598.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 4550 (27 ms): -223.7.
Step 4587 (27 ms): -221.84.
Step 4625 (28 ms): -223.87.
Step 4662 (27 ms): -223.99.
Step 4700 (26 ms): -221.08.
Step 4738 (27 ms): -206.53.
Step 4775 (27 ms): -231.23.
Step 4813 (27 ms): -208.33.
Step 4850 (27 ms): -208.38.
Step 4888 (12 ms): -289.68.

Epoch 13 (10.1 s):
    Evaluating model.
    Full set (5.17 s): ELBO: -218.32, ENRE: -211.37, KL: 6.9479.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 4926 (26 ms): -234.34.
Step 4963 (27 ms): -200.11.
Step 5001 (27 ms): -216.41.
Step 5038 (27 ms): -207.09.
Step 5076 (27 ms): -229.8.
Step 5114 (27 ms): -211.98.
Step 5151 (27 ms): -212.68.
Step 5189 (27 ms): -227.61.
Step 5226 (26 ms): -223.07.
Step 5264 (12 ms): -211.96.

Epoch 14 (10.1 s):
    Evaluating model.
    Full set (5.18 s): ELBO: -216.13, ENRE: -209.15, KL: 6.9767.
    Saving model parameters.
    Model parameters saved (86 ms).

Step 5302 (26 ms): -235.51.
Step 5339 (27 ms): -213.8.
Step 5377 (27 ms): -206.86.
Step 5414 (26 ms): -214.11.
Step 5452 (26 ms): -203.
Step 5490 (29 ms): -215.04.
Step 5527 (27 ms): -210.45.
Step 5565 (27 ms): -228.47.
Step 5602 (27 ms): -211.81.
Step 5640 (12 ms): -285.28.

Epoch 15 (10.1 s):
    Evaluating model.
    Full set (5.18 s): ELBO: -214.86, ENRE: -207.96, KL: 6.8957.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 5678 (27 ms): -207.79.
Step 5715 (27 ms): -212.
Step 5753 (28 ms): -213.42.
Step 5790 (27 ms): -219.24.
Step 5828 (27 ms): -216.77.
Step 5866 (27 ms): -214.76.
Step 5903 (27 ms): -205.43.
Step 5941 (27 ms): -209.71.
Step 5978 (27 ms): -230.86.
Step 6016 (12 ms): -214.5.

Epoch 16 (10.1 s):
    Evaluating model.
    Full set (5.21 s): ELBO: -213.98, ENRE: -207.35, KL: 6.6253.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 6054 (27 ms): -204.
Step 6091 (28 ms): -227.63.
Step 6129 (27 ms): -216.76.
Step 6166 (26 ms): -218.93.
Step 6204 (26 ms): -217.18.
Step 6242 (27 ms): -204.13.
Step 6279 (26 ms): -219.05.
Step 6317 (26 ms): -199.38.
Step 6354 (27 ms): -199.83.
Step 6392 (12 ms): -188.24.

Epoch 17 (10 s):
    Evaluating model.
    Full set (5.2 s): ELBO: -212.68, ENRE: -206.21, KL: 6.4668.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 6430 (27 ms): -213.9.
Step 6467 (27 ms): -208.26.
Step 6505 (27 ms): -217.48.
Step 6542 (27 ms): -225.58.
Step 6580 (27 ms): -222.94.
Step 6618 (27 ms): -203.38.
Step 6655 (27 ms): -207.75.
Step 6693 (27 ms): -201.04.
Step 6730 (27 ms): -214.07.
Step 6768 (12 ms): -300.62.

Epoch 18 (10.1 s):
    Evaluating model.
    Full set (5.21 s): ELBO: -211.54, ENRE: -205.12, KL: 6.4246.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 6806 (26 ms): -216.6.
Step 6843 (27 ms): -207.71.
Step 6881 (27 ms): -216.77.
Step 6918 (27 ms): -209.6.
Step 6956 (27 ms): -218.96.
Step 6994 (27 ms): -213.87.
Step 7031 (27 ms): -211.76.
Step 7069 (27 ms): -227.88.
Step 7106 (26 ms): -222.32.
Step 7144 (12 ms): -404.68.

Epoch 19 (10.1 s):
    Evaluating model.
    Full set (5.14 s): ELBO: -210.73, ENRE: -204.46, KL: 6.2694.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 7182 (27 ms): -220.27.
Step 7219 (27 ms): -198.49.
Step 7257 (27 ms): -196.2.
Step 7294 (26 ms): -200.06.
Step 7332 (27 ms): -190.1.
Step 7370 (27 ms): -200.14.
Step 7407 (27 ms): -205.27.
Step 7445 (27 ms): -221.19.
Step 7482 (27 ms): -202.08.
Step 7520 (12 ms): -236.3.

Epoch 20 (10.1 s):
    Evaluating model.
    Full set (5.19 s): ELBO: -209.88, ENRE: -203.51, KL: 6.3697.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 7558 (27 ms): -199.16.
Step 7595 (27 ms): -225.01.
Step 7633 (27 ms): -219.29.
Step 7670 (27 ms): -216.22.
Step 7708 (27 ms): -225.33.
Step 7746 (27 ms): -215.34.
Step 7783 (27 ms): -197.53.
Step 7821 (27 ms): -204.64.
Step 7858 (27 ms): -207.84.
Step 7896 (12 ms): -365.72.

Epoch 21 (10.1 s):
    Evaluating model.
    Full set (5.13 s): ELBO: -209.3, ENRE: -202.95, KL: 6.3471.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 7934 (27 ms): -206.82.
Step 7971 (27 ms): -205.75.
Step 8009 (26 ms): -219.02.
Step 8046 (27 ms): -208.59.
Step 8084 (26 ms): -216.9.
Step 8122 (27 ms): -218.65.
Step 8159 (27 ms): -208.55.
Step 8197 (27 ms): -206.16.
Step 8234 (27 ms): -210.48.
Step 8272 (12 ms): -261.68.

Epoch 22 (10 s):
    Evaluating model.
    Full set (5.18 s): ELBO: -208.75, ENRE: -202.6, KL: 6.1476.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 8310 (27 ms): -206.2.
Step 8347 (27 ms): -219.78.
Step 8385 (27 ms): -197.49.
Step 8422 (27 ms): -216.15.
Step 8460 (27 ms): -217.62.
Step 8498 (27 ms): -216.89.
Step 8535 (27 ms): -217.52.
Step 8573 (28 ms): -201.29.
Step 8610 (27 ms): -205.75.
Step 8648 (12 ms): -228.05.

Epoch 23 (10.1 s):
    Evaluating model.
    Full set (5.17 s): ELBO: -208.16, ENRE: -201.87, KL: 6.2823.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 8686 (27 ms): -192.68.
Step 8723 (27 ms): -206.89.
Step 8761 (27 ms): -199.86.
Step 8798 (26 ms): -209.13.
Step 8836 (27 ms): -216.86.
Step 8874 (26 ms): -201.44.
Step 8911 (27 ms): -229.69.
Step 8949 (27 ms): -204.32.
Step 8986 (26 ms): -206.54.
Step 9024 (12 ms): -292.35.

Epoch 24 (10 s):
    Evaluating model.
    Full set (5.2 s): ELBO: -207.71, ENRE: -201.4, KL: 6.3042.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 9062 (27 ms): -213.24.
Step 9099 (27 ms): -207.26.
Step 9137 (27 ms): -201.92.
Step 9174 (27 ms): -208.87.
Step 9212 (27 ms): -210.9.
Step 9250 (27 ms): -199.85.
Step 9287 (27 ms): -200.08.
Step 9325 (27 ms): -197.66.
Step 9362 (27 ms): -210.41.
Step 9400 (12 ms): -235.46.

Epoch 25 (10.1 s):
    Evaluating model.
    Full set (5.18 s): ELBO: -207.26, ENRE: -201, KL: 6.261.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 9438 (27 ms): -221.9.
Step 9475 (27 ms): -225.99.
Step 9513 (27 ms): -212.05.
Step 9550 (27 ms): -205.73.
Step 9588 (27 ms): -205.4.
Step 9626 (27 ms): -195.95.
Step 9663 (27 ms): -206.66.
Step 9701 (27 ms): -203.93.
Step 9738 (26 ms): -206.6.
Step 9776 (12 ms): -250.58.

Epoch 26 (10.1 s):
    Evaluating model.
    Full set (5.13 s): ELBO: -206.75, ENRE: -200.57, KL: 6.1822.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 9814 (27 ms): -216.55.
Step 9851 (27 ms): -200.49.
Step 9889 (27 ms): -212.75.
Step 9926 (27 ms): -212.16.
Step 9964 (27 ms): -201.39.
Step 10002 (27 ms): -214.61.
Step 10039 (27 ms): -197.28.
Step 10077 (27 ms): -194.9.
Step 10114 (26 ms): -199.77.
Step 10152 (12 ms): -216.9.

Epoch 27 (10.1 s):
    Evaluating model.
    Full set (5.18 s): ELBO: -206.62, ENRE: -200.51, KL: 6.1124.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 10190 (26 ms): -195.15.
Step 10227 (27 ms): -220.51.
Step 10265 (27 ms): -207.19.
Step 10302 (27 ms): -202.35.
Step 10340 (26 ms): -203.7.
Step 10378 (26 ms): -204.85.
Step 10415 (27 ms): -201.01.
Step 10453 (27 ms): -209.77.
Step 10490 (27 ms): -200.75.
Step 10528 (12 ms): -222.48.

Epoch 28 (10.1 s):
    Evaluating model.
    Full set (5.12 s): ELBO: -205.98, ENRE: -199.75, KL: 6.2258.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 10566 (26 ms): -207.62.
Step 10603 (27 ms): -195.42.
Step 10641 (27 ms): -200.98.
Step 10678 (27 ms): -209.95.
Step 10716 (27 ms): -205.57.
Step 10754 (27 ms): -201.26.
Step 10791 (27 ms): -204.4.
Step 10829 (27 ms): -232.24.
Step 10866 (27 ms): -199.76.
Step 10904 (12 ms): -491.81.

Epoch 29 (10.1 s):
    Evaluating model.
    Full set (5.19 s): ELBO: -205.87, ENRE: -199.66, KL: 6.2179.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 10942 (26 ms): -204.93.
Step 10979 (27 ms): -213.48.
Step 11017 (27 ms): -204.53.
Step 11054 (27 ms): -208.33.
Step 11092 (26 ms): -212.69.
Step 11130 (27 ms): -205.09.
Step 11167 (27 ms): -201.3.
Step 11205 (27 ms): -193.33.
Step 11242 (27 ms): -208.04.
Step 11280 (12 ms): -249.38.

Epoch 30 (10.1 s):
    Evaluating model.
    Full set (5.2 s): ELBO: -205.62, ENRE: -199.47, KL: 6.1587.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 11318 (26 ms): -203.9.
Step 11355 (26 ms): -190.64.
Step 11393 (27 ms): -201.63.
Step 11430 (27 ms): -194.02.
Step 11468 (27 ms): -208.8.
Step 11506 (26 ms): -205.38.
Step 11543 (26 ms): -188.95.
Step 11581 (27 ms): -211.44.
Step 11618 (26 ms): -204.63.
Step 11656 (12 ms): -222.71.

Epoch 31 (10 s):
    Evaluating model.
    Full set (5.19 s): ELBO: -205.06, ENRE: -198.86, KL: 6.2011.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 11694 (27 ms): -208.59.
Step 11731 (27 ms): -214.91.
Step 11769 (27 ms): -211.99.
Step 11806 (27 ms): -212.64.
Step 11844 (27 ms): -207.92.
Step 11882 (26 ms): -211.41.
Step 11919 (27 ms): -205.87.
Step 11957 (27 ms): -210.75.
Step 11994 (27 ms): -199.29.
Step 12032 (12 ms): -322.7.

Epoch 32 (10.1 s):
    Evaluating model.
    Full set (5.21 s): ELBO: -204.84, ENRE: -198.64, KL: 6.2022.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 12070 (27 ms): -202.45.
Step 12107 (27 ms): -203.22.
Step 12145 (27 ms): -199.64.
Step 12182 (26 ms): -193.56.
Step 12220 (27 ms): -199.2.
Step 12258 (27 ms): -203.22.
Step 12295 (27 ms): -207.51.
Step 12333 (26 ms): -207.75.
Step 12370 (27 ms): -206.64.
Step 12408 (12 ms): -302.09.

Epoch 33 (10.1 s):
    Evaluating model.
    Full set (5.19 s): ELBO: -204.63, ENRE: -198.49, KL: 6.1357.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 12446 (27 ms): -206.64.
Step 12483 (28 ms): -199.84.
Step 12521 (27 ms): -196.21.
Step 12558 (27 ms): -203.62.
Step 12596 (27 ms): -192.74.
Step 12634 (27 ms): -202.7.
Step 12671 (27 ms): -201.71.
Step 12709 (27 ms): -197.15.
Step 12746 (27 ms): -202.29.
Step 12784 (12 ms): -325.97.

Epoch 34 (10.2 s):
    Evaluating model.
    Full set (5.21 s): ELBO: -204.64, ENRE: -198.38, KL: 6.2624.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 12822 (27 ms): -191.91.
Step 12859 (27 ms): -194.58.
Step 12897 (27 ms): -198.53.
Step 12934 (27 ms): -195.28.
Step 12972 (27 ms): -207.89.
Step 13010 (27 ms): -209.1.
Step 13047 (27 ms): -214.77.
Step 13085 (27 ms): -210.45.
Step 13122 (27 ms): -193.43.
Step 13160 (12 ms): -310.99.

Epoch 35 (10.1 s):
    Evaluating model.
    Full set (5.12 s): ELBO: -204.33, ENRE: -198.13, KL: 6.2015.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 13198 (27 ms): -222.31.
Step 13235 (27 ms): -205.33.
Step 13273 (26 ms): -207.08.
Step 13310 (27 ms): -196.99.
Step 13348 (27 ms): -204.95.
Step 13386 (27 ms): -202.88.
Step 13423 (27 ms): -202.75.
Step 13461 (27 ms): -207.25.
Step 13498 (26 ms): -194.62.
Step 13536 (12 ms): -418.55.

Epoch 36 (10.1 s):
    Evaluating model.
    Full set (5.18 s): ELBO: -203.86, ENRE: -197.63, KL: 6.2241.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 13574 (27 ms): -203.29.
Step 13611 (27 ms): -202.05.
Step 13649 (27 ms): -214.02.
Step 13686 (27 ms): -213.52.
Step 13724 (26 ms): -198.65.
Step 13762 (27 ms): -206.2.
Step 13799 (27 ms): -205.45.
Step 13837 (27 ms): -196.86.
Step 13874 (27 ms): -209.67.
Step 13912 (12 ms): -189.1.

Epoch 37 (10.1 s):
    Evaluating model.
    Full set (5.18 s): ELBO: -203.7, ENRE: -197.42, KL: 6.2799.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 13950 (27 ms): -202.35.
Step 13987 (27 ms): -197.51.
Step 14025 (27 ms): -202.95.
Step 14062 (27 ms): -210.87.
Step 14100 (26 ms): -195.59.
Step 14138 (26 ms): -222.24.
Step 14175 (27 ms): -200.32.
Step 14213 (27 ms): -200.32.
Step 14250 (27 ms): -199.72.
Step 14288 (12 ms): -190.42.

Epoch 38 (10 s):
    Evaluating model.
    Full set (5.18 s): ELBO: -203.51, ENRE: -197.3, KL: 6.2045.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 14326 (27 ms): -206.47.
Step 14363 (27 ms): -212.62.
Step 14401 (27 ms): -203.38.
Step 14438 (27 ms): -221.28.
Step 14476 (27 ms): -199.17.
Step 14514 (27 ms): -208.26.
Step 14551 (27 ms): -189.8.
Step 14589 (27 ms): -202.27.
Step 14626 (27 ms): -187.1.
Step 14664 (12 ms): -187.76.

Epoch 39 (10.1 s):
    Evaluating model.
    Full set (5.18 s): ELBO: -203.11, ENRE: -197.01, KL: 6.0957.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 14702 (27 ms): -207.37.
Step 14739 (27 ms): -201.3.
Step 14777 (27 ms): -203.87.
Step 14814 (27 ms): -219.87.
Step 14852 (27 ms): -196.29.
Step 14890 (26 ms): -220.41.
Step 14927 (26 ms): -205.99.
Step 14965 (27 ms): -201.
Step 15002 (27 ms): -202.01.
Step 15040 (12 ms): -176.09.

Epoch 40 (10.1 s):
    Evaluating model.
    Full set (5.19 s): ELBO: -203.13, ENRE: -196.85, KL: 6.271.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 15078 (27 ms): -197.8.
Step 15115 (28 ms): -201.91.
Step 15153 (27 ms): -221.22.
Step 15190 (27 ms): -202.39.
Step 15228 (27 ms): -195.
Step 15266 (27 ms): -215.08.
Step 15303 (27 ms): -203.02.
Step 15341 (27 ms): -196.76.
Step 15378 (27 ms): -206.11.
Step 15416 (12 ms): -183.74.

Epoch 41 (10.1 s):
    Evaluating model.
    Full set (5.19 s): ELBO: -202.8, ENRE: -196.57, KL: 6.2332.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 15454 (27 ms): -231.4.
Step 15491 (27 ms): -196.85.
Step 15529 (27 ms): -195.51.
Step 15566 (27 ms): -220.92.
Step 15604 (27 ms): -199.54.
Step 15642 (27 ms): -198.48.
Step 15679 (27 ms): -200.79.
Step 15717 (27 ms): -200.76.
Step 15754 (26 ms): -206.24.
Step 15792 (12 ms): -205.29.

Epoch 42 (10.1 s):
    Evaluating model.
    Full set (5.11 s): ELBO: -202.66, ENRE: -196.5, KL: 6.1551.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 15830 (26 ms): -195.85.
Step 15867 (27 ms): -214.45.
Step 15905 (27 ms): -205.24.
Step 15942 (27 ms): -225.34.
Step 15980 (27 ms): -198.1.
Step 16018 (27 ms): -195.44.
Step 16055 (27 ms): -206.16.
Step 16093 (27 ms): -199.51.
Step 16130 (27 ms): -200.26.
Step 16168 (12 ms): -231.99.

Epoch 43 (10.1 s):
    Evaluating model.
    Full set (5.21 s): ELBO: -202.45, ENRE: -196.13, KL: 6.3146.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 16206 (27 ms): -211.94.
Step 16243 (27 ms): -212.59.
Step 16281 (27 ms): -204.49.
Step 16318 (27 ms): -207.88.
Step 16356 (26 ms): -201.18.
Step 16394 (27 ms): -193.56.
Step 16431 (27 ms): -202.44.
Step 16469 (27 ms): -193.96.
Step 16506 (27 ms): -189.43.
Step 16544 (12 ms): -196.29.

Epoch 44 (10.1 s):
    Evaluating model.
    Full set (5.16 s): ELBO: -202.55, ENRE: -196.39, KL: 6.1565.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 16582 (26 ms): -203.5.
Step 16619 (27 ms): -207.87.
Step 16657 (27 ms): -199.86.
Step 16694 (27 ms): -199.08.
Step 16732 (26 ms): -203.8.
Step 16770 (27 ms): -188.02.
Step 16807 (27 ms): -191.78.
Step 16845 (27 ms): -202.01.
Step 16882 (27 ms): -199.5.
Step 16920 (12 ms): -297.59.

Epoch 45 (10.1 s):
    Evaluating model.
    Full set (5.2 s): ELBO: -202.36, ENRE: -196.16, KL: 6.1986.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 16958 (27 ms): -205.86.
Step 16995 (27 ms): -208.51.
Step 17033 (27 ms): -195.99.
Step 17070 (27 ms): -207.97.
Step 17108 (27 ms): -206.93.
Step 17146 (26 ms): -194.25.
Step 17183 (27 ms): -195.43.
Step 17221 (27 ms): -218.56.
Step 17258 (27 ms): -191.39.
Step 17296 (12 ms): -195.86.

Epoch 46 (10.1 s):
    Evaluating model.
    Full set (5.2 s): ELBO: -202.08, ENRE: -195.86, KL: 6.2272.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 17334 (27 ms): -194.82.
Step 17371 (27 ms): -224.12.
Step 17409 (27 ms): -207.36.
Step 17446 (27 ms): -212.26.
Step 17484 (27 ms): -192.99.
Step 17522 (27 ms): -198.93.
Step 17559 (27 ms): -199.57.
Step 17597 (27 ms): -194.91.
Step 17634 (27 ms): -191.91.
Step 17672 (12 ms): -349.96.

Epoch 47 (10.1 s):
    Evaluating model.
    Full set (5.18 s): ELBO: -201.93, ENRE: -195.71, KL: 6.2188.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 17710 (27 ms): -198.85.
Step 17747 (27 ms): -214.12.
Step 17785 (27 ms): -206.78.
Step 17822 (27 ms): -198.16.
Step 17860 (26 ms): -214.83.
Step 17898 (27 ms): -199.48.
Step 17935 (28 ms): -210.98.
Step 17973 (27 ms): -206.64.
Step 18010 (27 ms): -215.77.
Step 18048 (12 ms): -256.28.

Epoch 48 (10.1 s):
    Evaluating model.
    Full set (5.19 s): ELBO: -201.98, ENRE: -195.83, KL: 6.1519.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 18086 (27 ms): -208.99.
Step 18123 (27 ms): -199.07.
Step 18161 (27 ms): -196.74.
Step 18198 (27 ms): -200.91.
Step 18236 (27 ms): -192.
Step 18274 (26 ms): -197.64.
Step 18311 (27 ms): -196.21.
Step 18349 (26 ms): -189.16.
Step 18386 (26 ms): -208.17.
Step 18424 (12 ms): -231.41.

Epoch 49 (10.1 s):
    Evaluating model.
    Full set (5.1 s): ELBO: -201.87, ENRE: -195.57, KL: 6.3034.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 18462 (26 ms): -198.39.
Step 18499 (27 ms): -209.78.
Step 18537 (27 ms): -210.12.
Step 18574 (27 ms): -199.25.
Step 18612 (27 ms): -201.62.
Step 18650 (26 ms): -204.36.
Step 18687 (27 ms): -203.04.
Step 18725 (27 ms): -198.66.
Step 18762 (27 ms): -195.82.
Step 18800 (12 ms): -300.7.

Epoch 50 (10.1 s):
    Evaluating model.
    Full set (5.18 s): ELBO: -201.5, ENRE: -195.22, KL: 6.2777.
    Saving model parameters.
    Model parameters saved (93 ms).

Model trained for 50 epochs (12m 51s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (851 ms).

Converting data set value array to sparse matrix.
Data set value array converted (269 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.61 s):  ELBO: -419.32, ENRE: -413.03, KL: 6.2885.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (533 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.07088749804392
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 32
kl weight: 1.07088749804392
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (42 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.67 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 32
    hidden sizes: 270, 159, 162, 170, 177
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.07088749804392
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 5 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 270)
    ENCODER/1/DENSE/biases:0             (270,)
    ENCODER/1/BATCH_NORM/beta:0          (270,)
    ENCODER/2/DENSE/weights:0            (270, 159)
    ENCODER/2/DENSE/biases:0             (159,)
    ENCODER/2/BATCH_NORM/beta:0          (159,)
    ENCODER/3/DENSE/weights:0            (159, 162)
    ENCODER/3/DENSE/biases:0             (162,)
    ENCODER/3/BATCH_NORM/beta:0          (162,)
    ENCODER/4/DENSE/weights:0            (162, 170)
    ENCODER/4/DENSE/biases:0             (170,)
    ENCODER/4/BATCH_NORM/beta:0          (170,)
    ENCODER/5/DENSE/weights:0            (170, 177)
    ENCODER/5/DENSE/biases:0             (177,)
    ENCODER/5/BATCH_NORM/beta:0          (177,)
    POSTERIOR/MU/DENSE/weights:0         (177, 32)
    POSTERIOR/MU/DENSE/biases:0          (32,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (177, 32)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (32,)
    DECODER/5/DENSE/weights:0            (32, 177)
    DECODER/5/DENSE/biases:0             (177,)
    DECODER/5/BATCH_NORM/beta:0          (177,)
    DECODER/4/DENSE/weights:0            (177, 170)
    DECODER/4/DENSE/biases:0             (170,)
    DECODER/4/BATCH_NORM/beta:0          (170,)
    DECODER/3/DENSE/weights:0            (170, 162)
    DECODER/3/DENSE/biases:0             (162,)
    DECODER/3/BATCH_NORM/beta:0          (162,)
    DECODER/2/DENSE/weights:0            (162, 159)
    DECODER/2/DENSE/biases:0             (159,)
    DECODER/2/BATCH_NORM/beta:0          (159,)
    DECODER/1/DENSE/weights:0            (159, 270)
    DECODER/1/DENSE/biases:0             (270,)
    DECODER/1/BATCH_NORM/beta:0          (270,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (270, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (564 ms).

Training model for 50 epochs on original values.

Step 38 (37 ms): -1978.9.
Step 75 (37 ms): -1500.6.
Step 113 (37 ms): -1189.7.
Step 150 (37 ms): -974.9.
Step 188 (37 ms): -856.93.
Step 226 (37 ms): -715.37.
Step 263 (38 ms): -655.57.
Step 301 (37 ms): -607.96.
Step 338 (38 ms): -571.04.
Step 376 (19 ms): -555.93.

Epoch 1 (16.9 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (7.02 s): ELBO: -1702.8, ENRE: -1681.7, KL: 21.138.
    Saving model parameters.
    Model parameters saved (201 ms).

Step 414 (37 ms): -464.18.
Step 451 (37 ms): -427.06.
Step 489 (37 ms): -388.69.
Step 526 (37 ms): -376.72.
Step 564 (37 ms): -370.09.
Step 602 (37 ms): -333.4.
Step 639 (37 ms): -330.91.
Step 677 (37 ms): -346.73.
Step 714 (36 ms): -302.47.
Step 752 (17 ms): -392.4.

Epoch 2 (13.9 s):
    Warm-up weight: 0.2
    Evaluating model.
    Full set (6.21 s): ELBO: -973.58, ENRE: -958.82, KL: 14.759.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 790 (38 ms): -290.09.
Step 827 (37 ms): -280.68.
Step 865 (38 ms): -279.53.
Step 902 (37 ms): -274.43.
Step 940 (37 ms): -270.43.
Step 978 (37 ms): -252.7.
Step 1015 (38 ms): -264.37.
Step 1053 (37 ms): -260.8.
Step 1090 (37 ms): -257.04.
Step 1128 (17 ms): -237.61.

Epoch 3 (14 s):
    Warm-up weight: 0.4
    Evaluating model.
    Full set (6.27 s): ELBO: -582.09, ENRE: -571.55, KL: 10.535.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 1166 (37 ms): -280.22.
Step 1203 (37 ms): -257.7.
Step 1241 (37 ms): -242.04.
Step 1278 (37 ms): -237.28.
Step 1316 (36 ms): -221.15.
Step 1354 (37 ms): -245.8.
Step 1391 (38 ms): -238.6.
Step 1429 (37 ms): -235.47.
Step 1466 (36 ms): -242.92.
Step 1504 (17 ms): -217.16.

Epoch 4 (13.9 s):
    Warm-up weight: 0.6
    Evaluating model.
    Full set (6.27 s): ELBO: -398.31, ENRE: -388.71, KL: 9.6024.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 1542 (37 ms): -248.11.
Step 1579 (37 ms): -237.85.
Step 1617 (37 ms): -241.52.
Step 1654 (37 ms): -221.55.
Step 1692 (37 ms): -231.96.
Step 1730 (37 ms): -219.58.
Step 1767 (37 ms): -233.79.
Step 1805 (37 ms): -220.28.
Step 1842 (37 ms): -220.57.
Step 1880 (19 ms): -260.64.

Epoch 5 (14 s):
    Warm-up weight: 0.8
    Evaluating model.
    Full set (6.27 s): ELBO: -300.09, ENRE: -290.87, KL: 9.226.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 1918 (37 ms): -239.52.
Step 1955 (37 ms): -212.19.
Step 1993 (37 ms): -239.53.
Step 2030 (37 ms): -222.13.
Step 2068 (37 ms): -215.3.
Step 2106 (37 ms): -226.43.
Step 2143 (37 ms): -229.94.
Step 2181 (37 ms): -225.22.
Step 2218 (37 ms): -222.24.
Step 2256 (17 ms): -343.68.

Epoch 6 (13.9 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -260.82, ENRE: -252.31, KL: 8.5136.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 2294 (38 ms): -225.83.
Step 2331 (37 ms): -216.79.
Step 2369 (37 ms): -209.43.
Step 2406 (37 ms): -218.06.
Step 2444 (37 ms): -229.51.
Step 2482 (37 ms): -213.85.
Step 2519 (38 ms): -220.59.
Step 2557 (37 ms): -216.11.
Step 2594 (37 ms): -216.19.
Step 2632 (17 ms): -219.19.

Epoch 7 (14 s):
    Evaluating model.
    Full set (6.22 s): ELBO: -239.22, ENRE: -230.96, KL: 8.2626.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 2670 (36 ms): -210.28.
Step 2707 (37 ms): -222.52.
Step 2745 (38 ms): -207.1.
Step 2782 (37 ms): -213.42.
Step 2820 (37 ms): -231.01.
Step 2858 (37 ms): -212.69.
Step 2895 (38 ms): -219.65.
Step 2933 (38 ms): -204.32.
Step 2970 (37 ms): -213.73.
Step 3008 (17 ms): -265.99.

Epoch 8 (14 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -227.35, ENRE: -218.95, KL: 8.3981.
    Saving model parameters.
    Model parameters saved (129 ms).

Step 3046 (37 ms): -225.12.
Step 3083 (37 ms): -203.45.
Step 3121 (37 ms): -215.03.
Step 3158 (37 ms): -214.97.
Step 3196 (37 ms): -221.86.
Step 3234 (37 ms): -218.9.
Step 3271 (37 ms): -226.64.
Step 3309 (37 ms): -223.51.
Step 3346 (37 ms): -222.
Step 3384 (17 ms): -204.22.

Epoch 9 (13.9 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -221.1, ENRE: -212.99, KL: 8.1118.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 3422 (37 ms): -208.03.
Step 3459 (37 ms): -203.52.
Step 3497 (37 ms): -217.18.
Step 3534 (37 ms): -205.61.
Step 3572 (37 ms): -197.9.
Step 3610 (37 ms): -208.68.
Step 3647 (37 ms): -205.87.
Step 3685 (37 ms): -217.19.
Step 3722 (37 ms): -213.34.
Step 3760 (17 ms): -213.82.

Epoch 10 (14 s):
    Evaluating model.
    Full set (6.26 s): ELBO: -219.77, ENRE: -211.93, KL: 7.8391.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 3798 (37 ms): -213.19.
Step 3835 (37 ms): -206.74.
Step 3873 (37 ms): -210.29.
Step 3910 (37 ms): -205.16.
Step 3948 (36 ms): -219.37.
Step 3986 (37 ms): -222.18.
Step 4023 (37 ms): -209.97.
Step 4061 (37 ms): -216.44.
Step 4098 (37 ms): -197.32.
Step 4136 (17 ms): -288.19.

Epoch 11 (13.9 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -214.96, ENRE: -207.17, KL: 7.7914.
    Saving model parameters.
    Model parameters saved (134 ms).

Step 4174 (37 ms): -210.34.
Step 4211 (37 ms): -213.82.
Step 4249 (37 ms): -208.51.
Step 4286 (37 ms): -210.4.
Step 4324 (37 ms): -206.89.
Step 4362 (37 ms): -209.4.
Step 4399 (37 ms): -231.43.
Step 4437 (37 ms): -220.11.
Step 4474 (37 ms): -201.23.
Step 4512 (17 ms): -241.75.

Epoch 12 (14 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -214.51, ENRE: -207.18, KL: 7.3346.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 4550 (36 ms): -207.81.
Step 4587 (36 ms): -209.44.
Step 4625 (36 ms): -208.43.
Step 4662 (36 ms): -205.2.
Step 4700 (37 ms): -203.75.
Step 4738 (37 ms): -206.41.
Step 4775 (37 ms): -214.94.
Step 4813 (38 ms): -204.14.
Step 4850 (37 ms): -209.75.
Step 4888 (17 ms): -249.28.

Epoch 13 (14 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -212.41, ENRE: -205.09, KL: 7.3232.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 4926 (37 ms): -207.93.
Step 4963 (37 ms): -219.07.
Step 5001 (38 ms): -217.77.
Step 5038 (37 ms): -207.47.
Step 5076 (37 ms): -214.75.
Step 5114 (38 ms): -200.26.
Step 5151 (37 ms): -213.6.
Step 5189 (37 ms): -195.76.
Step 5226 (37 ms): -199.79.
Step 5264 (17 ms): -195.8.

Epoch 14 (14 s):
    Evaluating model.
    Full set (6.2 s): ELBO: -214.03, ENRE: -206.74, KL: 7.2866.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 5302 (37 ms): -216.92.
Step 5339 (37 ms): -210.26.
Step 5377 (37 ms): -213.03.
Step 5414 (38 ms): -214.97.
Step 5452 (38 ms): -220.56.
Step 5490 (38 ms): -210.55.
Step 5527 (37 ms): -202.7.
Step 5565 (38 ms): -201.95.
Step 5602 (38 ms): -208.46.
Step 5640 (17 ms): -372.89.

Epoch 15 (14 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -211.27, ENRE: -204.12, KL: 7.1531.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 5678 (37 ms): -215.61.
Step 5715 (38 ms): -211.39.
Step 5753 (37 ms): -202.31.
Step 5790 (37 ms): -205.26.
Step 5828 (37 ms): -207.39.
Step 5866 (37 ms): -194.94.
Step 5903 (37 ms): -212.14.
Step 5941 (36 ms): -197.85.
Step 5978 (37 ms): -209.08.
Step 6016 (17 ms): -445.

Epoch 16 (13.9 s):
    Evaluating model.
    Full set (6.22 s): ELBO: -211.58, ENRE: -204.5, KL: 7.0794.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 6054 (37 ms): -201.88.
Step 6091 (37 ms): -201.
Step 6129 (37 ms): -209.61.
Step 6166 (37 ms): -198.51.
Step 6204 (37 ms): -203.56.
Step 6242 (37 ms): -202.92.
Step 6279 (37 ms): -214.68.
Step 6317 (37 ms): -195.32.
Step 6354 (38 ms): -206.96.
Step 6392 (17 ms): -232.59.

Epoch 17 (14 s):
    Evaluating model.
    Full set (6.29 s): ELBO: -210.02, ENRE: -202.99, KL: 7.0347.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 6430 (37 ms): -203.19.
Step 6467 (37 ms): -197.45.
Step 6505 (37 ms): -212.36.
Step 6542 (37 ms): -210.24.
Step 6580 (37 ms): -212.7.
Step 6618 (38 ms): -226.25.
Step 6655 (37 ms): -213.85.
Step 6693 (37 ms): -206.32.
Step 6730 (37 ms): -195.04.
Step 6768 (17 ms): -240.65.

Epoch 18 (13.9 s):
    Evaluating model.
    Full set (6.35 s): ELBO: -208.58, ENRE: -201.6, KL: 6.9793.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 6806 (38 ms): -201.29.
Step 6843 (37 ms): -207.7.
Step 6881 (38 ms): -203.89.
Step 6918 (38 ms): -203.38.
Step 6956 (38 ms): -204.16.
Step 6994 (38 ms): -205.31.
Step 7031 (37 ms): -203.67.
Step 7069 (38 ms): -207.88.
Step 7106 (37 ms): -196.54.
Step 7144 (17 ms): -213.59.

Epoch 19 (14.2 s):
    Evaluating model.
    Full set (6.33 s): ELBO: -207.6, ENRE: -200.62, KL: 6.976.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 7182 (37 ms): -209.39.
Step 7219 (38 ms): -194.44.
Step 7257 (37 ms): -199.31.
Step 7294 (37 ms): -199.38.
Step 7332 (38 ms): -212.89.
Step 7370 (38 ms): -215.38.
Step 7407 (37 ms): -206.12.
Step 7445 (38 ms): -206.96.
Step 7482 (37 ms): -203.75.
Step 7520 (17 ms): -244.96.

Epoch 20 (14.1 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -207.23, ENRE: -200.35, KL: 6.8815.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 7558 (37 ms): -203.61.
Step 7595 (37 ms): -194.8.
Step 7633 (38 ms): -214.9.
Step 7670 (38 ms): -201.39.
Step 7708 (37 ms): -201.71.
Step 7746 (37 ms): -208.46.
Step 7783 (38 ms): -201.31.
Step 7821 (37 ms): -221.31.
Step 7858 (38 ms): -198.46.
Step 7896 (17 ms): -288.29.

Epoch 21 (14 s):
    Evaluating model.
    Full set (6.2 s): ELBO: -206.4, ENRE: -199.68, KL: 6.7166.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 7934 (37 ms): -201.29.
Step 7971 (38 ms): -206.18.
Step 8009 (38 ms): -211.06.
Step 8046 (38 ms): -205.42.
Step 8084 (37 ms): -200.23.
Step 8122 (37 ms): -213.74.
Step 8159 (37 ms): -197.52.
Step 8197 (37 ms): -197.33.
Step 8234 (38 ms): -210.1.
Step 8272 (17 ms): -215.97.

Epoch 22 (14.1 s):
    Evaluating model.
    Full set (6.33 s): ELBO: -205.71, ENRE: -198.82, KL: 6.89.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 8310 (37 ms): -206.97.
Step 8347 (38 ms): -209.31.
Step 8385 (37 ms): -206.18.
Step 8422 (37 ms): -207.72.
Step 8460 (37 ms): -200.68.
Step 8498 (37 ms): -200.5.
Step 8535 (36 ms): -205.82.
Step 8573 (36 ms): -200.82.
Step 8610 (37 ms): -229.77.
Step 8648 (17 ms): -195.93.

Epoch 23 (13.9 s):
    Evaluating model.
    Full set (6.22 s): ELBO: -204.98, ENRE: -198.34, KL: 6.6383.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 8686 (37 ms): -192.88.
Step 8723 (37 ms): -203.98.
Step 8761 (37 ms): -200.18.
Step 8798 (37 ms): -207.13.
Step 8836 (38 ms): -199.26.
Step 8874 (37 ms): -202.59.
Step 8911 (38 ms): -212.04.
Step 8949 (37 ms): -204.01.
Step 8986 (37 ms): -199.73.
Step 9024 (17 ms): -211.98.

Epoch 24 (13.9 s):
    Evaluating model.
    Full set (6.26 s): ELBO: -204.54, ENRE: -197.6, KL: 6.9394.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 9062 (37 ms): -204.74.
Step 9099 (36 ms): -191.62.
Step 9137 (37 ms): -205.65.
Step 9174 (36 ms): -213.41.
Step 9212 (37 ms): -191.22.
Step 9250 (37 ms): -210.84.
Step 9287 (37 ms): -207.77.
Step 9325 (37 ms): -206.13.
Step 9362 (37 ms): -204.81.
Step 9400 (17 ms): -181.68.

Epoch 25 (13.9 s):
    Evaluating model.
    Full set (6.26 s): ELBO: -204.63, ENRE: -197.79, KL: 6.8394.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 9438 (38 ms): -199.64.
Step 9475 (37 ms): -191.33.
Step 9513 (38 ms): -209.42.
Step 9550 (37 ms): -208.5.
Step 9588 (37 ms): -200.6.
Step 9626 (37 ms): -211.09.
Step 9663 (38 ms): -207.14.
Step 9701 (37 ms): -196.77.
Step 9738 (38 ms): -192.71.
Step 9776 (17 ms): -299.74.

Epoch 26 (14 s):
    Evaluating model.
    Full set (6.24 s): ELBO: -204.48, ENRE: -197.62, KL: 6.8627.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 9814 (37 ms): -187.17.
Step 9851 (37 ms): -203.48.
Step 9889 (36 ms): -191.38.
Step 9926 (37 ms): -209.37.
Step 9964 (37 ms): -204.89.
Step 10002 (37 ms): -195.75.
Step 10039 (37 ms): -209.81.
Step 10077 (37 ms): -206.66.
Step 10114 (37 ms): -194.08.
Step 10152 (17 ms): -196.38.

Epoch 27 (13.9 s):
    Evaluating model.
    Full set (6.26 s): ELBO: -204.49, ENRE: -197.59, KL: 6.8997.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 10190 (38 ms): -194.94.
Step 10227 (39 ms): -192.18.
Step 10265 (37 ms): -209.31.
Step 10302 (37 ms): -201.93.
Step 10340 (37 ms): -201.04.
Step 10378 (37 ms): -205.42.
Step 10415 (37 ms): -205.07.
Step 10453 (38 ms): -205.13.
Step 10490 (37 ms): -197.72.
Step 10528 (17 ms): -379.29.

Epoch 28 (14 s):
    Evaluating model.
    Full set (6.18 s): ELBO: -203.62, ENRE: -196.71, KL: 6.9162.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 10566 (37 ms): -201.72.
Step 10603 (37 ms): -197.86.
Step 10641 (36 ms): -197.45.
Step 10678 (37 ms): -202.64.
Step 10716 (37 ms): -196.01.
Step 10754 (37 ms): -199.87.
Step 10791 (37 ms): -196.75.
Step 10829 (37 ms): -199.22.
Step 10866 (37 ms): -198.83.
Step 10904 (17 ms): -321.96.

Epoch 29 (14 s):
    Evaluating model.
    Full set (6.26 s): ELBO: -203.33, ENRE: -196.46, KL: 6.8643.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 10942 (38 ms): -205.22.
Step 10979 (38 ms): -208.26.
Step 11017 (37 ms): -192.98.
Step 11054 (37 ms): -216.35.
Step 11092 (36 ms): -201.64.
Step 11130 (37 ms): -205.73.
Step 11167 (37 ms): -189.32.
Step 11205 (37 ms): -200.91.
Step 11242 (37 ms): -201.47.
Step 11280 (17 ms): -275.88.

Epoch 30 (13.9 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -202.77, ENRE: -196.06, KL: 6.7087.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 11318 (37 ms): -202.53.
Step 11355 (37 ms): -209.16.
Step 11393 (38 ms): -196.35.
Step 11430 (37 ms): -203.08.
Step 11468 (37 ms): -193.19.
Step 11506 (37 ms): -199.33.
Step 11543 (37 ms): -194.72.
Step 11581 (38 ms): -209.43.
Step 11618 (37 ms): -186.85.
Step 11656 (17 ms): -264.72.

Epoch 31 (14 s):
    Evaluating model.
    Full set (6.29 s): ELBO: -202.63, ENRE: -195.84, KL: 6.79.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 11694 (37 ms): -196.49.
Step 11731 (37 ms): -201.38.
Step 11769 (37 ms): -202.03.
Step 11806 (36 ms): -192.95.
Step 11844 (37 ms): -196.07.
Step 11882 (37 ms): -205.79.
Step 11919 (38 ms): -215.24.
Step 11957 (38 ms): -190.9.
Step 11994 (37 ms): -196.03.
Step 12032 (17 ms): -199.99.

Epoch 32 (13.9 s):
    Evaluating model.
    Full set (6.29 s): ELBO: -202.36, ENRE: -195.65, KL: 6.7079.
    Saving model parameters.
    Model parameters saved (127 ms).

Step 12070 (37 ms): -208.84.
Step 12107 (37 ms): -204.73.
Step 12145 (37 ms): -194.99.
Step 12182 (38 ms): -202.53.
Step 12220 (37 ms): -211.09.
Step 12258 (37 ms): -197.56.
Step 12295 (37 ms): -185.97.
Step 12333 (37 ms): -195.57.
Step 12370 (38 ms): -193.99.
Step 12408 (17 ms): -205.29.

Epoch 33 (14 s):
    Evaluating model.
    Full set (6.24 s): ELBO: -201.93, ENRE: -195.22, KL: 6.707.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 12446 (37 ms): -197.98.
Step 12483 (37 ms): -203.05.
Step 12521 (37 ms): -206.96.
Step 12558 (37 ms): -198.23.
Step 12596 (37 ms): -199.24.
Step 12634 (37 ms): -199.52.
Step 12671 (37 ms): -200.05.
Step 12709 (37 ms): -192.84.
Step 12746 (37 ms): -196.04.
Step 12784 (17 ms): -252.87.

Epoch 34 (13.9 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -202.36, ENRE: -195.6, KL: 6.7564.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 12822 (37 ms): -211.32.
Step 12859 (38 ms): -211.68.
Step 12897 (37 ms): -212.24.
Step 12934 (38 ms): -203.22.
Step 12972 (38 ms): -214.37.
Step 13010 (37 ms): -189.42.
Step 13047 (37 ms): -191.53.
Step 13085 (37 ms): -190.01.
Step 13122 (37 ms): -216.6.
Step 13160 (17 ms): -202.38.

Epoch 35 (14 s):
    Evaluating model.
    Full set (6.2 s): ELBO: -201.23, ENRE: -194.54, KL: 6.6926.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 13198 (38 ms): -193.65.
Step 13235 (37 ms): -196.89.
Step 13273 (37 ms): -212.43.
Step 13310 (37 ms): -179.01.
Step 13348 (37 ms): -200.79.
Step 13386 (37 ms): -215.24.
Step 13423 (37 ms): -207.72.
Step 13461 (37 ms): -200.93.
Step 13498 (37 ms): -213.67.
Step 13536 (17 ms): -211.77.

Epoch 36 (14 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -201.02, ENRE: -194.43, KL: 6.5931.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 13574 (37 ms): -204.48.
Step 13611 (38 ms): -209.26.
Step 13649 (37 ms): -208.95.
Step 13686 (38 ms): -208.2.
Step 13724 (37 ms): -195.39.
Step 13762 (37 ms): -206.12.
Step 13799 (36 ms): -195.55.
Step 13837 (37 ms): -200.37.
Step 13874 (36 ms): -213.32.
Step 13912 (17 ms): -182.8.

Epoch 37 (13.9 s):
    Evaluating model.
    Full set (6.24 s): ELBO: -200.92, ENRE: -194.25, KL: 6.6766.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 13950 (37 ms): -204.09.
Step 13987 (37 ms): -192.29.
Step 14025 (37 ms): -198.16.
Step 14062 (37 ms): -205.08.
Step 14100 (38 ms): -197.62.
Step 14138 (37 ms): -195.85.
Step 14175 (38 ms): -187.54.
Step 14213 (37 ms): -209.14.
Step 14250 (37 ms): -195.05.
Step 14288 (17 ms): -259.94.

Epoch 38 (14 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -200.81, ENRE: -194.13, KL: 6.6737.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 14326 (37 ms): -200.98.
Step 14363 (37 ms): -197.91.
Step 14401 (37 ms): -211.39.
Step 14438 (37 ms): -203.73.
Step 14476 (37 ms): -200.21.
Step 14514 (37 ms): -204.97.
Step 14551 (37 ms): -208.79.
Step 14589 (37 ms): -201.77.
Step 14626 (37 ms): -198.27.
Step 14664 (17 ms): -163.65.

Epoch 39 (13.9 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -200.51, ENRE: -193.85, KL: 6.6644.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 14702 (38 ms): -208.21.
Step 14739 (37 ms): -194.63.
Step 14777 (38 ms): -205.31.
Step 14814 (38 ms): -207.16.
Step 14852 (38 ms): -199.78.
Step 14890 (37 ms): -202.5.
Step 14927 (37 ms): -182.59.
Step 14965 (37 ms): -202.29.
Step 15002 (38 ms): -194.64.
Step 15040 (17 ms): -353.22.

Epoch 40 (14.1 s):
    Evaluating model.
    Full set (6.23 s): ELBO: -200.49, ENRE: -193.84, KL: 6.6542.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 15078 (37 ms): -218.52.
Step 15115 (37 ms): -200.85.
Step 15153 (37 ms): -203.95.
Step 15190 (37 ms): -196.2.
Step 15228 (37 ms): -198.42.
Step 15266 (37 ms): -197.86.
Step 15303 (37 ms): -204.47.
Step 15341 (37 ms): -198.43.
Step 15378 (37 ms): -209.12.
Step 15416 (17 ms): -245.67.

Epoch 41 (13.9 s):
    Evaluating model.
    Full set (6.32 s): ELBO: -200.22, ENRE: -193.41, KL: 6.8155.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 15454 (37 ms): -187.25.
Step 15491 (37 ms): -190.45.
Step 15529 (38 ms): -205.72.
Step 15566 (37 ms): -196.85.
Step 15604 (37 ms): -199.69.
Step 15642 (37 ms): -202.9.
Step 15679 (38 ms): -203.22.
Step 15717 (37 ms): -195.12.
Step 15754 (37 ms): -197.69.
Step 15792 (17 ms): -213.31.

Epoch 42 (14 s):
    Evaluating model.
    Full set (6.22 s): ELBO: -200.69, ENRE: -193.93, KL: 6.7597.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 15830 (37 ms): -211.72.
Step 15867 (37 ms): -202.1.
Step 15905 (37 ms): -200.2.
Step 15942 (38 ms): -209.04.
Step 15980 (37 ms): -196.99.
Step 16018 (37 ms): -200.17.
Step 16055 (38 ms): -194.85.
Step 16093 (37 ms): -202.97.
Step 16130 (37 ms): -207.69.
Step 16168 (17 ms): -243.6.

Epoch 43 (14 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -200.33, ENRE: -193.62, KL: 6.7149.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 16206 (37 ms): -216.15.
Step 16243 (37 ms): -202.85.
Step 16281 (37 ms): -198.05.
Step 16318 (38 ms): -192.92.
Step 16356 (37 ms): -200.45.
Step 16394 (37 ms): -206.64.
Step 16431 (38 ms): -202.26.
Step 16469 (38 ms): -199.01.
Step 16506 (37 ms): -204.42.
Step 16544 (17 ms): -236.05.

Epoch 44 (13.9 s):
    Evaluating model.
    Full set (6.32 s): ELBO: -200.16, ENRE: -193.37, KL: 6.7841.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 16582 (38 ms): -196.35.
Step 16619 (38 ms): -199.33.
Step 16657 (37 ms): -199.82.
Step 16694 (37 ms): -191.71.
Step 16732 (38 ms): -212.73.
Step 16770 (37 ms): -201.92.
Step 16807 (37 ms): -204.63.
Step 16845 (37 ms): -204.25.
Step 16882 (39 ms): -199.61.
Step 16920 (17 ms): -186.94.

Epoch 45 (14 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -200.05, ENRE: -193.35, KL: 6.7031.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 16958 (37 ms): -202.05.
Step 16995 (37 ms): -189.61.
Step 17033 (37 ms): -186.95.
Step 17070 (36 ms): -189.46.
Step 17108 (37 ms): -191.76.
Step 17146 (37 ms): -194.65.
Step 17183 (38 ms): -197.16.
Step 17221 (37 ms): -190.9.
Step 17258 (37 ms): -197.7.
Step 17296 (17 ms): -310.6.

Epoch 46 (13.9 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -200.01, ENRE: -193.28, KL: 6.7315.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 17334 (37 ms): -209.06.
Step 17371 (38 ms): -195.09.
Step 17409 (37 ms): -202.75.
Step 17446 (37 ms): -210.26.
Step 17484 (37 ms): -204.04.
Step 17522 (37 ms): -198.13.
Step 17559 (37 ms): -212.73.
Step 17597 (38 ms): -208.77.
Step 17634 (38 ms): -195.7.
Step 17672 (18 ms): -210.16.

Epoch 47 (14 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -200.14, ENRE: -193.38, KL: 6.7604.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 17710 (36 ms): -196.96.
Step 17747 (37 ms): -196.7.
Step 17785 (37 ms): -199.98.
Step 17822 (37 ms): -204.64.
Step 17860 (36 ms): -200.92.
Step 17898 (37 ms): -195.98.
Step 17935 (37 ms): -200.55.
Step 17973 (37 ms): -195.33.
Step 18010 (37 ms): -195.96.
Step 18048 (18 ms): -199.87.

Epoch 48 (13.9 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -199.77, ENRE: -192.99, KL: 6.7776.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 18086 (38 ms): -193.6.
Step 18123 (37 ms): -202.48.
Step 18161 (37 ms): -200.25.
Step 18198 (37 ms): -204.24.
Step 18236 (37 ms): -198.02.
Step 18274 (37 ms): -192.16.
Step 18311 (36 ms): -204.21.
Step 18349 (38 ms): -199.57.
Step 18386 (38 ms): -197.84.
Step 18424 (17 ms): -298.27.

Epoch 49 (14 s):
    Evaluating model.
    Full set (6.2 s): ELBO: -200.26, ENRE: -193.59, KL: 6.6695.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 18462 (36 ms): -203.1.
Step 18499 (37 ms): -191.82.
Step 18537 (37 ms): -200.91.
Step 18574 (37 ms): -203.83.
Step 18612 (37 ms): -206.56.
Step 18650 (37 ms): -209.48.
Step 18687 (37 ms): -201.46.
Step 18725 (37 ms): -195.2.
Step 18762 (37 ms): -201.23.
Step 18800 (17 ms): -263.49.

Epoch 50 (14 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -199.69, ENRE: -192.88, KL: 6.8006.
    Saving model parameters.
    Model parameters saved (122 ms).

Model trained for 50 epochs (17m 4s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (10 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (850 ms).

Converting data set value array to sparse matrix.
Data set value array converted (272 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2.02 s):  ELBO: -427.77, ENRE: -420.99, KL: 6.7789.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (779 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 0.6549244713404632
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 38
kl weight: 0.6549244713404632
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (44 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.15 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.86 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 38
    hidden sizes: 216
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 0.6549244713404632
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 3 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 216)
    ENCODER/1/DENSE/biases:0             (216,)
    ENCODER/1/BATCH_NORM/beta:0          (216,)
    POSTERIOR/MU/DENSE/weights:0         (216, 38)
    POSTERIOR/MU/DENSE/biases:0          (38,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (216, 38)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (38,)
    DECODER/1/DENSE/weights:0            (38, 216)
    DECODER/1/DENSE/biases:0             (216,)
    DECODER/1/BATCH_NORM/beta:0          (216,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (216, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (212 ms).

Training model for 50 epochs on original values.

Step 38 (26 ms): -2217.5.
Step 75 (26 ms): -1814.8.
Step 113 (25 ms): -1502.4.
Step 150 (25 ms): -1304.2.
Step 188 (25 ms): -1198.6.
Step 226 (25 ms): -1019.1.
Step 263 (25 ms): -932.62.
Step 301 (26 ms): -1030.4.
Step 338 (25 ms): -866.59.
Step 376 (12 ms): -1026.8.

Epoch 1 (10.9 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (5.35 s): ELBO: -4195.9, ENRE: -3877.6, KL: 318.3.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 414 (25 ms): -753.32.
Step 451 (26 ms): -655.93.
Step 489 (25 ms): -589.6.
Step 526 (26 ms): -524.58.
Step 564 (25 ms): -485.21.
Step 602 (26 ms): -459.85.
Step 639 (25 ms): -422.25.
Step 677 (25 ms): -391.45.
Step 714 (25 ms): -388.13.
Step 752 (12 ms): -656.16.

Epoch 2 (9.52 s):
    Warm-up weight: 0.33
    Evaluating model.
    Full set (5.02 s): ELBO: -562.08, ENRE: -499.39, KL: 62.685.
    Saving model parameters.
    Model parameters saved (61 ms).

Step 790 (25 ms): -352.58.
Step 827 (25 ms): -348.32.
Step 865 (25 ms): -346.63.
Step 902 (25 ms): -342.13.
Step 940 (25 ms): -319.54.
Step 978 (25 ms): -295.13.
Step 1015 (25 ms): -296.42.
Step 1053 (25 ms): -296.17.
Step 1090 (25 ms): -288.31.
Step 1128 (12 ms): -260.26.

Epoch 3 (9.42 s):
    Warm-up weight: 0.67
    Evaluating model.
    Full set (5.02 s): ELBO: -460.67, ENRE: -427.54, KL: 33.127.
    Saving model parameters.
    Model parameters saved (60 ms).

Step 1166 (25 ms): -277.9.
Step 1203 (25 ms): -280.31.
Step 1241 (26 ms): -280.23.
Step 1278 (26 ms): -274.49.
Step 1316 (25 ms): -280.78.
Step 1354 (26 ms): -253.77.
Step 1391 (26 ms): -264.73.
Step 1429 (25 ms): -275.4.
Step 1466 (26 ms): -271.14.
Step 1504 (12 ms): -313.82.

Epoch 4 (9.53 s):
    Evaluating model.
    Full set (5.06 s): ELBO: -341.66, ENRE: -316.73, KL: 24.928.
    Saving model parameters.
    Model parameters saved (69 ms).

Step 1542 (25 ms): -249.46.
Step 1579 (25 ms): -248.67.
Step 1617 (25 ms): -241.32.
Step 1654 (26 ms): -282.67.
Step 1692 (26 ms): -262.44.
Step 1730 (25 ms): -247.54.
Step 1767 (25 ms): -247.93.
Step 1805 (25 ms): -237.58.
Step 1842 (25 ms): -257.44.
Step 1880 (11 ms): -361.99.

Epoch 5 (9.51 s):
    Evaluating model.
    Full set (4.95 s): ELBO: -292.65, ENRE: -270.09, KL: 22.562.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 1918 (25 ms): -232.44.
Step 1955 (25 ms): -243.52.
Step 1993 (25 ms): -253.64.
Step 2030 (25 ms): -243.35.
Step 2068 (26 ms): -232.26.
Step 2106 (26 ms): -234.28.
Step 2143 (26 ms): -270.19.
Step 2181 (25 ms): -224.8.
Step 2218 (25 ms): -236.79.
Step 2256 (12 ms): -229.94.

Epoch 6 (9.56 s):
    Evaluating model.
    Full set (5.08 s): ELBO: -263.36, ENRE: -241.96, KL: 21.403.
    Saving model parameters.
    Model parameters saved (75 ms).

Step 2294 (26 ms): -235.51.
Step 2331 (27 ms): -221.34.
Step 2369 (25 ms): -258.93.
Step 2406 (26 ms): -230.21.
Step 2444 (26 ms): -221.9.
Step 2482 (26 ms): -234.01.
Step 2519 (26 ms): -230.3.
Step 2557 (25 ms): -245.16.
Step 2594 (25 ms): -242.26.
Step 2632 (12 ms): -271.9.

Epoch 7 (9.69 s):
    Evaluating model.
    Full set (5 s): ELBO: -245.25, ENRE: -224.29, KL: 20.966.
    Saving model parameters.
    Model parameters saved (58 ms).

Step 2670 (25 ms): -233.57.
Step 2707 (25 ms): -245.89.
Step 2745 (25 ms): -230.6.
Step 2782 (25 ms): -222.35.
Step 2820 (25 ms): -227.54.
Step 2858 (25 ms): -223.22.
Step 2895 (25 ms): -255.95.
Step 2933 (25 ms): -221.88.
Step 2970 (25 ms): -227.1.
Step 3008 (12 ms): -257.52.

Epoch 8 (9.47 s):
    Evaluating model.
    Full set (5.04 s): ELBO: -235.63, ENRE: -215.29, KL: 20.347.
    Saving model parameters.
    Model parameters saved (60 ms).

Step 3046 (25 ms): -234.03.
Step 3083 (25 ms): -213.42.
Step 3121 (25 ms): -216.9.
Step 3158 (25 ms): -231.58.
Step 3196 (25 ms): -232.13.
Step 3234 (25 ms): -235.95.
Step 3271 (26 ms): -222.64.
Step 3309 (25 ms): -240.7.
Step 3346 (25 ms): -237.98.
Step 3384 (12 ms): -238.86.

Epoch 9 (9.53 s):
    Evaluating model.
    Full set (5.06 s): ELBO: -229.09, ENRE: -209.52, KL: 19.568.
    Saving model parameters.
    Model parameters saved (62 ms).

Step 3422 (25 ms): -229.85.
Step 3459 (25 ms): -229.99.
Step 3497 (26 ms): -215.84.
Step 3534 (26 ms): -217.31.
Step 3572 (26 ms): -223.2.
Step 3610 (25 ms): -241.54.
Step 3647 (26 ms): -226.28.
Step 3685 (26 ms): -232.11.
Step 3722 (26 ms): -222.79.
Step 3760 (12 ms): -234.33.

Epoch 10 (9.68 s):
    Evaluating model.
    Full set (5.12 s): ELBO: -224.22, ENRE: -204.74, KL: 19.482.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 3798 (25 ms): -219.46.
Step 3835 (25 ms): -223.75.
Step 3873 (25 ms): -208.35.
Step 3910 (26 ms): -234.51.
Step 3948 (25 ms): -210.34.
Step 3986 (25 ms): -230.54.
Step 4023 (26 ms): -214.42.
Step 4061 (25 ms): -234.32.
Step 4098 (25 ms): -212.7.
Step 4136 (12 ms): -362.81.

Epoch 11 (9.57 s):
    Evaluating model.
    Full set (5.05 s): ELBO: -222.67, ENRE: -203.51, KL: 19.169.
    Saving model parameters.
    Model parameters saved (61 ms).

Step 4174 (25 ms): -215.25.
Step 4211 (25 ms): -224.67.
Step 4249 (26 ms): -227.61.
Step 4286 (26 ms): -217.64.
Step 4324 (26 ms): -221.09.
Step 4362 (25 ms): -214.34.
Step 4399 (25 ms): -213.11.
Step 4437 (25 ms): -223.12.
Step 4474 (25 ms): -207.78.
Step 4512 (12 ms): -217.86.

Epoch 12 (9.55 s):
    Evaluating model.
    Full set (5.03 s): ELBO: -220.1, ENRE: -201.23, KL: 18.873.
    Saving model parameters.
    Model parameters saved (58 ms).

Step 4550 (25 ms): -226.6.
Step 4587 (25 ms): -209.33.
Step 4625 (25 ms): -216.32.
Step 4662 (26 ms): -233.33.
Step 4700 (26 ms): -209.59.
Step 4738 (25 ms): -228.87.
Step 4775 (25 ms): -226.75.
Step 4813 (25 ms): -208.43.
Step 4850 (25 ms): -228.37.
Step 4888 (12 ms): -214.21.

Epoch 13 (9.47 s):
    Evaluating model.
    Full set (5.03 s): ELBO: -218.64, ENRE: -199.88, KL: 18.764.
    Saving model parameters.
    Model parameters saved (61 ms).

Step 4926 (25 ms): -217.87.
Step 4963 (25 ms): -226.3.
Step 5001 (25 ms): -214.94.
Step 5038 (25 ms): -218.65.
Step 5076 (25 ms): -208.91.
Step 5114 (25 ms): -221.36.
Step 5151 (26 ms): -225.14.
Step 5189 (25 ms): -220.28.
Step 5226 (25 ms): -211.67.
Step 5264 (12 ms): -209.79.

Epoch 14 (9.51 s):
    Evaluating model.
    Full set (5.02 s): ELBO: -217.33, ENRE: -198.89, KL: 18.442.
    Saving model parameters.
    Model parameters saved (61 ms).

Step 5302 (26 ms): -216.57.
Step 5339 (25 ms): -202.23.
Step 5377 (25 ms): -207.38.
Step 5414 (25 ms): -209.18.
Step 5452 (25 ms): -208.94.
Step 5490 (25 ms): -204.33.
Step 5527 (25 ms): -213.76.
Step 5565 (25 ms): -216.06.
Step 5602 (25 ms): -248.77.
Step 5640 (11 ms): -238.08.

Epoch 15 (9.46 s):
    Evaluating model.
    Full set (4.94 s): ELBO: -217.16, ENRE: -198.43, KL: 18.731.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 5678 (25 ms): -223.33.
Step 5715 (26 ms): -203.24.
Step 5753 (25 ms): -209.
Step 5790 (25 ms): -215.87.
Step 5828 (25 ms): -212.75.
Step 5866 (26 ms): -215.85.
Step 5903 (25 ms): -227.03.
Step 5941 (25 ms): -208.37.
Step 5978 (25 ms): -213.97.
Step 6016 (12 ms): -207.72.

Epoch 16 (9.49 s):
    Evaluating model.
    Full set (5.03 s): ELBO: -215.5, ENRE: -197.81, KL: 17.688.
    Saving model parameters.
    Model parameters saved (61 ms).

Step 6054 (25 ms): -224.23.
Step 6091 (25 ms): -216.75.
Step 6129 (26 ms): -205.69.
Step 6166 (25 ms): -202.05.
Step 6204 (25 ms): -211.49.
Step 6242 (25 ms): -213.76.
Step 6279 (26 ms): -226.21.
Step 6317 (26 ms): -229.17.
Step 6354 (25 ms): -222.24.
Step 6392 (12 ms): -208.17.

Epoch 17 (9.5 s):
    Evaluating model.
    Full set (5.02 s): ELBO: -214.63, ENRE: -197.01, KL: 17.619.
    Saving model parameters.
    Model parameters saved (58 ms).

Step 6430 (25 ms): -214.32.
Step 6467 (25 ms): -211.1.
Step 6505 (25 ms): -210.91.
Step 6542 (24 ms): -212.36.
Step 6580 (25 ms): -208.11.
Step 6618 (25 ms): -215.77.
Step 6655 (25 ms): -206.07.
Step 6693 (25 ms): -212.42.
Step 6730 (25 ms): -206.16.
Step 6768 (12 ms): -258.38.

Epoch 18 (9.46 s):
    Evaluating model.
    Full set (5.04 s): ELBO: -214.35, ENRE: -196.31, KL: 18.036.
    Saving model parameters.
    Model parameters saved (61 ms).

Step 6806 (25 ms): -211.16.
Step 6843 (25 ms): -214.83.
Step 6881 (25 ms): -211.76.
Step 6918 (25 ms): -208.37.
Step 6956 (26 ms): -214.24.
Step 6994 (25 ms): -218.04.
Step 7031 (26 ms): -214.79.
Step 7069 (26 ms): -213.85.
Step 7106 (25 ms): -211.27.
Step 7144 (12 ms): -287.51.

Epoch 19 (9.55 s):
    Evaluating model.
    Full set (5 s): ELBO: -213.34, ENRE: -195.95, KL: 17.391.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 7182 (25 ms): -204.36.
Step 7219 (27 ms): -211.74.
Step 7257 (25 ms): -229.89.
Step 7294 (25 ms): -207.35.
Step 7332 (26 ms): -216.6.
Step 7370 (25 ms): -214.88.
Step 7407 (25 ms): -204.66.
Step 7445 (25 ms): -231.55.
Step 7482 (25 ms): -210.82.
Step 7520 (11 ms): -265.85.

Epoch 20 (9.44 s):
    Evaluating model.
    Full set (4.95 s): ELBO: -212.78, ENRE: -195.09, KL: 17.681.
    Saving model parameters.
    Model parameters saved (60 ms).

Step 7558 (25 ms): -213.93.
Step 7595 (25 ms): -218.05.
Step 7633 (25 ms): -235.84.
Step 7670 (25 ms): -225.76.
Step 7708 (25 ms): -205.7.
Step 7746 (25 ms): -229.63.
Step 7783 (26 ms): -216.27.
Step 7821 (25 ms): -212.81.
Step 7858 (25 ms): -219.41.
Step 7896 (12 ms): -190.82.

Epoch 21 (9.5 s):
    Evaluating model.
    Full set (5.01 s): ELBO: -211.89, ENRE: -194.39, KL: 17.499.
    Saving model parameters.
    Model parameters saved (61 ms).

Step 7934 (25 ms): -217.11.
Step 7971 (25 ms): -207.19.
Step 8009 (25 ms): -218.55.
Step 8046 (25 ms): -224.78.
Step 8084 (25 ms): -207.83.
Step 8122 (25 ms): -210.53.
Step 8159 (25 ms): -217.35.
Step 8197 (25 ms): -231.36.
Step 8234 (26 ms): -213.4.
Step 8272 (12 ms): -205.94.

Epoch 22 (9.5 s):
    Evaluating model.
    Full set (4.96 s): ELBO: -211.28, ENRE: -193.73, KL: 17.549.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 8310 (25 ms): -211.87.
Step 8347 (24 ms): -208.13.
Step 8385 (25 ms): -215.55.
Step 8422 (25 ms): -203.77.
Step 8460 (25 ms): -202.53.
Step 8498 (26 ms): -209.06.
Step 8535 (25 ms): -224.74.
Step 8573 (25 ms): -202.52.
Step 8610 (25 ms): -205.86.
Step 8648 (11 ms): -234.23.

Epoch 23 (9.46 s):
    Evaluating model.
    Full set (5 s): ELBO: -211.42, ENRE: -193.89, KL: 17.53.
    Saving model parameters.
    Model parameters saved (63 ms).

Step 8686 (25 ms): -208.67.
Step 8723 (25 ms): -203.47.
Step 8761 (25 ms): -206.42.
Step 8798 (25 ms): -202.49.
Step 8836 (25 ms): -213.09.
Step 8874 (25 ms): -211.14.
Step 8911 (25 ms): -216.75.
Step 8949 (25 ms): -199.27.
Step 8986 (25 ms): -209.81.
Step 9024 (12 ms): -220.93.

Epoch 24 (9.48 s):
    Evaluating model.
    Full set (5.01 s): ELBO: -210.65, ENRE: -193.24, KL: 17.404.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 9062 (25 ms): -203.56.
Step 9099 (25 ms): -222.67.
Step 9137 (25 ms): -213.4.
Step 9174 (25 ms): -203.58.
Step 9212 (25 ms): -221.98.
Step 9250 (25 ms): -215.02.
Step 9287 (25 ms): -201.74.
Step 9325 (25 ms): -215.71.
Step 9362 (25 ms): -204.97.
Step 9400 (12 ms): -206.08.

Epoch 25 (9.4 s):
    Evaluating model.
    Full set (5 s): ELBO: -209.59, ENRE: -192.15, KL: 17.444.
    Saving model parameters.
    Model parameters saved (61 ms).

Step 9438 (25 ms): -220.08.
Step 9475 (25 ms): -201.42.
Step 9513 (25 ms): -222.86.
Step 9550 (25 ms): -207.15.
Step 9588 (25 ms): -232.9.
Step 9626 (25 ms): -203.74.
Step 9663 (26 ms): -213.03.
Step 9701 (25 ms): -214.21.
Step 9738 (25 ms): -216.08.
Step 9776 (12 ms): -193.96.

Epoch 26 (9.47 s):
    Evaluating model.
    Full set (5.02 s): ELBO: -209.44, ENRE: -192.23, KL: 17.209.
    Saving model parameters.
    Model parameters saved (60 ms).

Step 9814 (25 ms): -206.95.
Step 9851 (25 ms): -198.34.
Step 9889 (26 ms): -204.31.
Step 9926 (25 ms): -198.74.
Step 9964 (25 ms): -209.73.
Step 10002 (25 ms): -207.16.
Step 10039 (25 ms): -215.03.
Step 10077 (25 ms): -215.75.
Step 10114 (26 ms): -203.31.
Step 10152 (11 ms): -262.7.

Epoch 27 (9.48 s):
    Evaluating model.
    Full set (4.91 s): ELBO: -209.35, ENRE: -192.1, KL: 17.251.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 10190 (25 ms): -215.03.
Step 10227 (25 ms): -212.71.
Step 10265 (25 ms): -198.73.
Step 10302 (26 ms): -210.19.
Step 10340 (25 ms): -192.66.
Step 10378 (26 ms): -206.96.
Step 10415 (25 ms): -214.57.
Step 10453 (25 ms): -205.04.
Step 10490 (25 ms): -210.3.
Step 10528 (12 ms): -228.7.

Epoch 28 (9.46 s):
    Evaluating model.
    Full set (5.01 s): ELBO: -208.95, ENRE: -191.14, KL: 17.815.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 10566 (25 ms): -201.9.
Step 10603 (25 ms): -209.21.
Step 10641 (25 ms): -226.2.
Step 10678 (27 ms): -202.23.
Step 10716 (26 ms): -222.37.
Step 10754 (25 ms): -203.24.
Step 10791 (25 ms): -229.1.
Step 10829 (25 ms): -204.21.
Step 10866 (25 ms): -211.14.
Step 10904 (12 ms): -572.99.

Epoch 29 (9.5 s):
    Evaluating model.
    Full set (5.01 s): ELBO: -208.08, ENRE: -190.87, KL: 17.205.
    Saving model parameters.
    Model parameters saved (58 ms).

Step 10942 (25 ms): -205.74.
Step 10979 (25 ms): -209.77.
Step 11017 (25 ms): -208.91.
Step 11054 (25 ms): -211.12.
Step 11092 (26 ms): -199.33.
Step 11130 (25 ms): -209.56.
Step 11167 (25 ms): -225.13.
Step 11205 (25 ms): -214.98.
Step 11242 (25 ms): -212.33.
Step 11280 (12 ms): -214.99.

Epoch 30 (9.38 s):
    Evaluating model.
    Full set (5.01 s): ELBO: -208.1, ENRE: -191.14, KL: 16.957.
    Saving model parameters.
    Model parameters saved (60 ms).

Step 11318 (25 ms): -204.66.
Step 11355 (25 ms): -210.51.
Step 11393 (25 ms): -201.5.
Step 11430 (25 ms): -211.91.
Step 11468 (25 ms): -193.68.
Step 11506 (25 ms): -214.95.
Step 11543 (25 ms): -195.39.
Step 11581 (25 ms): -197.04.
Step 11618 (25 ms): -215.92.
Step 11656 (11 ms): -206.34.

Epoch 31 (9.5 s):
    Evaluating model.
    Full set (5.01 s): ELBO: -207.72, ENRE: -190.67, KL: 17.053.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 11694 (25 ms): -211.11.
Step 11731 (25 ms): -203.21.
Step 11769 (25 ms): -202.25.
Step 11806 (25 ms): -220.1.
Step 11844 (25 ms): -215.43.
Step 11882 (25 ms): -217.33.
Step 11919 (25 ms): -203.14.
Step 11957 (24 ms): -212.56.
Step 11994 (25 ms): -208.4.
Step 12032 (11 ms): -201.61.

Epoch 32 (9.44 s):
    Evaluating model.
    Full set (4.9 s): ELBO: -207.71, ENRE: -190.38, KL: 17.331.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 12070 (25 ms): -206.63.
Step 12107 (25 ms): -210.97.
Step 12145 (25 ms): -202.81.
Step 12182 (25 ms): -202.44.
Step 12220 (25 ms): -207.38.
Step 12258 (25 ms): -205.17.
Step 12295 (25 ms): -201.49.
Step 12333 (25 ms): -204.35.
Step 12370 (25 ms): -193.07.
Step 12408 (12 ms): -208.1.

Epoch 33 (9.46 s):
    Evaluating model.
    Full set (5 s): ELBO: -207.53, ENRE: -190.25, KL: 17.28.
    Saving model parameters.
    Model parameters saved (60 ms).

Step 12446 (25 ms): -217.93.
Step 12483 (25 ms): -209.65.
Step 12521 (25 ms): -200.56.
Step 12558 (25 ms): -205.78.
Step 12596 (25 ms): -194.26.
Step 12634 (25 ms): -193.87.
Step 12671 (25 ms): -204.75.
Step 12709 (25 ms): -212.19.
Step 12746 (26 ms): -203.29.
Step 12784 (12 ms): -217.28.

Epoch 34 (9.45 s):
    Evaluating model.
    Full set (4.95 s): ELBO: -206.94, ENRE: -189.54, KL: 17.399.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 12822 (25 ms): -215.77.
Step 12859 (25 ms): -208.95.
Step 12897 (25 ms): -212.52.
Step 12934 (25 ms): -198.
Step 12972 (25 ms): -212.06.
Step 13010 (25 ms): -205.75.
Step 13047 (25 ms): -196.17.
Step 13085 (25 ms): -211.07.
Step 13122 (25 ms): -218.76.
Step 13160 (12 ms): -204.74.

Epoch 35 (9.37 s):
    Evaluating model.
    Full set (5 s): ELBO: -206.73, ENRE: -189.4, KL: 17.337.
    Saving model parameters.
    Model parameters saved (62 ms).

Step 13198 (25 ms): -206.18.
Step 13235 (25 ms): -215.64.
Step 13273 (25 ms): -213.25.
Step 13310 (25 ms): -202.82.
Step 13348 (25 ms): -204.64.
Step 13386 (25 ms): -213.64.
Step 13423 (25 ms): -202.46.
Step 13461 (25 ms): -218.73.
Step 13498 (25 ms): -223.58.
Step 13536 (12 ms): -197.34.

Epoch 36 (9.46 s):
    Evaluating model.
    Full set (5 s): ELBO: -206.28, ENRE: -188.82, KL: 17.466.
    Saving model parameters.
    Model parameters saved (61 ms).

Step 13574 (25 ms): -208.28.
Step 13611 (25 ms): -200.33.
Step 13649 (26 ms): -212.43.
Step 13686 (25 ms): -207.08.
Step 13724 (25 ms): -201.54.
Step 13762 (25 ms): -209.17.
Step 13799 (25 ms): -208.42.
Step 13837 (24 ms): -197.
Step 13874 (25 ms): -210.19.
Step 13912 (11 ms): -198.54.

Epoch 37 (9.42 s):
    Evaluating model.
    Full set (4.96 s): ELBO: -206, ENRE: -188.55, KL: 17.454.
    Saving model parameters.
    Model parameters saved (62 ms).

Step 13950 (25 ms): -202.64.
Step 13987 (25 ms): -210.15.
Step 14025 (25 ms): -219.57.
Step 14062 (25 ms): -210.03.
Step 14100 (25 ms): -209.52.
Step 14138 (25 ms): -210.81.
Step 14175 (25 ms): -205.39.
Step 14213 (25 ms): -197.61.
Step 14250 (25 ms): -216.41.
Step 14288 (12 ms): -243.82.

Epoch 38 (9.49 s):
    Evaluating model.
    Full set (5 s): ELBO: -206.1, ENRE: -188.59, KL: 17.516.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 14326 (25 ms): -199.52.
Step 14363 (25 ms): -204.06.
Step 14401 (25 ms): -210.
Step 14438 (25 ms): -215.04.
Step 14476 (25 ms): -209.14.
Step 14514 (25 ms): -201.66.
Step 14551 (25 ms): -198.07.
Step 14589 (25 ms): -194.53.
Step 14626 (25 ms): -208.68.
Step 14664 (12 ms): -317.21.

Epoch 39 (9.47 s):
    Evaluating model.
    Full set (4.91 s): ELBO: -205.58, ENRE: -188.13, KL: 17.447.
    Saving model parameters.
    Model parameters saved (58 ms).

Step 14702 (25 ms): -200.16.
Step 14739 (25 ms): -201.
Step 14777 (25 ms): -197.66.
Step 14814 (25 ms): -205.34.
Step 14852 (25 ms): -215.62.
Step 14890 (25 ms): -196.55.
Step 14927 (25 ms): -211.2.
Step 14965 (25 ms): -208.56.
Step 15002 (25 ms): -210.97.
Step 15040 (12 ms): -183.87.

Epoch 40 (9.42 s):
    Evaluating model.
    Full set (5 s): ELBO: -205.78, ENRE: -188.25, KL: 17.539.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 15078 (25 ms): -209.18.
Step 15115 (25 ms): -210.7.
Step 15153 (25 ms): -208.85.
Step 15190 (25 ms): -203.76.
Step 15228 (25 ms): -205.68.
Step 15266 (25 ms): -197.84.
Step 15303 (25 ms): -209.33.
Step 15341 (25 ms): -215.19.
Step 15378 (25 ms): -233.52.
Step 15416 (12 ms): -212.58.

Epoch 41 (9.45 s):
    Evaluating model.
    Full set (5 s): ELBO: -205.88, ENRE: -188.24, KL: 17.636.
    Saving model parameters.
    Model parameters saved (62 ms).

Step 15454 (25 ms): -214.33.
Step 15491 (24 ms): -198.72.
Step 15529 (24 ms): -212.34.
Step 15566 (25 ms): -209.94.
Step 15604 (25 ms): -205.55.
Step 15642 (25 ms): -203.52.
Step 15679 (25 ms): -214.99.
Step 15717 (25 ms): -202.58.
Step 15754 (25 ms): -199.22.
Step 15792 (12 ms): -311.65.

Epoch 42 (9.37 s):
    Evaluating model.
    Full set (5 s): ELBO: -205.28, ENRE: -187.53, KL: 17.756.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 15830 (25 ms): -209.2.
Step 15867 (25 ms): -204.48.
Step 15905 (25 ms): -193.79.
Step 15942 (25 ms): -201.01.
Step 15980 (25 ms): -198.57.
Step 16018 (25 ms): -214.88.
Step 16055 (25 ms): -206.23.
Step 16093 (25 ms): -202.88.
Step 16130 (25 ms): -204.61.
Step 16168 (12 ms): -197.4.

Epoch 43 (9.46 s):
    Evaluating model.
    Full set (4.99 s): ELBO: -204.98, ENRE: -187.28, KL: 17.698.
    Saving model parameters.
    Model parameters saved (61 ms).

Step 16206 (26 ms): -198.6.
Step 16243 (25 ms): -203.34.
Step 16281 (25 ms): -211.15.
Step 16318 (25 ms): -209.13.
Step 16356 (25 ms): -202.64.
Step 16394 (26 ms): -202.33.
Step 16431 (25 ms): -205.34.
Step 16469 (25 ms): -203.58.
Step 16506 (24 ms): -200.29.
Step 16544 (11 ms): -209.64.

Epoch 44 (9.43 s):
    Evaluating model.
    Full set (4.89 s): ELBO: -205.11, ENRE: -187.42, KL: 17.686.
    Saving model parameters.
    Model parameters saved (60 ms).

Step 16582 (25 ms): -210.24.
Step 16619 (25 ms): -213.88.
Step 16657 (25 ms): -237.28.
Step 16694 (25 ms): -199.67.
Step 16732 (25 ms): -203.04.
Step 16770 (25 ms): -198.83.
Step 16807 (25 ms): -213.74.
Step 16845 (25 ms): -202.
Step 16882 (25 ms): -206.12.
Step 16920 (12 ms): -249.5.

Epoch 45 (9.45 s):
    Evaluating model.
    Full set (5 s): ELBO: -204.51, ENRE: -187.06, KL: 17.454.
    Saving model parameters.
    Model parameters saved (61 ms).

Step 16958 (25 ms): -204.8.
Step 16995 (25 ms): -197.54.
Step 17033 (25 ms): -198.5.
Step 17070 (26 ms): -204.82.
Step 17108 (25 ms): -202.5.
Step 17146 (25 ms): -205.56.
Step 17183 (25 ms): -200.54.
Step 17221 (25 ms): -198.
Step 17258 (25 ms): -210.9.
Step 17296 (12 ms): -199.35.

Epoch 46 (9.47 s):
    Evaluating model.
    Full set (4.98 s): ELBO: -204.29, ENRE: -187.01, KL: 17.283.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 17334 (25 ms): -219.62.
Step 17371 (25 ms): -198.53.
Step 17409 (25 ms): -196.66.
Step 17446 (25 ms): -209.68.
Step 17484 (25 ms): -193.88.
Step 17522 (25 ms): -219.28.
Step 17559 (25 ms): -203.91.
Step 17597 (25 ms): -195.55.
Step 17634 (25 ms): -210.45.
Step 17672 (12 ms): -270.

Epoch 47 (9.42 s):
    Evaluating model.
    Full set (5 s): ELBO: -204.65, ENRE: -186.96, KL: 17.697.
    Saving model parameters.
    Model parameters saved (62 ms).

Step 17710 (25 ms): -199.9.
Step 17747 (25 ms): -202.83.
Step 17785 (25 ms): -198.15.
Step 17822 (25 ms): -206.53.
Step 17860 (26 ms): -200.61.
Step 17898 (25 ms): -215.15.
Step 17935 (25 ms): -207.41.
Step 17973 (25 ms): -193.33.
Step 18010 (25 ms): -199.84.
Step 18048 (12 ms): -251.28.

Epoch 48 (9.48 s):
    Evaluating model.
    Full set (4.99 s): ELBO: -204.04, ENRE: -186.22, KL: 17.816.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 18086 (25 ms): -196.27.
Step 18123 (25 ms): -217.99.
Step 18161 (25 ms): -219.19.
Step 18198 (25 ms): -195.95.
Step 18236 (25 ms): -201.93.
Step 18274 (25 ms): -203.21.
Step 18311 (25 ms): -194.71.
Step 18349 (25 ms): -208.36.
Step 18386 (25 ms): -201.56.
Step 18424 (11 ms): -241.67.

Epoch 49 (9.41 s):
    Evaluating model.
    Full set (4.94 s): ELBO: -204.63, ENRE: -186.74, KL: 17.896.
    Saving model parameters.
    Model parameters saved (64 ms).

Step 18462 (25 ms): -207.75.
Step 18499 (25 ms): -193.99.
Step 18537 (25 ms): -194.5.
Step 18574 (25 ms): -198.92.
Step 18612 (25 ms): -198.25.
Step 18650 (25 ms): -198.32.
Step 18687 (25 ms): -210.26.
Step 18725 (25 ms): -221.66.
Step 18762 (25 ms): -197.91.
Step 18800 (12 ms): -207.14.

Epoch 50 (9.47 s):
    Evaluating model.
    Full set (4.99 s): ELBO: -204.23, ENRE: -186.6, KL: 17.63.
    Saving model parameters.
    Model parameters saved (59 ms).

Model trained for 50 epochs (12m 10s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (12 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (867 ms).

Converting data set value array to sparse matrix.
Data set value array converted (270 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.36 s):  ELBO: -448.87, ENRE: -431.32, KL: 17.549.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (405 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 0.2917703600397126
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 22
kl weight: 0.2917703600397126
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (47 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.02 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.65 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 22
    hidden sizes: 202, 170, 200, 110, 217
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 0.2917703600397126
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 1 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 202)
    ENCODER/1/DENSE/biases:0             (202,)
    ENCODER/1/BATCH_NORM/beta:0          (202,)
    ENCODER/2/DENSE/weights:0            (202, 170)
    ENCODER/2/DENSE/biases:0             (170,)
    ENCODER/2/BATCH_NORM/beta:0          (170,)
    ENCODER/3/DENSE/weights:0            (170, 200)
    ENCODER/3/DENSE/biases:0             (200,)
    ENCODER/3/BATCH_NORM/beta:0          (200,)
    ENCODER/4/DENSE/weights:0            (200, 110)
    ENCODER/4/DENSE/biases:0             (110,)
    ENCODER/4/BATCH_NORM/beta:0          (110,)
    ENCODER/5/DENSE/weights:0            (110, 217)
    ENCODER/5/DENSE/biases:0             (217,)
    ENCODER/5/BATCH_NORM/beta:0          (217,)
    POSTERIOR/MU/DENSE/weights:0         (217, 22)
    POSTERIOR/MU/DENSE/biases:0          (22,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (217, 22)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (22,)
    DECODER/5/DENSE/weights:0            (22, 217)
    DECODER/5/DENSE/biases:0             (217,)
    DECODER/5/BATCH_NORM/beta:0          (217,)
    DECODER/4/DENSE/weights:0            (217, 110)
    DECODER/4/DENSE/biases:0             (110,)
    DECODER/4/BATCH_NORM/beta:0          (110,)
    DECODER/3/DENSE/weights:0            (110, 200)
    DECODER/3/DENSE/biases:0             (200,)
    DECODER/3/BATCH_NORM/beta:0          (200,)
    DECODER/2/DENSE/weights:0            (200, 170)
    DECODER/2/DENSE/biases:0             (170,)
    DECODER/2/BATCH_NORM/beta:0          (170,)
    DECODER/1/DENSE/weights:0            (170, 202)
    DECODER/1/DENSE/biases:0             (202,)
    DECODER/1/BATCH_NORM/beta:0          (202,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (202, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (551 ms).

Training model for 50 epochs on original values.

Step 38 (34 ms): -2090.8.
Step 75 (35 ms): -1634.4.
Step 113 (33 ms): -1344.9.
Step 150 (34 ms): -1134.2.
Step 188 (33 ms): -965.97.
Step 226 (34 ms): -852.75.
Step 263 (34 ms): -739.75.
Step 301 (34 ms): -675.63.
Step 338 (34 ms): -637.4.
Step 376 (18 ms): -540.85.

Epoch 1 (15.6 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.73 s): ELBO: -1763.4, ENRE: -1747.1, KL: 16.285.
    Saving model parameters.
    Model parameters saved (195 ms).

Step 414 (35 ms): -493.6.
Step 451 (33 ms): -440.61.
Step 489 (33 ms): -416.25.
Step 526 (34 ms): -376.55.
Step 564 (33 ms): -375.88.
Step 602 (34 ms): -359.95.
Step 639 (33 ms): -353.19.
Step 677 (34 ms): -341.16.
Step 714 (34 ms): -325.96.
Step 752 (17 ms): -498.38.

Epoch 2 (12.6 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -980.51, ENRE: -968.79, KL: 11.726.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 790 (33 ms): -300.78.
Step 827 (33 ms): -284.97.
Step 865 (33 ms): -272.84.
Step 902 (34 ms): -280.22.
Step 940 (34 ms): -290.27.
Step 978 (33 ms): -299.64.
Step 1015 (34 ms): -275.55.
Step 1053 (34 ms): -273.23.
Step 1090 (34 ms): -268.04.
Step 1128 (16 ms): -324.48.

Epoch 3 (12.6 s):
    Evaluating model.
    Full set (6 s): ELBO: -564.28, ENRE: -552.3, KL: 11.979.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 1166 (34 ms): -289.37.
Step 1203 (33 ms): -260.31.
Step 1241 (33 ms): -241.06.
Step 1278 (34 ms): -247.2.
Step 1316 (34 ms): -244.4.
Step 1354 (34 ms): -263.75.
Step 1391 (34 ms): -276.46.
Step 1429 (34 ms): -239.09.
Step 1466 (33 ms): -241.95.
Step 1504 (15 ms): -279.47.

Epoch 4 (12.6 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -389.1, ENRE: -377.51, KL: 11.587.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 1542 (34 ms): -248.9.
Step 1579 (34 ms): -255.66.
Step 1617 (34 ms): -230.1.
Step 1654 (34 ms): -237.64.
Step 1692 (34 ms): -232.99.
Step 1730 (34 ms): -234.54.
Step 1767 (34 ms): -249.01.
Step 1805 (34 ms): -252.06.
Step 1842 (33 ms): -230.42.
Step 1880 (16 ms): -259.64.

Epoch 5 (12.7 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -304.87, ENRE: -293.47, KL: 11.395.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 1918 (33 ms): -227.58.
Step 1955 (34 ms): -227.17.
Step 1993 (33 ms): -218.93.
Step 2030 (33 ms): -237.98.
Step 2068 (33 ms): -228.12.
Step 2106 (34 ms): -217.68.
Step 2143 (33 ms): -222.61.
Step 2181 (34 ms): -232.42.
Step 2218 (33 ms): -238.03.
Step 2256 (16 ms): -286.61.

Epoch 6 (12.6 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -261.25, ENRE: -249.12, KL: 12.135.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 2294 (34 ms): -213.17.
Step 2331 (33 ms): -223.74.
Step 2369 (34 ms): -214.19.
Step 2406 (34 ms): -224.99.
Step 2444 (34 ms): -227.26.
Step 2482 (34 ms): -228.82.
Step 2519 (34 ms): -216.54.
Step 2557 (33 ms): -229.61.
Step 2594 (34 ms): -227.48.
Step 2632 (16 ms): -247.04.

Epoch 7 (12.7 s):
    Evaluating model.
    Full set (6 s): ELBO: -243.41, ENRE: -230.69, KL: 12.723.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 2670 (34 ms): -223.82.
Step 2707 (33 ms): -220.93.
Step 2745 (33 ms): -212.77.
Step 2782 (33 ms): -216.13.
Step 2820 (33 ms): -223.55.
Step 2858 (33 ms): -236.46.
Step 2895 (33 ms): -216.24.
Step 2933 (33 ms): -205.68.
Step 2970 (33 ms): -225.94.
Step 3008 (16 ms): -331.

Epoch 8 (12.6 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -230.98, ENRE: -217.74, KL: 13.237.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 3046 (33 ms): -224.68.
Step 3083 (34 ms): -209.66.
Step 3121 (33 ms): -220.69.
Step 3158 (33 ms): -231.8.
Step 3196 (34 ms): -227.84.
Step 3234 (33 ms): -225.63.
Step 3271 (33 ms): -209.54.
Step 3309 (34 ms): -223.96.
Step 3346 (34 ms): -227.53.
Step 3384 (16 ms): -402.24.

Epoch 9 (12.7 s):
    Evaluating model.
    Full set (6 s): ELBO: -222.87, ENRE: -209.44, KL: 13.437.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 3422 (33 ms): -221.76.
Step 3459 (33 ms): -217.78.
Step 3497 (33 ms): -220.08.
Step 3534 (34 ms): -222.53.
Step 3572 (33 ms): -209.95.
Step 3610 (33 ms): -215.08.
Step 3647 (33 ms): -216.
Step 3685 (33 ms): -215.49.
Step 3722 (33 ms): -209.94.
Step 3760 (16 ms): -220.55.

Epoch 10 (12.6 s):
    Evaluating model.
    Full set (6 s): ELBO: -219.77, ENRE: -205.99, KL: 13.773.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 3798 (33 ms): -218.62.
Step 3835 (33 ms): -203.34.
Step 3873 (34 ms): -203.25.
Step 3910 (33 ms): -218.32.
Step 3948 (34 ms): -216.09.
Step 3986 (33 ms): -208.41.
Step 4023 (34 ms): -212.88.
Step 4061 (33 ms): -201.07.
Step 4098 (34 ms): -212.93.
Step 4136 (16 ms): -270.85.

Epoch 11 (12.7 s):
    Evaluating model.
    Full set (5.98 s): ELBO: -216.65, ENRE: -202.74, KL: 13.912.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 4174 (33 ms): -211.85.
Step 4211 (33 ms): -229.75.
Step 4249 (33 ms): -221.86.
Step 4286 (33 ms): -213.52.
Step 4324 (33 ms): -215.09.
Step 4362 (33 ms): -213.65.
Step 4399 (34 ms): -206.6.
Step 4437 (34 ms): -218.81.
Step 4474 (34 ms): -204.05.
Step 4512 (16 ms): -244.04.

Epoch 12 (12.6 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -214.96, ENRE: -200.93, KL: 14.032.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 4550 (34 ms): -216.43.
Step 4587 (33 ms): -228.
Step 4625 (33 ms): -209.8.
Step 4662 (33 ms): -217.49.
Step 4700 (33 ms): -225.07.
Step 4738 (34 ms): -199.8.
Step 4775 (34 ms): -226.06.
Step 4813 (34 ms): -215.2.
Step 4850 (33 ms): -215.12.
Step 4888 (16 ms): -182.93.

Epoch 13 (12.7 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -214.26, ENRE: -200.14, KL: 14.127.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 4926 (33 ms): -220.62.
Step 4963 (33 ms): -208.55.
Step 5001 (34 ms): -223.64.
Step 5038 (33 ms): -204.18.
Step 5076 (35 ms): -209.28.
Step 5114 (34 ms): -216.01.
Step 5151 (34 ms): -210.49.
Step 5189 (34 ms): -219.17.
Step 5226 (33 ms): -217.39.
Step 5264 (16 ms): -290.92.

Epoch 14 (12.6 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -213.27, ENRE: -198.95, KL: 14.318.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 5302 (34 ms): -210.44.
Step 5339 (34 ms): -228.62.
Step 5377 (33 ms): -218.76.
Step 5414 (34 ms): -217.85.
Step 5452 (33 ms): -215.68.
Step 5490 (34 ms): -206.76.
Step 5527 (33 ms): -207.93.
Step 5565 (33 ms): -217.34.
Step 5602 (32 ms): -206.
Step 5640 (16 ms): -229.05.

Epoch 15 (12.7 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -211.8, ENRE: -197.35, KL: 14.451.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 5678 (34 ms): -209.41.
Step 5715 (34 ms): -217.05.
Step 5753 (35 ms): -209.59.
Step 5790 (34 ms): -201.16.
Step 5828 (34 ms): -217.95.
Step 5866 (35 ms): -203.3.
Step 5903 (34 ms): -202.81.
Step 5941 (34 ms): -214.32.
Step 5978 (34 ms): -216.11.
Step 6016 (16 ms): -329.74.

Epoch 16 (12.8 s):
    Evaluating model.
    Full set (6.12 s): ELBO: -211.84, ENRE: -197.5, KL: 14.346.
    Saving model parameters.
    Model parameters saved (150 ms).

Step 6054 (34 ms): -196.83.
Step 6091 (35 ms): -206.57.
Step 6129 (37 ms): -201.12.
Step 6166 (35 ms): -208.32.
Step 6204 (33 ms): -213.85.
Step 6242 (34 ms): -217.03.
Step 6279 (33 ms): -205.49.
Step 6317 (34 ms): -210.35.
Step 6354 (34 ms): -221.52.
Step 6392 (15 ms): -385.25.

Epoch 17 (12.9 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -210.25, ENRE: -195.95, KL: 14.301.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 6430 (34 ms): -199.36.
Step 6467 (34 ms): -213.84.
Step 6505 (34 ms): -201.68.
Step 6542 (34 ms): -205.27.
Step 6580 (34 ms): -210.99.
Step 6618 (34 ms): -210.35.
Step 6655 (34 ms): -209.85.
Step 6693 (34 ms): -203.39.
Step 6730 (34 ms): -211.32.
Step 6768 (16 ms): -205.13.

Epoch 18 (12.7 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -209.78, ENRE: -195.59, KL: 14.184.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 6806 (33 ms): -203.81.
Step 6843 (34 ms): -223.84.
Step 6881 (34 ms): -209.72.
Step 6918 (34 ms): -215.57.
Step 6956 (34 ms): -223.23.
Step 6994 (34 ms): -206.77.
Step 7031 (34 ms): -196.81.
Step 7069 (35 ms): -214.44.
Step 7106 (34 ms): -197.32.
Step 7144 (17 ms): -230.04.

Epoch 19 (12.9 s):
    Evaluating model.
    Full set (6.15 s): ELBO: -209.26, ENRE: -194.96, KL: 14.301.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 7182 (33 ms): -202.59.
Step 7219 (34 ms): -216.17.
Step 7257 (34 ms): -206.27.
Step 7294 (34 ms): -205.67.
Step 7332 (34 ms): -217.11.
Step 7370 (33 ms): -205.01.
Step 7407 (34 ms): -213.65.
Step 7445 (34 ms): -202.66.
Step 7482 (34 ms): -218.56.
Step 7520 (16 ms): -560.15.

Epoch 20 (12.7 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -209.21, ENRE: -195.07, KL: 14.138.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 7558 (34 ms): -210.67.
Step 7595 (34 ms): -215.69.
Step 7633 (33 ms): -199.03.
Step 7670 (33 ms): -206.31.
Step 7708 (33 ms): -199.13.
Step 7746 (33 ms): -214.87.
Step 7783 (33 ms): -197.05.
Step 7821 (34 ms): -202.69.
Step 7858 (34 ms): -214.1.
Step 7896 (16 ms): -207.6.

Epoch 21 (12.6 s):
    Evaluating model.
    Full set (6 s): ELBO: -207.38, ENRE: -193.6, KL: 13.779.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 7934 (34 ms): -200.16.
Step 7971 (34 ms): -198.69.
Step 8009 (35 ms): -196.27.
Step 8046 (34 ms): -198.4.
Step 8084 (34 ms): -199.34.
Step 8122 (34 ms): -205.71.
Step 8159 (33 ms): -198.6.
Step 8197 (34 ms): -200.45.
Step 8234 (34 ms): -211.89.
Step 8272 (16 ms): -215.42.

Epoch 22 (12.7 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -207.48, ENRE: -193.82, KL: 13.663.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 8310 (33 ms): -205.07.
Step 8347 (34 ms): -223.48.
Step 8385 (34 ms): -195.68.
Step 8422 (33 ms): -210.6.
Step 8460 (33 ms): -200.24.
Step 8498 (34 ms): -201.6.
Step 8535 (33 ms): -207.64.
Step 8573 (33 ms): -203.29.
Step 8610 (33 ms): -194.89.
Step 8648 (16 ms): -220.21.

Epoch 23 (12.6 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -206.97, ENRE: -193.04, KL: 13.93.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 8686 (34 ms): -193.65.
Step 8723 (34 ms): -212.15.
Step 8761 (34 ms): -210.88.
Step 8798 (34 ms): -204.39.
Step 8836 (34 ms): -209.08.
Step 8874 (33 ms): -190.18.
Step 8911 (34 ms): -210.3.
Step 8949 (34 ms): -207.32.
Step 8986 (34 ms): -200.63.
Step 9024 (16 ms): -234.68.

Epoch 24 (12.7 s):
    Evaluating model.
    Full set (6 s): ELBO: -206.41, ENRE: -192.7, KL: 13.718.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 9062 (34 ms): -210.82.
Step 9099 (33 ms): -199.86.
Step 9137 (33 ms): -198.15.
Step 9174 (33 ms): -207.51.
Step 9212 (33 ms): -210.76.
Step 9250 (33 ms): -207.78.
Step 9287 (33 ms): -213.37.
Step 9325 (34 ms): -208.52.
Step 9362 (34 ms): -207.01.
Step 9400 (16 ms): -218.28.

Epoch 25 (12.6 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -206.67, ENRE: -192.81, KL: 13.857.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 9438 (33 ms): -197.49.
Step 9475 (34 ms): -213.59.
Step 9513 (33 ms): -205.4.
Step 9550 (33 ms): -197.85.
Step 9588 (34 ms): -215.09.
Step 9626 (34 ms): -198.44.
Step 9663 (34 ms): -197.02.
Step 9701 (34 ms): -214.96.
Step 9738 (33 ms): -208.84.
Step 9776 (16 ms): -208.35.

Epoch 26 (12.7 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -206.15, ENRE: -192.79, KL: 13.354.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 9814 (34 ms): -207.2.
Step 9851 (33 ms): -201.23.
Step 9889 (34 ms): -192.61.
Step 9926 (34 ms): -196.42.
Step 9964 (34 ms): -210.43.
Step 10002 (33 ms): -195.74.
Step 10039 (36 ms): -225.69.
Step 10077 (35 ms): -215.33.
Step 10114 (35 ms): -211.76.
Step 10152 (17 ms): -225.93.

Epoch 27 (12.9 s):
    Evaluating model.
    Full set (6.17 s): ELBO: -204.77, ENRE: -191.59, KL: 13.182.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 10190 (34 ms): -191.29.
Step 10227 (34 ms): -223.74.
Step 10265 (34 ms): -209.52.
Step 10302 (33 ms): -194.24.
Step 10340 (34 ms): -206.73.
Step 10378 (33 ms): -209.17.
Step 10415 (34 ms): -215.56.
Step 10453 (33 ms): -208.24.
Step 10490 (33 ms): -200.64.
Step 10528 (16 ms): -192.52.

Epoch 28 (12.7 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -204.59, ENRE: -191.4, KL: 13.194.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 10566 (33 ms): -196.41.
Step 10603 (34 ms): -215.89.
Step 10641 (34 ms): -208.55.
Step 10678 (34 ms): -201.8.
Step 10716 (34 ms): -198.88.
Step 10754 (34 ms): -195.53.
Step 10791 (34 ms): -220.18.
Step 10829 (34 ms): -193.82.
Step 10866 (34 ms): -190.98.
Step 10904 (16 ms): -263.07.

Epoch 29 (12.7 s):
    Evaluating model.
    Full set (6.13 s): ELBO: -204.83, ENRE: -191.43, KL: 13.405.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 10942 (35 ms): -206.98.
Step 10979 (34 ms): -203.76.
Step 11017 (36 ms): -213.12.
Step 11054 (35 ms): -204.3.
Step 11092 (35 ms): -200.75.
Step 11130 (35 ms): -208.05.
Step 11167 (34 ms): -220.13.
Step 11205 (34 ms): -200.63.
Step 11242 (34 ms): -219.
Step 11280 (16 ms): -185.3.

Epoch 30 (13 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -205.64, ENRE: -192.25, KL: 13.396.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 11318 (34 ms): -194.2.
Step 11355 (34 ms): -197.9.
Step 11393 (34 ms): -202.8.
Step 11430 (33 ms): -205.31.
Step 11468 (35 ms): -212.91.
Step 11506 (34 ms): -194.62.
Step 11543 (34 ms): -209.48.
Step 11581 (34 ms): -204.59.
Step 11618 (34 ms): -201.17.
Step 11656 (16 ms): -240.2.

Epoch 31 (12.8 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -204.26, ENRE: -190.63, KL: 13.63.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 11694 (35 ms): -193.7.
Step 11731 (34 ms): -200.3.
Step 11769 (34 ms): -205.64.
Step 11806 (34 ms): -206.1.
Step 11844 (34 ms): -205.91.
Step 11882 (34 ms): -199.47.
Step 11919 (35 ms): -213.39.
Step 11957 (34 ms): -213.36.
Step 11994 (34 ms): -218.65.
Step 12032 (16 ms): -214.59.

Epoch 32 (12.8 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -204.2, ENRE: -190.52, KL: 13.684.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 12070 (33 ms): -200.41.
Step 12107 (33 ms): -212.92.
Step 12145 (34 ms): -202.3.
Step 12182 (34 ms): -198.46.
Step 12220 (34 ms): -206.39.
Step 12258 (33 ms): -204.43.
Step 12295 (34 ms): -197.09.
Step 12333 (34 ms): -196.83.
Step 12370 (34 ms): -193.43.
Step 12408 (16 ms): -306.51.

Epoch 33 (12.7 s):
    Evaluating model.
    Full set (6 s): ELBO: -203.68, ENRE: -190.14, KL: 13.537.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 12446 (34 ms): -207.89.
Step 12483 (34 ms): -205.28.
Step 12521 (34 ms): -213.02.
Step 12558 (33 ms): -202.88.
Step 12596 (34 ms): -205.19.
Step 12634 (34 ms): -202.69.
Step 12671 (34 ms): -196.69.
Step 12709 (34 ms): -214.95.
Step 12746 (33 ms): -209.
Step 12784 (16 ms): -239.04.

Epoch 34 (12.6 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -203.89, ENRE: -190.1, KL: 13.791.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 12822 (33 ms): -210.31.
Step 12859 (34 ms): -202.27.
Step 12897 (34 ms): -201.33.
Step 12934 (33 ms): -192.03.
Step 12972 (33 ms): -197.19.
Step 13010 (33 ms): -199.77.
Step 13047 (34 ms): -204.64.
Step 13085 (34 ms): -198.05.
Step 13122 (34 ms): -195.27.
Step 13160 (16 ms): -252.6.

Epoch 35 (12.7 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -203.21, ENRE: -189.65, KL: 13.561.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 13198 (34 ms): -204.09.
Step 13235 (34 ms): -197.05.
Step 13273 (33 ms): -217.12.
Step 13310 (33 ms): -208.69.
Step 13348 (34 ms): -195.99.
Step 13386 (34 ms): -197.62.
Step 13423 (33 ms): -205.1.
Step 13461 (34 ms): -203.27.
Step 13498 (33 ms): -200.14.
Step 13536 (16 ms): -251.

Epoch 36 (12.6 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -203.2, ENRE: -189.61, KL: 13.583.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 13574 (34 ms): -210.25.
Step 13611 (34 ms): -198.23.
Step 13649 (34 ms): -217.23.
Step 13686 (34 ms): -208.32.
Step 13724 (34 ms): -203.84.
Step 13762 (34 ms): -201.23.
Step 13799 (34 ms): -195.79.
Step 13837 (34 ms): -210.17.
Step 13874 (34 ms): -206.31.
Step 13912 (16 ms): -237.74.

Epoch 37 (12.7 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -202.96, ENRE: -189.15, KL: 13.816.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 13950 (33 ms): -203.25.
Step 13987 (34 ms): -201.31.
Step 14025 (33 ms): -205.06.
Step 14062 (33 ms): -205.41.
Step 14100 (33 ms): -203.37.
Step 14138 (33 ms): -199.06.
Step 14175 (33 ms): -211.08.
Step 14213 (34 ms): -206.17.
Step 14250 (33 ms): -205.87.
Step 14288 (16 ms): -216.46.

Epoch 38 (12.6 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -202.86, ENRE: -188.94, KL: 13.921.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 14326 (34 ms): -201.93.
Step 14363 (34 ms): -201.82.
Step 14401 (34 ms): -192.34.
Step 14438 (34 ms): -197.82.
Step 14476 (34 ms): -206.6.
Step 14514 (34 ms): -215.56.
Step 14551 (34 ms): -214.15.
Step 14589 (34 ms): -192.08.
Step 14626 (34 ms): -213.1.
Step 14664 (16 ms): -246.19.

Epoch 39 (12.7 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -203.29, ENRE: -189.34, KL: 13.952.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 14702 (33 ms): -193.84.
Step 14739 (33 ms): -215.08.
Step 14777 (33 ms): -207.87.
Step 14814 (33 ms): -204.43.
Step 14852 (33 ms): -195.59.
Step 14890 (33 ms): -203.11.
Step 14927 (33 ms): -209.
Step 14965 (33 ms): -204.35.
Step 15002 (34 ms): -212.06.
Step 15040 (16 ms): -287.72.

Epoch 40 (12.6 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -202.45, ENRE: -188.76, KL: 13.693.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 15078 (34 ms): -198.21.
Step 15115 (33 ms): -205.36.
Step 15153 (33 ms): -201.64.
Step 15190 (33 ms): -210.39.
Step 15228 (34 ms): -207.19.
Step 15266 (34 ms): -208.56.
Step 15303 (33 ms): -193.84.
Step 15341 (34 ms): -201.08.
Step 15378 (34 ms): -208.32.
Step 15416 (16 ms): -203.97.

Epoch 41 (12.7 s):
    Evaluating model.
    Full set (6 s): ELBO: -202.56, ENRE: -188.61, KL: 13.946.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 15454 (34 ms): -221.87.
Step 15491 (33 ms): -198.01.
Step 15529 (33 ms): -200.8.
Step 15566 (33 ms): -193.58.
Step 15604 (33 ms): -204.9.
Step 15642 (34 ms): -202.81.
Step 15679 (34 ms): -207.15.
Step 15717 (34 ms): -201.37.
Step 15754 (34 ms): -200.94.
Step 15792 (16 ms): -210.49.

Epoch 42 (12.6 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -202.36, ENRE: -188.48, KL: 13.875.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 15830 (34 ms): -209.25.
Step 15867 (34 ms): -212.45.
Step 15905 (33 ms): -190.17.
Step 15942 (34 ms): -197.51.
Step 15980 (33 ms): -212.09.
Step 16018 (33 ms): -194.95.
Step 16055 (34 ms): -209.83.
Step 16093 (33 ms): -213.38.
Step 16130 (34 ms): -191.92.
Step 16168 (16 ms): -347.14.

Epoch 43 (12.7 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -202.7, ENRE: -188.64, KL: 14.063.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 16206 (33 ms): -215.06.
Step 16243 (33 ms): -206.25.
Step 16281 (33 ms): -208.73.
Step 16318 (34 ms): -203.46.
Step 16356 (33 ms): -201.16.
Step 16394 (34 ms): -212.62.
Step 16431 (34 ms): -196.02.
Step 16469 (34 ms): -210.51.
Step 16506 (33 ms): -195.24.
Step 16544 (16 ms): -215.42.

Epoch 44 (12.7 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -202.69, ENRE: -188.37, KL: 14.32.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 16582 (34 ms): -205.1.
Step 16619 (34 ms): -201.1.
Step 16657 (34 ms): -197.37.
Step 16694 (34 ms): -203.22.
Step 16732 (34 ms): -198.42.
Step 16770 (34 ms): -192.18.
Step 16807 (34 ms): -201.42.
Step 16845 (33 ms): -211.5.
Step 16882 (33 ms): -194.57.
Step 16920 (16 ms): -199.92.

Epoch 45 (12.7 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -202.18, ENRE: -188.15, KL: 14.027.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 16958 (33 ms): -205.68.
Step 16995 (34 ms): -206.48.
Step 17033 (34 ms): -204.77.
Step 17070 (34 ms): -202.21.
Step 17108 (34 ms): -209.87.
Step 17146 (33 ms): -198.85.
Step 17183 (34 ms): -199.63.
Step 17221 (34 ms): -213.15.
Step 17258 (34 ms): -202.94.
Step 17296 (16 ms): -203.98.

Epoch 46 (12.7 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -201.94, ENRE: -187.93, KL: 14.005.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 17334 (34 ms): -206.47.
Step 17371 (33 ms): -192.06.
Step 17409 (34 ms): -199.01.
Step 17446 (34 ms): -194.89.
Step 17484 (34 ms): -218.53.
Step 17522 (34 ms): -185.02.
Step 17559 (33 ms): -201.15.
Step 17597 (33 ms): -199.78.
Step 17634 (34 ms): -186.71.
Step 17672 (16 ms): -326.52.

Epoch 47 (12.7 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -202.03, ENRE: -187.92, KL: 14.109.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 17710 (34 ms): -201.53.
Step 17747 (34 ms): -201.86.
Step 17785 (33 ms): -205.08.
Step 17822 (34 ms): -202.97.
Step 17860 (34 ms): -213.12.
Step 17898 (34 ms): -205.24.
Step 17935 (34 ms): -201.11.
Step 17973 (34 ms): -211.88.
Step 18010 (34 ms): -185.85.
Step 18048 (16 ms): -195.4.

Epoch 48 (12.7 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -201.65, ENRE: -187.73, KL: 13.927.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 18086 (34 ms): -195.62.
Step 18123 (34 ms): -198.28.
Step 18161 (34 ms): -199.38.
Step 18198 (33 ms): -210.35.
Step 18236 (33 ms): -207.01.
Step 18274 (34 ms): -202.5.
Step 18311 (33 ms): -208.65.
Step 18349 (33 ms): -201.42.
Step 18386 (34 ms): -213.16.
Step 18424 (15 ms): -223.34.

Epoch 49 (12.6 s):
    Evaluating model.
    Full set (5.97 s): ELBO: -201.49, ENRE: -187.47, KL: 14.025.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 18462 (33 ms): -209.48.
Step 18499 (33 ms): -202.71.
Step 18537 (34 ms): -210.25.
Step 18574 (33 ms): -193.07.
Step 18612 (34 ms): -202.72.
Step 18650 (33 ms): -217.36.
Step 18687 (34 ms): -192.33.
Step 18725 (33 ms): -195.5.
Step 18762 (34 ms): -217.5.
Step 18800 (16 ms): -247.98.

Epoch 50 (12.7 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -201.62, ENRE: -187.68, KL: 13.947.
    Saving model parameters.
    Model parameters saved (120 ms).

Model trained for 50 epochs (15m 46s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (14 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (867 ms).

Converting data set value array to sparse matrix.
Data set value array converted (272 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.96 s):  ELBO: -441.4, ENRE: -427.49, KL: 13.913.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (731 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 0.28616590930939334
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 15
kl weight: 0.28616590930939334
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (46 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (3.97 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.67 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 15
    hidden sizes: 289, 125
    latent distribution: gaussian
    reconstruction distribution: gaussian
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 0.28616590930939334
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 4 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 289)
    ENCODER/1/DENSE/biases:0             (289,)
    ENCODER/1/BATCH_NORM/beta:0          (289,)
    ENCODER/2/DENSE/weights:0            (289, 125)
    ENCODER/2/DENSE/biases:0             (125,)
    ENCODER/2/BATCH_NORM/beta:0          (125,)
    POSTERIOR/MU/DENSE/weights:0         (125, 15)
    POSTERIOR/MU/DENSE/biases:0          (15,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (125, 15)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (15,)
    DECODER/2/DENSE/weights:0            (15, 125)
    DECODER/2/DENSE/biases:0             (125,)
    DECODER/2/BATCH_NORM/beta:0          (125,)
    DECODER/1/DENSE/weights:0            (125, 289)
    DECODER/1/DENSE/biases:0             (289,)
    DECODER/1/BATCH_NORM/beta:0          (289,)
    X_TILDE/MU/DENSE/weights:0           (289, 2000)
    X_TILDE/MU/DENSE/biases:0            (2000,)
    X_TILDE/LOG_SIGMA/DENSE/weights:0    (289, 2000)
    X_TILDE/LOG_SIGMA/DENSE/biases:0     (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (338 ms).

Training model for 50 epochs on original values.

Step 38 (36 ms): -3267.
Step 75 (37 ms): -2381.9.
Step 113 (37 ms): -1545.1.
Step 150 (37 ms): -705.05.
Step 188 (36 ms): -107.31.
Step 226 (36 ms): 297.07.
Step 263 (38 ms): 610.15.
Step 301 (37 ms): 929.79.
Step 338 (38 ms): 904.75.
Step 376 (19 ms): -1364.3.

Epoch 1 (15.8 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (5.97 s): ELBO: -1118.6, ENRE: -868.92, KL: 249.71.
    Saving model parameters.
    Model parameters saved (135 ms).

Step 414 (35 ms): 1452.2.
Step 451 (36 ms): 1653.7.
Step 489 (36 ms): 1712.7.
Step 526 (36 ms): 1644.4.
Step 564 (35 ms): 1929.3.
Step 602 (36 ms): 1557.8.
Step 639 (36 ms): 1796.3.
Step 677 (35 ms): 2029.6.
Step 714 (36 ms): 1754.9.
Step 752 (17 ms): -591.78.

Epoch 2 (13.4 s):
    Warm-up weight: 0.25
    Evaluating model.
    Full set (5.53 s): ELBO: -180.07, ENRE: -24.239, KL: 155.83.
    Saving model parameters.
    Model parameters saved (87 ms).

Step 790 (36 ms): 2076.
Step 827 (36 ms): 2081.9.
Step 865 (36 ms): 1968.4.
Step 902 (36 ms): 2027.3.
Step 940 (36 ms): 2120.4.
Step 978 (36 ms): 2097.5.
Step 1015 (35 ms): 2141.9.
Step 1053 (36 ms): 2172.9.
Step 1090 (36 ms): 2228.4.
Step 1128 (18 ms): 1304.4.

Epoch 3 (13.5 s):
    Warm-up weight: 0.5
    Evaluating model.
    Full set (5.6 s): ELBO: 1317.8, ENRE: 1439.9, KL: 122.06.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 1166 (37 ms): 1987.9.
Step 1203 (37 ms): 2175.4.
Step 1241 (37 ms): 2306.3.
Step 1278 (39 ms): 2201.8.
Step 1316 (36 ms): 2272.2.
Step 1354 (36 ms): 2203.
Step 1391 (36 ms): 2279.6.
Step 1429 (35 ms): 2269.5.
Step 1466 (35 ms): 2253.
Step 1504 (17 ms): 1611.8.

Epoch 4 (13.7 s):
    Warm-up weight: 0.75
    Evaluating model.
    Full set (5.54 s): ELBO: 2060.1, ENRE: 2155, KL: 94.901.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 1542 (36 ms): 2110.2.
Step 1579 (36 ms): 2452.9.
Step 1617 (36 ms): 2446.
Step 1654 (36 ms): 2355.9.
Step 1692 (36 ms): 2349.4.
Step 1730 (36 ms): 2442.5.
Step 1767 (36 ms): 2186.1.
Step 1805 (36 ms): 2263.
Step 1842 (36 ms): 2262.
Step 1880 (17 ms): 1028.4.

Epoch 5 (13.5 s):
    Evaluating model.
    Full set (5.54 s): ELBO: 2347.3, ENRE: 2414, KL: 66.612.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 1918 (35 ms): 2336.1.
Step 1955 (35 ms): 2428.7.
Step 1993 (36 ms): 2329.4.
Step 2030 (35 ms): 2351.2.
Step 2068 (36 ms): 2430.2.
Step 2106 (35 ms): 2386.4.
Step 2143 (36 ms): 2424.9.
Step 2181 (35 ms): 2319.
Step 2218 (36 ms): 2440.8.
Step 2256 (17 ms): -1731.4.

Epoch 6 (13.4 s):
    Evaluating model.
    Full set (5.52 s): ELBO: 2419.6, ENRE: 2478.8, KL: 59.165.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 2294 (36 ms): 2535.8.
Step 2331 (36 ms): 2428.
Step 2369 (36 ms): 2213.4.
Step 2406 (36 ms): 2440.
Step 2444 (36 ms): 2456.9.
Step 2482 (36 ms): 2499.3.
Step 2519 (35 ms): 2261.2.
Step 2557 (36 ms): 2464.
Step 2594 (36 ms): 2529.4.
Step 2632 (17 ms): 1575.8.

Epoch 7 (13.5 s):
    Evaluating model.
    Full set (5.52 s): ELBO: 2445.8, ENRE: 2494.5, KL: 48.75.
    Saving model parameters.
    Model parameters saved (86 ms).

Step 2670 (36 ms): 2466.8.
Step 2707 (35 ms): 2516.7.
Step 2745 (35 ms): 2332.4.
Step 2782 (36 ms): 2440.4.
Step 2820 (35 ms): 2448.5.
Step 2858 (35 ms): 2550.1.
Step 2895 (35 ms): 2454.2.
Step 2933 (36 ms): 2484.2.
Step 2970 (35 ms): 2501.9.
Step 3008 (17 ms): 240.86.

Epoch 8 (13.3 s):
    Evaluating model.
    Full set (5.5 s): ELBO: 2471.5, ENRE: 2514.3, KL: 42.741.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 3046 (36 ms): 2571.9.
Step 3083 (36 ms): 2567.8.
Step 3121 (36 ms): 2579.6.
Step 3158 (36 ms): 2570.5.
Step 3196 (36 ms): 2546.2.
Step 3234 (36 ms): 2542.9.
Step 3271 (36 ms): 2512.8.
Step 3309 (36 ms): 2519.3.
Step 3346 (35 ms): 2469.6.
Step 3384 (17 ms): 260.31.

Epoch 9 (13.5 s):
    Evaluating model.
    Full set (5.52 s): ELBO: 2467.4, ENRE: 2514.4, KL: 46.934.
    Saving model parameters.
    Model parameters saved (130 ms).

Step 3422 (35 ms): 2506.2.
Step 3459 (36 ms): 2611.1.
Step 3497 (36 ms): 2590.1.
Step 3534 (36 ms): 2640.4.
Step 3572 (36 ms): 2570.8.
Step 3610 (35 ms): 2493.1.
Step 3647 (37 ms): 2506.2.
Step 3685 (36 ms): 2609.
Step 3722 (35 ms): 2474.3.
Step 3760 (17 ms): -407.62.

Epoch 10 (13.5 s):
    Evaluating model.
    Full set (5.55 s): ELBO: 2489.3, ENRE: 2543.1, KL: 53.849.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 3798 (36 ms): 2579.2.
Step 3835 (37 ms): 2603.5.
Step 3873 (36 ms): 2389.3.
Step 3910 (36 ms): 2611.3.
Step 3948 (36 ms): 2712.9.
Step 3986 (36 ms): 2416.8.
Step 4023 (36 ms): 2581.7.
Step 4061 (36 ms): 2576.4.
Step 4098 (35 ms): 2559.7.
Step 4136 (17 ms): 1734.2.

Epoch 11 (13.6 s):
    Evaluating model.
    Full set (5.52 s): ELBO: 2486.9, ENRE: 2554.7, KL: 67.819.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 4174 (36 ms): 2602.7.
Step 4211 (36 ms): 2600.5.
Step 4249 (36 ms): 2605.
Step 4286 (37 ms): 2703.1.
Step 4324 (36 ms): 2525.2.
Step 4362 (35 ms): 2576.9.
Step 4399 (36 ms): 2479.5.
Step 4437 (36 ms): 2499.6.
Step 4474 (36 ms): 2583.4.
Step 4512 (17 ms): 587.48.

Epoch 12 (13.6 s):
    Evaluating model.
    Full set (5.6 s): ELBO: 2548.5, ENRE: 2602, KL: 53.496.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 4550 (37 ms): 2541.1.
Step 4587 (37 ms): 2573.2.
Step 4625 (37 ms): 2631.7.
Step 4662 (37 ms): 2568.1.
Step 4700 (36 ms): 2598.1.
Step 4738 (36 ms): 2575.2.
Step 4775 (36 ms): 2534.8.
Step 4813 (36 ms): 2551.1.
Step 4850 (36 ms): 2603.1.
Step 4888 (17 ms): 838.39.

Epoch 13 (13.6 s):
    Evaluating model.
    Full set (5.55 s): ELBO: 2521.4, ENRE: 2590, KL: 68.599.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 4926 (36 ms): 2658.1.
Step 4963 (36 ms): 2510.4.
Step 5001 (36 ms): 2476.8.
Step 5038 (36 ms): 2587.2.
Step 5076 (36 ms): 2601.7.
Step 5114 (37 ms): 2584.9.
Step 5151 (35 ms): 2575.3.
Step 5189 (36 ms): 2646.8.
Step 5226 (36 ms): 2547.3.
Step 5264 (17 ms): 1412.

Epoch 14 (13.6 s):
    Evaluating model.
    Full set (5.6 s): ELBO: 2553.1, ENRE: 2616.5, KL: 63.38.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 5302 (36 ms): 2541.1.
Step 5339 (36 ms): 2663.3.
Step 5377 (36 ms): 2555.6.
Step 5414 (36 ms): 2691.8.
Step 5452 (36 ms): 2623.3.
Step 5490 (36 ms): 2662.2.
Step 5527 (37 ms): 2644.2.
Step 5565 (36 ms): 2459.8.
Step 5602 (38 ms): 2443.8.
Step 5640 (16 ms): 772.06.

Epoch 15 (13.6 s):
    Evaluating model.
    Full set (5.54 s): ELBO: 2602.3, ENRE: 2657.9, KL: 55.54.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 5678 (37 ms): 2584.
Step 5715 (36 ms): 2615.2.
Step 5753 (36 ms): 2644.9.
Step 5790 (37 ms): 2654.5.
Step 5828 (36 ms): 2574.4.
Step 5866 (37 ms): 2673.7.
Step 5903 (36 ms): 2590.2.
Step 5941 (37 ms): 2588.4.
Step 5978 (36 ms): 2716.3.
Step 6016 (17 ms): 5.7078.

Epoch 16 (13.6 s):
    Evaluating model.
    Full set (5.58 s): ELBO: 2584.9, ENRE: 2648.7, KL: 63.842.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 6054 (36 ms): 2545.9.
Step 6091 (36 ms): 2575.
Step 6129 (37 ms): 2618.7.
Step 6166 (36 ms): 2640.4.
Step 6204 (36 ms): 2647.1.
Step 6242 (36 ms): 2583.7.
Step 6279 (35 ms): 2713.7.
Step 6317 (35 ms): 2666.9.
Step 6354 (36 ms): 2556.1.
Step 6392 (17 ms): -1288.1.

Epoch 17 (13.5 s):
    Evaluating model.
    Full set (5.56 s): ELBO: 2601.3, ENRE: 2659.9, KL: 58.579.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 6430 (36 ms): 2699.
Step 6467 (37 ms): 2593.7.
Step 6505 (37 ms): 2657.6.
Step 6542 (36 ms): 2626.8.
Step 6580 (36 ms): 2601.3.
Step 6618 (37 ms): 2622.
Step 6655 (37 ms): 2661.
Step 6693 (37 ms): 2639.6.
Step 6730 (36 ms): 2641.1.
Step 6768 (17 ms): 1175.4.

Epoch 18 (13.7 s):
    Evaluating model.
    Full set (5.59 s): ELBO: 2609.4, ENRE: 2672.3, KL: 62.894.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 6806 (36 ms): 2638.5.
Step 6843 (36 ms): 2565.
Step 6881 (36 ms): 2622.6.
Step 6918 (36 ms): 2475.5.
Step 6956 (35 ms): 2700.1.
Step 6994 (36 ms): 2720.9.
Step 7031 (38 ms): 2641.3.
Step 7069 (36 ms): 2588.9.
Step 7106 (36 ms): 2635.5.
Step 7144 (17 ms): 1548.1.

Epoch 19 (13.5 s):
    Evaluating model.
    Full set (5.51 s): ELBO: 2652.2, ENRE: 2701.9, KL: 49.686.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 7182 (36 ms): 2658.9.
Step 7219 (36 ms): 2708.4.
Step 7257 (36 ms): 2625.5.
Step 7294 (36 ms): 2637.6.
Step 7332 (37 ms): 2673.2.
Step 7370 (36 ms): 2481.3.
Step 7407 (36 ms): 2503.6.
Step 7445 (35 ms): 2694.7.
Step 7482 (36 ms): 2699.6.
Step 7520 (17 ms): -1587.2.

Epoch 20 (13.6 s):
    Evaluating model.
    Full set (5.56 s): ELBO: 2608.3, ENRE: 2668.7, KL: 60.452.
    Saving model parameters.
    Model parameters saved (87 ms).

Step 7558 (35 ms): 2576.5.
Step 7595 (35 ms): 2689.3.
Step 7633 (35 ms): 2618.7.
Step 7670 (36 ms): 2648.7.
Step 7708 (36 ms): 2610.5.
Step 7746 (36 ms): 2644.1.
Step 7783 (35 ms): 2627.3.
Step 7821 (36 ms): 2645.4.
Step 7858 (36 ms): 2654.3.
Step 7896 (17 ms): 699.96.

Epoch 21 (13.4 s):
    Evaluating model.
    Full set (5.56 s): ELBO: 2658.3, ENRE: 2715.1, KL: 56.854.
    Saving model parameters.
    Model parameters saved (87 ms).

Step 7934 (36 ms): 2589.2.
Step 7971 (36 ms): 2666.7.
Step 8009 (36 ms): 2496.9.
Step 8046 (36 ms): 2701.8.
Step 8084 (35 ms): 2672.5.
Step 8122 (36 ms): 2574.7.
Step 8159 (36 ms): 2626.1.
Step 8197 (36 ms): 2718.2.
Step 8234 (36 ms): 2698.8.
Step 8272 (16 ms): 176.3.

Epoch 22 (13.5 s):
    Evaluating model.
    Full set (5.54 s): ELBO: 2585, ENRE: 2662.1, KL: 77.125.
    Saving model parameters.
    Model parameters saved (87 ms).

Step 8310 (35 ms): 2689.6.
Step 8347 (36 ms): 2685.3.
Step 8385 (35 ms): 2728.4.
Step 8422 (35 ms): 2698.9.
Step 8460 (35 ms): 2665.7.
Step 8498 (36 ms): 2700.8.
Step 8535 (36 ms): 2650.9.
Step 8573 (36 ms): 2704.3.
Step 8610 (36 ms): 2568.1.
Step 8648 (17 ms): -7039.

Epoch 23 (13.4 s):
    Evaluating model.
    Full set (5.57 s): ELBO: 2625.3, ENRE: 2690.1, KL: 64.77.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 8686 (36 ms): 2634.9.
Step 8723 (36 ms): 2639.6.
Step 8761 (36 ms): 2747.3.
Step 8798 (36 ms): 2691.2.
Step 8836 (36 ms): 2681.3.
Step 8874 (37 ms): 2661.4.
Step 8911 (36 ms): 2587.
Step 8949 (36 ms): 2678.2.
Step 8986 (36 ms): 2688.2.
Step 9024 (17 ms): 1589.7.

Epoch 24 (13.6 s):
    Evaluating model.
    Full set (5.54 s): ELBO: 2660.1, ENRE: 2717.9, KL: 57.847.
    Saving model parameters.
    Model parameters saved (85 ms).

Step 9062 (36 ms): 2617.2.
Step 9099 (36 ms): 2632.4.
Step 9137 (36 ms): 2599.8.
Step 9174 (35 ms): 2705.2.
Step 9212 (36 ms): 2683.
Step 9250 (36 ms): 2715.4.
Step 9287 (35 ms): 2763.4.
Step 9325 (37 ms): 2635.2.
Step 9362 (36 ms): 2696.1.
Step 9400 (17 ms): 281.75.

Epoch 25 (13.5 s):
    Evaluating model.
    Full set (5.57 s): ELBO: 2665.7, ENRE: 2724, KL: 58.235.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 9438 (36 ms): 2723.
Step 9475 (36 ms): 2630.7.
Step 9513 (36 ms): 2668.6.
Step 9550 (36 ms): 2732.
Step 9588 (38 ms): 2662.6.
Step 9626 (36 ms): 2620.9.
Step 9663 (36 ms): 2714.9.
Step 9701 (36 ms): 2718.
Step 9738 (36 ms): 2699.2.
Step 9776 (17 ms): 1348.3.

Epoch 26 (13.6 s):
    Evaluating model.
    Full set (5.51 s): ELBO: 2696.5, ENRE: 2750.5, KL: 53.929.
    Saving model parameters.
    Model parameters saved (86 ms).

Step 9814 (36 ms): 2624.2.
Step 9851 (35 ms): 2649.5.
Step 9889 (36 ms): 2653.4.
Step 9926 (36 ms): 2738.1.
Step 9964 (36 ms): 2639.5.
Step 10002 (36 ms): 2587.8.
Step 10039 (36 ms): 2685.7.
Step 10077 (36 ms): 2634.
Step 10114 (36 ms): 2728.2.
Step 10152 (17 ms): 920.5.

Epoch 27 (13.5 s):
    Evaluating model.
    Full set (5.56 s): ELBO: 2710, ENRE: 2759.1, KL: 49.165.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 10190 (36 ms): 2696.
Step 10227 (36 ms): 2636.1.
Step 10265 (35 ms): 2674.9.
Step 10302 (36 ms): 2744.
Step 10340 (36 ms): 2677.2.
Step 10378 (36 ms): 2746.
Step 10415 (36 ms): 2675.6.
Step 10453 (36 ms): 2646.3.
Step 10490 (36 ms): 2564.2.
Step 10528 (17 ms): 248.84.

Epoch 28 (13.6 s):
    Evaluating model.
    Full set (5.51 s): ELBO: 2712.6, ENRE: 2761.3, KL: 48.646.
    Saving model parameters.
    Model parameters saved (87 ms).

Step 10566 (36 ms): 2799.9.
Step 10603 (36 ms): 2678.4.
Step 10641 (35 ms): 2713.6.
Step 10678 (36 ms): 2588.9.
Step 10716 (35 ms): 2681.4.
Step 10754 (36 ms): 2738.8.
Step 10791 (36 ms): 2675.3.
Step 10829 (36 ms): 2681.5.
Step 10866 (36 ms): 2661.8.
Step 10904 (17 ms): 315.44.

Epoch 29 (13.5 s):
    Evaluating model.
    Full set (5.57 s): ELBO: 2713.4, ENRE: 2767.3, KL: 53.905.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 10942 (36 ms): 2739.6.
Step 10979 (37 ms): 2743.9.
Step 11017 (36 ms): 2698.4.
Step 11054 (36 ms): 2675.4.
Step 11092 (36 ms): 2630.3.
Step 11130 (36 ms): 2686.4.
Step 11167 (36 ms): 2741.6.
Step 11205 (36 ms): 2648.3.
Step 11242 (36 ms): 2752.3.
Step 11280 (17 ms): 1344.4.

Epoch 30 (13.6 s):
    Evaluating model.
    Full set (5.51 s): ELBO: 2700, ENRE: 2762.7, KL: 62.699.
    Saving model parameters.
    Model parameters saved (86 ms).

Step 11318 (36 ms): 2635.
Step 11355 (36 ms): 2672.8.
Step 11393 (36 ms): 2724.
Step 11430 (35 ms): 2729.
Step 11468 (37 ms): 2744.4.
Step 11506 (36 ms): 2676.2.
Step 11543 (36 ms): 2704.5.
Step 11581 (36 ms): 2650.
Step 11618 (36 ms): 2715.5.
Step 11656 (17 ms): 674.57.

Epoch 31 (13.5 s):
    Evaluating model.
    Full set (5.57 s): ELBO: 2722.7, ENRE: 2785.1, KL: 62.428.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 11694 (36 ms): 2693.3.
Step 11731 (36 ms): 2698.1.
Step 11769 (36 ms): 2745.8.
Step 11806 (36 ms): 2770.4.
Step 11844 (36 ms): 2645.7.
Step 11882 (36 ms): 2780.4.
Step 11919 (36 ms): 2676.3.
Step 11957 (36 ms): 2525.1.
Step 11994 (36 ms): 2649.7.
Step 12032 (16 ms): 1242.6.

Epoch 32 (13.5 s):
    Evaluating model.
    Full set (5.51 s): ELBO: 2714.4, ENRE: 2777, KL: 62.566.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 12070 (36 ms): 2620.1.
Step 12107 (35 ms): 2781.3.
Step 12145 (36 ms): 2692.9.
Step 12182 (36 ms): 2740.9.
Step 12220 (36 ms): 2675.6.
Step 12258 (36 ms): 2679.7.
Step 12295 (36 ms): 2768.3.
Step 12333 (36 ms): 2696.1.
Step 12370 (36 ms): 2749.6.
Step 12408 (17 ms): 1486.2.

Epoch 33 (13.5 s):
    Evaluating model.
    Full set (5.57 s): ELBO: 2735.9, ENRE: 2785.8, KL: 49.963.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 12446 (36 ms): 2634.7.
Step 12483 (36 ms): 2718.8.
Step 12521 (37 ms): 2674.5.
Step 12558 (36 ms): 2673.8.
Step 12596 (36 ms): 2715.
Step 12634 (36 ms): 2707.6.
Step 12671 (36 ms): 2772.5.
Step 12709 (35 ms): 2713.6.
Step 12746 (36 ms): 2764.4.
Step 12784 (17 ms): 1608.7.

Epoch 34 (13.5 s):
    Evaluating model.
    Full set (5.52 s): ELBO: 2731.5, ENRE: 2789.9, KL: 58.467.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 12822 (35 ms): 2714.5.
Step 12859 (36 ms): 2744.
Step 12897 (36 ms): 2749.8.
Step 12934 (36 ms): 2726.5.
Step 12972 (38 ms): 2748.8.
Step 13010 (36 ms): 2723.2.
Step 13047 (36 ms): 2745.6.
Step 13085 (36 ms): 2696.
Step 13122 (36 ms): 2738.7.
Step 13160 (17 ms): 1370.3.

Epoch 35 (13.6 s):
    Evaluating model.
    Full set (5.56 s): ELBO: 2736, ENRE: 2796.4, KL: 60.378.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 13198 (36 ms): 2734.8.
Step 13235 (36 ms): 2738.5.
Step 13273 (36 ms): 2703.5.
Step 13310 (36 ms): 2719.6.
Step 13348 (36 ms): 2770.6.
Step 13386 (36 ms): 2753.5.
Step 13423 (36 ms): 2707.5.
Step 13461 (36 ms): 2832.8.
Step 13498 (36 ms): 2784.9.
Step 13536 (17 ms): 645.83.

Epoch 36 (13.5 s):
    Evaluating model.
    Full set (5.54 s): ELBO: 2742.6, ENRE: 2792.9, KL: 50.36.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 13574 (36 ms): 2736.9.
Step 13611 (36 ms): 2798.2.
Step 13649 (36 ms): 2725.3.
Step 13686 (37 ms): 2727.6.
Step 13724 (36 ms): 2773.3.
Step 13762 (36 ms): 2667.2.
Step 13799 (36 ms): 2756.4.
Step 13837 (36 ms): 2674.1.
Step 13874 (35 ms): 2739.
Step 13912 (17 ms): -409.24.

Epoch 37 (13.6 s):
    Evaluating model.
    Full set (5.56 s): ELBO: 2752.4, ENRE: 2804.6, KL: 52.18.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 13950 (36 ms): 2832.2.
Step 13987 (36 ms): 2643.9.
Step 14025 (36 ms): 2759.8.
Step 14062 (36 ms): 2762.7.
Step 14100 (37 ms): 2773.1.
Step 14138 (35 ms): 2808.7.
Step 14175 (36 ms): 2720.5.
Step 14213 (36 ms): 2740.8.
Step 14250 (36 ms): 2788.5.
Step 14288 (17 ms): 1314.1.

Epoch 38 (13.5 s):
    Evaluating model.
    Full set (5.52 s): ELBO: 2762.3, ENRE: 2817.2, KL: 54.929.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 14326 (36 ms): 2687.4.
Step 14363 (37 ms): 2795.6.
Step 14401 (36 ms): 2734.4.
Step 14438 (36 ms): 2782.8.
Step 14476 (36 ms): 2786.5.
Step 14514 (37 ms): 2660.
Step 14551 (36 ms): 2765.4.
Step 14589 (36 ms): 2773.5.
Step 14626 (36 ms): 2786.3.
Step 14664 (18 ms): 1932.5.

Epoch 39 (13.6 s):
    Evaluating model.
    Full set (5.57 s): ELBO: 2773.9, ENRE: 2823.2, KL: 49.241.
    Saving model parameters.
    Model parameters saved (87 ms).

Step 14702 (37 ms): 2771.4.
Step 14739 (36 ms): 2749.7.
Step 14777 (36 ms): 2596.
Step 14814 (37 ms): 2819.7.
Step 14852 (36 ms): 2684.4.
Step 14890 (36 ms): 2838.8.
Step 14927 (36 ms): 2696.9.
Step 14965 (36 ms): 2748.
Step 15002 (36 ms): 2714.2.
Step 15040 (17 ms): 1518.2.

Epoch 40 (13.5 s):
    Evaluating model.
    Full set (5.54 s): ELBO: 2764.9, ENRE: 2817.5, KL: 52.6.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 15078 (36 ms): 2721.2.
Step 15115 (36 ms): 2825.5.
Step 15153 (36 ms): 2757.9.
Step 15190 (37 ms): 2773.3.
Step 15228 (36 ms): 2816.8.
Step 15266 (37 ms): 2785.4.
Step 15303 (36 ms): 2793.7.
Step 15341 (36 ms): 2782.7.
Step 15378 (36 ms): 2652.3.
Step 15416 (17 ms): 427.95.

Epoch 41 (13.6 s):
    Evaluating model.
    Full set (5.56 s): ELBO: 2764.8, ENRE: 2820.4, KL: 55.537.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 15454 (37 ms): 2673.
Step 15491 (36 ms): 2756.3.
Step 15529 (36 ms): 2745.
Step 15566 (36 ms): 2705.5.
Step 15604 (36 ms): 2799.8.
Step 15642 (35 ms): 2740.2.
Step 15679 (36 ms): 2799.2.
Step 15717 (36 ms): 2782.2.
Step 15754 (36 ms): 2714.8.
Step 15792 (17 ms): 455.44.

Epoch 42 (13.4 s):
    Evaluating model.
    Full set (5.55 s): ELBO: 2769.3, ENRE: 2820.5, KL: 51.169.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 15830 (36 ms): 2786.1.
Step 15867 (36 ms): 2777.7.
Step 15905 (37 ms): 2781.9.
Step 15942 (36 ms): 2807.8.
Step 15980 (37 ms): 2681.9.
Step 16018 (36 ms): 2815.7.
Step 16055 (36 ms): 2766.2.
Step 16093 (38 ms): 2791.8.
Step 16130 (36 ms): 2826.7.
Step 16168 (17 ms): 1393.7.

Epoch 43 (13.6 s):
    Evaluating model.
    Full set (5.55 s): ELBO: 2763.5, ENRE: 2819.6, KL: 56.109.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 16206 (36 ms): 2796.7.
Step 16243 (35 ms): 2786.9.
Step 16281 (36 ms): 2604.5.
Step 16318 (36 ms): 2780.4.
Step 16356 (35 ms): 2761.1.
Step 16394 (36 ms): 2764.1.
Step 16431 (36 ms): 2848.
Step 16469 (36 ms): 2748.3.
Step 16506 (35 ms): 2719.2.
Step 16544 (17 ms): 1031.

Epoch 44 (13.5 s):
    Evaluating model.
    Full set (5.57 s): ELBO: 2746.6, ENRE: 2808.3, KL: 61.68.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 16582 (36 ms): 2755.9.
Step 16619 (36 ms): 2774.6.
Step 16657 (36 ms): 2824.6.
Step 16694 (36 ms): 2774.6.
Step 16732 (36 ms): 2714.4.
Step 16770 (36 ms): 2741.7.
Step 16807 (36 ms): 2822.4.
Step 16845 (36 ms): 2851.3.
Step 16882 (36 ms): 2649.5.
Step 16920 (17 ms): 927.29.

Epoch 45 (13.6 s):
    Evaluating model.
    Full set (5.55 s): ELBO: 2792.1, ENRE: 2842.4, KL: 50.228.
    Saving model parameters.
    Model parameters saved (86 ms).

Step 16958 (36 ms): 2777.7.
Step 16995 (36 ms): 2771.4.
Step 17033 (36 ms): 2799.2.
Step 17070 (36 ms): 2909.4.
Step 17108 (36 ms): 2793.8.
Step 17146 (36 ms): 2728.5.
Step 17183 (35 ms): 2818.9.
Step 17221 (35 ms): 2842.6.
Step 17258 (36 ms): 2780.9.
Step 17296 (17 ms): 2322.1.

Epoch 46 (13.5 s):
    Evaluating model.
    Full set (5.56 s): ELBO: 2766.8, ENRE: 2820.3, KL: 53.512.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 17334 (36 ms): 2745.3.
Step 17371 (37 ms): 2865.3.
Step 17409 (36 ms): 2795.5.
Step 17446 (37 ms): 2782.4.
Step 17484 (36 ms): 2775.5.
Step 17522 (37 ms): 2784.8.
Step 17559 (36 ms): 2849.3.
Step 17597 (36 ms): 2827.9.
Step 17634 (36 ms): 2735.5.
Step 17672 (17 ms): 130.01.

Epoch 47 (13.6 s):
    Evaluating model.
    Full set (5.53 s): ELBO: 2800.5, ENRE: 2847.8, KL: 47.285.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 17710 (36 ms): 2706.1.
Step 17747 (35 ms): 2823.3.
Step 17785 (36 ms): 2755.5.
Step 17822 (36 ms): 2877.
Step 17860 (36 ms): 2822.7.
Step 17898 (36 ms): 2849.3.
Step 17935 (36 ms): 2828.1.
Step 17973 (36 ms): 2807.3.
Step 18010 (36 ms): 2780.6.
Step 18048 (17 ms): 114.66.

Epoch 48 (13.5 s):
    Evaluating model.
    Full set (5.57 s): ELBO: 2782.1, ENRE: 2830, KL: 47.89.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 18086 (36 ms): 2871.9.
Step 18123 (36 ms): 2810.5.
Step 18161 (36 ms): 2839.4.
Step 18198 (36 ms): 2830.3.
Step 18236 (36 ms): 2811.4.
Step 18274 (36 ms): 2793.1.
Step 18311 (36 ms): 2784.3.
Step 18349 (36 ms): 2788.2.
Step 18386 (36 ms): 2811.
Step 18424 (17 ms): 1669.8.

Epoch 49 (13.6 s):
    Evaluating model.
    Full set (5.54 s): ELBO: 2779.9, ENRE: 2829.5, KL: 49.67.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 18462 (36 ms): 2838.9.
Step 18499 (36 ms): 2838.4.
Step 18537 (36 ms): 2787.8.
Step 18574 (36 ms): 2856.4.
Step 18612 (35 ms): 2847.2.
Step 18650 (36 ms): 2818.3.
Step 18687 (36 ms): 2846.9.
Step 18725 (36 ms): 2803.2.
Step 18762 (36 ms): 2869.1.
Step 18800 (17 ms): -484.97.

Epoch 50 (13.5 s):
    Evaluating model.
    Full set (5.58 s): ELBO: 2791.7, ENRE: 2839.7, KL: 47.949.
    Saving model parameters.
    Model parameters saved (88 ms).

Model trained for 50 epochs (16m 5s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (13 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (854 ms).

Converting data set value array to sparse matrix.
Data set value array converted (271 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.88 s):  ELBO: -11894, ENRE: -11846, KL: 47.973.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (691 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.501317237948895
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 42
kl weight: 1.501317237948895
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (49 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.07 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.72 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 42
    hidden sizes: 178, 78, 104
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.501317237948895
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 4 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 178)
    ENCODER/1/DENSE/biases:0             (178,)
    ENCODER/1/BATCH_NORM/beta:0          (178,)
    ENCODER/2/DENSE/weights:0            (178, 78)
    ENCODER/2/DENSE/biases:0             (78,)
    ENCODER/2/BATCH_NORM/beta:0          (78,)
    ENCODER/3/DENSE/weights:0            (78, 104)
    ENCODER/3/DENSE/biases:0             (104,)
    ENCODER/3/BATCH_NORM/beta:0          (104,)
    POSTERIOR/MU/DENSE/weights:0         (104, 42)
    POSTERIOR/MU/DENSE/biases:0          (42,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (104, 42)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (42,)
    DECODER/3/DENSE/weights:0            (42, 104)
    DECODER/3/DENSE/biases:0             (104,)
    DECODER/3/BATCH_NORM/beta:0          (104,)
    DECODER/2/DENSE/weights:0            (104, 78)
    DECODER/2/DENSE/biases:0             (78,)
    DECODER/2/BATCH_NORM/beta:0          (78,)
    DECODER/1/DENSE/weights:0            (78, 178)
    DECODER/1/DENSE/biases:0             (178,)
    DECODER/1/BATCH_NORM/beta:0          (178,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (178, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (381 ms).

Training model for 50 epochs on original values.

Step 38 (28 ms): -2187.
Step 75 (28 ms): -1838.
Step 113 (27 ms): -1518.
Step 150 (28 ms): -1394.6.
Step 188 (28 ms): -1117.1.
Step 226 (28 ms): -953.33.
Step 263 (28 ms): -854.26.
Step 301 (28 ms): -751.79.
Step 338 (28 ms): -681.01.
Step 376 (15 ms): -602.93.

Epoch 1 (12.5 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (5.81 s): ELBO: -1772.8, ENRE: -1732.5, KL: 40.342.
    Saving model parameters.
    Model parameters saved (151 ms).

Step 414 (28 ms): -572.14.
Step 451 (29 ms): -560.31.
Step 489 (28 ms): -456.12.
Step 526 (28 ms): -435.09.
Step 564 (28 ms): -434.49.
Step 602 (28 ms): -425.53.
Step 639 (29 ms): -385.32.
Step 677 (28 ms): -364.2.
Step 714 (29 ms): -351.84.
Step 752 (15 ms): -327.3.

Epoch 2 (10.5 s):
    Warm-up weight: 0.25
    Evaluating model.
    Full set (5.31 s): ELBO: -1038, ENRE: -1007.2, KL: 30.789.
    Saving model parameters.
    Model parameters saved (97 ms).

Step 790 (28 ms): -331.66.
Step 827 (28 ms): -339.41.
Step 865 (28 ms): -319.67.
Step 902 (28 ms): -289.36.
Step 940 (28 ms): -299.35.
Step 978 (28 ms): -281.17.
Step 1015 (27 ms): -305.35.
Step 1053 (28 ms): -297.26.
Step 1090 (27 ms): -324.43.
Step 1128 (13 ms): -297.44.

Epoch 3 (10.4 s):
    Warm-up weight: 0.5
    Evaluating model.
    Full set (5.24 s): ELBO: -614.72, ENRE: -595.35, KL: 19.364.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 1166 (28 ms): -257.25.
Step 1203 (28 ms): -284.62.
Step 1241 (29 ms): -286.83.
Step 1278 (28 ms): -267.25.
Step 1316 (28 ms): -257.23.
Step 1354 (28 ms): -254.94.
Step 1391 (28 ms): -265.88.
Step 1429 (28 ms): -246.47.
Step 1466 (28 ms): -235.81.
Step 1504 (13 ms): -324.09.

Epoch 4 (10.6 s):
    Warm-up weight: 0.75
    Evaluating model.
    Full set (5.3 s): ELBO: -414.15, ENRE: -400.53, KL: 13.618.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 1542 (28 ms): -252.97.
Step 1579 (28 ms): -248.66.
Step 1617 (29 ms): -239.75.
Step 1654 (28 ms): -247.33.
Step 1692 (28 ms): -246.45.
Step 1730 (28 ms): -249.87.
Step 1767 (28 ms): -276.18.
Step 1805 (28 ms): -237.74.
Step 1842 (28 ms): -236.56.
Step 1880 (13 ms): -393.89.

Epoch 5 (10.5 s):
    Evaluating model.
    Full set (5.25 s): ELBO: -323.53, ENRE: -312.91, KL: 10.617.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 1918 (28 ms): -226.79.
Step 1955 (28 ms): -242.1.
Step 1993 (28 ms): -242.35.
Step 2030 (28 ms): -234.69.
Step 2068 (28 ms): -232.36.
Step 2106 (28 ms): -242.38.
Step 2143 (28 ms): -231.3.
Step 2181 (28 ms): -217.17.
Step 2218 (28 ms): -233.91.
Step 2256 (13 ms): -258.94.

Epoch 6 (10.5 s):
    Evaluating model.
    Full set (5.3 s): ELBO: -273.09, ENRE: -263.7, KL: 9.3936.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 2294 (28 ms): -228.47.
Step 2331 (29 ms): -227.38.
Step 2369 (28 ms): -224.52.
Step 2406 (28 ms): -249.42.
Step 2444 (28 ms): -225.52.
Step 2482 (28 ms): -235.15.
Step 2519 (28 ms): -227.75.
Step 2557 (28 ms): -220.48.
Step 2594 (28 ms): -225.93.
Step 2632 (13 ms): -316.43.

Epoch 7 (10.5 s):
    Evaluating model.
    Full set (5.26 s): ELBO: -249.38, ENRE: -240.79, KL: 8.5919.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 2670 (27 ms): -226.61.
Step 2707 (27 ms): -223.73.
Step 2745 (28 ms): -215.66.
Step 2782 (28 ms): -246.81.
Step 2820 (28 ms): -237.85.
Step 2858 (27 ms): -222.21.
Step 2895 (28 ms): -217.23.
Step 2933 (28 ms): -215.81.
Step 2970 (27 ms): -219.37.
Step 3008 (13 ms): -267.2.

Epoch 8 (10.4 s):
    Evaluating model.
    Full set (5.3 s): ELBO: -236.02, ENRE: -227.75, KL: 8.2717.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 3046 (28 ms): -233.97.
Step 3083 (28 ms): -224.34.
Step 3121 (28 ms): -223.12.
Step 3158 (28 ms): -239.58.
Step 3196 (27 ms): -217.97.
Step 3234 (28 ms): -228.26.
Step 3271 (28 ms): -221.57.
Step 3309 (28 ms): -225.79.
Step 3346 (28 ms): -221.73.
Step 3384 (13 ms): -236.2.

Epoch 9 (10.5 s):
    Evaluating model.
    Full set (5.3 s): ELBO: -227.01, ENRE: -218.9, KL: 8.1021.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 3422 (28 ms): -223.22.
Step 3459 (28 ms): -209.58.
Step 3497 (27 ms): -221.35.
Step 3534 (28 ms): -224.81.
Step 3572 (28 ms): -217.64.
Step 3610 (28 ms): -225.91.
Step 3647 (27 ms): -227.41.
Step 3685 (28 ms): -225.35.
Step 3722 (28 ms): -217.07.
Step 3760 (13 ms): -223.54.

Epoch 10 (10.5 s):
    Evaluating model.
    Full set (5.28 s): ELBO: -222.97, ENRE: -215.11, KL: 7.8552.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 3798 (28 ms): -222.37.
Step 3835 (29 ms): -216.19.
Step 3873 (28 ms): -248.57.
Step 3910 (30 ms): -220.18.
Step 3948 (28 ms): -223.82.
Step 3986 (29 ms): -226.3.
Step 4023 (28 ms): -215.09.
Step 4061 (28 ms): -218.02.
Step 4098 (28 ms): -216.49.
Step 4136 (13 ms): -259.78.

Epoch 11 (10.6 s):
    Evaluating model.
    Full set (5.31 s): ELBO: -220.14, ENRE: -212.78, KL: 7.3597.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 4174 (28 ms): -234.71.
Step 4211 (28 ms): -224.1.
Step 4249 (28 ms): -217.86.
Step 4286 (28 ms): -219.68.
Step 4324 (28 ms): -234.44.
Step 4362 (28 ms): -219.99.
Step 4399 (28 ms): -219.78.
Step 4437 (28 ms): -219.07.
Step 4474 (28 ms): -228.92.
Step 4512 (13 ms): -247.35.

Epoch 12 (10.5 s):
    Evaluating model.
    Full set (5.23 s): ELBO: -218.36, ENRE: -211.07, KL: 7.2936.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 4550 (28 ms): -218.06.
Step 4587 (27 ms): -219.05.
Step 4625 (28 ms): -205.11.
Step 4662 (28 ms): -227.06.
Step 4700 (28 ms): -211.86.
Step 4738 (28 ms): -209.46.
Step 4775 (28 ms): -219.28.
Step 4813 (28 ms): -213.97.
Step 4850 (28 ms): -218.63.
Step 4888 (13 ms): -230.4.

Epoch 13 (10.5 s):
    Evaluating model.
    Full set (5.31 s): ELBO: -216.46, ENRE: -209.32, KL: 7.1366.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 4926 (28 ms): -214.7.
Step 4963 (28 ms): -217.62.
Step 5001 (28 ms): -212.36.
Step 5038 (28 ms): -200.58.
Step 5076 (28 ms): -234.32.
Step 5114 (28 ms): -222.62.
Step 5151 (28 ms): -207.11.
Step 5189 (28 ms): -220.84.
Step 5226 (27 ms): -198.68.
Step 5264 (13 ms): -207.83.

Epoch 14 (10.5 s):
    Evaluating model.
    Full set (5.25 s): ELBO: -214.94, ENRE: -207.86, KL: 7.0762.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 5302 (27 ms): -234.69.
Step 5339 (28 ms): -219.86.
Step 5377 (27 ms): -225.76.
Step 5414 (29 ms): -213.44.
Step 5452 (27 ms): -200.15.
Step 5490 (28 ms): -222.12.
Step 5527 (29 ms): -219.78.
Step 5565 (27 ms): -218.8.
Step 5602 (28 ms): -218.94.
Step 5640 (13 ms): -414.77.

Epoch 15 (10.4 s):
    Evaluating model.
    Full set (5.32 s): ELBO: -214.23, ENRE: -207.31, KL: 6.9186.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 5678 (28 ms): -203.48.
Step 5715 (28 ms): -216.6.
Step 5753 (28 ms): -206.04.
Step 5790 (28 ms): -208.12.
Step 5828 (29 ms): -236.51.
Step 5866 (28 ms): -213.21.
Step 5903 (28 ms): -212.63.
Step 5941 (28 ms): -209.39.
Step 5978 (28 ms): -227.12.
Step 6016 (13 ms): -240.13.

Epoch 16 (10.6 s):
    Evaluating model.
    Full set (5.28 s): ELBO: -213.41, ENRE: -206.66, KL: 6.748.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 6054 (28 ms): -208.25.
Step 6091 (28 ms): -208.72.
Step 6129 (28 ms): -237.84.
Step 6166 (28 ms): -201.5.
Step 6204 (28 ms): -204.1.
Step 6242 (28 ms): -217.18.
Step 6279 (28 ms): -204.49.
Step 6317 (28 ms): -223.5.
Step 6354 (28 ms): -213.55.
Step 6392 (13 ms): -213.11.

Epoch 17 (10.5 s):
    Evaluating model.
    Full set (5.23 s): ELBO: -212.74, ENRE: -205.94, KL: 6.8002.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 6430 (28 ms): -214.32.
Step 6467 (28 ms): -213.16.
Step 6505 (28 ms): -217.1.
Step 6542 (28 ms): -207.29.
Step 6580 (28 ms): -209.07.
Step 6618 (28 ms): -211.37.
Step 6655 (28 ms): -222.83.
Step 6693 (27 ms): -216.35.
Step 6730 (28 ms): -224.85.
Step 6768 (13 ms): -210.53.

Epoch 18 (10.5 s):
    Evaluating model.
    Full set (5.29 s): ELBO: -212.14, ENRE: -205.6, KL: 6.543.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 6806 (28 ms): -222.46.
Step 6843 (28 ms): -205.04.
Step 6881 (28 ms): -219.2.
Step 6918 (28 ms): -211.81.
Step 6956 (28 ms): -209.15.
Step 6994 (28 ms): -207.29.
Step 7031 (29 ms): -206.93.
Step 7069 (27 ms): -194.92.
Step 7106 (28 ms): -209.42.
Step 7144 (13 ms): -217.76.

Epoch 19 (10.4 s):
    Evaluating model.
    Full set (5.19 s): ELBO: -211.36, ENRE: -204.86, KL: 6.5062.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 7182 (28 ms): -207.32.
Step 7219 (27 ms): -201.58.
Step 7257 (28 ms): -210.22.
Step 7294 (28 ms): -206.8.
Step 7332 (28 ms): -208.1.
Step 7370 (28 ms): -205.02.
Step 7407 (28 ms): -206.82.
Step 7445 (28 ms): -212.63.
Step 7482 (27 ms): -205.19.
Step 7520 (13 ms): -375.85.

Epoch 20 (10.5 s):
    Evaluating model.
    Full set (5.27 s): ELBO: -210.89, ENRE: -204.44, KL: 6.4532.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 7558 (28 ms): -209.05.
Step 7595 (28 ms): -210.89.
Step 7633 (28 ms): -208.18.
Step 7670 (29 ms): -212.8.
Step 7708 (27 ms): -205.59.
Step 7746 (28 ms): -214.29.
Step 7783 (28 ms): -227.81.
Step 7821 (28 ms): -220.59.
Step 7858 (27 ms): -204.98.
Step 7896 (13 ms): -478.68.

Epoch 21 (10.5 s):
    Evaluating model.
    Full set (5.21 s): ELBO: -210.46, ENRE: -204.06, KL: 6.4008.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 7934 (27 ms): -203.29.
Step 7971 (27 ms): -213.32.
Step 8009 (28 ms): -214.17.
Step 8046 (27 ms): -219.22.
Step 8084 (27 ms): -215.6.
Step 8122 (28 ms): -206.45.
Step 8159 (28 ms): -210.94.
Step 8197 (28 ms): -211.96.
Step 8234 (28 ms): -208.16.
Step 8272 (15 ms): -291.31.

Epoch 22 (10.4 s):
    Evaluating model.
    Full set (5.29 s): ELBO: -210.05, ENRE: -203.75, KL: 6.3005.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 8310 (28 ms): -200.46.
Step 8347 (28 ms): -205.24.
Step 8385 (28 ms): -229.79.
Step 8422 (28 ms): -223.4.
Step 8460 (27 ms): -204.37.
Step 8498 (28 ms): -198.01.
Step 8535 (27 ms): -201.1.
Step 8573 (28 ms): -204.77.
Step 8610 (28 ms): -212.98.
Step 8648 (13 ms): -211.62.

Epoch 23 (10.5 s):
    Evaluating model.
    Full set (5.24 s): ELBO: -209.51, ENRE: -203.25, KL: 6.2647.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 8686 (28 ms): -223.25.
Step 8723 (28 ms): -208.13.
Step 8761 (28 ms): -215.24.
Step 8798 (28 ms): -206.83.
Step 8836 (27 ms): -210.04.
Step 8874 (27 ms): -205.76.
Step 8911 (28 ms): -199.27.
Step 8949 (27 ms): -205.28.
Step 8986 (27 ms): -207.37.
Step 9024 (13 ms): -241.14.

Epoch 24 (10.4 s):
    Evaluating model.
    Full set (5.26 s): ELBO: -208.91, ENRE: -202.63, KL: 6.2779.
    Saving model parameters.
    Model parameters saved (97 ms).

Step 9062 (27 ms): -208.51.
Step 9099 (28 ms): -219.91.
Step 9137 (28 ms): -198.5.
Step 9174 (28 ms): -216.35.
Step 9212 (28 ms): -199.48.
Step 9250 (28 ms): -223.52.
Step 9287 (28 ms): -194.98.
Step 9325 (28 ms): -208.73.
Step 9362 (28 ms): -212.71.
Step 9400 (13 ms): -353.86.

Epoch 25 (10.5 s):
    Evaluating model.
    Full set (5.28 s): ELBO: -208.77, ENRE: -202.55, KL: 6.2231.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 9438 (28 ms): -231.66.
Step 9475 (28 ms): -197.45.
Step 9513 (28 ms): -205.97.
Step 9550 (27 ms): -213.85.
Step 9588 (28 ms): -207.51.
Step 9626 (27 ms): -212.93.
Step 9663 (27 ms): -208.02.
Step 9701 (27 ms): -214.36.
Step 9738 (27 ms): -220.79.
Step 9776 (13 ms): -213.3.

Epoch 26 (10.4 s):
    Evaluating model.
    Full set (5.18 s): ELBO: -208.08, ENRE: -201.79, KL: 6.2835.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 9814 (27 ms): -211.28.
Step 9851 (28 ms): -212.24.
Step 9889 (28 ms): -209.17.
Step 9926 (28 ms): -213.57.
Step 9964 (28 ms): -215.85.
Step 10002 (28 ms): -202.89.
Step 10039 (28 ms): -213.76.
Step 10077 (27 ms): -212.7.
Step 10114 (28 ms): -207.08.
Step 10152 (13 ms): -209.42.

Epoch 27 (10.4 s):
    Evaluating model.
    Full set (5.28 s): ELBO: -207.63, ENRE: -201.38, KL: 6.2487.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 10190 (28 ms): -196.58.
Step 10227 (28 ms): -205.89.
Step 10265 (27 ms): -208.35.
Step 10302 (28 ms): -205.04.
Step 10340 (28 ms): -210.96.
Step 10378 (28 ms): -205.52.
Step 10415 (28 ms): -202.48.
Step 10453 (28 ms): -204.98.
Step 10490 (27 ms): -222.19.
Step 10528 (13 ms): -214.49.

Epoch 28 (10.5 s):
    Evaluating model.
    Full set (5.2 s): ELBO: -207.39, ENRE: -201.23, KL: 6.1638.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 10566 (27 ms): -205.86.
Step 10603 (28 ms): -195.77.
Step 10641 (28 ms): -209.13.
Step 10678 (28 ms): -203.9.
Step 10716 (28 ms): -205.74.
Step 10754 (28 ms): -216.69.
Step 10791 (28 ms): -200.44.
Step 10829 (28 ms): -219.89.
Step 10866 (28 ms): -219.2.
Step 10904 (14 ms): -240.9.

Epoch 29 (10.4 s):
    Evaluating model.
    Full set (5.26 s): ELBO: -206.95, ENRE: -200.84, KL: 6.1139.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 10942 (28 ms): -209.41.
Step 10979 (28 ms): -204.42.
Step 11017 (27 ms): -199.73.
Step 11054 (28 ms): -204.07.
Step 11092 (28 ms): -189.54.
Step 11130 (28 ms): -212.76.
Step 11167 (27 ms): -201.93.
Step 11205 (28 ms): -207.73.
Step 11242 (28 ms): -200.74.
Step 11280 (13 ms): -191.82.

Epoch 30 (10.5 s):
    Evaluating model.
    Full set (5.22 s): ELBO: -206.69, ENRE: -200.5, KL: 6.191.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 11318 (28 ms): -211.65.
Step 11355 (27 ms): -204.54.
Step 11393 (28 ms): -200.98.
Step 11430 (28 ms): -216.46.
Step 11468 (27 ms): -211.28.
Step 11506 (28 ms): -206.91.
Step 11543 (27 ms): -215.09.
Step 11581 (28 ms): -206.98.
Step 11618 (28 ms): -209.25.
Step 11656 (13 ms): -287.06.

Epoch 31 (10.4 s):
    Evaluating model.
    Full set (5.27 s): ELBO: -206.53, ENRE: -200.4, KL: 6.1341.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 11694 (28 ms): -208.9.
Step 11731 (28 ms): -215.01.
Step 11769 (28 ms): -221.47.
Step 11806 (28 ms): -216.21.
Step 11844 (28 ms): -210.26.
Step 11882 (28 ms): -192.38.
Step 11919 (28 ms): -206.26.
Step 11957 (27 ms): -209.04.
Step 11994 (28 ms): -210.11.
Step 12032 (13 ms): -230.93.

Epoch 32 (10.4 s):
    Evaluating model.
    Full set (5.26 s): ELBO: -205.88, ENRE: -199.82, KL: 6.062.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 12070 (27 ms): -207.94.
Step 12107 (28 ms): -201.95.
Step 12145 (27 ms): -196.24.
Step 12182 (27 ms): -207.16.
Step 12220 (27 ms): -216.51.
Step 12258 (27 ms): -199.72.
Step 12295 (27 ms): -213.99.
Step 12333 (27 ms): -202.99.
Step 12370 (27 ms): -207.05.
Step 12408 (13 ms): -306.07.

Epoch 33 (10.3 s):
    Evaluating model.
    Full set (5.17 s): ELBO: -205.68, ENRE: -199.61, KL: 6.0658.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 12446 (28 ms): -202.88.
Step 12483 (28 ms): -206.85.
Step 12521 (27 ms): -201.34.
Step 12558 (27 ms): -200.03.
Step 12596 (28 ms): -218.03.
Step 12634 (28 ms): -207.46.
Step 12671 (28 ms): -211.23.
Step 12709 (28 ms): -204.01.
Step 12746 (28 ms): -210.21.
Step 12784 (13 ms): -261.68.

Epoch 34 (10.4 s):
    Evaluating model.
    Full set (5.28 s): ELBO: -205.64, ENRE: -199.67, KL: 5.9672.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 12822 (28 ms): -200.15.
Step 12859 (28 ms): -203.84.
Step 12897 (28 ms): -204.47.
Step 12934 (28 ms): -200.19.
Step 12972 (28 ms): -201.7.
Step 13010 (28 ms): -207.1.
Step 13047 (27 ms): -190.74.
Step 13085 (28 ms): -210.58.
Step 13122 (28 ms): -215.6.
Step 13160 (13 ms): -231.65.

Epoch 35 (10.5 s):
    Evaluating model.
    Full set (5.2 s): ELBO: -205.26, ENRE: -199.37, KL: 5.8909.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 13198 (28 ms): -202.57.
Step 13235 (27 ms): -216.25.
Step 13273 (27 ms): -202.47.
Step 13310 (28 ms): -206.53.
Step 13348 (28 ms): -216.74.
Step 13386 (27 ms): -195.3.
Step 13423 (28 ms): -208.98.
Step 13461 (28 ms): -216.82.
Step 13498 (28 ms): -198.72.
Step 13536 (13 ms): -319.14.

Epoch 36 (10.4 s):
    Evaluating model.
    Full set (5.28 s): ELBO: -205.02, ENRE: -199.2, KL: 5.8158.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 13574 (28 ms): -196.27.
Step 13611 (28 ms): -191.42.
Step 13649 (27 ms): -206.03.
Step 13686 (28 ms): -195.69.
Step 13724 (27 ms): -198.97.
Step 13762 (28 ms): -200.96.
Step 13799 (28 ms): -196.49.
Step 13837 (28 ms): -197.74.
Step 13874 (28 ms): -201.45.
Step 13912 (13 ms): -309.44.

Epoch 37 (10.5 s):
    Evaluating model.
    Full set (5.23 s): ELBO: -204.73, ENRE: -198.92, KL: 5.8081.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 13950 (28 ms): -205.36.
Step 13987 (27 ms): -201.88.
Step 14025 (27 ms): -202.62.
Step 14062 (28 ms): -213.54.
Step 14100 (27 ms): -202.38.
Step 14138 (28 ms): -220.77.
Step 14175 (28 ms): -198.31.
Step 14213 (28 ms): -199.37.
Step 14250 (27 ms): -201.87.
Step 14288 (13 ms): -209.6.

Epoch 38 (10.4 s):
    Evaluating model.
    Full set (5.27 s): ELBO: -204.58, ENRE: -198.82, KL: 5.7538.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 14326 (28 ms): -207.15.
Step 14363 (28 ms): -200.97.
Step 14401 (27 ms): -221.96.
Step 14438 (28 ms): -193.95.
Step 14476 (28 ms): -210.85.
Step 14514 (28 ms): -217.77.
Step 14551 (28 ms): -207.14.
Step 14589 (28 ms): -198.
Step 14626 (28 ms): -209.39.
Step 14664 (13 ms): -194.31.

Epoch 39 (10.5 s):
    Evaluating model.
    Full set (5.26 s): ELBO: -204.29, ENRE: -198.5, KL: 5.7915.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 14702 (27 ms): -199.31.
Step 14739 (28 ms): -210.7.
Step 14777 (27 ms): -212.13.
Step 14814 (27 ms): -208.83.
Step 14852 (28 ms): -196.39.
Step 14890 (28 ms): -212.44.
Step 14927 (27 ms): -197.37.
Step 14965 (28 ms): -206.81.
Step 15002 (28 ms): -213.31.
Step 15040 (13 ms): -280.13.

Epoch 40 (10.4 s):
    Evaluating model.
    Full set (5.17 s): ELBO: -204.16, ENRE: -198.42, KL: 5.7386.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 15078 (28 ms): -215.9.
Step 15115 (28 ms): -199.52.
Step 15153 (28 ms): -205.07.
Step 15190 (28 ms): -205.64.
Step 15228 (27 ms): -219.37.
Step 15266 (28 ms): -190.37.
Step 15303 (27 ms): -198.42.
Step 15341 (28 ms): -199.67.
Step 15378 (28 ms): -199.24.
Step 15416 (13 ms): -237.53.

Epoch 41 (10.5 s):
    Evaluating model.
    Full set (5.27 s): ELBO: -203.86, ENRE: -198.07, KL: 5.7859.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 15454 (28 ms): -214.92.
Step 15491 (27 ms): -208.14.
Step 15529 (28 ms): -215.47.
Step 15566 (28 ms): -197.08.
Step 15604 (28 ms): -203.63.
Step 15642 (28 ms): -205.89.
Step 15679 (28 ms): -203.21.
Step 15717 (28 ms): -220.88.
Step 15754 (28 ms): -200.5.
Step 15792 (13 ms): -409.16.

Epoch 42 (10.5 s):
    Evaluating model.
    Full set (5.18 s): ELBO: -203.74, ENRE: -197.97, KL: 5.7701.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 15830 (28 ms): -206.74.
Step 15867 (27 ms): -205.38.
Step 15905 (27 ms): -197.67.
Step 15942 (28 ms): -210.82.
Step 15980 (28 ms): -204.33.
Step 16018 (28 ms): -200.03.
Step 16055 (28 ms): -194.42.
Step 16093 (28 ms): -203.91.
Step 16130 (27 ms): -198.57.
Step 16168 (13 ms): -446.08.

Epoch 43 (10.4 s):
    Evaluating model.
    Full set (5.27 s): ELBO: -203.48, ENRE: -197.66, KL: 5.8211.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 16206 (28 ms): -201.31.
Step 16243 (27 ms): -206.24.
Step 16281 (28 ms): -201.89.
Step 16318 (28 ms): -223.13.
Step 16356 (28 ms): -199.62.
Step 16394 (28 ms): -206.27.
Step 16431 (28 ms): -206.02.
Step 16469 (28 ms): -210.88.
Step 16506 (28 ms): -202.23.
Step 16544 (13 ms): -243.57.

Epoch 44 (10.5 s):
    Evaluating model.
    Full set (5.25 s): ELBO: -203.29, ENRE: -197.45, KL: 5.8384.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 16582 (28 ms): -207.61.
Step 16619 (28 ms): -200.21.
Step 16657 (27 ms): -197.52.
Step 16694 (27 ms): -191.82.
Step 16732 (27 ms): -209.03.
Step 16770 (28 ms): -207.
Step 16807 (28 ms): -197.9.
Step 16845 (27 ms): -199.24.
Step 16882 (28 ms): -197.55.
Step 16920 (13 ms): -186.6.

Epoch 45 (10.4 s):
    Evaluating model.
    Full set (5.25 s): ELBO: -203.1, ENRE: -197.31, KL: 5.7909.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 16958 (28 ms): -195.86.
Step 16995 (27 ms): -216.27.
Step 17033 (28 ms): -206.
Step 17070 (28 ms): -195.77.
Step 17108 (28 ms): -212.78.
Step 17146 (28 ms): -208.72.
Step 17183 (28 ms): -198.33.
Step 17221 (27 ms): -202.85.
Step 17258 (28 ms): -209.77.
Step 17296 (13 ms): -166.35.

Epoch 46 (10.5 s):
    Evaluating model.
    Full set (5.27 s): ELBO: -202.93, ENRE: -197.14, KL: 5.7988.
    Saving model parameters.
    Model parameters saved (100 ms).

Step 17334 (27 ms): -200.
Step 17371 (28 ms): -203.82.
Step 17409 (28 ms): -204.4.
Step 17446 (27 ms): -204.45.
Step 17484 (28 ms): -197.23.
Step 17522 (28 ms): -197.07.
Step 17559 (28 ms): -208.68.
Step 17597 (27 ms): -199.18.
Step 17634 (28 ms): -201.9.
Step 17672 (13 ms): -233.54.

Epoch 47 (10.4 s):
    Evaluating model.
    Full set (5.28 s): ELBO: -202.95, ENRE: -197.19, KL: 5.762.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 17710 (29 ms): -202.83.
Step 17747 (28 ms): -195.15.
Step 17785 (28 ms): -210.56.
Step 17822 (28 ms): -195.16.
Step 17860 (28 ms): -201.84.
Step 17898 (28 ms): -203.
Step 17935 (28 ms): -204.56.
Step 17973 (28 ms): -201.41.
Step 18010 (28 ms): -201.01.
Step 18048 (13 ms): -185.08.

Epoch 48 (10.5 s):
    Evaluating model.
    Full set (5.26 s): ELBO: -202.66, ENRE: -196.9, KL: 5.7585.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 18086 (28 ms): -191.38.
Step 18123 (28 ms): -201.75.
Step 18161 (29 ms): -201.
Step 18198 (27 ms): -189.99.
Step 18236 (27 ms): -212.53.
Step 18274 (27 ms): -196.87.
Step 18311 (27 ms): -205.11.
Step 18349 (28 ms): -201.08.
Step 18386 (27 ms): -198.67.
Step 18424 (13 ms): -340.7.

Epoch 49 (10.4 s):
    Evaluating model.
    Full set (5.23 s): ELBO: -202.73, ENRE: -196.99, KL: 5.7434.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 18462 (28 ms): -216.22.
Step 18499 (28 ms): -197.78.
Step 18537 (27 ms): -201.49.
Step 18574 (28 ms): -197.29.
Step 18612 (27 ms): -197.5.
Step 18650 (28 ms): -204.83.
Step 18687 (28 ms): -208.17.
Step 18725 (28 ms): -205.18.
Step 18762 (29 ms): -196.37.
Step 18800 (13 ms): -190.16.

Epoch 50 (10.5 s):
    Evaluating model.
    Full set (5.28 s): ELBO: -202.38, ENRE: -196.65, KL: 5.7249.
    Saving model parameters.
    Model parameters saved (96 ms).

Model trained for 50 epochs (13m 15s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (859 ms).

Converting data set value array to sparse matrix.
Data set value array converted (269 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.64 s):  ELBO: -419.71, ENRE: -413.98, KL: 5.7261.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (546 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.5529780459111007
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 19
kl weight: 1.5529780459111007
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (41 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.21 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.77 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 19
    hidden sizes: 207, 213, 147, 111
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.5529780459111007
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 1 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 207)
    ENCODER/1/DENSE/biases:0             (207,)
    ENCODER/1/BATCH_NORM/beta:0          (207,)
    ENCODER/2/DENSE/weights:0            (207, 213)
    ENCODER/2/DENSE/biases:0             (213,)
    ENCODER/2/BATCH_NORM/beta:0          (213,)
    ENCODER/3/DENSE/weights:0            (213, 147)
    ENCODER/3/DENSE/biases:0             (147,)
    ENCODER/3/BATCH_NORM/beta:0          (147,)
    ENCODER/4/DENSE/weights:0            (147, 111)
    ENCODER/4/DENSE/biases:0             (111,)
    ENCODER/4/BATCH_NORM/beta:0          (111,)
    POSTERIOR/MU/DENSE/weights:0         (111, 19)
    POSTERIOR/MU/DENSE/biases:0          (19,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (111, 19)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (19,)
    DECODER/4/DENSE/weights:0            (19, 111)
    DECODER/4/DENSE/biases:0             (111,)
    DECODER/4/BATCH_NORM/beta:0          (111,)
    DECODER/3/DENSE/weights:0            (111, 147)
    DECODER/3/DENSE/biases:0             (147,)
    DECODER/3/BATCH_NORM/beta:0          (147,)
    DECODER/2/DENSE/weights:0            (147, 213)
    DECODER/2/DENSE/biases:0             (213,)
    DECODER/2/BATCH_NORM/beta:0          (213,)
    DECODER/1/DENSE/weights:0            (213, 207)
    DECODER/1/DENSE/biases:0             (207,)
    DECODER/1/BATCH_NORM/beta:0          (207,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (207, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (705 ms).

Training model for 50 epochs on original values.

Step 38 (33 ms): -2056.4.
Step 75 (34 ms): -1592.1.
Step 113 (33 ms): -1304.8.
Step 150 (32 ms): -1109.9.
Step 188 (32 ms): -899.23.
Step 226 (32 ms): -759.93.
Step 263 (32 ms): -688.06.
Step 301 (32 ms): -602.48.
Step 338 (32 ms): -542.48.
Step 376 (17 ms): -492.98.

Epoch 1 (14.8 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.49 s): ELBO: -1751.2, ENRE: -1736.4, KL: 14.772.
    Saving model parameters.
    Model parameters saved (177 ms).

Step 414 (32 ms): -447.38.
Step 451 (32 ms): -416.74.
Step 489 (33 ms): -390.84.
Step 526 (32 ms): -391.89.
Step 564 (32 ms): -351.7.
Step 602 (33 ms): -346.01.
Step 639 (32 ms): -322.13.
Step 677 (32 ms): -303.73.
Step 714 (31 ms): -287.51.
Step 752 (15 ms): -333.38.

Epoch 2 (12.1 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -907.22, ENRE: -897.7, KL: 9.5217.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 790 (32 ms): -284.23.
Step 827 (32 ms): -291.62.
Step 865 (32 ms): -270.54.
Step 902 (33 ms): -253.72.
Step 940 (32 ms): -261.84.
Step 978 (32 ms): -269.27.
Step 1015 (33 ms): -265.98.
Step 1053 (32 ms): -271.
Step 1090 (32 ms): -244.19.
Step 1128 (15 ms): -242.63.

Epoch 3 (12.2 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -504.99, ENRE: -496.66, KL: 8.333.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 1166 (32 ms): -248.45.
Step 1203 (32 ms): -232.86.
Step 1241 (32 ms): -249.58.
Step 1278 (32 ms): -243.81.
Step 1316 (33 ms): -239.47.
Step 1354 (32 ms): -254.7.
Step 1391 (32 ms): -256.82.
Step 1429 (31 ms): -237.35.
Step 1466 (32 ms): -227.78.
Step 1504 (16 ms): -424.68.

Epoch 4 (12.1 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -356.29, ENRE: -348.75, KL: 7.5408.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 1542 (32 ms): -229.45.
Step 1579 (32 ms): -251.9.
Step 1617 (32 ms): -226.36.
Step 1654 (32 ms): -246.9.
Step 1692 (32 ms): -237.92.
Step 1730 (32 ms): -233.27.
Step 1767 (33 ms): -219.02.
Step 1805 (32 ms): -225.3.
Step 1842 (32 ms): -228.55.
Step 1880 (15 ms): -345.78.

Epoch 5 (12.1 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -291.94, ENRE: -285.17, KL: 6.7741.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 1918 (32 ms): -222.64.
Step 1955 (33 ms): -218.87.
Step 1993 (32 ms): -232.99.
Step 2030 (32 ms): -229.66.
Step 2068 (31 ms): -228.09.
Step 2106 (31 ms): -209.58.
Step 2143 (32 ms): -234.36.
Step 2181 (32 ms): -223.42.
Step 2218 (31 ms): -212.12.
Step 2256 (15 ms): -227.72.

Epoch 6 (12.1 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -261.96, ENRE: -255.65, KL: 6.3097.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 2294 (32 ms): -223.79.
Step 2331 (32 ms): -215.63.
Step 2369 (33 ms): -209.81.
Step 2406 (32 ms): -221.8.
Step 2444 (32 ms): -223.59.
Step 2482 (32 ms): -220.56.
Step 2519 (32 ms): -229.44.
Step 2557 (32 ms): -212.96.
Step 2594 (32 ms): -218.64.
Step 2632 (15 ms): -262.53.

Epoch 7 (12.1 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -242.38, ENRE: -236.43, KL: 5.9432.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 2670 (33 ms): -215.98.
Step 2707 (32 ms): -221.7.
Step 2745 (32 ms): -212.67.
Step 2782 (33 ms): -219.35.
Step 2820 (32 ms): -239.64.
Step 2858 (32 ms): -211.07.
Step 2895 (32 ms): -207.48.
Step 2933 (32 ms): -227.66.
Step 2970 (32 ms): -224.35.
Step 3008 (15 ms): -219.65.

Epoch 8 (12 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -232.59, ENRE: -226.85, KL: 5.7394.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 3046 (32 ms): -210.81.
Step 3083 (32 ms): -219.03.
Step 3121 (32 ms): -228.71.
Step 3158 (32 ms): -212.61.
Step 3196 (32 ms): -215.88.
Step 3234 (33 ms): -233.79.
Step 3271 (33 ms): -228.68.
Step 3309 (32 ms): -217.37.
Step 3346 (32 ms): -209.3.
Step 3384 (15 ms): -184.14.

Epoch 9 (12.2 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -226.27, ENRE: -220.66, KL: 5.6151.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 3422 (33 ms): -223.65.
Step 3459 (32 ms): -237.25.
Step 3497 (32 ms): -211.97.
Step 3534 (33 ms): -226.59.
Step 3572 (32 ms): -202.86.
Step 3610 (33 ms): -211.56.
Step 3647 (32 ms): -203.61.
Step 3685 (32 ms): -204.73.
Step 3722 (31 ms): -210.37.
Step 3760 (15 ms): -250.72.

Epoch 10 (12.1 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -221.18, ENRE: -215.6, KL: 5.584.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 3798 (32 ms): -224.8.
Step 3835 (32 ms): -219.95.
Step 3873 (32 ms): -203.96.
Step 3910 (32 ms): -212.42.
Step 3948 (32 ms): -214.51.
Step 3986 (33 ms): -216.68.
Step 4023 (32 ms): -204.71.
Step 4061 (32 ms): -205.42.
Step 4098 (32 ms): -230.35.
Step 4136 (15 ms): -177.13.

Epoch 11 (12.2 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -217.5, ENRE: -212.09, KL: 5.4095.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 4174 (32 ms): -203.34.
Step 4211 (32 ms): -213.95.
Step 4249 (31 ms): -195.3.
Step 4286 (32 ms): -238.98.
Step 4324 (32 ms): -207.48.
Step 4362 (32 ms): -202.32.
Step 4399 (32 ms): -213.36.
Step 4437 (32 ms): -213.73.
Step 4474 (32 ms): -207.47.
Step 4512 (15 ms): -264.19.

Epoch 12 (12.1 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -215.84, ENRE: -210.36, KL: 5.4771.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 4550 (33 ms): -197.38.
Step 4587 (33 ms): -198.33.
Step 4625 (32 ms): -216.37.
Step 4662 (32 ms): -202.73.
Step 4700 (33 ms): -200.49.
Step 4738 (32 ms): -204.76.
Step 4775 (32 ms): -216.15.
Step 4813 (32 ms): -205.9.
Step 4850 (32 ms): -211.17.
Step 4888 (15 ms): -244.83.

Epoch 13 (12.1 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -213.97, ENRE: -208.48, KL: 5.4906.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 4926 (32 ms): -205.27.
Step 4963 (31 ms): -204.71.
Step 5001 (32 ms): -209.04.
Step 5038 (32 ms): -217.7.
Step 5076 (32 ms): -223.54.
Step 5114 (32 ms): -205.7.
Step 5151 (32 ms): -209.45.
Step 5189 (32 ms): -212.1.
Step 5226 (32 ms): -198.23.
Step 5264 (15 ms): -358.62.

Epoch 14 (12 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -212.39, ENRE: -207.15, KL: 5.2341.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 5302 (32 ms): -210.71.
Step 5339 (32 ms): -210.47.
Step 5377 (32 ms): -217.43.
Step 5414 (32 ms): -193.35.
Step 5452 (32 ms): -216.38.
Step 5490 (32 ms): -210.13.
Step 5527 (32 ms): -218.48.
Step 5565 (32 ms): -201.86.
Step 5602 (33 ms): -214.1.
Step 5640 (15 ms): -224.22.

Epoch 15 (12.1 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -210.74, ENRE: -205.43, KL: 5.3075.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 5678 (31 ms): -215.85.
Step 5715 (32 ms): -205.59.
Step 5753 (32 ms): -208.07.
Step 5790 (32 ms): -199.83.
Step 5828 (32 ms): -208.51.
Step 5866 (32 ms): -219.12.
Step 5903 (32 ms): -194.66.
Step 5941 (32 ms): -202.18.
Step 5978 (32 ms): -203.51.
Step 6016 (15 ms): -211.13.

Epoch 16 (12.1 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -211.29, ENRE: -206.05, KL: 5.2391.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 6054 (33 ms): -217.32.
Step 6091 (32 ms): -196.28.
Step 6129 (32 ms): -212.68.
Step 6166 (32 ms): -202.67.
Step 6204 (32 ms): -219.51.
Step 6242 (32 ms): -193.28.
Step 6279 (32 ms): -211.62.
Step 6317 (33 ms): -204.25.
Step 6354 (32 ms): -218.3.
Step 6392 (15 ms): -299.89.

Epoch 17 (12.2 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -209.36, ENRE: -204.13, KL: 5.2234.
    Saving model parameters.
    Model parameters saved (100 ms).

Step 6430 (32 ms): -216.27.
Step 6467 (32 ms): -199.99.
Step 6505 (32 ms): -206.92.
Step 6542 (32 ms): -196.
Step 6580 (32 ms): -201.75.
Step 6618 (33 ms): -213.32.
Step 6655 (33 ms): -204.11.
Step 6693 (33 ms): -223.37.
Step 6730 (32 ms): -217.79.
Step 6768 (15 ms): -181.67.

Epoch 18 (12.1 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -208.52, ENRE: -203.18, KL: 5.3454.
    Saving model parameters.
    Model parameters saved (130 ms).

Step 6806 (32 ms): -204.63.
Step 6843 (33 ms): -218.49.
Step 6881 (33 ms): -203.23.
Step 6918 (33 ms): -205.63.
Step 6956 (33 ms): -216.12.
Step 6994 (32 ms): -203.61.
Step 7031 (32 ms): -205.98.
Step 7069 (32 ms): -235.95.
Step 7106 (33 ms): -219.01.
Step 7144 (15 ms): -223.6.

Epoch 19 (12.2 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -208.16, ENRE: -202.95, KL: 5.2066.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 7182 (32 ms): -197.19.
Step 7219 (32 ms): -216.22.
Step 7257 (32 ms): -208.42.
Step 7294 (32 ms): -200.38.
Step 7332 (33 ms): -212.42.
Step 7370 (32 ms): -190.09.
Step 7407 (32 ms): -211.97.
Step 7445 (32 ms): -205.81.
Step 7482 (32 ms): -213.94.
Step 7520 (15 ms): -198.31.

Epoch 20 (12.1 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -207.55, ENRE: -202.31, KL: 5.2365.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 7558 (32 ms): -192.55.
Step 7595 (32 ms): -210.24.
Step 7633 (32 ms): -204.51.
Step 7670 (32 ms): -203.59.
Step 7708 (32 ms): -211.04.
Step 7746 (32 ms): -203.15.
Step 7783 (32 ms): -201.88.
Step 7821 (32 ms): -212.37.
Step 7858 (32 ms): -199.42.
Step 7896 (15 ms): -200.98.

Epoch 21 (12.1 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -206.96, ENRE: -201.75, KL: 5.2143.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 7934 (32 ms): -194.69.
Step 7971 (32 ms): -199.34.
Step 8009 (32 ms): -214.64.
Step 8046 (32 ms): -215.86.
Step 8084 (32 ms): -190.59.
Step 8122 (33 ms): -202.95.
Step 8159 (32 ms): -210.25.
Step 8197 (32 ms): -202.31.
Step 8234 (32 ms): -213.07.
Step 8272 (15 ms): -191.43.

Epoch 22 (12.1 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -205.82, ENRE: -200.56, KL: 5.2588.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 8310 (32 ms): -190.24.
Step 8347 (32 ms): -212.67.
Step 8385 (32 ms): -217.47.
Step 8422 (34 ms): -201.58.
Step 8460 (33 ms): -188.87.
Step 8498 (32 ms): -202.41.
Step 8535 (32 ms): -206.7.
Step 8573 (33 ms): -198.67.
Step 8610 (32 ms): -205.9.
Step 8648 (15 ms): -487.03.

Epoch 23 (12.2 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -205.99, ENRE: -200.77, KL: 5.2194.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 8686 (32 ms): -207.1.
Step 8723 (32 ms): -199.92.
Step 8761 (32 ms): -209.94.
Step 8798 (33 ms): -205.
Step 8836 (32 ms): -207.09.
Step 8874 (32 ms): -202.63.
Step 8911 (32 ms): -216.73.
Step 8949 (32 ms): -196.54.
Step 8986 (33 ms): -213.23.
Step 9024 (15 ms): -247.45.

Epoch 24 (12.2 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -205.11, ENRE: -199.84, KL: 5.2714.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 9062 (32 ms): -193.98.
Step 9099 (33 ms): -190.15.
Step 9137 (32 ms): -200.81.
Step 9174 (32 ms): -208.44.
Step 9212 (32 ms): -213.12.
Step 9250 (32 ms): -216.33.
Step 9287 (33 ms): -215.86.
Step 9325 (32 ms): -200.21.
Step 9362 (32 ms): -193.66.
Step 9400 (15 ms): -264.03.

Epoch 25 (12.2 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -205.29, ENRE: -200.12, KL: 5.1655.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 9438 (32 ms): -211.03.
Step 9475 (32 ms): -210.16.
Step 9513 (32 ms): -205.41.
Step 9550 (33 ms): -206.94.
Step 9588 (33 ms): -214.22.
Step 9626 (32 ms): -218.94.
Step 9663 (32 ms): -212.78.
Step 9701 (32 ms): -198.44.
Step 9738 (33 ms): -217.02.
Step 9776 (15 ms): -243.1.

Epoch 26 (12.1 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -204.61, ENRE: -199.41, KL: 5.1999.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 9814 (32 ms): -196.69.
Step 9851 (32 ms): -210.32.
Step 9889 (33 ms): -197.26.
Step 9926 (32 ms): -205.14.
Step 9964 (32 ms): -208.45.
Step 10002 (33 ms): -198.53.
Step 10039 (32 ms): -213.74.
Step 10077 (32 ms): -200.32.
Step 10114 (32 ms): -191.43.
Step 10152 (15 ms): -239.2.

Epoch 27 (12.1 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -204.39, ENRE: -199.18, KL: 5.2111.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 10190 (32 ms): -189.38.
Step 10227 (32 ms): -202.1.
Step 10265 (33 ms): -205.37.
Step 10302 (32 ms): -212.39.
Step 10340 (32 ms): -200.55.
Step 10378 (32 ms): -208.71.
Step 10415 (32 ms): -188.89.
Step 10453 (32 ms): -203.26.
Step 10490 (32 ms): -207.04.
Step 10528 (15 ms): -248.95.

Epoch 28 (12.1 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -204.04, ENRE: -198.94, KL: 5.1005.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 10566 (32 ms): -202.74.
Step 10603 (33 ms): -203.77.
Step 10641 (32 ms): -199.75.
Step 10678 (32 ms): -209.25.
Step 10716 (32 ms): -208.36.
Step 10754 (32 ms): -191.73.
Step 10791 (32 ms): -206.29.
Step 10829 (32 ms): -197.53.
Step 10866 (32 ms): -208.27.
Step 10904 (15 ms): -191.93.

Epoch 29 (12.1 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -204.13, ENRE: -198.93, KL: 5.1984.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 10942 (33 ms): -202.98.
Step 10979 (32 ms): -210.44.
Step 11017 (32 ms): -220.63.
Step 11054 (33 ms): -203.69.
Step 11092 (32 ms): -197.67.
Step 11130 (32 ms): -211.43.
Step 11167 (32 ms): -216.21.
Step 11205 (32 ms): -195.98.
Step 11242 (33 ms): -199.75.
Step 11280 (15 ms): -221.35.

Epoch 30 (12.2 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -203.61, ENRE: -198.38, KL: 5.2341.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 11318 (32 ms): -206.6.
Step 11355 (32 ms): -201.04.
Step 11393 (32 ms): -208.41.
Step 11430 (32 ms): -188.93.
Step 11468 (33 ms): -198.01.
Step 11506 (32 ms): -199.01.
Step 11543 (32 ms): -220.77.
Step 11581 (32 ms): -194.07.
Step 11618 (32 ms): -196.86.
Step 11656 (15 ms): -209.17.

Epoch 31 (12.1 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -203.46, ENRE: -198.29, KL: 5.1693.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 11694 (33 ms): -218.53.
Step 11731 (33 ms): -203.51.
Step 11769 (32 ms): -195.36.
Step 11806 (32 ms): -202.97.
Step 11844 (32 ms): -193.21.
Step 11882 (33 ms): -194.23.
Step 11919 (32 ms): -202.49.
Step 11957 (32 ms): -199.56.
Step 11994 (34 ms): -216.44.
Step 12032 (15 ms): -208.88.

Epoch 32 (12.2 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -203.35, ENRE: -198.11, KL: 5.232.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 12070 (32 ms): -198.72.
Step 12107 (32 ms): -190.22.
Step 12145 (32 ms): -194.86.
Step 12182 (33 ms): -208.26.
Step 12220 (32 ms): -195.43.
Step 12258 (32 ms): -202.12.
Step 12295 (32 ms): -198.17.
Step 12333 (32 ms): -192.74.
Step 12370 (32 ms): -207.93.
Step 12408 (15 ms): -189.84.

Epoch 33 (12.1 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -203.2, ENRE: -198, KL: 5.1991.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 12446 (33 ms): -201.48.
Step 12483 (32 ms): -202.32.
Step 12521 (32 ms): -210.44.
Step 12558 (32 ms): -200.26.
Step 12596 (33 ms): -199.22.
Step 12634 (32 ms): -200.03.
Step 12671 (33 ms): -197.54.
Step 12709 (32 ms): -217.59.
Step 12746 (32 ms): -201.82.
Step 12784 (15 ms): -208.11.

Epoch 34 (12.2 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -203.05, ENRE: -197.88, KL: 5.1629.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 12822 (32 ms): -203.32.
Step 12859 (32 ms): -194.21.
Step 12897 (33 ms): -212.48.
Step 12934 (32 ms): -212.97.
Step 12972 (32 ms): -194.48.
Step 13010 (32 ms): -203.06.
Step 13047 (31 ms): -213.27.
Step 13085 (32 ms): -196.78.
Step 13122 (32 ms): -201.94.
Step 13160 (15 ms): -282.93.

Epoch 35 (12.1 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -203.05, ENRE: -197.88, KL: 5.1679.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 13198 (33 ms): -203.65.
Step 13235 (32 ms): -199.52.
Step 13273 (33 ms): -201.75.
Step 13310 (33 ms): -200.15.
Step 13348 (32 ms): -199.28.
Step 13386 (32 ms): -204.71.
Step 13423 (32 ms): -190.82.
Step 13461 (32 ms): -193.77.
Step 13498 (32 ms): -212.76.
Step 13536 (15 ms): -210.28.

Epoch 36 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -202.74, ENRE: -197.6, KL: 5.1477.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 13574 (33 ms): -212.61.
Step 13611 (33 ms): -192.4.
Step 13649 (32 ms): -200.1.
Step 13686 (32 ms): -199.91.
Step 13724 (32 ms): -196.71.
Step 13762 (32 ms): -208.96.
Step 13799 (32 ms): -195.42.
Step 13837 (32 ms): -203.08.
Step 13874 (33 ms): -197.47.
Step 13912 (15 ms): -171.37.

Epoch 37 (12.1 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -202.22, ENRE: -197.08, KL: 5.1324.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 13950 (32 ms): -199.86.
Step 13987 (32 ms): -207.94.
Step 14025 (32 ms): -202.53.
Step 14062 (33 ms): -210.83.
Step 14100 (32 ms): -212.27.
Step 14138 (32 ms): -207.64.
Step 14175 (32 ms): -197.21.
Step 14213 (33 ms): -195.67.
Step 14250 (34 ms): -205.98.
Step 14288 (15 ms): -186.48.

Epoch 38 (12.2 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -202.05, ENRE: -196.73, KL: 5.3174.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 14326 (32 ms): -202.3.
Step 14363 (33 ms): -197.6.
Step 14401 (32 ms): -212.32.
Step 14438 (33 ms): -201.07.
Step 14476 (32 ms): -203.08.
Step 14514 (32 ms): -202.88.
Step 14551 (32 ms): -210.78.
Step 14589 (32 ms): -201.53.
Step 14626 (32 ms): -204.35.
Step 14664 (15 ms): -273.69.

Epoch 39 (12.1 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -201.7, ENRE: -196.44, KL: 5.2556.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 14702 (33 ms): -199.48.
Step 14739 (32 ms): -198.7.
Step 14777 (33 ms): -204.19.
Step 14814 (32 ms): -203.61.
Step 14852 (32 ms): -209.99.
Step 14890 (32 ms): -197.68.
Step 14927 (33 ms): -191.69.
Step 14965 (32 ms): -196.69.
Step 15002 (32 ms): -204.57.
Step 15040 (15 ms): -206.32.

Epoch 40 (12.2 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -201.65, ENRE: -196.45, KL: 5.2007.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 15078 (33 ms): -209.35.
Step 15115 (32 ms): -194.55.
Step 15153 (32 ms): -202.35.
Step 15190 (32 ms): -205.07.
Step 15228 (33 ms): -217.23.
Step 15266 (32 ms): -202.34.
Step 15303 (32 ms): -210.24.
Step 15341 (33 ms): -194.5.
Step 15378 (32 ms): -203.28.
Step 15416 (15 ms): -214.02.

Epoch 41 (12.1 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -201.89, ENRE: -196.68, KL: 5.2111.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 15454 (33 ms): -197.18.
Step 15491 (33 ms): -203.31.
Step 15529 (32 ms): -191.36.
Step 15566 (33 ms): -195.97.
Step 15604 (33 ms): -205.31.
Step 15642 (32 ms): -206.22.
Step 15679 (32 ms): -193.81.
Step 15717 (32 ms): -197.79.
Step 15754 (33 ms): -199.87.
Step 15792 (15 ms): -226.9.

Epoch 42 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -201.52, ENRE: -196.19, KL: 5.3277.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 15830 (33 ms): -211.55.
Step 15867 (32 ms): -195.48.
Step 15905 (32 ms): -201.67.
Step 15942 (32 ms): -196.
Step 15980 (32 ms): -195.12.
Step 16018 (32 ms): -210.97.
Step 16055 (32 ms): -205.81.
Step 16093 (33 ms): -205.78.
Step 16130 (32 ms): -192.61.
Step 16168 (15 ms): -185.75.

Epoch 43 (12.1 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -201.33, ENRE: -196.03, KL: 5.3058.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 16206 (32 ms): -192.34.
Step 16243 (33 ms): -196.02.
Step 16281 (32 ms): -202.36.
Step 16318 (32 ms): -194.81.
Step 16356 (32 ms): -202.46.
Step 16394 (32 ms): -191.8.
Step 16431 (32 ms): -194.69.
Step 16469 (32 ms): -198.49.
Step 16506 (32 ms): -203.13.
Step 16544 (15 ms): -242.8.

Epoch 44 (12.2 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -201.45, ENRE: -196.23, KL: 5.2206.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 16582 (32 ms): -194.85.
Step 16619 (32 ms): -180.95.
Step 16657 (32 ms): -206.4.
Step 16694 (32 ms): -193.22.
Step 16732 (34 ms): -201.81.
Step 16770 (32 ms): -197.9.
Step 16807 (32 ms): -194.15.
Step 16845 (32 ms): -201.87.
Step 16882 (32 ms): -193.39.
Step 16920 (15 ms): -246.06.

Epoch 45 (12.1 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -200.96, ENRE: -195.65, KL: 5.3059.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 16958 (32 ms): -197.41.
Step 16995 (32 ms): -206.96.
Step 17033 (32 ms): -199.61.
Step 17070 (32 ms): -203.46.
Step 17108 (32 ms): -199.27.
Step 17146 (33 ms): -208.94.
Step 17183 (32 ms): -203.62.
Step 17221 (32 ms): -219.25.
Step 17258 (34 ms): -194.74.
Step 17296 (15 ms): -186.88.

Epoch 46 (12.2 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -200.89, ENRE: -195.65, KL: 5.2375.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 17334 (33 ms): -207.02.
Step 17371 (32 ms): -201.42.
Step 17409 (32 ms): -202.9.
Step 17446 (32 ms): -197.58.
Step 17484 (32 ms): -189.82.
Step 17522 (32 ms): -192.04.
Step 17559 (32 ms): -188.93.
Step 17597 (32 ms): -204.04.
Step 17634 (32 ms): -190.5.
Step 17672 (15 ms): -219.78.

Epoch 47 (12 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -200.71, ENRE: -195.43, KL: 5.2833.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 17710 (32 ms): -205.58.
Step 17747 (32 ms): -202.68.
Step 17785 (32 ms): -203.17.
Step 17822 (32 ms): -196.76.
Step 17860 (33 ms): -212.54.
Step 17898 (32 ms): -198.62.
Step 17935 (33 ms): -204.14.
Step 17973 (32 ms): -211.69.
Step 18010 (32 ms): -202.59.
Step 18048 (15 ms): -177.48.

Epoch 48 (12.2 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -200.92, ENRE: -195.64, KL: 5.285.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 18086 (32 ms): -188.32.
Step 18123 (32 ms): -198.86.
Step 18161 (32 ms): -208.42.
Step 18198 (32 ms): -202.37.
Step 18236 (32 ms): -200.17.
Step 18274 (32 ms): -199.27.
Step 18311 (32 ms): -201.33.
Step 18349 (32 ms): -198.38.
Step 18386 (32 ms): -196.49.
Step 18424 (15 ms): -281.56.

Epoch 49 (12.1 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -200.83, ENRE: -195.57, KL: 5.263.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 18462 (32 ms): -213.37.
Step 18499 (33 ms): -189.15.
Step 18537 (32 ms): -204.92.
Step 18574 (32 ms): -185.89.
Step 18612 (32 ms): -201.57.
Step 18650 (32 ms): -205.67.
Step 18687 (33 ms): -197.95.
Step 18725 (32 ms): -205.04.
Step 18762 (32 ms): -193.2.
Step 18800 (15 ms): -226.2.

Epoch 50 (12.2 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -200.61, ENRE: -195.3, KL: 5.303.
    Saving model parameters.
    Model parameters saved (110 ms).

Model trained for 50 epochs (15m 10s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (13 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (896 ms).

Converting data set value array to sparse matrix.
Data set value array converted (308 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.84 s):  ELBO: -419.45, ENRE: -414.15, KL: 5.3019.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (656 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 0.9196386502818357
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 8
kl weight: 0.9196386502818357
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (49 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (3.92 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.67 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 8
    hidden sizes: 255, 199
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 0.9196386502818357
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 5 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 255)
    ENCODER/1/DENSE/biases:0             (255,)
    ENCODER/1/BATCH_NORM/beta:0          (255,)
    ENCODER/2/DENSE/weights:0            (255, 199)
    ENCODER/2/DENSE/biases:0             (199,)
    ENCODER/2/BATCH_NORM/beta:0          (199,)
    POSTERIOR/MU/DENSE/weights:0         (199, 8)
    POSTERIOR/MU/DENSE/biases:0          (8,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (199, 8)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (8,)
    DECODER/2/DENSE/weights:0            (8, 199)
    DECODER/2/DENSE/biases:0             (199,)
    DECODER/2/BATCH_NORM/beta:0          (199,)
    DECODER/1/DENSE/weights:0            (199, 255)
    DECODER/1/DENSE/biases:0             (255,)
    DECODER/1/BATCH_NORM/beta:0          (255,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (255, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (305 ms).

Training model for 50 epochs on original values.

Step 38 (31 ms): -1860.7.
Step 75 (31 ms): -1436.7.
Step 113 (30 ms): -1120.3.
Step 150 (30 ms): -872.69.
Step 188 (30 ms): -706.97.
Step 226 (30 ms): -605.92.
Step 263 (30 ms): -504.08.
Step 301 (30 ms): -453.76.
Step 338 (30 ms): -408.92.
Step 376 (15 ms): -512.52.

Epoch 1 (13.2 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (5.87 s): ELBO: -1536, ENRE: -1512.5, KL: 23.53.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 414 (30 ms): -361.48.
Step 451 (30 ms): -346.49.
Step 489 (30 ms): -341.74.
Step 526 (30 ms): -301.03.
Step 564 (29 ms): -330.22.
Step 602 (29 ms): -326.47.
Step 639 (29 ms): -289.31.
Step 677 (30 ms): -318.45.
Step 714 (30 ms): -296.16.
Step 752 (14 ms): -285.37.

Epoch 2 (11.2 s):
    Warm-up weight: 0.2
    Evaluating model.
    Full set (5.44 s): ELBO: -821.18, ENRE: -802.98, KL: 18.203.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 790 (30 ms): -261.68.
Step 827 (30 ms): -271.96.
Step 865 (30 ms): -258.25.
Step 902 (32 ms): -250.28.
Step 940 (30 ms): -239.9.
Step 978 (30 ms): -262.34.
Step 1015 (30 ms): -259.85.
Step 1053 (30 ms): -260.99.
Step 1090 (30 ms): -250.22.
Step 1128 (14 ms): -247.28.

Epoch 3 (11.3 s):
    Warm-up weight: 0.4
    Evaluating model.
    Full set (5.49 s): ELBO: -492.5, ENRE: -480.28, KL: 12.218.
    Saving model parameters.
    Model parameters saved (82 ms).

Step 1166 (30 ms): -248.4.
Step 1203 (30 ms): -235.2.
Step 1241 (30 ms): -235.21.
Step 1278 (30 ms): -240.21.
Step 1316 (30 ms): -237.23.
Step 1354 (30 ms): -238.66.
Step 1391 (30 ms): -230.96.
Step 1429 (30 ms): -224.25.
Step 1466 (30 ms): -243.48.
Step 1504 (13 ms): -210.82.

Epoch 4 (11.3 s):
    Warm-up weight: 0.6
    Evaluating model.
    Full set (5.42 s): ELBO: -346.55, ENRE: -337.04, KL: 9.5132.
    Saving model parameters.
    Model parameters saved (79 ms).

Step 1542 (31 ms): -221.01.
Step 1579 (30 ms): -224.31.
Step 1617 (30 ms): -241.3.
Step 1654 (30 ms): -223.26.
Step 1692 (30 ms): -227.98.
Step 1730 (30 ms): -219.85.
Step 1767 (30 ms): -223.2.
Step 1805 (30 ms): -234.91.
Step 1842 (31 ms): -226.85.
Step 1880 (14 ms): -268.44.

Epoch 5 (11.3 s):
    Warm-up weight: 0.8
    Evaluating model.
    Full set (5.49 s): ELBO: -278.39, ENRE: -269.3, KL: 9.0857.
    Saving model parameters.
    Model parameters saved (80 ms).

Step 1918 (30 ms): -210.09.
Step 1955 (30 ms): -213.51.
Step 1993 (30 ms): -214.72.
Step 2030 (30 ms): -231.7.
Step 2068 (29 ms): -210.55.
Step 2106 (32 ms): -228.22.
Step 2143 (30 ms): -215.58.
Step 2181 (30 ms): -208.41.
Step 2218 (30 ms): -229.54.
Step 2256 (14 ms): -196.24.

Epoch 6 (11.3 s):
    Evaluating model.
    Full set (5.4 s): ELBO: -243.29, ENRE: -234.85, KL: 8.4353.
    Saving model parameters.
    Model parameters saved (79 ms).

Step 2294 (30 ms): -215.56.
Step 2331 (30 ms): -214.76.
Step 2369 (30 ms): -210.18.
Step 2406 (30 ms): -210.37.
Step 2444 (30 ms): -209.49.
Step 2482 (30 ms): -213.4.
Step 2519 (30 ms): -208.18.
Step 2557 (30 ms): -212.97.
Step 2594 (30 ms): -233.7.
Step 2632 (14 ms): -239.61.

Epoch 7 (11.3 s):
    Evaluating model.
    Full set (5.48 s): ELBO: -228.01, ENRE: -219.73, KL: 8.2865.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 2670 (30 ms): -229.91.
Step 2707 (30 ms): -218.65.
Step 2745 (30 ms): -204.15.
Step 2782 (30 ms): -208.23.
Step 2820 (31 ms): -197.62.
Step 2858 (30 ms): -223.44.
Step 2895 (29 ms): -215.63.
Step 2933 (30 ms): -198.12.
Step 2970 (30 ms): -192.62.
Step 3008 (13 ms): -265.16.

Epoch 8 (11.3 s):
    Evaluating model.
    Full set (5.38 s): ELBO: -219.83, ENRE: -211.36, KL: 8.467.
    Saving model parameters.
    Model parameters saved (78 ms).

Step 3046 (29 ms): -206.64.
Step 3083 (30 ms): -221.47.
Step 3121 (30 ms): -214.02.
Step 3158 (30 ms): -196.35.
Step 3196 (30 ms): -208.14.
Step 3234 (31 ms): -226.77.
Step 3271 (30 ms): -215.57.
Step 3309 (30 ms): -215.59.
Step 3346 (30 ms): -233.65.
Step 3384 (15 ms): -200.03.

Epoch 9 (11.3 s):
    Evaluating model.
    Full set (5.5 s): ELBO: -214.58, ENRE: -206.1, KL: 8.4759.
    Saving model parameters.
    Model parameters saved (80 ms).

Step 3422 (30 ms): -213.32.
Step 3459 (30 ms): -225.96.
Step 3497 (31 ms): -209.71.
Step 3534 (30 ms): -203.39.
Step 3572 (30 ms): -205.99.
Step 3610 (30 ms): -206.86.
Step 3647 (31 ms): -216.06.
Step 3685 (30 ms): -213.07.
Step 3722 (30 ms): -217.75.
Step 3760 (14 ms): -255.83.

Epoch 10 (11.3 s):
    Evaluating model.
    Full set (5.38 s): ELBO: -210.6, ENRE: -201.69, KL: 8.9084.
    Saving model parameters.
    Model parameters saved (85 ms).

Step 3798 (30 ms): -192.9.
Step 3835 (30 ms): -214.05.
Step 3873 (29 ms): -207.5.
Step 3910 (30 ms): -200.76.
Step 3948 (30 ms): -219.1.
Step 3986 (30 ms): -210.28.
Step 4023 (31 ms): -202.76.
Step 4061 (31 ms): -201.54.
Step 4098 (30 ms): -211.8.
Step 4136 (14 ms): -209.12.

Epoch 11 (11.3 s):
    Evaluating model.
    Full set (5.49 s): ELBO: -208.27, ENRE: -199.38, KL: 8.8874.
    Saving model parameters.
    Model parameters saved (81 ms).

Step 4174 (30 ms): -205.97.
Step 4211 (30 ms): -202.47.
Step 4249 (30 ms): -209.27.
Step 4286 (30 ms): -215.03.
Step 4324 (31 ms): -209.52.
Step 4362 (30 ms): -200.67.
Step 4399 (30 ms): -213.01.
Step 4437 (30 ms): -203.07.
Step 4474 (30 ms): -202.5.
Step 4512 (14 ms): -210.28.

Epoch 12 (11.4 s):
    Evaluating model.
    Full set (5.41 s): ELBO: -207.02, ENRE: -198.18, KL: 8.8361.
    Saving model parameters.
    Model parameters saved (81 ms).

Step 4550 (30 ms): -206.17.
Step 4587 (30 ms): -191.95.
Step 4625 (30 ms): -205.99.
Step 4662 (30 ms): -208.98.
Step 4700 (30 ms): -207.67.
Step 4738 (31 ms): -215.99.
Step 4775 (31 ms): -212.78.
Step 4813 (30 ms): -194.98.
Step 4850 (30 ms): -204.41.
Step 4888 (14 ms): -239.89.

Epoch 13 (11.3 s):
    Evaluating model.
    Full set (5.49 s): ELBO: -206.21, ENRE: -197.35, KL: 8.8545.
    Saving model parameters.
    Model parameters saved (79 ms).

Step 4926 (31 ms): -214.59.
Step 4963 (30 ms): -202.19.
Step 5001 (31 ms): -214.43.
Step 5038 (30 ms): -207.84.
Step 5076 (30 ms): -195.12.
Step 5114 (30 ms): -210.06.
Step 5151 (30 ms): -205.3.
Step 5189 (30 ms): -210.02.
Step 5226 (30 ms): -212.6.
Step 5264 (14 ms): -184.82.

Epoch 14 (11.3 s):
    Evaluating model.
    Full set (5.38 s): ELBO: -205.53, ENRE: -196.42, KL: 9.1043.
    Saving model parameters.
    Model parameters saved (77 ms).

Step 5302 (30 ms): -214.27.
Step 5339 (30 ms): -187.91.
Step 5377 (30 ms): -199.04.
Step 5414 (30 ms): -212.39.
Step 5452 (30 ms): -205.18.
Step 5490 (30 ms): -206.94.
Step 5527 (30 ms): -202.86.
Step 5565 (32 ms): -201.71.
Step 5602 (30 ms): -199.85.
Step 5640 (14 ms): -249.4.

Epoch 15 (11.3 s):
    Evaluating model.
    Full set (5.49 s): ELBO: -204.78, ENRE: -195.62, KL: 9.1589.
    Saving model parameters.
    Model parameters saved (80 ms).

Step 5678 (31 ms): -208.96.
Step 5715 (30 ms): -206.83.
Step 5753 (30 ms): -206.39.
Step 5790 (30 ms): -195.71.
Step 5828 (30 ms): -202.46.
Step 5866 (30 ms): -196.57.
Step 5903 (30 ms): -211.11.
Step 5941 (30 ms): -217.19.
Step 5978 (30 ms): -207.58.
Step 6016 (14 ms): -191.2.

Epoch 16 (11.4 s):
    Evaluating model.
    Full set (5.43 s): ELBO: -204.53, ENRE: -195.26, KL: 9.2661.
    Saving model parameters.
    Model parameters saved (78 ms).

Step 6054 (30 ms): -211.28.
Step 6091 (30 ms): -198.85.
Step 6129 (30 ms): -201.9.
Step 6166 (30 ms): -209.
Step 6204 (30 ms): -204.49.
Step 6242 (30 ms): -200.06.
Step 6279 (30 ms): -205.4.
Step 6317 (30 ms): -212.3.
Step 6354 (30 ms): -211.82.
Step 6392 (14 ms): -219.41.

Epoch 17 (11.2 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -203.67, ENRE: -194.46, KL: 9.2175.
    Saving model parameters.
    Model parameters saved (82 ms).

Step 6430 (30 ms): -222.12.
Step 6467 (30 ms): -196.38.
Step 6505 (30 ms): -207.81.
Step 6542 (30 ms): -202.65.
Step 6580 (30 ms): -203.81.
Step 6618 (30 ms): -195.25.
Step 6655 (30 ms): -199.01.
Step 6693 (30 ms): -205.64.
Step 6730 (30 ms): -194.98.
Step 6768 (14 ms): -232.07.

Epoch 18 (11.3 s):
    Evaluating model.
    Full set (5.43 s): ELBO: -203.18, ENRE: -194.12, KL: 9.0591.
    Saving model parameters.
    Model parameters saved (82 ms).

Step 6806 (30 ms): -203.31.
Step 6843 (30 ms): -208.41.
Step 6881 (29 ms): -193.15.
Step 6918 (30 ms): -207.96.
Step 6956 (29 ms): -203.08.
Step 6994 (30 ms): -200.19.
Step 7031 (30 ms): -205.38.
Step 7069 (30 ms): -214.1.
Step 7106 (30 ms): -210.87.
Step 7144 (14 ms): -179.87.

Epoch 19 (11.3 s):
    Evaluating model.
    Full set (5.5 s): ELBO: -203.21, ENRE: -194.17, KL: 9.0404.
    Saving model parameters.
    Model parameters saved (83 ms).

Step 7182 (31 ms): -205.97.
Step 7219 (30 ms): -203.34.
Step 7257 (30 ms): -195.19.
Step 7294 (30 ms): -201.56.
Step 7332 (31 ms): -202.89.
Step 7370 (30 ms): -213.17.
Step 7407 (30 ms): -201.92.
Step 7445 (31 ms): -202.26.
Step 7482 (30 ms): -210.59.
Step 7520 (14 ms): -375.17.

Epoch 20 (11.4 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -202.81, ENRE: -193.39, KL: 9.4161.
    Saving model parameters.
    Model parameters saved (77 ms).

Step 7558 (30 ms): -201.99.
Step 7595 (30 ms): -207.54.
Step 7633 (30 ms): -202.22.
Step 7670 (30 ms): -202.21.
Step 7708 (30 ms): -197.73.
Step 7746 (31 ms): -202.77.
Step 7783 (30 ms): -195.92.
Step 7821 (30 ms): -203.6.
Step 7858 (29 ms): -196.34.
Step 7896 (14 ms): -236.61.

Epoch 21 (11.2 s):
    Evaluating model.
    Full set (5.48 s): ELBO: -202.36, ENRE: -193.25, KL: 9.1126.
    Saving model parameters.
    Model parameters saved (80 ms).

Step 7934 (31 ms): -195.38.
Step 7971 (30 ms): -205.54.
Step 8009 (31 ms): -199.
Step 8046 (30 ms): -205.39.
Step 8084 (30 ms): -204.55.
Step 8122 (30 ms): -218.55.
Step 8159 (30 ms): -209.79.
Step 8197 (30 ms): -197.65.
Step 8234 (30 ms): -215.43.
Step 8272 (14 ms): -428.19.

Epoch 22 (11.4 s):
    Evaluating model.
    Full set (5.51 s): ELBO: -202.21, ENRE: -192.98, KL: 9.2386.
    Saving model parameters.
    Model parameters saved (82 ms).

Step 8310 (30 ms): -202.57.
Step 8347 (30 ms): -208.85.
Step 8385 (31 ms): -196.51.
Step 8422 (29 ms): -209.39.
Step 8460 (29 ms): -201.49.
Step 8498 (30 ms): -201.23.
Step 8535 (30 ms): -206.09.
Step 8573 (29 ms): -196.57.
Step 8610 (29 ms): -198.5.
Step 8648 (14 ms): -233.26.

Epoch 23 (11.2 s):
    Evaluating model.
    Full set (5.49 s): ELBO: -201.97, ENRE: -192.87, KL: 9.0973.
    Saving model parameters.
    Model parameters saved (85 ms).

Step 8686 (31 ms): -199.38.
Step 8723 (30 ms): -200.6.
Step 8761 (30 ms): -203.09.
Step 8798 (30 ms): -201.22.
Step 8836 (30 ms): -200.15.
Step 8874 (30 ms): -189.16.
Step 8911 (30 ms): -198.64.
Step 8949 (31 ms): -183.26.
Step 8986 (30 ms): -189.72.
Step 9024 (14 ms): -163.41.

Epoch 24 (11.3 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -201.57, ENRE: -192.56, KL: 9.0081.
    Saving model parameters.
    Model parameters saved (84 ms).

Step 9062 (31 ms): -200.46.
Step 9099 (29 ms): -198.55.
Step 9137 (30 ms): -205.56.
Step 9174 (30 ms): -202.38.
Step 9212 (30 ms): -199.68.
Step 9250 (30 ms): -191.25.
Step 9287 (30 ms): -207.72.
Step 9325 (30 ms): -202.41.
Step 9362 (30 ms): -195.66.
Step 9400 (14 ms): -208.93.

Epoch 25 (11.2 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -201.38, ENRE: -192.21, KL: 9.1628.
    Saving model parameters.
    Model parameters saved (81 ms).

Step 9438 (31 ms): -200.92.
Step 9475 (30 ms): -200.82.
Step 9513 (30 ms): -198.94.
Step 9550 (31 ms): -200.92.
Step 9588 (30 ms): -192.71.
Step 9626 (31 ms): -196.32.
Step 9663 (30 ms): -208.14.
Step 9701 (30 ms): -208.1.
Step 9738 (30 ms): -194.65.
Step 9776 (14 ms): -206.35.

Epoch 26 (11.4 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -201.46, ENRE: -192.37, KL: 9.0866.
    Saving model parameters.
    Model parameters saved (80 ms).

Step 9814 (30 ms): -215.38.
Step 9851 (30 ms): -195.42.
Step 9889 (32 ms): -196.4.
Step 9926 (30 ms): -208.39.
Step 9964 (30 ms): -189.72.
Step 10002 (32 ms): -193.95.
Step 10039 (30 ms): -197.12.
Step 10077 (30 ms): -203.16.
Step 10114 (30 ms): -214.77.
Step 10152 (13 ms): -258.4.

Epoch 27 (11.3 s):
    Evaluating model.
    Full set (5.4 s): ELBO: -201.22, ENRE: -191.81, KL: 9.4024.
    Saving model parameters.
    Model parameters saved (80 ms).

Step 10190 (30 ms): -217.37.
Step 10227 (30 ms): -210.64.
Step 10265 (30 ms): -211.18.
Step 10302 (30 ms): -202.12.
Step 10340 (29 ms): -194.25.
Step 10378 (30 ms): -195.29.
Step 10415 (30 ms): -202.87.
Step 10453 (31 ms): -197.98.
Step 10490 (30 ms): -197.6.
Step 10528 (14 ms): -251.44.

Epoch 28 (11.3 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -200.99, ENRE: -191.83, KL: 9.1617.
    Saving model parameters.
    Model parameters saved (78 ms).

Step 10566 (32 ms): -198.26.
Step 10603 (30 ms): -207.17.
Step 10641 (30 ms): -220.2.
Step 10678 (30 ms): -202.1.
Step 10716 (30 ms): -209.1.
Step 10754 (29 ms): -208.68.
Step 10791 (30 ms): -209.04.
Step 10829 (29 ms): -201.61.
Step 10866 (29 ms): -198.77.
Step 10904 (14 ms): -203.89.

Epoch 29 (11.3 s):
    Evaluating model.
    Full set (5.4 s): ELBO: -200.94, ENRE: -191.68, KL: 9.266.
    Saving model parameters.
    Model parameters saved (79 ms).

Step 10942 (30 ms): -190.64.
Step 10979 (31 ms): -193.39.
Step 11017 (31 ms): -217.81.
Step 11054 (30 ms): -200.01.
Step 11092 (30 ms): -218.53.
Step 11130 (30 ms): -218.23.
Step 11167 (30 ms): -205.35.
Step 11205 (30 ms): -206.25.
Step 11242 (30 ms): -209.82.
Step 11280 (14 ms): -251.45.

Epoch 30 (11.3 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -200.85, ENRE: -191.71, KL: 9.1433.
    Saving model parameters.
    Model parameters saved (85 ms).

Step 11318 (30 ms): -197.71.
Step 11355 (30 ms): -191.28.
Step 11393 (30 ms): -205.67.
Step 11430 (30 ms): -210.82.
Step 11468 (30 ms): -195.79.
Step 11506 (30 ms): -207.7.
Step 11543 (31 ms): -206.39.
Step 11581 (29 ms): -198.44.
Step 11618 (30 ms): -192.69.
Step 11656 (14 ms): -216.36.

Epoch 31 (11.3 s):
    Evaluating model.
    Full set (5.38 s): ELBO: -200.58, ENRE: -191.48, KL: 9.1035.
    Saving model parameters.
    Model parameters saved (81 ms).

Step 11694 (30 ms): -203.6.
Step 11731 (30 ms): -205.44.
Step 11769 (30 ms): -195.65.
Step 11806 (30 ms): -213.26.
Step 11844 (30 ms): -204.13.
Step 11882 (30 ms): -198.56.
Step 11919 (30 ms): -190.84.
Step 11957 (30 ms): -208.28.
Step 11994 (30 ms): -209.35.
Step 12032 (14 ms): -219.04.

Epoch 32 (11.3 s):
    Evaluating model.
    Full set (5.48 s): ELBO: -200.41, ENRE: -191.11, KL: 9.2998.
    Saving model parameters.
    Model parameters saved (81 ms).

Step 12070 (30 ms): -192.68.
Step 12107 (30 ms): -201.47.
Step 12145 (30 ms): -188.65.
Step 12182 (31 ms): -204.67.
Step 12220 (30 ms): -201.02.
Step 12258 (30 ms): -194.18.
Step 12295 (30 ms): -202.43.
Step 12333 (31 ms): -200.25.
Step 12370 (30 ms): -197.78.
Step 12408 (14 ms): -347.87.

Epoch 33 (11.4 s):
    Evaluating model.
    Full set (5.4 s): ELBO: -200.53, ENRE: -191.24, KL: 9.2921.
    Saving model parameters.
    Model parameters saved (79 ms).

Step 12446 (30 ms): -197.47.
Step 12483 (30 ms): -198.78.
Step 12521 (30 ms): -205.09.
Step 12558 (30 ms): -208.62.
Step 12596 (30 ms): -202.85.
Step 12634 (31 ms): -218.92.
Step 12671 (31 ms): -202.03.
Step 12709 (30 ms): -190.77.
Step 12746 (30 ms): -197.17.
Step 12784 (14 ms): -252.03.

Epoch 34 (11.3 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -200.46, ENRE: -191.35, KL: 9.1129.
    Saving model parameters.
    Model parameters saved (79 ms).

Step 12822 (30 ms): -201.94.
Step 12859 (29 ms): -211.05.
Step 12897 (30 ms): -192.46.
Step 12934 (30 ms): -194.42.
Step 12972 (30 ms): -191.25.
Step 13010 (30 ms): -201.89.
Step 13047 (30 ms): -212.12.
Step 13085 (30 ms): -195.53.
Step 13122 (30 ms): -204.
Step 13160 (14 ms): -174.57.

Epoch 35 (11.3 s):
    Evaluating model.
    Full set (5.37 s): ELBO: -200.39, ENRE: -191.05, KL: 9.3413.
    Saving model parameters.
    Model parameters saved (77 ms).

Step 13198 (30 ms): -203.45.
Step 13235 (29 ms): -195.05.
Step 13273 (30 ms): -200.27.
Step 13310 (30 ms): -192.07.
Step 13348 (30 ms): -195.75.
Step 13386 (30 ms): -201.27.
Step 13423 (30 ms): -207.49.
Step 13461 (30 ms): -198.49.
Step 13498 (31 ms): -198.38.
Step 13536 (14 ms): -157.7.

Epoch 36 (11.2 s):
    Evaluating model.
    Full set (5.44 s): ELBO: -200.11, ENRE: -190.98, KL: 9.1327.
    Saving model parameters.
    Model parameters saved (84 ms).

Step 13574 (30 ms): -200.77.
Step 13611 (30 ms): -196.26.
Step 13649 (30 ms): -200.36.
Step 13686 (30 ms): -198.4.
Step 13724 (30 ms): -212.1.
Step 13762 (30 ms): -204.35.
Step 13799 (30 ms): -211.17.
Step 13837 (30 ms): -198.15.
Step 13874 (30 ms): -203.44.
Step 13912 (14 ms): -194.79.

Epoch 37 (11.3 s):
    Evaluating model.
    Full set (5.43 s): ELBO: -200.04, ENRE: -190.82, KL: 9.2201.
    Saving model parameters.
    Model parameters saved (84 ms).

Step 13950 (30 ms): -203.36.
Step 13987 (30 ms): -199.79.
Step 14025 (30 ms): -201.96.
Step 14062 (30 ms): -189.82.
Step 14100 (30 ms): -210.95.
Step 14138 (30 ms): -206.59.
Step 14175 (29 ms): -195.81.
Step 14213 (30 ms): -215.73.
Step 14250 (30 ms): -196.03.
Step 14288 (14 ms): -248.09.

Epoch 38 (11.2 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -200, ENRE: -190.71, KL: 9.2886.
    Saving model parameters.
    Model parameters saved (81 ms).

Step 14326 (30 ms): -201.45.
Step 14363 (30 ms): -212.27.
Step 14401 (31 ms): -201.06.
Step 14438 (30 ms): -188.64.
Step 14476 (30 ms): -222.59.
Step 14514 (30 ms): -199.63.
Step 14551 (30 ms): -214.95.
Step 14589 (30 ms): -196.59.
Step 14626 (30 ms): -200.59.
Step 14664 (14 ms): -192.66.

Epoch 39 (11.3 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -199.82, ENRE: -190.5, KL: 9.3164.
    Saving model parameters.
    Model parameters saved (78 ms).

Step 14702 (30 ms): -186.
Step 14739 (29 ms): -203.46.
Step 14777 (30 ms): -194.78.
Step 14814 (31 ms): -194.39.
Step 14852 (29 ms): -193.38.
Step 14890 (29 ms): -210.81.
Step 14927 (30 ms): -204.31.
Step 14965 (30 ms): -199.9.
Step 15002 (30 ms): -196.18.
Step 15040 (14 ms): -247.85.

Epoch 40 (11.2 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -199.67, ENRE: -190.45, KL: 9.2203.
    Saving model parameters.
    Model parameters saved (81 ms).

Step 15078 (31 ms): -197.08.
Step 15115 (31 ms): -214.01.
Step 15153 (30 ms): -197.13.
Step 15190 (30 ms): -192.06.
Step 15228 (30 ms): -191.7.
Step 15266 (30 ms): -190.13.
Step 15303 (30 ms): -200.38.
Step 15341 (30 ms): -211.47.
Step 15378 (30 ms): -198.17.
Step 15416 (14 ms): -221.65.

Epoch 41 (11.4 s):
    Evaluating model.
    Full set (5.54 s): ELBO: -199.72, ENRE: -190.27, KL: 9.4436.
    Saving model parameters.
    Model parameters saved (78 ms).

Step 15454 (30 ms): -180.96.
Step 15491 (30 ms): -211.59.
Step 15529 (30 ms): -195.78.
Step 15566 (29 ms): -211.01.
Step 15604 (38 ms): -206.82.
Step 15642 (30 ms): -199.86.
Step 15679 (30 ms): -208.
Step 15717 (30 ms): -202.96.
Step 15754 (30 ms): -203.95.
Step 15792 (14 ms): -227.82.

Epoch 42 (11.3 s):
    Evaluating model.
    Full set (5.53 s): ELBO: -199.66, ENRE: -190.37, KL: 9.287.
    Saving model parameters.
    Model parameters saved (83 ms).

Step 15830 (30 ms): -199.46.
Step 15867 (30 ms): -206.65.
Step 15905 (30 ms): -202.51.
Step 15942 (30 ms): -193.12.
Step 15980 (32 ms): -195.64.
Step 16018 (30 ms): -200.3.
Step 16055 (30 ms): -192.46.
Step 16093 (30 ms): -196.08.
Step 16130 (30 ms): -203.92.
Step 16168 (14 ms): -206.84.

Epoch 43 (11.4 s):
    Evaluating model.
    Full set (5.51 s): ELBO: -199.51, ENRE: -190.16, KL: 9.3496.
    Saving model parameters.
    Model parameters saved (82 ms).

Step 16206 (31 ms): -203.55.
Step 16243 (30 ms): -199.6.
Step 16281 (30 ms): -190.81.
Step 16318 (30 ms): -195.72.
Step 16356 (30 ms): -188.02.
Step 16394 (29 ms): -198.31.
Step 16431 (30 ms): -210.17.
Step 16469 (30 ms): -203.36.
Step 16506 (31 ms): -195.85.
Step 16544 (13 ms): -205.58.

Epoch 44 (11.3 s):
    Evaluating model.
    Full set (5.51 s): ELBO: -199.44, ENRE: -190.15, KL: 9.2919.
    Saving model parameters.
    Model parameters saved (84 ms).

Step 16582 (30 ms): -206.56.
Step 16619 (31 ms): -203.26.
Step 16657 (31 ms): -211.68.
Step 16694 (30 ms): -204.89.
Step 16732 (30 ms): -198.93.
Step 16770 (30 ms): -196.93.
Step 16807 (30 ms): -197.2.
Step 16845 (30 ms): -203.45.
Step 16882 (30 ms): -191.64.
Step 16920 (14 ms): -263.78.

Epoch 45 (11.4 s):
    Evaluating model.
    Full set (5.53 s): ELBO: -199.45, ENRE: -190.12, KL: 9.3294.
    Saving model parameters.
    Model parameters saved (85 ms).

Step 16958 (30 ms): -201.01.
Step 16995 (30 ms): -198.24.
Step 17033 (30 ms): -191.09.
Step 17070 (30 ms): -200.31.
Step 17108 (30 ms): -196.3.
Step 17146 (30 ms): -201.55.
Step 17183 (30 ms): -201.45.
Step 17221 (30 ms): -201.14.
Step 17258 (29 ms): -202.51.
Step 17296 (14 ms): -189.96.

Epoch 46 (11.3 s):
    Evaluating model.
    Full set (5.48 s): ELBO: -199.32, ENRE: -190.12, KL: 9.2017.
    Saving model parameters.
    Model parameters saved (79 ms).

Step 17334 (31 ms): -190.43.
Step 17371 (31 ms): -197.86.
Step 17409 (30 ms): -198.13.
Step 17446 (30 ms): -199.13.
Step 17484 (30 ms): -191.86.
Step 17522 (32 ms): -202.
Step 17559 (30 ms): -184.74.
Step 17597 (30 ms): -196.86.
Step 17634 (30 ms): -197.64.
Step 17672 (14 ms): -234.95.

Epoch 47 (11.4 s):
    Evaluating model.
    Full set (5.54 s): ELBO: -199.25, ENRE: -189.99, KL: 9.261.
    Saving model parameters.
    Model parameters saved (82 ms).

Step 17710 (31 ms): -198.55.
Step 17747 (31 ms): -187.86.
Step 17785 (30 ms): -186.16.
Step 17822 (30 ms): -193.69.
Step 17860 (30 ms): -216.
Step 17898 (30 ms): -186.64.
Step 17935 (30 ms): -206.75.
Step 17973 (30 ms): -207.09.
Step 18010 (30 ms): -215.31.
Step 18048 (14 ms): -219.06.

Epoch 48 (11.3 s):
    Evaluating model.
    Full set (5.43 s): ELBO: -199.25, ENRE: -189.97, KL: 9.2821.
    Saving model parameters.
    Model parameters saved (81 ms).

Step 18086 (30 ms): -205.08.
Step 18123 (30 ms): -197.58.
Step 18161 (32 ms): -194.01.
Step 18198 (30 ms): -201.46.
Step 18236 (30 ms): -216.7.
Step 18274 (30 ms): -192.13.
Step 18311 (30 ms): -195.28.
Step 18349 (30 ms): -190.15.
Step 18386 (30 ms): -190.93.
Step 18424 (14 ms): -197.09.

Epoch 49 (11.4 s):
    Evaluating model.
    Full set (5.52 s): ELBO: -199.22, ENRE: -189.94, KL: 9.285.
    Saving model parameters.
    Model parameters saved (83 ms).

Step 18462 (30 ms): -210.36.
Step 18499 (30 ms): -209.98.
Step 18537 (30 ms): -191.52.
Step 18574 (30 ms): -197.24.
Step 18612 (30 ms): -202.7.
Step 18650 (30 ms): -201.22.
Step 18687 (30 ms): -198.28.
Step 18725 (29 ms): -193.46.
Step 18762 (30 ms): -200.81.
Step 18800 (13 ms): -228.54.

Epoch 50 (11.3 s):
    Evaluating model.
    Full set (5.42 s): ELBO: -199.19, ENRE: -189.99, KL: 9.2024.
    Saving model parameters.
    Model parameters saved (78 ms).

Model trained for 50 epochs (14m 7s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (13 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (864 ms).

Converting data set value array to sparse matrix.
Data set value array converted (276 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.6 s):  ELBO: -429.66, ENRE: -420.48, KL: 9.1831.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (518 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.1836778436930602
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 55
kl weight: 1.1836778436930602
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (49 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.69 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 55
    hidden sizes: 293, 57, 221, 146, 61
    latent distribution: gaussian
    reconstruction distribution: gaussian
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.1836778436930602
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 4 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 293)
    ENCODER/1/DENSE/biases:0             (293,)
    ENCODER/1/BATCH_NORM/beta:0          (293,)
    ENCODER/2/DENSE/weights:0            (293, 57)
    ENCODER/2/DENSE/biases:0             (57,)
    ENCODER/2/BATCH_NORM/beta:0          (57,)
    ENCODER/3/DENSE/weights:0            (57, 221)
    ENCODER/3/DENSE/biases:0             (221,)
    ENCODER/3/BATCH_NORM/beta:0          (221,)
    ENCODER/4/DENSE/weights:0            (221, 146)
    ENCODER/4/DENSE/biases:0             (146,)
    ENCODER/4/BATCH_NORM/beta:0          (146,)
    ENCODER/5/DENSE/weights:0            (146, 61)
    ENCODER/5/DENSE/biases:0             (61,)
    ENCODER/5/BATCH_NORM/beta:0          (61,)
    POSTERIOR/MU/DENSE/weights:0         (61, 55)
    POSTERIOR/MU/DENSE/biases:0          (55,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (61, 55)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (55,)
    DECODER/5/DENSE/weights:0            (55, 61)
    DECODER/5/DENSE/biases:0             (61,)
    DECODER/5/BATCH_NORM/beta:0          (61,)
    DECODER/4/DENSE/weights:0            (61, 146)
    DECODER/4/DENSE/biases:0             (146,)
    DECODER/4/BATCH_NORM/beta:0          (146,)
    DECODER/3/DENSE/weights:0            (146, 221)
    DECODER/3/DENSE/biases:0             (221,)
    DECODER/3/BATCH_NORM/beta:0          (221,)
    DECODER/2/DENSE/weights:0            (221, 57)
    DECODER/2/DENSE/biases:0             (57,)
    DECODER/2/BATCH_NORM/beta:0          (57,)
    DECODER/1/DENSE/weights:0            (57, 293)
    DECODER/1/DENSE/biases:0             (293,)
    DECODER/1/BATCH_NORM/beta:0          (293,)
    X_TILDE/MU/DENSE/weights:0           (293, 2000)
    X_TILDE/MU/DENSE/biases:0            (2000,)
    X_TILDE/LOG_SIGMA/DENSE/weights:0    (293, 2000)
    X_TILDE/LOG_SIGMA/DENSE/biases:0     (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (610 ms).

Training model for 50 epochs on original values.

Step 38 (43 ms): -3116.2.
Step 75 (43 ms): -1809.5.
Step 113 (43 ms): -1011.3.
Step 150 (41 ms): -656.28.
Step 188 (43 ms): -256.87.
Step 226 (42 ms): 167.95.
Step 263 (42 ms): 334.76.
Step 301 (42 ms): 589.25.
Step 338 (42 ms): 708.8.
Step 376 (23 ms): -321.76.

Epoch 1 (19.2 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (7.08 s): ELBO: -2640.8, ENRE: -2608.7, KL: 32.047.
    Saving model parameters.
    Model parameters saved (220 ms).

Step 414 (42 ms): 1358.4.
Step 451 (43 ms): 1538.8.
Step 489 (43 ms): 1507.2.
Step 526 (43 ms): 1670.4.
Step 564 (44 ms): 1898.2.
Step 602 (42 ms): 1061.8.
Step 639 (43 ms): 1093.1.
Step 677 (43 ms): 1999.3.
Step 714 (43 ms): 2152.3.
Step 752 (22 ms): 184.35.

Epoch 2 (16.1 s):
    Warm-up weight: 0.25
    Evaluating model.
    Full set (6.4 s): ELBO: -818.01, ENRE: -750.25, KL: 67.759.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 790 (42 ms): 2022.3.
Step 827 (42 ms): 2238.9.
Step 865 (43 ms): 2168.7.
Step 902 (42 ms): 2283.7.
Step 940 (42 ms): 2148.9.
Step 978 (43 ms): 2271.4.
Step 1015 (42 ms): 2020.
Step 1053 (42 ms): 2291.
Step 1090 (42 ms): 2187.2.
Step 1128 (20 ms): -375.91.

Epoch 3 (16 s):
    Warm-up weight: 0.5
    Evaluating model.
    Full set (6.42 s): ELBO: 965.92, ENRE: 1017, KL: 51.067.
    Saving model parameters.
    Model parameters saved (139 ms).

Step 1166 (42 ms): 2266.7.
Step 1203 (42 ms): 2313.
Step 1241 (45 ms): 2084.1.
Step 1278 (43 ms): 2481.7.
Step 1316 (42 ms): 2277.3.
Step 1354 (42 ms): 2392.3.
Step 1391 (43 ms): 2187.3.
Step 1429 (44 ms): 2196.1.
Step 1466 (42 ms): 2359.9.
Step 1504 (21 ms): 1546.9.

Epoch 4 (16 s):
    Warm-up weight: 0.75
    Evaluating model.
    Full set (6.33 s): ELBO: 2100.4, ENRE: 2135.7, KL: 35.294.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 1542 (43 ms): 2447.3.
Step 1579 (42 ms): 2490.9.
Step 1617 (43 ms): 2442.3.
Step 1654 (42 ms): 2481.8.
Step 1692 (43 ms): 2259.3.
Step 1730 (42 ms): 2480.3.
Step 1767 (43 ms): 2470.6.
Step 1805 (43 ms): 2296.5.
Step 1842 (42 ms): 2467.3.
Step 1880 (20 ms): 154.45.

Epoch 5 (16 s):
    Evaluating model.
    Full set (6.39 s): ELBO: 2167.1, ENRE: 2191.7, KL: 24.623.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 1918 (42 ms): 2402.5.
Step 1955 (42 ms): 2388.3.
Step 1993 (43 ms): 2395.7.
Step 2030 (42 ms): 2488.8.
Step 2068 (42 ms): 2487.9.
Step 2106 (42 ms): 2388.5.
Step 2143 (41 ms): 2379.9.
Step 2181 (42 ms): 2480.4.
Step 2218 (42 ms): 2447.2.
Step 2256 (20 ms): 1039.5.

Epoch 6 (15.9 s):
    Evaluating model.
    Full set (6.38 s): ELBO: 2142.3, ENRE: 2160.7, KL: 18.413.
    Saving model parameters.
    Model parameters saved (127 ms).

Step 2294 (43 ms): 2470.7.
Step 2331 (43 ms): 2369.2.
Step 2369 (44 ms): 2565.1.
Step 2406 (42 ms): 2431.2.
Step 2444 (43 ms): 2310.9.
Step 2482 (43 ms): 2465.3.
Step 2519 (42 ms): 2468.2.
Step 2557 (43 ms): 2566.1.
Step 2594 (43 ms): 2555.9.
Step 2632 (20 ms): 543.8.

Epoch 7 (16 s):
    Evaluating model.
    Full set (6.36 s): ELBO: 2131.4, ENRE: 2149.7, KL: 18.291.
    Saving model parameters.
    Model parameters saved (132 ms).

Step 2670 (41 ms): 2450.3.
Step 2707 (42 ms): 2541.
Step 2745 (43 ms): 2549.4.
Step 2782 (42 ms): 1827.5.
Step 2820 (42 ms): 2545.5.
Step 2858 (42 ms): 2413.1.
Step 2895 (43 ms): 2571.2.
Step 2933 (44 ms): 2490.8.
Step 2970 (42 ms): 2513.4.
Step 3008 (20 ms): 1704.1.

Epoch 8 (16 s):
    Evaluating model.
    Full set (6.39 s): ELBO: 2177.3, ENRE: 2196.7, KL: 19.463.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 3046 (43 ms): 2553.1.
Step 3083 (44 ms): 2566.4.
Step 3121 (42 ms): 2522.2.
Step 3158 (42 ms): 2448.3.
Step 3196 (43 ms): 2546.5.
Step 3234 (43 ms): 2488.9.
Step 3271 (43 ms): 2603.
Step 3309 (42 ms): 2560.6.
Step 3346 (42 ms): 2492.5.
Step 3384 (20 ms): 243.53.

Epoch 9 (16 s):
    Evaluating model.
    Full set (6.32 s): ELBO: 2199.1, ENRE: 2221.7, KL: 22.614.
    Saving model parameters.
    Model parameters saved (130 ms).

Step 3422 (42 ms): 2506.5.
Step 3459 (44 ms): 2217.9.
Step 3497 (43 ms): 2397.7.
Step 3534 (43 ms): 2631.9.
Step 3572 (43 ms): 2457.7.
Step 3610 (43 ms): 2576.
Step 3647 (43 ms): 2606.6.
Step 3685 (42 ms): 2336.3.
Step 3722 (43 ms): 2575.5.
Step 3760 (20 ms): -23.544.

Epoch 10 (16 s):
    Evaluating model.
    Full set (6.4 s): ELBO: 2134, ENRE: 2159.4, KL: 25.467.
    Saving model parameters.
    Model parameters saved (130 ms).

Step 3798 (43 ms): 2600.7.
Step 3835 (42 ms): 2475.
Step 3873 (42 ms): 2599.8.
Step 3910 (42 ms): 2489.7.
Step 3948 (42 ms): 2381.1.
Step 3986 (41 ms): 2440.3.
Step 4023 (42 ms): 2437.7.
Step 4061 (42 ms): 2473.2.
Step 4098 (42 ms): 2564.2.
Step 4136 (21 ms): 992.19.

Epoch 11 (15.9 s):
    Evaluating model.
    Full set (6.39 s): ELBO: 2139.5, ENRE: 2165.3, KL: 25.793.
    Saving model parameters.
    Model parameters saved (130 ms).

Step 4174 (42 ms): 2512.7.
Step 4211 (43 ms): 2542.7.
Step 4249 (43 ms): 2488.1.
Step 4286 (43 ms): 2533.9.
Step 4324 (42 ms): 2500.
Step 4362 (42 ms): 2608.1.
Step 4399 (42 ms): 2441.5.
Step 4437 (42 ms): 2621.6.
Step 4474 (42 ms): 2531.9.
Step 4512 (20 ms): 128.56.

Epoch 12 (16 s):
    Evaluating model.
    Full set (6.29 s): ELBO: 2173.8, ENRE: 2200.3, KL: 26.487.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 4550 (42 ms): 2630.5.
Step 4587 (43 ms): 2625.8.
Step 4625 (42 ms): 2462.8.
Step 4662 (43 ms): 2509.8.
Step 4700 (45 ms): 2418.7.
Step 4738 (42 ms): 2457.6.
Step 4775 (42 ms): 2505.7.
Step 4813 (43 ms): 2628.8.
Step 4850 (42 ms): 2550.8.
Step 4888 (20 ms): -562.11.

Epoch 13 (16 s):
    Evaluating model.
    Full set (6.4 s): ELBO: 2254.8, ENRE: 2279, KL: 24.134.
    Saving model parameters.
    Model parameters saved (133 ms).

Step 4926 (42 ms): 2557.3.
Step 4963 (42 ms): 2597.8.
Step 5001 (42 ms): 2555.8.
Step 5038 (42 ms): 2648.4.
Step 5076 (41 ms): 2183.5.
Step 5114 (42 ms): 2669.4.
Step 5151 (42 ms): 2347.3.
Step 5189 (42 ms): 2547.6.
Step 5226 (42 ms): 2632.3.
Step 5264 (20 ms): -885.83.

Epoch 14 (15.9 s):
    Evaluating model.
    Full set (6.39 s): ELBO: 2227.1, ENRE: 2254.6, KL: 27.529.
    Saving model parameters.
    Model parameters saved (131 ms).

Step 5302 (42 ms): 2634.3.
Step 5339 (44 ms): 2558.1.
Step 5377 (42 ms): 2452.
Step 5414 (42 ms): 2616.1.
Step 5452 (42 ms): 2648.1.
Step 5490 (43 ms): 2623.6.
Step 5527 (43 ms): 2575.7.
Step 5565 (43 ms): 2516.2.
Step 5602 (48 ms): 2550.2.
Step 5640 (21 ms): -1864.3.

Epoch 15 (16 s):
    Evaluating model.
    Full set (6.34 s): ELBO: 2324.2, ENRE: 2350, KL: 25.766.
    Saving model parameters.
    Model parameters saved (135 ms).

Step 5678 (42 ms): 2646.3.
Step 5715 (42 ms): 2548.3.
Step 5753 (42 ms): 2665.2.
Step 5790 (42 ms): 2494.6.
Step 5828 (43 ms): 2635.8.
Step 5866 (43 ms): 2674.9.
Step 5903 (42 ms): 2670.2.
Step 5941 (42 ms): 2578.7.
Step 5978 (42 ms): 2633.5.
Step 6016 (20 ms): -197.96.

Epoch 16 (16 s):
    Evaluating model.
    Full set (6.4 s): ELBO: 2341.4, ENRE: 2367.7, KL: 26.341.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 6054 (42 ms): 2629.4.
Step 6091 (43 ms): 2660.7.
Step 6129 (42 ms): 2711.4.
Step 6166 (42 ms): 2610.2.
Step 6204 (42 ms): 2708.6.
Step 6242 (41 ms): 2619.
Step 6279 (43 ms): 2665.3.
Step 6317 (43 ms): 2530.6.
Step 6354 (42 ms): 2647.8.
Step 6392 (20 ms): -977.15.

Epoch 17 (15.9 s):
    Evaluating model.
    Full set (6.37 s): ELBO: 2370.7, ENRE: 2397.4, KL: 26.722.
    Saving model parameters.
    Model parameters saved (131 ms).

Step 6430 (43 ms): 2671.8.
Step 6467 (43 ms): 2716.4.
Step 6505 (42 ms): 2602.1.
Step 6542 (43 ms): 2674.6.
Step 6580 (43 ms): 2617.3.
Step 6618 (43 ms): 2597.7.
Step 6655 (42 ms): 2575.8.
Step 6693 (43 ms): 2639.1.
Step 6730 (43 ms): 2657.5.
Step 6768 (20 ms): 515.6.

Epoch 18 (16 s):
    Evaluating model.
    Full set (6.38 s): ELBO: 2369.7, ENRE: 2397.2, KL: 27.546.
    Saving model parameters.
    Model parameters saved (127 ms).

Step 6806 (41 ms): 2594.5.
Step 6843 (42 ms): 2647.6.
Step 6881 (42 ms): 2686.1.
Step 6918 (42 ms): 2583.8.
Step 6956 (42 ms): 2634.8.
Step 6994 (43 ms): 2633.3.
Step 7031 (42 ms): 2657.5.
Step 7069 (43 ms): 2564.
Step 7106 (46 ms): 2637.9.
Step 7144 (21 ms): 640.43.

Epoch 19 (15.9 s):
    Evaluating model.
    Full set (6.39 s): ELBO: 2326.4, ENRE: 2355.8, KL: 29.389.
    Saving model parameters.
    Model parameters saved (134 ms).

Step 7182 (42 ms): 2648.
Step 7219 (43 ms): 2699.6.
Step 7257 (43 ms): 2599.9.
Step 7294 (42 ms): 2606.7.
Step 7332 (42 ms): 2626.4.
Step 7370 (42 ms): 2666.5.
Step 7407 (42 ms): 2578.3.
Step 7445 (42 ms): 2717.9.
Step 7482 (41 ms): 2726.8.
Step 7520 (21 ms): 1336.7.

Epoch 20 (15.9 s):
    Evaluating model.
    Full set (6.32 s): ELBO: 2342.3, ENRE: 2372, KL: 29.691.
    Saving model parameters.
    Model parameters saved (133 ms).

Step 7558 (43 ms): 2653.9.
Step 7595 (43 ms): 2647.7.
Step 7633 (43 ms): 2758.7.
Step 7670 (42 ms): 2618.6.
Step 7708 (42 ms): 2614.5.
Step 7746 (43 ms): 2728.5.
Step 7783 (43 ms): 2633.5.
Step 7821 (43 ms): 2529.8.
Step 7858 (42 ms): 2612.2.
Step 7896 (21 ms): 146.63.

Epoch 21 (16 s):
    Evaluating model.
    Full set (6.39 s): ELBO: 2440, ENRE: 2465.1, KL: 25.079.
    Saving model parameters.
    Model parameters saved (130 ms).

Step 7934 (42 ms): 2512.6.
Step 7971 (42 ms): 2593.8.
Step 8009 (42 ms): 2558.6.
Step 8046 (42 ms): 2573.2.
Step 8084 (42 ms): 2643.5.
Step 8122 (43 ms): 2699.4.
Step 8159 (42 ms): 2635.9.
Step 8197 (43 ms): 2601.4.
Step 8234 (42 ms): 2668.1.
Step 8272 (20 ms): -294.1.

Epoch 22 (15.9 s):
    Evaluating model.
    Full set (6.39 s): ELBO: 2446.2, ENRE: 2471.4, KL: 25.225.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 8310 (42 ms): 2698.3.
Step 8347 (43 ms): 2663.7.
Step 8385 (42 ms): 2712.9.
Step 8422 (43 ms): 2721.7.
Step 8460 (44 ms): 2619.3.
Step 8498 (42 ms): 2653.5.
Step 8535 (43 ms): 2760.4.
Step 8573 (43 ms): 2622.6.
Step 8610 (42 ms): 2659.9.
Step 8648 (20 ms): -1700.

Epoch 23 (16 s):
    Evaluating model.
    Full set (6.29 s): ELBO: 2536.5, ENRE: 2559.4, KL: 22.879.
    Saving model parameters.
    Model parameters saved (129 ms).

Step 8686 (41 ms): 2664.1.
Step 8723 (43 ms): 2608.
Step 8761 (42 ms): 2724.8.
Step 8798 (42 ms): 2693.3.
Step 8836 (42 ms): 2654.2.
Step 8874 (42 ms): 2733.2.
Step 8911 (42 ms): 2690.3.
Step 8949 (43 ms): 2655.
Step 8986 (42 ms): 2703.7.
Step 9024 (21 ms): 2039.2.

Epoch 24 (15.9 s):
    Evaluating model.
    Full set (6.38 s): ELBO: 2544.4, ENRE: 2566.1, KL: 21.712.
    Saving model parameters.
    Model parameters saved (130 ms).

Step 9062 (43 ms): 2627.3.
Step 9099 (42 ms): 2658.9.
Step 9137 (43 ms): 2692.1.
Step 9174 (42 ms): 2624.6.
Step 9212 (42 ms): 2735.5.
Step 9250 (42 ms): 2704.7.
Step 9287 (42 ms): 2678.9.
Step 9325 (42 ms): 2630.6.
Step 9362 (42 ms): 2706.4.
Step 9400 (20 ms): -2644.

Epoch 25 (15.9 s):
    Evaluating model.
    Full set (6.38 s): ELBO: 2554.6, ENRE: 2576.7, KL: 22.092.
    Saving model parameters.
    Model parameters saved (127 ms).

Step 9438 (42 ms): 2675.4.
Step 9475 (43 ms): 2687.6.
Step 9513 (43 ms): 2674.4.
Step 9550 (42 ms): 2767.5.
Step 9588 (42 ms): 2654.7.
Step 9626 (43 ms): 2768.9.
Step 9663 (43 ms): 2633.3.
Step 9701 (43 ms): 2748.5.
Step 9738 (42 ms): 2705.2.
Step 9776 (20 ms): -1323.8.

Epoch 26 (16 s):
    Evaluating model.
    Full set (6.32 s): ELBO: 2533.4, ENRE: 2556.2, KL: 22.8.
    Saving model parameters.
    Model parameters saved (134 ms).

Step 9814 (42 ms): 2606.7.
Step 9851 (42 ms): 2702.3.
Step 9889 (42 ms): 2700.8.
Step 9926 (42 ms): 2605.7.
Step 9964 (42 ms): 2677.3.
Step 10002 (42 ms): 2602.9.
Step 10039 (43 ms): 2675.9.
Step 10077 (43 ms): 2653.
Step 10114 (43 ms): 2732.6.
Step 10152 (21 ms): 250.35.

Epoch 27 (15.9 s):
    Evaluating model.
    Full set (6.4 s): ELBO: 2601.6, ENRE: 2620.4, KL: 18.853.
    Saving model parameters.
    Model parameters saved (129 ms).

Step 10190 (42 ms): 2661.1.
Step 10227 (42 ms): 2753.5.
Step 10265 (43 ms): 2702.8.
Step 10302 (43 ms): 2741.7.
Step 10340 (42 ms): 2715.2.
Step 10378 (42 ms): 2713.
Step 10415 (42 ms): 2745.1.
Step 10453 (42 ms): 2724.3.
Step 10490 (42 ms): 2731.7.
Step 10528 (19 ms): 596.68.

Epoch 28 (15.9 s):
    Evaluating model.
    Full set (6.36 s): ELBO: 2602.7, ENRE: 2623.7, KL: 21.08.
    Saving model parameters.
    Model parameters saved (130 ms).

Step 10566 (43 ms): 2756.6.
Step 10603 (43 ms): 2668.2.
Step 10641 (42 ms): 2709.9.
Step 10678 (43 ms): 2671.5.
Step 10716 (43 ms): 2765.1.
Step 10754 (42 ms): 2730.2.
Step 10791 (43 ms): 2676.2.
Step 10829 (43 ms): 2716.3.
Step 10866 (42 ms): 2684.4.
Step 10904 (22 ms): 887.76.

Epoch 29 (16 s):
    Evaluating model.
    Full set (6.39 s): ELBO: 2617.5, ENRE: 2636.2, KL: 18.738.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 10942 (41 ms): 2746.6.
Step 10979 (42 ms): 2745.6.
Step 11017 (43 ms): 2673.1.
Step 11054 (41 ms): 2738.2.
Step 11092 (42 ms): 2726.3.
Step 11130 (43 ms): 2656.
Step 11167 (42 ms): 2655.9.
Step 11205 (43 ms): 2710.5.
Step 11242 (42 ms): 2583.3.
Step 11280 (21 ms): -207.7.

Epoch 30 (15.9 s):
    Evaluating model.
    Full set (6.38 s): ELBO: 2648, ENRE: 2665.7, KL: 17.74.
    Saving model parameters.
    Model parameters saved (127 ms).

Step 11318 (42 ms): 2615.
Step 11355 (43 ms): 2687.6.
Step 11393 (42 ms): 2626.4.
Step 11430 (43 ms): 2734.
Step 11468 (43 ms): 2670.6.
Step 11506 (42 ms): 2692.5.
Step 11543 (42 ms): 2809.6.
Step 11581 (42 ms): 2729.3.
Step 11618 (42 ms): 2606.8.
Step 11656 (20 ms): 1192.4.

Epoch 31 (15.9 s):
    Evaluating model.
    Full set (6.32 s): ELBO: 2643.6, ENRE: 2662, KL: 18.386.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 11694 (42 ms): 2711.1.
Step 11731 (43 ms): 2610.7.
Step 11769 (43 ms): 2696.5.
Step 11806 (43 ms): 2692.6.
Step 11844 (42 ms): 2729.6.
Step 11882 (42 ms): 2801.7.
Step 11919 (43 ms): 2769.6.
Step 11957 (44 ms): 2652.4.
Step 11994 (42 ms): 2657.6.
Step 12032 (20 ms): 144.07.

Epoch 32 (16 s):
    Evaluating model.
    Full set (6.4 s): ELBO: 2663.8, ENRE: 2681.9, KL: 18.067.
    Saving model parameters.
    Model parameters saved (135 ms).

Step 12070 (42 ms): 2667.1.
Step 12107 (43 ms): 2664.8.
Step 12145 (42 ms): 2710.2.
Step 12182 (42 ms): 2700.
Step 12220 (41 ms): 2670.7.
Step 12258 (42 ms): 2682.3.
Step 12295 (43 ms): 2683.2.
Step 12333 (43 ms): 2727.8.
Step 12370 (42 ms): 2710.3.
Step 12408 (20 ms): 1803.2.

Epoch 33 (15.9 s):
    Evaluating model.
    Full set (6.39 s): ELBO: 2614.8, ENRE: 2634.5, KL: 19.687.
    Saving model parameters.
    Model parameters saved (130 ms).

Step 12446 (43 ms): 2644.1.
Step 12483 (43 ms): 2690.6.
Step 12521 (42 ms): 2708.2.
Step 12558 (43 ms): 2701.7.
Step 12596 (42 ms): 2749.
Step 12634 (43 ms): 2632.3.
Step 12671 (42 ms): 2605.3.
Step 12709 (43 ms): 2659.1.
Step 12746 (42 ms): 2703.1.
Step 12784 (20 ms): -156.83.

Epoch 34 (16 s):
    Evaluating model.
    Full set (6.3 s): ELBO: 2633.9, ENRE: 2652.8, KL: 18.9.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 12822 (42 ms): 2741.
Step 12859 (43 ms): 2705.5.
Step 12897 (43 ms): 2704.4.
Step 12934 (43 ms): 2694.2.
Step 12972 (43 ms): 2529.3.
Step 13010 (43 ms): 2682.2.
Step 13047 (43 ms): 2788.4.
Step 13085 (43 ms): 2723.4.
Step 13122 (43 ms): 2634.2.
Step 13160 (20 ms): 711.62.

Epoch 35 (16 s):
    Evaluating model.
    Full set (6.38 s): ELBO: 2660.3, ENRE: 2678.6, KL: 18.321.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 13198 (43 ms): 2698.3.
Step 13235 (43 ms): 2745.7.
Step 13273 (42 ms): 2694.6.
Step 13310 (42 ms): 2709.2.
Step 13348 (42 ms): 2625.1.
Step 13386 (41 ms): 2467.4.
Step 13423 (41 ms): 2607.4.
Step 13461 (42 ms): 2606.7.
Step 13498 (42 ms): 2689.4.
Step 13536 (20 ms): -585.59.

Epoch 36 (15.8 s):
    Evaluating model.
    Full set (6.39 s): ELBO: 2657.7, ENRE: 2675.6, KL: 17.928.
    Saving model parameters.
    Model parameters saved (130 ms).

Step 13574 (42 ms): 2725.1.
Step 13611 (43 ms): 2752.7.
Step 13649 (43 ms): 2720.3.
Step 13686 (43 ms): 2626.1.
Step 13724 (42 ms): 2716.1.
Step 13762 (42 ms): 2610.3.
Step 13799 (42 ms): 2713.2.
Step 13837 (43 ms): 2713.5.
Step 13874 (42 ms): 2663.9.
Step 13912 (20 ms): 812.13.

Epoch 37 (16 s):
    Evaluating model.
    Full set (6.34 s): ELBO: 2672.6, ENRE: 2689.9, KL: 17.257.
    Saving model parameters.
    Model parameters saved (130 ms).

Step 13950 (42 ms): 2703.9.
Step 13987 (42 ms): 2791.8.
Step 14025 (42 ms): 2739.3.
Step 14062 (42 ms): 2748.8.
Step 14100 (42 ms): 2754.2.
Step 14138 (43 ms): 2713.7.
Step 14175 (43 ms): 2703.1.
Step 14213 (43 ms): 2680.5.
Step 14250 (42 ms): 2665.
Step 14288 (21 ms): -287.54.

Epoch 38 (15.9 s):
    Evaluating model.
    Full set (6.4 s): ELBO: 2650.5, ENRE: 2669.5, KL: 19.064.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 14326 (43 ms): 2757.3.
Step 14363 (44 ms): 2675.7.
Step 14401 (43 ms): 2710.1.
Step 14438 (43 ms): 2693.8.
Step 14476 (42 ms): 2760.8.
Step 14514 (42 ms): 2694.8.
Step 14551 (42 ms): 2763.2.
Step 14589 (42 ms): 2795.8.
Step 14626 (42 ms): 2702.4.
Step 14664 (20 ms): -5.0991.

Epoch 39 (15.9 s):
    Evaluating model.
    Full set (6.36 s): ELBO: 2641.4, ENRE: 2659.9, KL: 18.441.
    Saving model parameters.
    Model parameters saved (141 ms).

Step 14702 (43 ms): 2751.8.
Step 14739 (43 ms): 2726.6.
Step 14777 (43 ms): 2669.3.
Step 14814 (42 ms): 2753.4.
Step 14852 (43 ms): 2683.9.
Step 14890 (42 ms): 2709.9.
Step 14927 (43 ms): 2727.9.
Step 14965 (43 ms): 2693.1.
Step 15002 (42 ms): 2590.
Step 15040 (22 ms): -483.

Epoch 40 (16 s):
    Evaluating model.
    Full set (6.39 s): ELBO: 2692.7, ENRE: 2710, KL: 17.281.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 15078 (41 ms): 2708.4.
Step 15115 (42 ms): 2753.7.
Step 15153 (42 ms): 2566.5.
Step 15190 (42 ms): 2755.7.
Step 15228 (41 ms): 2796.1.
Step 15266 (42 ms): 2712.5.
Step 15303 (42 ms): 2687.1.
Step 15341 (43 ms): 2709.2.
Step 15378 (42 ms): 2780.4.
Step 15416 (20 ms): 342.81.

Epoch 41 (15.9 s):
    Evaluating model.
    Full set (6.39 s): ELBO: 2676.9, ENRE: 2693.7, KL: 16.756.
    Saving model parameters.
    Model parameters saved (138 ms).

Step 15454 (42 ms): 2722.8.
Step 15491 (43 ms): 2736.7.
Step 15529 (42 ms): 2662.9.
Step 15566 (42 ms): 2669.5.
Step 15604 (42 ms): 2629.
Step 15642 (42 ms): 2749.6.
Step 15679 (42 ms): 2653.4.
Step 15717 (42 ms): 2672.9.
Step 15754 (42 ms): 2713.9.
Step 15792 (19 ms): -113.99.

Epoch 42 (15.9 s):
    Evaluating model.
    Full set (6.31 s): ELBO: 2681, ENRE: 2699.4, KL: 18.387.
    Saving model parameters.
    Model parameters saved (131 ms).

Step 15830 (42 ms): 2666.6.
Step 15867 (42 ms): 2785.2.
Step 15905 (43 ms): 2740.9.
Step 15942 (43 ms): 2744.8.
Step 15980 (42 ms): 2756.1.
Step 16018 (42 ms): 2766.6.
Step 16055 (43 ms): 2743.9.
Step 16093 (43 ms): 2650.6.
Step 16130 (42 ms): 2743.7.
Step 16168 (21 ms): 372.41.

Epoch 43 (16 s):
    Evaluating model.
    Full set (6.41 s): ELBO: 2667.8, ENRE: 2686.6, KL: 18.714.
    Saving model parameters.
    Model parameters saved (133 ms).

Step 16206 (42 ms): 2722.8.
Step 16243 (43 ms): 2647.4.
Step 16281 (42 ms): 2757.
Step 16318 (42 ms): 2676.7.
Step 16356 (42 ms): 2731.7.
Step 16394 (42 ms): 2760.5.
Step 16431 (43 ms): 2733.7.
Step 16469 (43 ms): 2749.9.
Step 16506 (43 ms): 2718.3.
Step 16544 (21 ms): -178.54.

Epoch 44 (15.9 s):
    Evaluating model.
    Full set (6.41 s): ELBO: 2685.7, ENRE: 2703.3, KL: 17.605.
    Saving model parameters.
    Model parameters saved (127 ms).

Step 16582 (42 ms): 2785.3.
Step 16619 (44 ms): 2672.4.
Step 16657 (43 ms): 2756.2.
Step 16694 (42 ms): 2793.6.
Step 16732 (43 ms): 2699.2.
Step 16770 (43 ms): 2722.
Step 16807 (43 ms): 2707.2.
Step 16845 (43 ms): 2799.9.
Step 16882 (42 ms): 2752.7.
Step 16920 (21 ms): -564.43.

Epoch 45 (16 s):
    Evaluating model.
    Full set (6.3 s): ELBO: 2681.7, ENRE: 2700.1, KL: 18.409.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 16958 (42 ms): 2697.4.
Step 16995 (43 ms): 2769.7.
Step 17033 (42 ms): 2703.
Step 17070 (43 ms): 2692.8.
Step 17108 (43 ms): 2808.7.
Step 17146 (42 ms): 2752.8.
Step 17183 (43 ms): 2736.4.
Step 17221 (43 ms): 2751.1.
Step 17258 (44 ms): 2770.5.
Step 17296 (22 ms): -1389.6.

Epoch 46 (16 s):
    Evaluating model.
    Full set (6.38 s): ELBO: 2691.8, ENRE: 2709.4, KL: 17.553.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 17334 (42 ms): 2831.7.
Step 17371 (42 ms): 2774.6.
Step 17409 (44 ms): 2763.7.
Step 17446 (42 ms): 2834.6.
Step 17484 (42 ms): 2774.3.
Step 17522 (41 ms): 2792.1.
Step 17559 (43 ms): 2685.4.
Step 17597 (42 ms): 2764.2.
Step 17634 (42 ms): 2782.1.
Step 17672 (20 ms): -563.11.

Epoch 47 (15.9 s):
    Evaluating model.
    Full set (6.38 s): ELBO: 2707, ENRE: 2724.3, KL: 17.288.
    Saving model parameters.
    Model parameters saved (131 ms).

Step 17710 (42 ms): 2651.4.
Step 17747 (43 ms): 2708.8.
Step 17785 (43 ms): 2640.8.
Step 17822 (43 ms): 2726.9.
Step 17860 (42 ms): 2669.5.
Step 17898 (42 ms): 2765.9.
Step 17935 (43 ms): 2751.3.
Step 17973 (43 ms): 2630.2.
Step 18010 (42 ms): 2797.
Step 18048 (20 ms): -63.979.

Epoch 48 (16 s):
    Evaluating model.
    Full set (6.31 s): ELBO: 2707.5, ENRE: 2725, KL: 17.425.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 18086 (42 ms): 2712.
Step 18123 (42 ms): 2715.2.
Step 18161 (42 ms): 2773.
Step 18198 (43 ms): 2754.9.
Step 18236 (42 ms): 2691.
Step 18274 (43 ms): 2764.
Step 18311 (42 ms): 2791.5.
Step 18349 (42 ms): 2659.
Step 18386 (42 ms): 2667.4.
Step 18424 (20 ms): 688.4.

Epoch 49 (15.9 s):
    Evaluating model.
    Full set (6.39 s): ELBO: 2732.1, ENRE: 2748.6, KL: 16.515.
    Saving model parameters.
    Model parameters saved (133 ms).

Step 18462 (43 ms): 2771.2.
Step 18499 (42 ms): 2751.9.
Step 18537 (42 ms): 2584.
Step 18574 (42 ms): 2701.3.
Step 18612 (42 ms): 2736.9.
Step 18650 (42 ms): 2699.7.
Step 18687 (42 ms): 2660.1.
Step 18725 (42 ms): 2763.6.
Step 18762 (42 ms): 2777.8.
Step 18800 (20 ms): 1282.3.

Epoch 50 (15.9 s):
    Evaluating model.
    Full set (6.36 s): ELBO: 2724.9, ENRE: 2741.9, KL: 16.941.
    Saving model parameters.
    Model parameters saved (128 ms).

Model trained for 50 epochs (18m 50s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (10 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (869 ms).

Converting data set value array to sparse matrix.
Data set value array converted (269 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2.09 s):  ELBO: -9106.4, ENRE: -9089.7, KL: 16.728.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (940 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.866967584565442
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 25
kl weight: 1.866967584565442
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (48 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (3.97 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.67 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 25
    hidden sizes: 116, 266, 297, 288
    latent distribution: gaussian
    reconstruction distribution: gaussian
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.866967584565442
    using analytical KL term
    using batch normalisation for minibatches
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 116)
    ENCODER/1/DENSE/biases:0             (116,)
    ENCODER/1/BATCH_NORM/beta:0          (116,)
    ENCODER/2/DENSE/weights:0            (116, 266)
    ENCODER/2/DENSE/biases:0             (266,)
    ENCODER/2/BATCH_NORM/beta:0          (266,)
    ENCODER/3/DENSE/weights:0            (266, 297)
    ENCODER/3/DENSE/biases:0             (297,)
    ENCODER/3/BATCH_NORM/beta:0          (297,)
    ENCODER/4/DENSE/weights:0            (297, 288)
    ENCODER/4/DENSE/biases:0             (288,)
    ENCODER/4/BATCH_NORM/beta:0          (288,)
    POSTERIOR/MU/DENSE/weights:0         (288, 25)
    POSTERIOR/MU/DENSE/biases:0          (25,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (288, 25)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (25,)
    DECODER/4/DENSE/weights:0            (25, 288)
    DECODER/4/DENSE/biases:0             (288,)
    DECODER/4/BATCH_NORM/beta:0          (288,)
    DECODER/3/DENSE/weights:0            (288, 297)
    DECODER/3/DENSE/biases:0             (297,)
    DECODER/3/BATCH_NORM/beta:0          (297,)
    DECODER/2/DENSE/weights:0            (297, 266)
    DECODER/2/DENSE/biases:0             (266,)
    DECODER/2/BATCH_NORM/beta:0          (266,)
    DECODER/1/DENSE/weights:0            (266, 116)
    DECODER/1/DENSE/biases:0             (116,)
    DECODER/1/BATCH_NORM/beta:0          (116,)
    X_TILDE/MU/DENSE/weights:0           (116, 2000)
    X_TILDE/MU/DENSE/biases:0            (2000,)
    X_TILDE/LOG_SIGMA/DENSE/weights:0    (116, 2000)
    X_TILDE/LOG_SIGMA/DENSE/biases:0     (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (500 ms).

Training model for 50 epochs on original values.

Step 38 (36 ms): -3425.3.
Step 75 (36 ms): -2358.6.
Step 113 (36 ms): -1718.3.
Step 150 (34 ms): -1225.1.
Step 188 (34 ms): -776.12.
Step 226 (36 ms): -352.46.
Step 263 (34 ms): 174.55.
Step 301 (34 ms): 584.93.
Step 338 (34 ms): 1059.3.
Step 376 (18 ms): 1276.

Epoch 1 (15.7 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -1642.4, ENRE: -1633.7, KL: 8.721.
    Saving model parameters.
    Model parameters saved (201 ms).

Step 414 (34 ms): 1715.7.
Step 451 (34 ms): 2009.9.
Step 489 (34 ms): 1919.5.
Step 526 (35 ms): 2237.3.
Step 564 (34 ms): 2352.3.
Step 602 (34 ms): 2467.
Step 639 (35 ms): 2423.7.
Step 677 (34 ms): 2364.3.
Step 714 (34 ms): 2139.9.
Step 752 (18 ms): 2525.1.

Epoch 2 (12.9 s):
    Evaluating model.
    Full set (5.47 s): ELBO: 1003.3, ENRE: 1009.4, KL: 6.1329.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 790 (34 ms): 2289.8.
Step 827 (34 ms): 2516.
Step 865 (34 ms): 2393.2.
Step 902 (34 ms): 2444.1.
Step 940 (34 ms): 2465.9.
Step 978 (34 ms): 2311.4.
Step 1015 (34 ms): 2433.
Step 1053 (33 ms): 2542.7.
Step 1090 (34 ms): 2496.7.
Step 1128 (16 ms): 1902.

Epoch 3 (12.8 s):
    Evaluating model.
    Full set (5.42 s): ELBO: 1998.9, ENRE: 2006.1, KL: 7.1847.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 1166 (34 ms): 2496.2.
Step 1203 (36 ms): 2527.8.
Step 1241 (34 ms): 2362.8.
Step 1278 (34 ms): 2489.6.
Step 1316 (34 ms): 2530.8.
Step 1354 (34 ms): 2573.5.
Step 1391 (34 ms): 2532.8.
Step 1429 (34 ms): 2592.6.
Step 1466 (35 ms): 2396.
Step 1504 (16 ms): 2614.2.

Epoch 4 (12.9 s):
    Evaluating model.
    Full set (5.47 s): ELBO: 2316.1, ENRE: 2324.7, KL: 8.5649.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 1542 (34 ms): 2555.4.
Step 1579 (34 ms): 2521.4.
Step 1617 (34 ms): 2475.2.
Step 1654 (34 ms): 2556.6.
Step 1692 (34 ms): 2613.7.
Step 1730 (35 ms): 2471.8.
Step 1767 (34 ms): 2469.4.
Step 1805 (34 ms): 2456.3.
Step 1842 (34 ms): 2608.3.
Step 1880 (16 ms): 2418.2.

Epoch 5 (12.8 s):
    Evaluating model.
    Full set (5.43 s): ELBO: 2299.3, ENRE: 2310.3, KL: 10.931.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 1918 (35 ms): 2288.6.
Step 1955 (35 ms): 2387.
Step 1993 (34 ms): 2534.3.
Step 2030 (34 ms): 2530.2.
Step 2068 (34 ms): 2593.4.
Step 2106 (34 ms): 2573.6.
Step 2143 (34 ms): 2591.9.
Step 2181 (34 ms): 2517.7.
Step 2218 (34 ms): 2632.4.
Step 2256 (16 ms): 1285.5.

Epoch 6 (12.9 s):
    Evaluating model.
    Full set (5.45 s): ELBO: 2383.4, ENRE: 2395.5, KL: 12.175.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 2294 (34 ms): 2658.3.
Step 2331 (33 ms): 2604.1.
Step 2369 (33 ms): 2484.8.
Step 2406 (34 ms): 2510.8.
Step 2444 (34 ms): 2550.8.
Step 2482 (34 ms): 2629.4.
Step 2519 (36 ms): 2344.
Step 2557 (34 ms): 2576.4.
Step 2594 (34 ms): 2454.8.
Step 2632 (16 ms): 1896.1.

Epoch 7 (12.8 s):
    Evaluating model.
    Full set (5.43 s): ELBO: 2398.5, ENRE: 2411.7, KL: 13.246.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 2670 (34 ms): 2600.4.
Step 2707 (35 ms): 2600.1.
Step 2745 (35 ms): 2468.4.
Step 2782 (34 ms): 2568.4.
Step 2820 (35 ms): 2612.6.
Step 2858 (34 ms): 2647.7.
Step 2895 (35 ms): 2631.3.
Step 2933 (35 ms): 2574.
Step 2970 (34 ms): 2590.2.
Step 3008 (16 ms): 1831.6.

Epoch 8 (12.9 s):
    Evaluating model.
    Full set (5.45 s): ELBO: 2318.6, ENRE: 2334, KL: 15.422.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 3046 (34 ms): 2560.8.
Step 3083 (34 ms): 2496.2.
Step 3121 (35 ms): 2527.
Step 3158 (35 ms): 2589.5.
Step 3196 (34 ms): 2668.5.
Step 3234 (34 ms): 2588.5.
Step 3271 (34 ms): 2603.8.
Step 3309 (35 ms): 2500.1.
Step 3346 (34 ms): 2519.6.
Step 3384 (17 ms): -257.09.

Epoch 9 (12.9 s):
    Evaluating model.
    Full set (5.55 s): ELBO: 2258.9, ENRE: 2275.7, KL: 16.775.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 3422 (35 ms): 2541.2.
Step 3459 (35 ms): 2593.8.
Step 3497 (34 ms): 2630.5.
Step 3534 (35 ms): 2537.5.
Step 3572 (34 ms): 2611.8.
Step 3610 (34 ms): 2564.5.
Step 3647 (34 ms): 2623.7.
Step 3685 (34 ms): 2568.2.
Step 3722 (33 ms): 2634.9.
Step 3760 (16 ms): -5805.3.

Epoch 10 (12.9 s):
    Evaluating model.
    Full set (5.37 s): ELBO: 2305.6, ENRE: 2324, KL: 18.414.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 3798 (34 ms): 2556.3.
Step 3835 (34 ms): 2636.9.
Step 3873 (34 ms): 2486.3.
Step 3910 (34 ms): 2587.2.
Step 3948 (34 ms): 2654.8.
Step 3986 (34 ms): 2458.
Step 4023 (34 ms): 2524.9.
Step 4061 (34 ms): 2600.4.
Step 4098 (34 ms): 2618.3.
Step 4136 (16 ms): 1767.8.

Epoch 11 (12.8 s):
    Evaluating model.
    Full set (5.39 s): ELBO: 2211.7, ENRE: 2231.7, KL: 20.005.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 4174 (34 ms): 2670.6.
Step 4211 (34 ms): 2546.8.
Step 4249 (34 ms): 2605.7.
Step 4286 (34 ms): 2703.
Step 4324 (33 ms): 2582.6.
Step 4362 (33 ms): 2615.7.
Step 4399 (36 ms): 2647.5.
Step 4437 (34 ms): 2688.
Step 4474 (34 ms): 2660.9.
Step 4512 (16 ms): 1624.

Epoch 12 (12.8 s):
    Evaluating model.
    Full set (5.35 s): ELBO: 2310.8, ENRE: 2331.4, KL: 20.574.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 4550 (34 ms): 2578.8.
Step 4587 (34 ms): 2524.6.
Step 4625 (35 ms): 2600.6.
Step 4662 (33 ms): 2684.2.
Step 4700 (33 ms): 2604.1.
Step 4738 (33 ms): 2633.8.
Step 4775 (34 ms): 2620.8.
Step 4813 (34 ms): 2626.5.
Step 4850 (34 ms): 2579.1.
Step 4888 (16 ms): 2322.7.

Epoch 13 (12.8 s):
    Evaluating model.
    Full set (5.37 s): ELBO: 2235.7, ENRE: 2255.9, KL: 20.172.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 4926 (34 ms): 2515.4.
Step 4963 (34 ms): 2609.4.
Step 5001 (34 ms): 2708.6.
Step 5038 (34 ms): 2666.5.
Step 5076 (34 ms): 2613.2.
Step 5114 (34 ms): 2497.7.
Step 5151 (34 ms): 2611.7.
Step 5189 (35 ms): 2618.2.
Step 5226 (34 ms): 2509.6.
Step 5264 (16 ms): -3646.3.

Epoch 14 (12.8 s):
    Evaluating model.
    Full set (5.35 s): ELBO: 2259.2, ENRE: 2278.5, KL: 19.26.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 5302 (34 ms): 2667.3.
Step 5339 (34 ms): 2722.9.
Step 5377 (33 ms): 2676.2.
Step 5414 (34 ms): 2661.5.
Step 5452 (34 ms): 2464.1.
Step 5490 (34 ms): 2729.4.
Step 5527 (34 ms): 2701.9.
Step 5565 (34 ms): 2604.7.
Step 5602 (34 ms): 2565.8.
Step 5640 (16 ms): 2154.7.

Epoch 15 (12.8 s):
    Evaluating model.
    Full set (5.4 s): ELBO: 2311.1, ENRE: 2328.8, KL: 17.757.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 5678 (35 ms): 2590.2.
Step 5715 (34 ms): 2515.5.
Step 5753 (34 ms): 2619.
Step 5790 (34 ms): 2689.4.
Step 5828 (34 ms): 2686.4.
Step 5866 (34 ms): 2604.9.
Step 5903 (34 ms): 2578.3.
Step 5941 (34 ms): 2731.3.
Step 5978 (34 ms): 2685.6.
Step 6016 (16 ms): 2312.9.

Epoch 16 (12.8 s):
    Evaluating model.
    Full set (5.36 s): ELBO: 2436.8, ENRE: 2453, KL: 16.234.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 6054 (34 ms): 2723.4.
Step 6091 (34 ms): 2635.1.
Step 6129 (34 ms): 2705.3.
Step 6166 (34 ms): 2689.9.
Step 6204 (35 ms): 2736.5.
Step 6242 (34 ms): 2587.
Step 6279 (35 ms): 2611.7.
Step 6317 (34 ms): 2661.5.
Step 6354 (34 ms): 2701.
Step 6392 (16 ms): -2872.4.

Epoch 17 (12.8 s):
    Evaluating model.
    Full set (5.38 s): ELBO: 2491.3, ENRE: 2507.1, KL: 15.79.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 6430 (34 ms): 2703.4.
Step 6467 (34 ms): 2696.7.
Step 6505 (34 ms): 2663.4.
Step 6542 (34 ms): 2556.
Step 6580 (34 ms): 2641.
Step 6618 (34 ms): 2747.6.
Step 6655 (34 ms): 2612.5.
Step 6693 (34 ms): 2567.6.
Step 6730 (35 ms): 2643.9.
Step 6768 (16 ms): 945.84.

Epoch 18 (12.8 s):
    Evaluating model.
    Full set (5.34 s): ELBO: 2426.9, ENRE: 2443.1, KL: 16.191.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 6806 (34 ms): 2607.7.
Step 6843 (34 ms): 2740.
Step 6881 (34 ms): 2690.7.
Step 6918 (34 ms): 2674.
Step 6956 (34 ms): 2569.2.
Step 6994 (34 ms): 2638.4.
Step 7031 (34 ms): 2638.7.
Step 7069 (34 ms): 2620.6.
Step 7106 (34 ms): 2696.2.
Step 7144 (16 ms): 1575.8.

Epoch 19 (12.8 s):
    Evaluating model.
    Full set (5.37 s): ELBO: 2436.3, ENRE: 2452.6, KL: 16.274.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 7182 (34 ms): 2652.8.
Step 7219 (34 ms): 2709.9.
Step 7257 (34 ms): 2545.9.
Step 7294 (34 ms): 2665.9.
Step 7332 (34 ms): 2624.6.
Step 7370 (34 ms): 2705.7.
Step 7407 (34 ms): 2701.2.
Step 7445 (34 ms): 2737.2.
Step 7482 (34 ms): 2656.4.
Step 7520 (16 ms): 452.66.

Epoch 20 (12.8 s):
    Evaluating model.
    Full set (5.35 s): ELBO: 2451.6, ENRE: 2468, KL: 16.355.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 7558 (34 ms): 2738.5.
Step 7595 (33 ms): 2644.5.
Step 7633 (34 ms): 2692.8.
Step 7670 (34 ms): 2702.6.
Step 7708 (34 ms): 2773.3.
Step 7746 (34 ms): 2676.
Step 7783 (34 ms): 2645.3.
Step 7821 (34 ms): 2649.
Step 7858 (34 ms): 2700.9.
Step 7896 (16 ms): 1669.8.

Epoch 21 (12.8 s):
    Evaluating model.
    Full set (5.39 s): ELBO: 2454.2, ENRE: 2470.6, KL: 16.429.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 7934 (34 ms): 2736.5.
Step 7971 (34 ms): 2684.
Step 8009 (34 ms): 2705.8.
Step 8046 (34 ms): 2665.6.
Step 8084 (36 ms): 2709.7.
Step 8122 (34 ms): 2775.3.
Step 8159 (35 ms): 2663.8.
Step 8197 (34 ms): 2795.1.
Step 8234 (34 ms): 2666.1.
Step 8272 (16 ms): 1942.1.

Epoch 22 (12.8 s):
    Evaluating model.
    Full set (5.34 s): ELBO: 2458.2, ENRE: 2474.8, KL: 16.608.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 8310 (36 ms): 2737.6.
Step 8347 (34 ms): 2595.8.
Step 8385 (34 ms): 2683.3.
Step 8422 (35 ms): 2669.5.
Step 8460 (34 ms): 2666.1.
Step 8498 (34 ms): 2690.5.
Step 8535 (34 ms): 2706.1.
Step 8573 (34 ms): 2666.3.
Step 8610 (34 ms): 2756.7.
Step 8648 (16 ms): 1138.8.

Epoch 23 (12.8 s):
    Evaluating model.
    Full set (5.39 s): ELBO: 2470.4, ENRE: 2486.6, KL: 16.179.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 8686 (34 ms): 2665.6.
Step 8723 (34 ms): 2673.4.
Step 8761 (34 ms): 2686.9.
Step 8798 (34 ms): 2707.4.
Step 8836 (34 ms): 2670.8.
Step 8874 (34 ms): 2752.7.
Step 8911 (34 ms): 2702.4.
Step 8949 (34 ms): 2659.1.
Step 8986 (34 ms): 2725.4.
Step 9024 (17 ms): -557.78.

Epoch 24 (12.8 s):
    Evaluating model.
    Full set (5.35 s): ELBO: 2486.9, ENRE: 2503.2, KL: 16.274.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 9062 (34 ms): 2753.6.
Step 9099 (34 ms): 2710.8.
Step 9137 (34 ms): 2705.5.
Step 9174 (34 ms): 2632.2.
Step 9212 (34 ms): 2748.7.
Step 9250 (35 ms): 2679.
Step 9287 (35 ms): 2708.
Step 9325 (34 ms): 2671.4.
Step 9362 (35 ms): 2687.3.
Step 9400 (16 ms): 1272.9.

Epoch 25 (12.8 s):
    Evaluating model.
    Full set (5.38 s): ELBO: 2523.8, ENRE: 2539.4, KL: 15.609.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 9438 (34 ms): 2708.3.
Step 9475 (34 ms): 2673.2.
Step 9513 (34 ms): 2747.1.
Step 9550 (34 ms): 2720.1.
Step 9588 (34 ms): 2648.
Step 9626 (34 ms): 2752.5.
Step 9663 (34 ms): 2669.1.
Step 9701 (34 ms): 2768.5.
Step 9738 (34 ms): 2707.
Step 9776 (16 ms): 2061.1.

Epoch 26 (12.8 s):
    Evaluating model.
    Full set (5.34 s): ELBO: 2462.5, ENRE: 2478.9, KL: 16.396.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 9814 (34 ms): 2677.3.
Step 9851 (34 ms): 2575.
Step 9889 (33 ms): 2627.8.
Step 9926 (34 ms): 2652.8.
Step 9964 (34 ms): 2651.8.
Step 10002 (34 ms): 2704.4.
Step 10039 (34 ms): 2644.6.
Step 10077 (34 ms): 2696.7.
Step 10114 (34 ms): 2720.7.
Step 10152 (16 ms): 819.43.

Epoch 27 (12.8 s):
    Evaluating model.
    Full set (5.38 s): ELBO: 2461.9, ENRE: 2477.9, KL: 15.915.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 10190 (34 ms): 2729.
Step 10227 (34 ms): 2737.6.
Step 10265 (34 ms): 2729.7.
Step 10302 (34 ms): 2637.5.
Step 10340 (34 ms): 2801.6.
Step 10378 (34 ms): 2685.8.
Step 10415 (34 ms): 2668.4.
Step 10453 (34 ms): 2689.1.
Step 10490 (34 ms): 2638.
Step 10528 (16 ms): 2184.8.

Epoch 28 (12.8 s):
    Evaluating model.
    Full set (5.34 s): ELBO: 2501, ENRE: 2516.5, KL: 15.475.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 10566 (34 ms): 2647.5.
Step 10603 (34 ms): 2706.8.
Step 10641 (34 ms): 2612.4.
Step 10678 (34 ms): 2717.
Step 10716 (34 ms): 2755.3.
Step 10754 (34 ms): 2712.1.
Step 10791 (35 ms): 2712.9.
Step 10829 (34 ms): 2705.7.
Step 10866 (34 ms): 2644.2.
Step 10904 (16 ms): -834.5.

Epoch 29 (12.8 s):
    Evaluating model.
    Full set (5.38 s): ELBO: 2581.9, ENRE: 2596.3, KL: 14.378.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 10942 (34 ms): 2635.9.
Step 10979 (34 ms): 2676.3.
Step 11017 (34 ms): 2728.6.
Step 11054 (34 ms): 2692.1.
Step 11092 (34 ms): 2709.
Step 11130 (34 ms): 2659.1.
Step 11167 (34 ms): 2719.3.
Step 11205 (34 ms): 2750.1.
Step 11242 (34 ms): 2772.7.
Step 11280 (16 ms): 1689.7.

Epoch 30 (12.8 s):
    Evaluating model.
    Full set (5.34 s): ELBO: 2599.3, ENRE: 2613, KL: 13.721.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 11318 (34 ms): 2702.
Step 11355 (34 ms): 2742.6.
Step 11393 (33 ms): 2746.3.
Step 11430 (34 ms): 2729.7.
Step 11468 (34 ms): 2716.1.
Step 11506 (34 ms): 2635.8.
Step 11543 (34 ms): 2751.4.
Step 11581 (33 ms): 2735.8.
Step 11618 (34 ms): 2779.
Step 11656 (16 ms): 537.55.

Epoch 31 (12.8 s):
    Evaluating model.
    Full set (5.38 s): ELBO: 2588.8, ENRE: 2603, KL: 14.187.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 11694 (34 ms): 2631.4.
Step 11731 (35 ms): 2620.2.
Step 11769 (34 ms): 2687.9.
Step 11806 (34 ms): 2752.6.
Step 11844 (34 ms): 2728.8.
Step 11882 (34 ms): 2785.5.
Step 11919 (34 ms): 2662.9.
Step 11957 (34 ms): 2726.1.
Step 11994 (34 ms): 2714.9.
Step 12032 (16 ms): -496.6.

Epoch 32 (12.8 s):
    Evaluating model.
    Full set (5.32 s): ELBO: 2611.8, ENRE: 2625.6, KL: 13.727.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 12070 (34 ms): 2744.7.
Step 12107 (34 ms): 2693.4.
Step 12145 (34 ms): 2686.5.
Step 12182 (34 ms): 2686.
Step 12220 (34 ms): 2769.3.
Step 12258 (34 ms): 2722.9.
Step 12295 (34 ms): 2722.5.
Step 12333 (34 ms): 2728.9.
Step 12370 (34 ms): 2688.9.
Step 12408 (16 ms): -1837.6.

Epoch 33 (12.8 s):
    Evaluating model.
    Full set (5.37 s): ELBO: 2591.4, ENRE: 2605.4, KL: 14.03.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 12446 (34 ms): 2726.5.
Step 12483 (34 ms): 2608.1.
Step 12521 (34 ms): 2691.7.
Step 12558 (34 ms): 2663.5.
Step 12596 (34 ms): 2778.6.
Step 12634 (34 ms): 2653.6.
Step 12671 (34 ms): 2631.1.
Step 12709 (34 ms): 2734.7.
Step 12746 (33 ms): 2739.1.
Step 12784 (16 ms): -4034.5.

Epoch 34 (12.8 s):
    Evaluating model.
    Full set (5.32 s): ELBO: 2574.8, ENRE: 2589.5, KL: 14.695.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 12822 (33 ms): 2754.7.
Step 12859 (33 ms): 2720.3.
Step 12897 (34 ms): 2683.2.
Step 12934 (34 ms): 2760.8.
Step 12972 (34 ms): 2755.6.
Step 13010 (34 ms): 2695.8.
Step 13047 (33 ms): 2659.7.
Step 13085 (34 ms): 2740.8.
Step 13122 (34 ms): 2682.4.
Step 13160 (16 ms): 650.79.

Epoch 35 (12.8 s):
    Evaluating model.
    Full set (5.39 s): ELBO: 2565.3, ENRE: 2579.9, KL: 14.565.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 13198 (34 ms): 2747.8.
Step 13235 (34 ms): 2768.5.
Step 13273 (34 ms): 2724.9.
Step 13310 (34 ms): 2768.3.
Step 13348 (34 ms): 2706.1.
Step 13386 (34 ms): 2682.1.
Step 13423 (34 ms): 2699.5.
Step 13461 (34 ms): 2761.7.
Step 13498 (33 ms): 2725.4.
Step 13536 (16 ms): 2115.5.

Epoch 36 (12.8 s):
    Evaluating model.
    Full set (5.33 s): ELBO: 2529.5, ENRE: 2544.7, KL: 15.255.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 13574 (34 ms): 2730.5.
Step 13611 (34 ms): 2738.9.
Step 13649 (34 ms): 2787.9.
Step 13686 (34 ms): 2694.4.
Step 13724 (35 ms): 2764.4.
Step 13762 (34 ms): 2734.1.
Step 13799 (33 ms): 2811.1.
Step 13837 (35 ms): 2758.9.
Step 13874 (34 ms): 2697.5.
Step 13912 (16 ms): 1384.3.

Epoch 37 (12.9 s):
    Evaluating model.
    Full set (5.38 s): ELBO: 2559.9, ENRE: 2574.7, KL: 14.799.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 13950 (34 ms): 2779.9.
Step 13987 (34 ms): 2779.9.
Step 14025 (33 ms): 2692.3.
Step 14062 (34 ms): 2702.4.
Step 14100 (34 ms): 2742.1.
Step 14138 (34 ms): 2716.3.
Step 14175 (33 ms): 2741.9.
Step 14213 (34 ms): 2787.5.
Step 14250 (34 ms): 2759.2.
Step 14288 (16 ms): 752.19.

Epoch 38 (12.8 s):
    Evaluating model.
    Full set (5.35 s): ELBO: 2609.1, ENRE: 2623.3, KL: 14.132.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 14326 (34 ms): 2753.7.
Step 14363 (35 ms): 2756.2.
Step 14401 (34 ms): 2767.3.
Step 14438 (34 ms): 2690.8.
Step 14476 (34 ms): 2733.8.
Step 14514 (34 ms): 2800.7.
Step 14551 (34 ms): 2699.4.
Step 14589 (34 ms): 2671.9.
Step 14626 (34 ms): 2724.5.
Step 14664 (16 ms): -14851.

Epoch 39 (12.8 s):
    Evaluating model.
    Full set (5.39 s): ELBO: 2579.7, ENRE: 2594, KL: 14.295.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 14702 (33 ms): 2688.7.
Step 14739 (34 ms): 2671.8.
Step 14777 (35 ms): 2752.7.
Step 14814 (33 ms): 2702.4.
Step 14852 (34 ms): 2735.9.
Step 14890 (34 ms): 2793.3.
Step 14927 (34 ms): 2782.
Step 14965 (34 ms): 2773.9.
Step 15002 (34 ms): 2755.9.
Step 15040 (16 ms): 1015.8.

Epoch 40 (12.7 s):
    Evaluating model.
    Full set (5.31 s): ELBO: 2595, ENRE: 2609.1, KL: 14.089.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 15078 (34 ms): 2806.5.
Step 15115 (35 ms): 2754.8.
Step 15153 (34 ms): 2779.7.
Step 15190 (34 ms): 2730.5.
Step 15228 (34 ms): 2737.7.
Step 15266 (34 ms): 2704.9.
Step 15303 (34 ms): 2747.8.
Step 15341 (34 ms): 2656.8.
Step 15378 (34 ms): 2850.
Step 15416 (16 ms): -719.08.

Epoch 41 (12.8 s):
    Evaluating model.
    Full set (5.37 s): ELBO: 2636.7, ENRE: 2650.4, KL: 13.67.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 15454 (34 ms): 2784.2.
Step 15491 (34 ms): 2648.6.
Step 15529 (34 ms): 2731.8.
Step 15566 (34 ms): 2765.3.
Step 15604 (33 ms): 2756.
Step 15642 (34 ms): 2792.8.
Step 15679 (34 ms): 2726.6.
Step 15717 (34 ms): 2758.9.
Step 15754 (34 ms): 2661.7.
Step 15792 (16 ms): 1282.8.

Epoch 42 (12.8 s):
    Evaluating model.
    Full set (5.33 s): ELBO: 2649.4, ENRE: 2663.2, KL: 13.798.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 15830 (34 ms): 2740.5.
Step 15867 (34 ms): 2721.3.
Step 15905 (34 ms): 2713.5.
Step 15942 (34 ms): 2758.1.
Step 15980 (34 ms): 2621.
Step 16018 (34 ms): 2688.2.
Step 16055 (34 ms): 2799.7.
Step 16093 (34 ms): 2782.6.
Step 16130 (34 ms): 2731.7.
Step 16168 (16 ms): -20489.

Epoch 43 (12.8 s):
    Evaluating model.
    Full set (5.4 s): ELBO: 2644.1, ENRE: 2658, KL: 13.857.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 16206 (34 ms): 2749.
Step 16243 (34 ms): 2794.
Step 16281 (35 ms): 2744.7.
Step 16318 (34 ms): 2775.7.
Step 16356 (34 ms): 2772.9.
Step 16394 (34 ms): 2733.1.
Step 16431 (34 ms): 2723.4.
Step 16469 (34 ms): 2698.1.
Step 16506 (34 ms): 2737.
Step 16544 (15 ms): 438.3.

Epoch 44 (12.8 s):
    Evaluating model.
    Full set (5.34 s): ELBO: 2661.6, ENRE: 2676.1, KL: 14.508.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 16582 (34 ms): 2754.7.
Step 16619 (35 ms): 2722.6.
Step 16657 (34 ms): 2806.8.
Step 16694 (35 ms): 2682.9.
Step 16732 (34 ms): 2593.1.
Step 16770 (34 ms): 2706.4.
Step 16807 (35 ms): 2702.4.
Step 16845 (34 ms): 2727.2.
Step 16882 (34 ms): 2763.9.
Step 16920 (16 ms): -4541.7.

Epoch 45 (12.8 s):
    Evaluating model.
    Full set (5.38 s): ELBO: 2704.3, ENRE: 2717.3, KL: 13.004.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 16958 (34 ms): 2712.6.
Step 16995 (34 ms): 2704.7.
Step 17033 (34 ms): 2660.8.
Step 17070 (34 ms): 2766.9.
Step 17108 (34 ms): 2715.5.
Step 17146 (34 ms): 2746.9.
Step 17183 (34 ms): 2683.8.
Step 17221 (34 ms): 2807.3.
Step 17258 (34 ms): 2745.1.
Step 17296 (16 ms): 45.11.

Epoch 46 (12.8 s):
    Evaluating model.
    Full set (5.32 s): ELBO: 2710, ENRE: 2722.9, KL: 12.952.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 17334 (34 ms): 2850.1.
Step 17371 (34 ms): 2776.3.
Step 17409 (35 ms): 2744.3.
Step 17446 (35 ms): 2710.3.
Step 17484 (34 ms): 2793.
Step 17522 (35 ms): 2845.4.
Step 17559 (34 ms): 2660.4.
Step 17597 (34 ms): 2686.2.
Step 17634 (34 ms): 2674.6.
Step 17672 (16 ms): 214.41.

Epoch 47 (12.9 s):
    Evaluating model.
    Full set (5.37 s): ELBO: 2696.2, ENRE: 2709.5, KL: 13.244.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 17710 (34 ms): 2791.5.
Step 17747 (34 ms): 2760.3.
Step 17785 (34 ms): 2791.1.
Step 17822 (34 ms): 2842.2.
Step 17860 (34 ms): 2736.1.
Step 17898 (33 ms): 2794.7.
Step 17935 (34 ms): 2793.4.
Step 17973 (33 ms): 2762.8.
Step 18010 (34 ms): 2763.8.
Step 18048 (16 ms): 949.87.

Epoch 48 (12.7 s):
    Evaluating model.
    Full set (5.33 s): ELBO: 2718.8, ENRE: 2731.9, KL: 13.075.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 18086 (35 ms): 2785.2.
Step 18123 (34 ms): 2620.
Step 18161 (34 ms): 2811.3.
Step 18198 (34 ms): 2638.6.
Step 18236 (33 ms): 2800.8.
Step 18274 (34 ms): 2761.8.
Step 18311 (34 ms): 2833.6.
Step 18349 (34 ms): 2710.1.
Step 18386 (34 ms): 2783.4.
Step 18424 (16 ms): -5275.7.

Epoch 49 (12.8 s):
    Evaluating model.
    Full set (5.38 s): ELBO: 2711, ENRE: 2724.2, KL: 13.199.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 18462 (33 ms): 2798.5.
Step 18499 (35 ms): 2679.3.
Step 18537 (34 ms): 2755.7.
Step 18574 (34 ms): 2749.9.
Step 18612 (34 ms): 2796.7.
Step 18650 (34 ms): 2775.2.
Step 18687 (34 ms): 2694.8.
Step 18725 (34 ms): 2700.5.
Step 18762 (33 ms): 2634.7.
Step 18800 (16 ms): -523.05.

Epoch 50 (12.7 s):
    Evaluating model.
    Full set (5.37 s): ELBO: 2725.2, ENRE: 2738.5, KL: 13.298.
    Saving model parameters.
    Model parameters saved (118 ms).

Model trained for 50 epochs (15m 21s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (10 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (855 ms).

Converting data set value array to sparse matrix.
Data set value array converted (269 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2.03 s):  ELBO: -12284, ENRE: -12270, KL: 13.239.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (787 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.5570187729130314
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 52
kl weight: 1.5570187729130314
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (50 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.05 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.65 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 52
    hidden sizes: 51, 282, 52
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.5570187729130314
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 1 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 51)
    ENCODER/1/DENSE/biases:0             (51,)
    ENCODER/1/BATCH_NORM/beta:0          (51,)
    ENCODER/2/DENSE/weights:0            (51, 282)
    ENCODER/2/DENSE/biases:0             (282,)
    ENCODER/2/BATCH_NORM/beta:0          (282,)
    ENCODER/3/DENSE/weights:0            (282, 52)
    ENCODER/3/DENSE/biases:0             (52,)
    ENCODER/3/BATCH_NORM/beta:0          (52,)
    POSTERIOR/MU/DENSE/weights:0         (52, 52)
    POSTERIOR/MU/DENSE/biases:0          (52,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (52, 52)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (52,)
    DECODER/3/DENSE/weights:0            (52, 52)
    DECODER/3/DENSE/biases:0             (52,)
    DECODER/3/BATCH_NORM/beta:0          (52,)
    DECODER/2/DENSE/weights:0            (52, 282)
    DECODER/2/DENSE/biases:0             (282,)
    DECODER/2/BATCH_NORM/beta:0          (282,)
    DECODER/1/DENSE/weights:0            (282, 51)
    DECODER/1/DENSE/biases:0             (51,)
    DECODER/1/BATCH_NORM/beta:0          (51,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (51, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (368 ms).

Training model for 50 epochs on original values.

Step 38 (26 ms): -2440.4.
Step 75 (26 ms): -2252.
Step 113 (25 ms): -2035.1.
Step 150 (25 ms): -1960.3.
Step 188 (25 ms): -1809.4.
Step 226 (25 ms): -1681.3.
Step 263 (25 ms): -1611.2.
Step 301 (24 ms): -1520.4.
Step 338 (24 ms): -1427.2.
Step 376 (13 ms): -1317.9.

Epoch 1 (11.4 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (5.41 s): ELBO: -2074.4, ENRE: -2066, KL: 8.4046.
    Saving model parameters.
    Model parameters saved (141 ms).

Step 414 (24 ms): -1273.8.
Step 451 (24 ms): -1158.1.
Step 489 (24 ms): -1122.8.
Step 526 (24 ms): -1021.3.
Step 564 (24 ms): -931.91.
Step 602 (24 ms): -883.43.
Step 639 (24 ms): -790.92.
Step 677 (24 ms): -783.9.
Step 714 (24 ms): -731.89.
Step 752 (13 ms): -844.95.

Epoch 2 (9.08 s):
    Evaluating model.
    Full set (5 s): ELBO: -1338.4, ENRE: -1333.5, KL: 4.8811.
    Saving model parameters.
    Model parameters saved (83 ms).

Step 790 (24 ms): -618.56.
Step 827 (24 ms): -613.18.
Step 865 (24 ms): -570.11.
Step 902 (25 ms): -569.
Step 940 (25 ms): -529.12.
Step 978 (24 ms): -523.13.
Step 1015 (24 ms): -520.29.
Step 1053 (24 ms): -520.59.
Step 1090 (24 ms): -471.2.
Step 1128 (12 ms): -486.23.

Epoch 3 (9.14 s):
    Evaluating model.
    Full set (4.98 s): ELBO: -859.48, ENRE: -855.58, KL: 3.8978.
    Saving model parameters.
    Model parameters saved (83 ms).

Step 1166 (24 ms): -497.15.
Step 1203 (24 ms): -450.13.
Step 1241 (24 ms): -444.94.
Step 1278 (24 ms): -408.97.
Step 1316 (24 ms): -398.18.
Step 1354 (24 ms): -434.69.
Step 1391 (24 ms): -422.97.
Step 1429 (24 ms): -409.88.
Step 1466 (23 ms): -373.29.
Step 1504 (11 ms): -373.65.

Epoch 4 (9 s):
    Evaluating model.
    Full set (4.9 s): ELBO: -590.97, ENRE: -586.76, KL: 4.2094.
    Saving model parameters.
    Model parameters saved (84 ms).

Step 1542 (24 ms): -401.72.
Step 1579 (24 ms): -379.48.
Step 1617 (24 ms): -354.04.
Step 1654 (24 ms): -357.09.
Step 1692 (24 ms): -352.03.
Step 1730 (25 ms): -344.11.
Step 1767 (24 ms): -354.19.
Step 1805 (25 ms): -370.42.
Step 1842 (24 ms): -375.8.
Step 1880 (11 ms): -434.56.

Epoch 5 (9.09 s):
    Evaluating model.
    Full set (5 s): ELBO: -466.49, ENRE: -461.83, KL: 4.6645.
    Saving model parameters.
    Model parameters saved (86 ms).

Step 1918 (24 ms): -363.93.
Step 1955 (24 ms): -341.2.
Step 1993 (24 ms): -298.37.
Step 2030 (24 ms): -320.63.
Step 2068 (24 ms): -333.94.
Step 2106 (25 ms): -311.08.
Step 2143 (24 ms): -319.78.
Step 2181 (24 ms): -325.63.
Step 2218 (24 ms): -305.88.
Step 2256 (11 ms): -373.24.

Epoch 6 (9.07 s):
    Evaluating model.
    Full set (4.91 s): ELBO: -404.12, ENRE: -399.84, KL: 4.2836.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 2294 (24 ms): -315.36.
Step 2331 (23 ms): -307.56.
Step 2369 (24 ms): -275.4.
Step 2406 (24 ms): -287.97.
Step 2444 (24 ms): -303.16.
Step 2482 (24 ms): -306.04.
Step 2519 (24 ms): -296.78.
Step 2557 (24 ms): -289.32.
Step 2594 (24 ms): -282.11.
Step 2632 (11 ms): -425.52.

Epoch 7 (8.97 s):
    Evaluating model.
    Full set (4.99 s): ELBO: -362.64, ENRE: -358.43, KL: 4.2104.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 2670 (24 ms): -261.27.
Step 2707 (24 ms): -282.17.
Step 2745 (24 ms): -273.22.
Step 2782 (24 ms): -297.4.
Step 2820 (24 ms): -276.22.
Step 2858 (24 ms): -271.45.
Step 2895 (24 ms): -295.4.
Step 2933 (25 ms): -265.14.
Step 2970 (24 ms): -286.59.
Step 3008 (14 ms): -255.2.

Epoch 8 (9.12 s):
    Evaluating model.
    Full set (5 s): ELBO: -318.56, ENRE: -314.16, KL: 4.4008.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 3046 (24 ms): -260.55.
Step 3083 (24 ms): -260.78.
Step 3121 (24 ms): -270.39.
Step 3158 (24 ms): -284.01.
Step 3196 (24 ms): -244.23.
Step 3234 (25 ms): -243.98.
Step 3271 (24 ms): -268.87.
Step 3309 (24 ms): -248.59.
Step 3346 (24 ms): -257.21.
Step 3384 (12 ms): -234.41.

Epoch 9 (9.05 s):
    Evaluating model.
    Full set (4.89 s): ELBO: -289.41, ENRE: -284.52, KL: 4.8861.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 3422 (24 ms): -250.09.
Step 3459 (24 ms): -241.45.
Step 3497 (24 ms): -263.7.
Step 3534 (24 ms): -251.91.
Step 3572 (25 ms): -245.54.
Step 3610 (24 ms): -244.21.
Step 3647 (24 ms): -266.09.
Step 3685 (24 ms): -252.75.
Step 3722 (24 ms): -257.52.
Step 3760 (11 ms): -518.38.

Epoch 10 (9.11 s):
    Evaluating model.
    Full set (4.99 s): ELBO: -270.36, ENRE: -265.27, KL: 5.0954.
    Saving model parameters.
    Model parameters saved (87 ms).

Step 3798 (24 ms): -247.39.
Step 3835 (24 ms): -242.95.
Step 3873 (24 ms): -229.75.
Step 3910 (24 ms): -239.27.
Step 3948 (24 ms): -238.2.
Step 3986 (24 ms): -235.68.
Step 4023 (24 ms): -228.48.
Step 4061 (24 ms): -235.16.
Step 4098 (24 ms): -257.52.
Step 4136 (11 ms): -202.81.

Epoch 11 (9.09 s):
    Evaluating model.
    Full set (4.93 s): ELBO: -255.82, ENRE: -250.53, KL: 5.2961.
    Saving model parameters.
    Model parameters saved (86 ms).

Step 4174 (24 ms): -236.02.
Step 4211 (24 ms): -244.34.
Step 4249 (24 ms): -261.78.
Step 4286 (24 ms): -238.73.
Step 4324 (24 ms): -233.28.
Step 4362 (24 ms): -249.26.
Step 4399 (24 ms): -226.15.
Step 4437 (24 ms): -233.03.
Step 4474 (24 ms): -248.48.
Step 4512 (11 ms): -200.05.

Epoch 12 (9.01 s):
    Evaluating model.
    Full set (5 s): ELBO: -245.44, ENRE: -239.82, KL: 5.616.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 4550 (24 ms): -226.1.
Step 4587 (24 ms): -218.69.
Step 4625 (24 ms): -224.15.
Step 4662 (24 ms): -277.48.
Step 4700 (24 ms): -238.94.
Step 4738 (24 ms): -235.71.
Step 4775 (24 ms): -227.08.
Step 4813 (25 ms): -233.74.
Step 4850 (24 ms): -221.91.
Step 4888 (11 ms): -175.11.

Epoch 13 (9.11 s):
    Evaluating model.
    Full set (5 s): ELBO: -237.25, ENRE: -231.68, KL: 5.575.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 4926 (24 ms): -224.74.
Step 4963 (25 ms): -223.16.
Step 5001 (24 ms): -229.51.
Step 5038 (24 ms): -235.21.
Step 5076 (24 ms): -240.19.
Step 5114 (24 ms): -237.92.
Step 5151 (23 ms): -226.36.
Step 5189 (24 ms): -225.01.
Step 5226 (24 ms): -210.98.
Step 5264 (11 ms): -308.76.

Epoch 14 (9.03 s):
    Evaluating model.
    Full set (4.89 s): ELBO: -231.68, ENRE: -225.98, KL: 5.7003.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 5302 (24 ms): -246.59.
Step 5339 (24 ms): -222.37.
Step 5377 (24 ms): -218.66.
Step 5414 (24 ms): -226.81.
Step 5452 (25 ms): -250.85.
Step 5490 (24 ms): -220.99.
Step 5527 (24 ms): -210.9.
Step 5565 (24 ms): -222.29.
Step 5602 (25 ms): -228.24.
Step 5640 (12 ms): -183.99.

Epoch 15 (9.05 s):
    Evaluating model.
    Full set (4.98 s): ELBO: -227.7, ENRE: -221.74, KL: 5.9625.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 5678 (24 ms): -247.3.
Step 5715 (24 ms): -230.54.
Step 5753 (24 ms): -229.2.
Step 5790 (24 ms): -226.29.
Step 5828 (24 ms): -224.63.
Step 5866 (24 ms): -211.42.
Step 5903 (24 ms): -229.92.
Step 5941 (24 ms): -215.76.
Step 5978 (24 ms): -228.96.
Step 6016 (12 ms): -232.07.

Epoch 16 (9.09 s):
    Evaluating model.
    Full set (4.95 s): ELBO: -225.21, ENRE: -219.41, KL: 5.8019.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 6054 (24 ms): -227.03.
Step 6091 (24 ms): -241.63.
Step 6129 (24 ms): -214.44.
Step 6166 (24 ms): -225.27.
Step 6204 (24 ms): -239.2.
Step 6242 (24 ms): -230.58.
Step 6279 (24 ms): -218.09.
Step 6317 (24 ms): -222.98.
Step 6354 (24 ms): -222.73.
Step 6392 (12 ms): -265.85.

Epoch 17 (8.99 s):
    Evaluating model.
    Full set (4.96 s): ELBO: -223.59, ENRE: -217.71, KL: 5.8883.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 6430 (24 ms): -218.62.
Step 6467 (24 ms): -210.54.
Step 6505 (24 ms): -223.3.
Step 6542 (24 ms): -213.02.
Step 6580 (24 ms): -206.2.
Step 6618 (24 ms): -236.11.
Step 6655 (25 ms): -248.28.
Step 6693 (24 ms): -210.75.
Step 6730 (24 ms): -231.33.
Step 6768 (11 ms): -258.35.

Epoch 18 (9.13 s):
    Evaluating model.
    Full set (5 s): ELBO: -221.92, ENRE: -215.99, KL: 5.9358.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 6806 (24 ms): -228.35.
Step 6843 (25 ms): -224.16.
Step 6881 (24 ms): -204.25.
Step 6918 (25 ms): -207.59.
Step 6956 (24 ms): -216.39.
Step 6994 (24 ms): -216.57.
Step 7031 (24 ms): -215.25.
Step 7069 (23 ms): -211.91.
Step 7106 (24 ms): -209.59.
Step 7144 (11 ms): -219.26.

Epoch 19 (9.07 s):
    Evaluating model.
    Full set (4.89 s): ELBO: -221.11, ENRE: -215.26, KL: 5.8466.
    Saving model parameters.
    Model parameters saved (85 ms).

Step 7182 (23 ms): -212.51.
Step 7219 (23 ms): -223.7.
Step 7257 (25 ms): -218.67.
Step 7294 (24 ms): -217.76.
Step 7332 (24 ms): -232.42.
Step 7370 (24 ms): -210.76.
Step 7407 (24 ms): -201.45.
Step 7445 (24 ms): -220.5.
Step 7482 (24 ms): -227.09.
Step 7520 (12 ms): -207.12.

Epoch 20 (9.04 s):
    Evaluating model.
    Full set (4.99 s): ELBO: -218.84, ENRE: -213.08, KL: 5.761.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 7558 (24 ms): -231.
Step 7595 (24 ms): -218.34.
Step 7633 (24 ms): -221.48.
Step 7670 (24 ms): -216.36.
Step 7708 (25 ms): -211.73.
Step 7746 (24 ms): -221.55.
Step 7783 (24 ms): -227.26.
Step 7821 (24 ms): -223.99.
Step 7858 (24 ms): -201.98.
Step 7896 (11 ms): -304.7.

Epoch 21 (9.11 s):
    Evaluating model.
    Full set (4.98 s): ELBO: -218.68, ENRE: -212.99, KL: 5.6873.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 7934 (24 ms): -239.38.
Step 7971 (24 ms): -234.09.
Step 8009 (24 ms): -217.71.
Step 8046 (24 ms): -211.86.
Step 8084 (24 ms): -218.49.
Step 8122 (23 ms): -214.98.
Step 8159 (24 ms): -210.91.
Step 8197 (24 ms): -210.5.
Step 8234 (24 ms): -205.61.
Step 8272 (11 ms): -211.56.

Epoch 22 (9 s):
    Evaluating model.
    Full set (4.93 s): ELBO: -217.66, ENRE: -212.03, KL: 5.6342.
    Saving model parameters.
    Model parameters saved (86 ms).

Step 8310 (25 ms): -219.42.
Step 8347 (24 ms): -221.16.
Step 8385 (24 ms): -211.24.
Step 8422 (24 ms): -214.98.
Step 8460 (24 ms): -228.71.
Step 8498 (24 ms): -209.08.
Step 8535 (24 ms): -213.04.
Step 8573 (24 ms): -218.78.
Step 8610 (24 ms): -212.73.
Step 8648 (12 ms): -202.28.

Epoch 23 (9.1 s):
    Evaluating model.
    Full set (4.98 s): ELBO: -216.05, ENRE: -210.58, KL: 5.4709.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 8686 (24 ms): -202.03.
Step 8723 (24 ms): -226.88.
Step 8761 (24 ms): -200.43.
Step 8798 (24 ms): -204.32.
Step 8836 (25 ms): -218.12.
Step 8874 (24 ms): -213.16.
Step 8911 (23 ms): -226.77.
Step 8949 (24 ms): -211.28.
Step 8986 (24 ms): -195.07.
Step 9024 (11 ms): -319.69.

Epoch 24 (9.05 s):
    Evaluating model.
    Full set (4.93 s): ELBO: -214.67, ENRE: -209.21, KL: 5.467.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 9062 (24 ms): -218.33.
Step 9099 (24 ms): -218.83.
Step 9137 (24 ms): -217.92.
Step 9174 (24 ms): -216.34.
Step 9212 (24 ms): -208.76.
Step 9250 (24 ms): -210.47.
Step 9287 (24 ms): -223.77.
Step 9325 (24 ms): -210.02.
Step 9362 (24 ms): -198.48.
Step 9400 (11 ms): -349.91.

Epoch 25 (9.02 s):
    Evaluating model.
    Full set (4.99 s): ELBO: -213.7, ENRE: -208.37, KL: 5.3338.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 9438 (24 ms): -205.81.
Step 9475 (25 ms): -206.76.
Step 9513 (24 ms): -216.71.
Step 9550 (24 ms): -229.25.
Step 9588 (24 ms): -199.7.
Step 9626 (24 ms): -224.24.
Step 9663 (24 ms): -191.4.
Step 9701 (25 ms): -195.8.
Step 9738 (24 ms): -210.84.
Step 9776 (12 ms): -351.87.

Epoch 26 (9.09 s):
    Evaluating model.
    Full set (4.99 s): ELBO: -213.37, ENRE: -208.14, KL: 5.2311.
    Saving model parameters.
    Model parameters saved (84 ms).

Step 9814 (24 ms): -200.08.
Step 9851 (24 ms): -222.82.
Step 9889 (24 ms): -197.87.
Step 9926 (24 ms): -207.9.
Step 9964 (24 ms): -209.4.
Step 10002 (24 ms): -207.46.
Step 10039 (24 ms): -224.84.
Step 10077 (24 ms): -206.75.
Step 10114 (24 ms): -207.35.
Step 10152 (11 ms): -427.32.

Epoch 27 (9.02 s):
    Evaluating model.
    Full set (4.89 s): ELBO: -212.18, ENRE: -206.9, KL: 5.2797.
    Saving model parameters.
    Model parameters saved (84 ms).

Step 10190 (24 ms): -211.46.
Step 10227 (25 ms): -193.57.
Step 10265 (24 ms): -215.07.
Step 10302 (24 ms): -226.72.
Step 10340 (25 ms): -217.29.
Step 10378 (25 ms): -220.84.
Step 10415 (24 ms): -210.93.
Step 10453 (24 ms): -212.89.
Step 10490 (24 ms): -216.08.
Step 10528 (11 ms): -233.56.

Epoch 28 (9.11 s):
    Evaluating model.
    Full set (4.99 s): ELBO: -211.64, ENRE: -206.54, KL: 5.0993.
    Saving model parameters.
    Model parameters saved (84 ms).

Step 10566 (25 ms): -209.64.
Step 10603 (24 ms): -201.66.
Step 10641 (24 ms): -215.1.
Step 10678 (24 ms): -218.41.
Step 10716 (24 ms): -206.58.
Step 10754 (24 ms): -216.88.
Step 10791 (24 ms): -220.65.
Step 10829 (24 ms): -208.25.
Step 10866 (24 ms): -194.93.
Step 10904 (11 ms): -320.14.

Epoch 29 (9.09 s):
    Evaluating model.
    Full set (4.92 s): ELBO: -210.86, ENRE: -205.76, KL: 5.0957.
    Saving model parameters.
    Model parameters saved (84 ms).

Step 10942 (24 ms): -211.69.
Step 10979 (23 ms): -206.87.
Step 11017 (24 ms): -207.84.
Step 11054 (24 ms): -197.2.
Step 11092 (24 ms): -206.85.
Step 11130 (24 ms): -196.17.
Step 11167 (24 ms): -224.31.
Step 11205 (25 ms): -217.98.
Step 11242 (25 ms): -204.63.
Step 11280 (11 ms): -394.78.

Epoch 30 (8.99 s):
    Evaluating model.
    Full set (5 s): ELBO: -210.55, ENRE: -205.47, KL: 5.0722.
    Saving model parameters.
    Model parameters saved (84 ms).

Step 11318 (24 ms): -197.91.
Step 11355 (24 ms): -205.22.
Step 11393 (24 ms): -217.46.
Step 11430 (24 ms): -195.91.
Step 11468 (24 ms): -199.56.
Step 11506 (24 ms): -215.31.
Step 11543 (24 ms): -211.31.
Step 11581 (24 ms): -227.03.
Step 11618 (24 ms): -215.4.
Step 11656 (12 ms): -231.94.

Epoch 31 (9.11 s):
    Evaluating model.
    Full set (5 s): ELBO: -210.03, ENRE: -205.02, KL: 5.0083.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 11694 (24 ms): -213.88.
Step 11731 (24 ms): -199.52.
Step 11769 (24 ms): -202.84.
Step 11806 (24 ms): -201.94.
Step 11844 (24 ms): -220.93.
Step 11882 (24 ms): -205.44.
Step 11919 (24 ms): -208.44.
Step 11957 (24 ms): -206.34.
Step 11994 (24 ms): -230.69.
Step 12032 (11 ms): -463.45.

Epoch 32 (9.02 s):
    Evaluating model.
    Full set (4.88 s): ELBO: -209.4, ENRE: -204.36, KL: 5.0457.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 12070 (24 ms): -204.03.
Step 12107 (24 ms): -230.01.
Step 12145 (24 ms): -220.97.
Step 12182 (24 ms): -204.16.
Step 12220 (24 ms): -215.42.
Step 12258 (24 ms): -204.63.
Step 12295 (24 ms): -207.79.
Step 12333 (24 ms): -186.53.
Step 12370 (24 ms): -209.92.
Step 12408 (11 ms): -222.15.

Epoch 33 (9.06 s):
    Evaluating model.
    Full set (5 s): ELBO: -209, ENRE: -204.04, KL: 4.9595.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 12446 (24 ms): -213.41.
Step 12483 (25 ms): -218.83.
Step 12521 (24 ms): -203.76.
Step 12558 (24 ms): -225.81.
Step 12596 (24 ms): -214.06.
Step 12634 (24 ms): -202.3.
Step 12671 (24 ms): -214.84.
Step 12709 (24 ms): -202.34.
Step 12746 (24 ms): -201.51.
Step 12784 (11 ms): -249.23.

Epoch 34 (9.08 s):
    Evaluating model.
    Full set (4.93 s): ELBO: -209.18, ENRE: -204.31, KL: 4.8645.
    Saving model parameters.
    Model parameters saved (83 ms).

Step 12822 (24 ms): -201.82.
Step 12859 (24 ms): -199.42.
Step 12897 (24 ms): -202.49.
Step 12934 (24 ms): -205.73.
Step 12972 (24 ms): -213.35.
Step 13010 (24 ms): -208.5.
Step 13047 (24 ms): -201.41.
Step 13085 (24 ms): -208.2.
Step 13122 (24 ms): -218.6.
Step 13160 (12 ms): -195.68.

Epoch 35 (8.98 s):
    Evaluating model.
    Full set (4.94 s): ELBO: -208.48, ENRE: -203.52, KL: 4.958.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 13198 (25 ms): -202.69.
Step 13235 (24 ms): -205.41.
Step 13273 (24 ms): -212.36.
Step 13310 (24 ms): -219.17.
Step 13348 (24 ms): -207.4.
Step 13386 (24 ms): -201.88.
Step 13423 (24 ms): -203.85.
Step 13461 (25 ms): -210.45.
Step 13498 (24 ms): -208.59.
Step 13536 (11 ms): -183.

Epoch 36 (9.1 s):
    Evaluating model.
    Full set (5 s): ELBO: -208.19, ENRE: -203.31, KL: 4.875.
    Saving model parameters.
    Model parameters saved (86 ms).

Step 13574 (25 ms): -210.04.
Step 13611 (24 ms): -209.97.
Step 13649 (24 ms): -197.23.
Step 13686 (24 ms): -197.19.
Step 13724 (24 ms): -215.22.
Step 13762 (24 ms): -208.64.
Step 13799 (24 ms): -203.9.
Step 13837 (24 ms): -203.26.
Step 13874 (24 ms): -209.21.
Step 13912 (11 ms): -174.29.

Epoch 37 (9.09 s):
    Evaluating model.
    Full set (4.91 s): ELBO: -207.67, ENRE: -202.74, KL: 4.9324.
    Saving model parameters.
    Model parameters saved (85 ms).

Step 13950 (23 ms): -222.39.
Step 13987 (24 ms): -211.21.
Step 14025 (24 ms): -194.02.
Step 14062 (23 ms): -217.34.
Step 14100 (24 ms): -209.91.
Step 14138 (23 ms): -212.2.
Step 14175 (24 ms): -213.12.
Step 14213 (24 ms): -205.14.
Step 14250 (24 ms): -211.14.
Step 14288 (12 ms): -241.36.

Epoch 38 (9.02 s):
    Evaluating model.
    Full set (5 s): ELBO: -207.13, ENRE: -202.21, KL: 4.9192.
    Saving model parameters.
    Model parameters saved (85 ms).

Step 14326 (24 ms): -209.28.
Step 14363 (24 ms): -203.07.
Step 14401 (24 ms): -214.86.
Step 14438 (24 ms): -206.65.
Step 14476 (25 ms): -199.17.
Step 14514 (24 ms): -202.06.
Step 14551 (24 ms): -199.44.
Step 14589 (24 ms): -195.86.
Step 14626 (24 ms): -208.95.
Step 14664 (12 ms): -240.87.

Epoch 39 (9.11 s):
    Evaluating model.
    Full set (4.97 s): ELBO: -207.01, ENRE: -202.09, KL: 4.9254.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 14702 (24 ms): -198.78.
Step 14739 (24 ms): -195.15.
Step 14777 (24 ms): -191.91.
Step 14814 (24 ms): -211.5.
Step 14852 (25 ms): -206.15.
Step 14890 (24 ms): -209.72.
Step 14927 (23 ms): -199.69.
Step 14965 (24 ms): -210.44.
Step 15002 (23 ms): -218.64.
Step 15040 (11 ms): -186.62.

Epoch 40 (9.02 s):
    Evaluating model.
    Full set (4.88 s): ELBO: -206.7, ENRE: -201.74, KL: 4.9512.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 15078 (25 ms): -212.05.
Step 15115 (24 ms): -204.27.
Step 15153 (24 ms): -218.3.
Step 15190 (24 ms): -201.32.
Step 15228 (24 ms): -210.69.
Step 15266 (24 ms): -202.2.
Step 15303 (24 ms): -199.72.
Step 15341 (24 ms): -207.23.
Step 15378 (24 ms): -205.19.
Step 15416 (11 ms): -296.3.

Epoch 41 (9.1 s):
    Evaluating model.
    Full set (4.98 s): ELBO: -206.31, ENRE: -201.45, KL: 4.8581.
    Saving model parameters.
    Model parameters saved (85 ms).

Step 15454 (24 ms): -232.1.
Step 15491 (24 ms): -196.85.
Step 15529 (24 ms): -209.02.
Step 15566 (24 ms): -208.12.
Step 15604 (24 ms): -196.36.
Step 15642 (24 ms): -210.69.
Step 15679 (24 ms): -212.66.
Step 15717 (24 ms): -200.88.
Step 15754 (24 ms): -217.61.
Step 15792 (11 ms): -201.67.

Epoch 42 (9.06 s):
    Evaluating model.
    Full set (4.91 s): ELBO: -206.27, ENRE: -201.39, KL: 4.877.
    Saving model parameters.
    Model parameters saved (87 ms).

Step 15830 (23 ms): -208.
Step 15867 (24 ms): -220.98.
Step 15905 (24 ms): -206.48.
Step 15942 (23 ms): -191.51.
Step 15980 (23 ms): -193.1.
Step 16018 (24 ms): -205.3.
Step 16055 (24 ms): -213.35.
Step 16093 (24 ms): -200.17.
Step 16130 (25 ms): -211.33.
Step 16168 (11 ms): -241.19.

Epoch 43 (8.93 s):
    Evaluating model.
    Full set (4.99 s): ELBO: -206.12, ENRE: -201.31, KL: 4.807.
    Saving model parameters.
    Model parameters saved (85 ms).

Step 16206 (24 ms): -209.72.
Step 16243 (25 ms): -208.25.
Step 16281 (24 ms): -203.44.
Step 16318 (24 ms): -200.08.
Step 16356 (24 ms): -203.94.
Step 16394 (24 ms): -206.87.
Step 16431 (24 ms): -195.15.
Step 16469 (24 ms): -192.66.
Step 16506 (24 ms): -220.44.
Step 16544 (11 ms): -245.23.

Epoch 44 (9.06 s):
    Evaluating model.
    Full set (4.96 s): ELBO: -205.74, ENRE: -200.89, KL: 4.847.
    Saving model parameters.
    Model parameters saved (86 ms).

Step 16582 (25 ms): -210.33.
Step 16619 (24 ms): -208.26.
Step 16657 (24 ms): -217.79.
Step 16694 (24 ms): -205.43.
Step 16732 (23 ms): -194.3.
Step 16770 (24 ms): -220.18.
Step 16807 (24 ms): -205.71.
Step 16845 (24 ms): -205.6.
Step 16882 (23 ms): -215.57.
Step 16920 (11 ms): -212.01.

Epoch 45 (8.97 s):
    Evaluating model.
    Full set (4.81 s): ELBO: -205.71, ENRE: -200.93, KL: 4.7817.
    Saving model parameters.
    Model parameters saved (85 ms).

Step 16958 (24 ms): -206.32.
Step 16995 (24 ms): -195.81.
Step 17033 (24 ms): -206.16.
Step 17070 (24 ms): -197.42.
Step 17108 (24 ms): -214.78.
Step 17146 (24 ms): -202.66.
Step 17183 (25 ms): -203.54.
Step 17221 (24 ms): -205.46.
Step 17258 (24 ms): -205.34.
Step 17296 (11 ms): -204.34.

Epoch 46 (9.03 s):
    Evaluating model.
    Full set (4.98 s): ELBO: -205.66, ENRE: -200.84, KL: 4.8215.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 17334 (24 ms): -210.32.
Step 17371 (24 ms): -198.53.
Step 17409 (24 ms): -221.12.
Step 17446 (24 ms): -208.81.
Step 17484 (24 ms): -198.81.
Step 17522 (24 ms): -197.01.
Step 17559 (24 ms): -208.83.
Step 17597 (24 ms): -211.56.
Step 17634 (25 ms): -204.77.
Step 17672 (12 ms): -204.45.

Epoch 47 (9.11 s):
    Evaluating model.
    Full set (4.9 s): ELBO: -205.06, ENRE: -200.2, KL: 4.8681.
    Saving model parameters.
    Model parameters saved (85 ms).

Step 17710 (25 ms): -196.51.
Step 17747 (25 ms): -212.06.
Step 17785 (24 ms): -211.71.
Step 17822 (24 ms): -206.89.
Step 17860 (24 ms): -202.66.
Step 17898 (23 ms): -192.48.
Step 17935 (23 ms): -202.63.
Step 17973 (24 ms): -200.18.
Step 18010 (24 ms): -205.48.
Step 18048 (11 ms): -356.39.

Epoch 48 (8.9 s):
    Evaluating model.
    Full set (4.93 s): ELBO: -204.98, ENRE: -200.14, KL: 4.8351.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 18086 (24 ms): -205.7.
Step 18123 (24 ms): -200.77.
Step 18161 (24 ms): -195.19.
Step 18198 (24 ms): -202.21.
Step 18236 (24 ms): -192.19.
Step 18274 (24 ms): -202.81.
Step 18311 (24 ms): -215.24.
Step 18349 (24 ms): -204.51.
Step 18386 (26 ms): -215.87.
Step 18424 (11 ms): -383.44.

Epoch 49 (9.07 s):
    Evaluating model.
    Full set (4.97 s): ELBO: -204.76, ENRE: -199.92, KL: 4.8417.
    Saving model parameters.
    Model parameters saved (84 ms).

Step 18462 (24 ms): -204.64.
Step 18499 (25 ms): -206.21.
Step 18537 (24 ms): -206.47.
Step 18574 (24 ms): -213.04.
Step 18612 (24 ms): -208.33.
Step 18650 (24 ms): -214.14.
Step 18687 (23 ms): -202.92.
Step 18725 (24 ms): -202.97.
Step 18762 (24 ms): -206.06.
Step 18800 (11 ms): -196.43.

Epoch 50 (9.06 s):
    Evaluating model.
    Full set (4.84 s): ELBO: -204.78, ENRE: -199.98, KL: 4.8001.
    Saving model parameters.
    Model parameters saved (84 ms).

Model trained for 50 epochs (11m 48s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (9 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (859 ms).

Converting data set value array to sparse matrix.
Data set value array converted (272 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.55 s):  ELBO: -410.24, ENRE: -405.44, KL: 4.8018.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (510 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.4364513603512523
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 62
kl weight: 1.4364513603512523
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (46 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.02 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.65 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 62
    hidden sizes: 124, 230, 104, 246
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.4364513603512523
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 2 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 124)
    ENCODER/1/DENSE/biases:0             (124,)
    ENCODER/1/BATCH_NORM/beta:0          (124,)
    ENCODER/2/DENSE/weights:0            (124, 230)
    ENCODER/2/DENSE/biases:0             (230,)
    ENCODER/2/BATCH_NORM/beta:0          (230,)
    ENCODER/3/DENSE/weights:0            (230, 104)
    ENCODER/3/DENSE/biases:0             (104,)
    ENCODER/3/BATCH_NORM/beta:0          (104,)
    ENCODER/4/DENSE/weights:0            (104, 246)
    ENCODER/4/DENSE/biases:0             (246,)
    ENCODER/4/BATCH_NORM/beta:0          (246,)
    POSTERIOR/MU/DENSE/weights:0         (246, 62)
    POSTERIOR/MU/DENSE/biases:0          (62,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (246, 62)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (62,)
    DECODER/4/DENSE/weights:0            (62, 246)
    DECODER/4/DENSE/biases:0             (246,)
    DECODER/4/BATCH_NORM/beta:0          (246,)
    DECODER/3/DENSE/weights:0            (246, 104)
    DECODER/3/DENSE/biases:0             (104,)
    DECODER/3/BATCH_NORM/beta:0          (104,)
    DECODER/2/DENSE/weights:0            (104, 230)
    DECODER/2/DENSE/biases:0             (230,)
    DECODER/2/BATCH_NORM/beta:0          (230,)
    DECODER/1/DENSE/weights:0            (230, 124)
    DECODER/1/DENSE/biases:0             (124,)
    DECODER/1/BATCH_NORM/beta:0          (124,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (124, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (710 ms).

Training model for 50 epochs on original values.

Step 38 (30 ms): -2399.9.
Step 75 (30 ms): -2070.4.
Step 113 (30 ms): -1851.4.
Step 150 (31 ms): -1644.8.
Step 188 (31 ms): -1471.2.
Step 226 (31 ms): -1320.3.
Step 263 (30 ms): -1218.
Step 301 (30 ms): -1149.9.
Step 338 (30 ms): -1055.4.
Step 376 (16 ms): -969.99.

Epoch 1 (14 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.08 s): ELBO: -1871.2, ENRE: -1848.6, KL: 22.623.
    Saving model parameters.
    Model parameters saved (172 ms).

Step 414 (30 ms): -724.14.
Step 451 (30 ms): -626.8.
Step 489 (30 ms): -570.5.
Step 526 (30 ms): -508.81.
Step 564 (30 ms): -493.14.
Step 602 (30 ms): -459.56.
Step 639 (31 ms): -419.39.
Step 677 (30 ms): -419.65.
Step 714 (31 ms): -386.05.
Step 752 (15 ms): -485.4.

Epoch 2 (11.4 s):
    Warm-up weight: 0.5
    Evaluating model.
    Full set (5.6 s): ELBO: -972.03, ENRE: -955.86, KL: 16.165.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 790 (31 ms): -352.7.
Step 827 (30 ms): -356.74.
Step 865 (31 ms): -335.23.
Step 902 (31 ms): -326.89.
Step 940 (31 ms): -325.26.
Step 978 (31 ms): -328.58.
Step 1015 (30 ms): -304.78.
Step 1053 (30 ms): -345.24.
Step 1090 (31 ms): -293.15.
Step 1128 (14 ms): -297.24.

Epoch 3 (11.5 s):
    Evaluating model.
    Full set (5.54 s): ELBO: -545.06, ENRE: -534.93, KL: 10.134.
    Saving model parameters.
    Model parameters saved (101 ms).

Step 1166 (30 ms): -297.31.
Step 1203 (30 ms): -298.57.
Step 1241 (30 ms): -291.52.
Step 1278 (30 ms): -285.48.
Step 1316 (30 ms): -299.99.
Step 1354 (31 ms): -270.05.
Step 1391 (30 ms): -266.28.
Step 1429 (31 ms): -257.73.
Step 1466 (30 ms): -274.33.
Step 1504 (14 ms): -404.81.

Epoch 4 (11.4 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -370.74, ENRE: -362.74, KL: 8.
    Saving model parameters.
    Model parameters saved (101 ms).

Step 1542 (31 ms): -286.83.
Step 1579 (30 ms): -270.3.
Step 1617 (30 ms): -253.33.
Step 1654 (31 ms): -272.31.
Step 1692 (31 ms): -277.49.
Step 1730 (31 ms): -251.63.
Step 1767 (30 ms): -242.91.
Step 1805 (30 ms): -247.83.
Step 1842 (31 ms): -262.65.
Step 1880 (14 ms): -245.74.

Epoch 5 (11.5 s):
    Evaluating model.
    Full set (5.53 s): ELBO: -302.71, ENRE: -295.18, KL: 7.528.
    Saving model parameters.
    Model parameters saved (100 ms).

Step 1918 (30 ms): -262.22.
Step 1955 (30 ms): -232.4.
Step 1993 (29 ms): -269.99.
Step 2030 (30 ms): -245.3.
Step 2068 (30 ms): -246.57.
Step 2106 (30 ms): -249.65.
Step 2143 (30 ms): -228.68.
Step 2181 (31 ms): -244.25.
Step 2218 (31 ms): -247.88.
Step 2256 (14 ms): -226.16.

Epoch 6 (11.4 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -269.87, ENRE: -262.59, KL: 7.2865.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 2294 (31 ms): -226.29.
Step 2331 (31 ms): -223.63.
Step 2369 (31 ms): -229.51.
Step 2406 (32 ms): -242.
Step 2444 (30 ms): -232.05.
Step 2482 (31 ms): -230.74.
Step 2519 (30 ms): -235.
Step 2557 (31 ms): -224.92.
Step 2594 (30 ms): -236.63.
Step 2632 (15 ms): -314.34.

Epoch 7 (11.5 s):
    Evaluating model.
    Full set (5.57 s): ELBO: -252.37, ENRE: -245.62, KL: 6.7543.
    Saving model parameters.
    Model parameters saved (99 ms).

Step 2670 (30 ms): -230.51.
Step 2707 (30 ms): -221.58.
Step 2745 (29 ms): -233.54.
Step 2782 (29 ms): -241.76.
Step 2820 (29 ms): -228.88.
Step 2858 (31 ms): -231.3.
Step 2895 (30 ms): -232.72.
Step 2933 (30 ms): -219.09.
Step 2970 (30 ms): -208.77.
Step 3008 (14 ms): -238.33.

Epoch 8 (11.3 s):
    Evaluating model.
    Full set (5.58 s): ELBO: -241.5, ENRE: -234.64, KL: 6.8578.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 3046 (30 ms): -217.08.
Step 3083 (31 ms): -220.9.
Step 3121 (30 ms): -216.65.
Step 3158 (30 ms): -209.67.
Step 3196 (30 ms): -216.4.
Step 3234 (30 ms): -223.59.
Step 3271 (31 ms): -229.13.
Step 3309 (30 ms): -244.05.
Step 3346 (30 ms): -212.64.
Step 3384 (14 ms): -237.56.

Epoch 9 (11.4 s):
    Evaluating model.
    Full set (5.57 s): ELBO: -233.58, ENRE: -226.6, KL: 6.9839.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 3422 (30 ms): -213.06.
Step 3459 (30 ms): -221.64.
Step 3497 (30 ms): -217.52.
Step 3534 (30 ms): -224.23.
Step 3572 (30 ms): -224.08.
Step 3610 (30 ms): -229.69.
Step 3647 (30 ms): -209.51.
Step 3685 (30 ms): -225.77.
Step 3722 (31 ms): -222.62.
Step 3760 (14 ms): -307.3.

Epoch 10 (11.3 s):
    Evaluating model.
    Full set (5.55 s): ELBO: -227.21, ENRE: -220.14, KL: 7.0739.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 3798 (31 ms): -226.07.
Step 3835 (31 ms): -222.58.
Step 3873 (30 ms): -219.79.
Step 3910 (31 ms): -238.28.
Step 3948 (31 ms): -225.13.
Step 3986 (31 ms): -211.36.
Step 4023 (30 ms): -220.21.
Step 4061 (31 ms): -227.71.
Step 4098 (31 ms): -220.05.
Step 4136 (14 ms): -287.99.

Epoch 11 (11.5 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -224.1, ENRE: -217.2, KL: 6.8968.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 4174 (31 ms): -209.48.
Step 4211 (30 ms): -222.18.
Step 4249 (30 ms): -213.48.
Step 4286 (30 ms): -222.
Step 4324 (30 ms): -219.35.
Step 4362 (31 ms): -225.91.
Step 4399 (30 ms): -219.52.
Step 4437 (30 ms): -221.78.
Step 4474 (31 ms): -212.88.
Step 4512 (14 ms): -259.82.

Epoch 12 (11.4 s):
    Evaluating model.
    Full set (5.53 s): ELBO: -222.21, ENRE: -215.5, KL: 6.7122.
    Saving model parameters.
    Model parameters saved (100 ms).

Step 4550 (31 ms): -227.38.
Step 4587 (30 ms): -206.66.
Step 4625 (30 ms): -212.36.
Step 4662 (30 ms): -217.53.
Step 4700 (31 ms): -239.21.
Step 4738 (32 ms): -203.2.
Step 4775 (31 ms): -217.19.
Step 4813 (30 ms): -213.6.
Step 4850 (31 ms): -207.3.
Step 4888 (14 ms): -242.15.

Epoch 13 (11.5 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -219.87, ENRE: -213.54, KL: 6.3281.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 4926 (31 ms): -216.15.
Step 4963 (30 ms): -218.75.
Step 5001 (30 ms): -210.37.
Step 5038 (30 ms): -214.34.
Step 5076 (30 ms): -211.1.
Step 5114 (30 ms): -216.76.
Step 5151 (30 ms): -211.12.
Step 5189 (30 ms): -196.6.
Step 5226 (30 ms): -220.01.
Step 5264 (14 ms): -345.12.

Epoch 14 (11.4 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -218.39, ENRE: -211.97, KL: 6.4194.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 5302 (31 ms): -215.2.
Step 5339 (30 ms): -227.99.
Step 5377 (31 ms): -213.1.
Step 5414 (31 ms): -214.72.
Step 5452 (31 ms): -213.72.
Step 5490 (31 ms): -212.72.
Step 5527 (31 ms): -219.66.
Step 5565 (30 ms): -220.5.
Step 5602 (31 ms): -206.47.
Step 5640 (14 ms): -303.62.

Epoch 15 (11.5 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -216.18, ENRE: -210.12, KL: 6.066.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 5678 (30 ms): -205.72.
Step 5715 (30 ms): -209.59.
Step 5753 (30 ms): -205.6.
Step 5790 (31 ms): -230.01.
Step 5828 (31 ms): -221.5.
Step 5866 (30 ms): -223.97.
Step 5903 (30 ms): -204.91.
Step 5941 (30 ms): -216.58.
Step 5978 (31 ms): -197.42.
Step 6016 (13 ms): -381.12.

Epoch 16 (11.4 s):
    Evaluating model.
    Full set (5.43 s): ELBO: -214.66, ENRE: -208.54, KL: 6.1106.
    Saving model parameters.
    Model parameters saved (101 ms).

Step 6054 (31 ms): -212.91.
Step 6091 (30 ms): -209.89.
Step 6129 (30 ms): -217.11.
Step 6166 (31 ms): -209.37.
Step 6204 (31 ms): -212.2.
Step 6242 (31 ms): -204.01.
Step 6279 (30 ms): -205.69.
Step 6317 (30 ms): -213.2.
Step 6354 (31 ms): -216.02.
Step 6392 (14 ms): -337.94.

Epoch 17 (11.4 s):
    Evaluating model.
    Full set (5.58 s): ELBO: -213.42, ENRE: -207.48, KL: 5.9429.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 6430 (31 ms): -201.86.
Step 6467 (30 ms): -205.11.
Step 6505 (31 ms): -253.39.
Step 6542 (31 ms): -222.58.
Step 6580 (30 ms): -223.61.
Step 6618 (31 ms): -212.45.
Step 6655 (30 ms): -207.66.
Step 6693 (30 ms): -218.33.
Step 6730 (30 ms): -206.84.
Step 6768 (14 ms): -313.57.

Epoch 18 (11.5 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -212.17, ENRE: -206.42, KL: 5.7546.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 6806 (30 ms): -207.61.
Step 6843 (29 ms): -211.98.
Step 6881 (30 ms): -214.11.
Step 6918 (31 ms): -208.87.
Step 6956 (31 ms): -203.33.
Step 6994 (31 ms): -226.26.
Step 7031 (30 ms): -207.69.
Step 7069 (31 ms): -200.72.
Step 7106 (30 ms): -213.76.
Step 7144 (14 ms): -376.7.

Epoch 19 (11.5 s):
    Evaluating model.
    Full set (5.59 s): ELBO: -211.72, ENRE: -206.05, KL: 5.6726.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 7182 (30 ms): -212.06.
Step 7219 (31 ms): -220.46.
Step 7257 (31 ms): -201.39.
Step 7294 (31 ms): -202.
Step 7332 (31 ms): -233.86.
Step 7370 (31 ms): -203.4.
Step 7407 (31 ms): -215.04.
Step 7445 (31 ms): -209.35.
Step 7482 (30 ms): -195.59.
Step 7520 (14 ms): -225.31.

Epoch 20 (11.5 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -210.67, ENRE: -205.17, KL: 5.4983.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 7558 (30 ms): -207.61.
Step 7595 (30 ms): -201.27.
Step 7633 (30 ms): -204.54.
Step 7670 (30 ms): -214.16.
Step 7708 (31 ms): -200.57.
Step 7746 (31 ms): -207.04.
Step 7783 (31 ms): -202.35.
Step 7821 (31 ms): -194.16.
Step 7858 (31 ms): -191.57.
Step 7896 (14 ms): -219.65.

Epoch 21 (11.4 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -210.39, ENRE: -204.73, KL: 5.6602.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 7934 (31 ms): -200.32.
Step 7971 (30 ms): -201.25.
Step 8009 (30 ms): -211.92.
Step 8046 (31 ms): -199.08.
Step 8084 (31 ms): -207.44.
Step 8122 (30 ms): -207.04.
Step 8159 (31 ms): -208.27.
Step 8197 (31 ms): -195.26.
Step 8234 (31 ms): -216.96.
Step 8272 (14 ms): -204.03.

Epoch 22 (11.5 s):
    Evaluating model.
    Full set (5.49 s): ELBO: -209.56, ENRE: -204.21, KL: 5.3511.
    Saving model parameters.
    Model parameters saved (99 ms).

Step 8310 (30 ms): -216.56.
Step 8347 (30 ms): -207.67.
Step 8385 (30 ms): -207.52.
Step 8422 (30 ms): -203.2.
Step 8460 (30 ms): -220.18.
Step 8498 (30 ms): -202.17.
Step 8535 (31 ms): -206.85.
Step 8573 (30 ms): -204.23.
Step 8610 (31 ms): -197.45.
Step 8648 (14 ms): -237.69.

Epoch 23 (11.4 s):
    Evaluating model.
    Full set (5.63 s): ELBO: -208.82, ENRE: -203.49, KL: 5.3306.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 8686 (31 ms): -197.75.
Step 8723 (30 ms): -219.22.
Step 8761 (30 ms): -197.75.
Step 8798 (30 ms): -206.9.
Step 8836 (30 ms): -201.4.
Step 8874 (30 ms): -198.46.
Step 8911 (31 ms): -209.85.
Step 8949 (30 ms): -216.1.
Step 8986 (31 ms): -202.32.
Step 9024 (14 ms): -229.95.

Epoch 24 (11.5 s):
    Evaluating model.
    Full set (5.52 s): ELBO: -208.43, ENRE: -203.11, KL: 5.3252.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 9062 (30 ms): -204.55.
Step 9099 (30 ms): -197.41.
Step 9137 (30 ms): -204.73.
Step 9174 (30 ms): -198.29.
Step 9212 (30 ms): -205.46.
Step 9250 (30 ms): -198.83.
Step 9287 (30 ms): -206.48.
Step 9325 (30 ms): -236.03.
Step 9362 (30 ms): -215.15.
Step 9400 (14 ms): -209.46.

Epoch 25 (11.3 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -208.23, ENRE: -202.87, KL: 5.3656.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 9438 (31 ms): -212.27.
Step 9475 (30 ms): -211.71.
Step 9513 (30 ms): -213.12.
Step 9550 (31 ms): -205.59.
Step 9588 (31 ms): -207.65.
Step 9626 (31 ms): -197.61.
Step 9663 (31 ms): -196.75.
Step 9701 (30 ms): -202.03.
Step 9738 (30 ms): -209.48.
Step 9776 (14 ms): -218.38.

Epoch 26 (11.5 s):
    Evaluating model.
    Full set (5.54 s): ELBO: -207.44, ENRE: -202.2, KL: 5.239.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 9814 (31 ms): -198.17.
Step 9851 (30 ms): -207.41.
Step 9889 (30 ms): -216.16.
Step 9926 (31 ms): -208.5.
Step 9964 (30 ms): -214.78.
Step 10002 (30 ms): -206.58.
Step 10039 (30 ms): -218.4.
Step 10077 (30 ms): -194.69.
Step 10114 (32 ms): -218.87.
Step 10152 (14 ms): -314.41.

Epoch 27 (11.4 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -206.92, ENRE: -201.61, KL: 5.305.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 10190 (31 ms): -198.
Step 10227 (31 ms): -210.25.
Step 10265 (31 ms): -208.03.
Step 10302 (31 ms): -200.51.
Step 10340 (30 ms): -202.98.
Step 10378 (31 ms): -196.62.
Step 10415 (30 ms): -191.37.
Step 10453 (30 ms): -215.26.
Step 10490 (30 ms): -199.91.
Step 10528 (14 ms): -291.61.

Epoch 28 (11.5 s):
    Evaluating model.
    Full set (5.56 s): ELBO: -206.52, ENRE: -201.21, KL: 5.3096.
    Saving model parameters.
    Model parameters saved (99 ms).

Step 10566 (30 ms): -214.13.
Step 10603 (30 ms): -205.15.
Step 10641 (30 ms): -203.19.
Step 10678 (29 ms): -193.04.
Step 10716 (30 ms): -207.23.
Step 10754 (30 ms): -216.26.
Step 10791 (30 ms): -215.41.
Step 10829 (30 ms): -215.97.
Step 10866 (30 ms): -210.79.
Step 10904 (14 ms): -265.47.

Epoch 29 (11.3 s):
    Evaluating model.
    Full set (5.59 s): ELBO: -206.01, ENRE: -200.72, KL: 5.2951.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 10942 (34 ms): -202.44.
Step 10979 (30 ms): -196.79.
Step 11017 (30 ms): -201.56.
Step 11054 (31 ms): -208.69.
Step 11092 (31 ms): -210.93.
Step 11130 (30 ms): -199.5.
Step 11167 (31 ms): -196.06.
Step 11205 (30 ms): -213.08.
Step 11242 (31 ms): -196.59.
Step 11280 (14 ms): -193.29.

Epoch 30 (11.5 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -205.97, ENRE: -200.67, KL: 5.3029.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 11318 (30 ms): -199.54.
Step 11355 (30 ms): -198.17.
Step 11393 (30 ms): -208.73.
Step 11430 (30 ms): -190.2.
Step 11468 (30 ms): -210.
Step 11506 (30 ms): -202.57.
Step 11543 (30 ms): -198.26.
Step 11581 (31 ms): -198.3.
Step 11618 (30 ms): -206.77.
Step 11656 (14 ms): -269.41.

Epoch 31 (11.3 s):
    Evaluating model.
    Full set (5.57 s): ELBO: -205.3, ENRE: -200.01, KL: 5.2901.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 11694 (31 ms): -205.57.
Step 11731 (30 ms): -204.41.
Step 11769 (30 ms): -201.27.
Step 11806 (30 ms): -206.73.
Step 11844 (31 ms): -196.95.
Step 11882 (30 ms): -198.
Step 11919 (31 ms): -205.6.
Step 11957 (31 ms): -206.11.
Step 11994 (30 ms): -228.9.
Step 12032 (14 ms): -211.02.

Epoch 32 (11.5 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -205.37, ENRE: -200.17, KL: 5.2005.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 12070 (31 ms): -202.08.
Step 12107 (30 ms): -187.27.
Step 12145 (30 ms): -205.33.
Step 12182 (30 ms): -202.86.
Step 12220 (30 ms): -202.22.
Step 12258 (32 ms): -199.91.
Step 12295 (30 ms): -202.03.
Step 12333 (30 ms): -204.47.
Step 12370 (30 ms): -202.06.
Step 12408 (14 ms): -279.99.

Epoch 33 (11.4 s):
    Evaluating model.
    Full set (5.52 s): ELBO: -205.13, ENRE: -199.92, KL: 5.208.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 12446 (30 ms): -199.38.
Step 12483 (30 ms): -203.19.
Step 12521 (30 ms): -201.97.
Step 12558 (31 ms): -204.5.
Step 12596 (31 ms): -199.47.
Step 12634 (31 ms): -208.02.
Step 12671 (31 ms): -214.4.
Step 12709 (30 ms): -204.73.
Step 12746 (31 ms): -212.74.
Step 12784 (14 ms): -232.81.

Epoch 34 (11.5 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -204.85, ENRE: -199.54, KL: 5.3058.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 12822 (30 ms): -203.29.
Step 12859 (30 ms): -217.23.
Step 12897 (30 ms): -210.33.
Step 12934 (30 ms): -201.22.
Step 12972 (30 ms): -211.74.
Step 13010 (30 ms): -198.4.
Step 13047 (29 ms): -214.56.
Step 13085 (30 ms): -209.45.
Step 13122 (29 ms): -207.45.
Step 13160 (14 ms): -368.

Epoch 35 (11.4 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -204.58, ENRE: -199.37, KL: 5.2083.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 13198 (31 ms): -210.84.
Step 13235 (31 ms): -189.14.
Step 13273 (31 ms): -195.96.
Step 13310 (31 ms): -218.98.
Step 13348 (30 ms): -182.66.
Step 13386 (31 ms): -199.14.
Step 13423 (30 ms): -202.1.
Step 13461 (31 ms): -205.66.
Step 13498 (30 ms): -199.69.
Step 13536 (14 ms): -274.34.

Epoch 36 (11.5 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -204.25, ENRE: -198.96, KL: 5.2884.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 13574 (30 ms): -192.15.
Step 13611 (30 ms): -200.23.
Step 13649 (31 ms): -199.72.
Step 13686 (30 ms): -208.63.
Step 13724 (31 ms): -216.99.
Step 13762 (30 ms): -205.96.
Step 13799 (30 ms): -212.58.
Step 13837 (30 ms): -215.09.
Step 13874 (30 ms): -187.35.
Step 13912 (14 ms): -203.37.

Epoch 37 (11.4 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -203.96, ENRE: -198.7, KL: 5.2613.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 13950 (30 ms): -201.44.
Step 13987 (31 ms): -200.4.
Step 14025 (30 ms): -200.54.
Step 14062 (31 ms): -211.58.
Step 14100 (30 ms): -198.75.
Step 14138 (31 ms): -189.65.
Step 14175 (30 ms): -206.48.
Step 14213 (30 ms): -192.78.
Step 14250 (31 ms): -208.42.
Step 14288 (14 ms): -202.34.

Epoch 38 (11.5 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -204.19, ENRE: -198.93, KL: 5.2607.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 14326 (31 ms): -215.39.
Step 14363 (30 ms): -201.56.
Step 14401 (30 ms): -206.44.
Step 14438 (31 ms): -204.55.
Step 14476 (31 ms): -192.84.
Step 14514 (30 ms): -200.94.
Step 14551 (30 ms): -203.49.
Step 14589 (30 ms): -201.58.
Step 14626 (30 ms): -191.53.
Step 14664 (14 ms): -247.98.

Epoch 39 (11.4 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -204.05, ENRE: -198.63, KL: 5.4156.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 14702 (30 ms): -197.25.
Step 14739 (30 ms): -193.28.
Step 14777 (31 ms): -187.82.
Step 14814 (30 ms): -220.73.
Step 14852 (31 ms): -211.29.
Step 14890 (31 ms): -200.24.
Step 14927 (30 ms): -205.68.
Step 14965 (30 ms): -200.55.
Step 15002 (31 ms): -206.86.
Step 15040 (14 ms): -214.84.

Epoch 40 (11.4 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -204.4, ENRE: -198.96, KL: 5.439.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 15078 (31 ms): -197.07.
Step 15115 (31 ms): -204.61.
Step 15153 (30 ms): -197.17.
Step 15190 (31 ms): -196.78.
Step 15228 (31 ms): -196.35.
Step 15266 (31 ms): -207.67.
Step 15303 (30 ms): -205.28.
Step 15341 (30 ms): -208.03.
Step 15378 (30 ms): -207.71.
Step 15416 (14 ms): -201.86.

Epoch 41 (11.4 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -204.82, ENRE: -199.41, KL: 5.4125.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 15454 (29 ms): -189.89.
Step 15491 (30 ms): -213.14.
Step 15529 (30 ms): -202.26.
Step 15566 (30 ms): -201.87.
Step 15604 (31 ms): -198.44.
Step 15642 (30 ms): -204.74.
Step 15679 (30 ms): -199.1.
Step 15717 (30 ms): -199.1.
Step 15754 (31 ms): -216.19.
Step 15792 (14 ms): -219.13.

Epoch 42 (11.4 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -203.54, ENRE: -198.04, KL: 5.4969.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 15830 (31 ms): -208.44.
Step 15867 (30 ms): -211.74.
Step 15905 (31 ms): -200.26.
Step 15942 (31 ms): -205.35.
Step 15980 (31 ms): -192.44.
Step 16018 (30 ms): -206.59.
Step 16055 (30 ms): -194.59.
Step 16093 (30 ms): -205.21.
Step 16130 (30 ms): -197.59.
Step 16168 (14 ms): -191.15.

Epoch 43 (11.5 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -202.78, ENRE: -197.36, KL: 5.4238.
    Saving model parameters.
    Model parameters saved (99 ms).

Step 16206 (30 ms): -203.17.
Step 16243 (30 ms): -212.27.
Step 16281 (30 ms): -206.02.
Step 16318 (30 ms): -198.67.
Step 16356 (30 ms): -207.16.
Step 16394 (30 ms): -199.87.
Step 16431 (31 ms): -208.31.
Step 16469 (31 ms): -201.26.
Step 16506 (31 ms): -196.13.
Step 16544 (14 ms): -231.48.

Epoch 44 (11.4 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -203.37, ENRE: -197.98, KL: 5.3926.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 16582 (31 ms): -198.45.
Step 16619 (30 ms): -210.08.
Step 16657 (31 ms): -192.08.
Step 16694 (31 ms): -216.04.
Step 16732 (31 ms): -211.38.
Step 16770 (31 ms): -200.99.
Step 16807 (30 ms): -199.99.
Step 16845 (30 ms): -206.18.
Step 16882 (31 ms): -205.89.
Step 16920 (14 ms): -233.45.

Epoch 45 (11.5 s):
    Evaluating model.
    Full set (5.49 s): ELBO: -202.92, ENRE: -197.5, KL: 5.4151.
    Saving model parameters.
    Model parameters saved (101 ms).

Step 16958 (29 ms): -199.79.
Step 16995 (30 ms): -217.54.
Step 17033 (30 ms): -197.43.
Step 17070 (30 ms): -194.52.
Step 17108 (30 ms): -200.27.
Step 17146 (30 ms): -200.52.
Step 17183 (30 ms): -196.33.
Step 17221 (30 ms): -196.49.
Step 17258 (31 ms): -194.33.
Step 17296 (14 ms): -301.82.

Epoch 46 (11.3 s):
    Evaluating model.
    Full set (5.59 s): ELBO: -202.73, ENRE: -197.34, KL: 5.3905.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 17334 (30 ms): -218.43.
Step 17371 (30 ms): -195.26.
Step 17409 (31 ms): -201.86.
Step 17446 (30 ms): -206.3.
Step 17484 (32 ms): -205.33.
Step 17522 (31 ms): -199.06.
Step 17559 (31 ms): -200.49.
Step 17597 (30 ms): -207.89.
Step 17634 (30 ms): -194.11.
Step 17672 (14 ms): -233.44.

Epoch 47 (11.5 s):
    Evaluating model.
    Full set (5.52 s): ELBO: -202.85, ENRE: -197.41, KL: 5.4379.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 17710 (30 ms): -209.42.
Step 17747 (30 ms): -200.83.
Step 17785 (30 ms): -197.08.
Step 17822 (30 ms): -201.21.
Step 17860 (30 ms): -205.13.
Step 17898 (30 ms): -198.29.
Step 17935 (30 ms): -214.8.
Step 17973 (30 ms): -205.48.
Step 18010 (30 ms): -204.87.
Step 18048 (14 ms): -263.82.

Epoch 48 (11.3 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -202.19, ENRE: -196.71, KL: 5.4809.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 18086 (31 ms): -195.8.
Step 18123 (31 ms): -199.81.
Step 18161 (31 ms): -195.88.
Step 18198 (31 ms): -209.28.
Step 18236 (30 ms): -191.72.
Step 18274 (31 ms): -220.27.
Step 18311 (30 ms): -189.6.
Step 18349 (31 ms): -194.17.
Step 18386 (31 ms): -200.25.
Step 18424 (14 ms): -277.33.

Epoch 49 (11.5 s):
    Evaluating model.
    Full set (5.57 s): ELBO: -202.66, ENRE: -197.28, KL: 5.3733.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 18462 (30 ms): -207.54.
Step 18499 (30 ms): -206.65.
Step 18537 (30 ms): -205.7.
Step 18574 (30 ms): -206.2.
Step 18612 (30 ms): -193.89.
Step 18650 (30 ms): -197.69.
Step 18687 (30 ms): -197.97.
Step 18725 (30 ms): -203.82.
Step 18762 (30 ms): -192.56.
Step 18800 (14 ms): -208.65.

Epoch 50 (11.3 s):
    Evaluating model.
    Full set (5.58 s): ELBO: -202.03, ENRE: -196.67, KL: 5.362.
    Saving model parameters.
    Model parameters saved (103 ms).

Model trained for 50 epochs (14m 19s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (10 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (866 ms).

Converting data set value array to sparse matrix.
Data set value array converted (267 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.79 s):  ELBO: -421.05, ENRE: -415.68, KL: 5.3679.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (645 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.8123062064222135
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 29
kl weight: 1.8123062064222135
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (44 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.11 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.65 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 29
    hidden sizes: 129, 238
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.8123062064222135
    using analytical KL term
    using batch normalisation for minibatches
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 129)
    ENCODER/1/DENSE/biases:0             (129,)
    ENCODER/1/BATCH_NORM/beta:0          (129,)
    ENCODER/2/DENSE/weights:0            (129, 238)
    ENCODER/2/DENSE/biases:0             (238,)
    ENCODER/2/BATCH_NORM/beta:0          (238,)
    POSTERIOR/MU/DENSE/weights:0         (238, 29)
    POSTERIOR/MU/DENSE/biases:0          (29,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (238, 29)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (29,)
    DECODER/2/DENSE/weights:0            (29, 238)
    DECODER/2/DENSE/biases:0             (238,)
    DECODER/2/BATCH_NORM/beta:0          (238,)
    DECODER/1/DENSE/weights:0            (238, 129)
    DECODER/1/DENSE/biases:0             (129,)
    DECODER/1/BATCH_NORM/beta:0          (129,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (129, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (294 ms).

Training model for 50 epochs on original values.

Step 38 (26 ms): -2178.8.
Step 75 (26 ms): -1832.3.
Step 113 (27 ms): -1621.1.
Step 150 (25 ms): -1384.8.
Step 188 (25 ms): -1249.
Step 226 (25 ms): -1080.3.
Step 263 (25 ms): -977.15.
Step 301 (25 ms): -846.32.
Step 338 (26 ms): -802.43.
Step 376 (12 ms): -627.27.

Epoch 1 (11.4 s):
    Evaluating model.
    Full set (5.28 s): ELBO: -1589.9, ENRE: -1569.3, KL: 20.642.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 414 (25 ms): -635.83.
Step 451 (25 ms): -582.84.
Step 489 (25 ms): -518.34.
Step 526 (26 ms): -488.15.
Step 564 (26 ms): -455.36.
Step 602 (26 ms): -439.
Step 639 (26 ms): -403.51.
Step 677 (25 ms): -399.6.
Step 714 (26 ms): -375.66.
Step 752 (12 ms): -393.09.

Epoch 2 (9.58 s):
    Evaluating model.
    Full set (5.02 s): ELBO: -1029.4, ENRE: -1017, KL: 12.426.
    Saving model parameters.
    Model parameters saved (74 ms).

Step 790 (26 ms): -388.06.
Step 827 (26 ms): -341.33.
Step 865 (25 ms): -335.69.
Step 902 (26 ms): -338.79.
Step 940 (26 ms): -321.13.
Step 978 (25 ms): -313.21.
Step 1015 (27 ms): -302.57.
Step 1053 (25 ms): -296.99.
Step 1090 (25 ms): -294.78.
Step 1128 (12 ms): -309.4.

Epoch 3 (9.6 s):
    Evaluating model.
    Full set (4.93 s): ELBO: -627.27, ENRE: -618.32, KL: 8.9496.
    Saving model parameters.
    Model parameters saved (72 ms).

Step 1166 (26 ms): -296.38.
Step 1203 (25 ms): -298.28.
Step 1241 (24 ms): -273.6.
Step 1278 (25 ms): -276.01.
Step 1316 (25 ms): -265.68.
Step 1354 (25 ms): -270.37.
Step 1391 (25 ms): -272.46.
Step 1429 (25 ms): -266.77.
Step 1466 (25 ms): -272.36.
Step 1504 (12 ms): -311.91.

Epoch 4 (9.43 s):
    Evaluating model.
    Full set (5.02 s): ELBO: -400.46, ENRE: -392.43, KL: 8.0333.
    Saving model parameters.
    Model parameters saved (76 ms).

Step 1542 (26 ms): -260.55.
Step 1579 (26 ms): -250.79.
Step 1617 (25 ms): -266.97.
Step 1654 (26 ms): -253.85.
Step 1692 (25 ms): -259.3.
Step 1730 (26 ms): -233.59.
Step 1767 (26 ms): -250.55.
Step 1805 (25 ms): -238.09.
Step 1842 (26 ms): -248.6.
Step 1880 (12 ms): -427.73.

Epoch 5 (9.64 s):
    Evaluating model.
    Full set (5.02 s): ELBO: -302.18, ENRE: -294.81, KL: 7.3751.
    Saving model parameters.
    Model parameters saved (71 ms).

Step 1918 (26 ms): -246.57.
Step 1955 (25 ms): -259.89.
Step 1993 (25 ms): -254.31.
Step 2030 (26 ms): -258.69.
Step 2068 (26 ms): -246.19.
Step 2106 (25 ms): -243.86.
Step 2143 (25 ms): -239.07.
Step 2181 (25 ms): -232.45.
Step 2218 (25 ms): -230.42.
Step 2256 (12 ms): -244.28.

Epoch 6 (9.56 s):
    Evaluating model.
    Full set (4.89 s): ELBO: -259.61, ENRE: -252.78, KL: 6.8344.
    Saving model parameters.
    Model parameters saved (72 ms).

Step 2294 (25 ms): -237.68.
Step 2331 (25 ms): -244.01.
Step 2369 (26 ms): -230.17.
Step 2406 (26 ms): -234.55.
Step 2444 (26 ms): -237.09.
Step 2482 (26 ms): -240.64.
Step 2519 (25 ms): -234.59.
Step 2557 (26 ms): -214.57.
Step 2594 (26 ms): -242.3.
Step 2632 (12 ms): -456.31.

Epoch 7 (9.61 s):
    Evaluating model.
    Full set (5.02 s): ELBO: -240.28, ENRE: -233.52, KL: 6.761.
    Saving model parameters.
    Model parameters saved (71 ms).

Step 2670 (26 ms): -230.31.
Step 2707 (25 ms): -230.
Step 2745 (25 ms): -240.3.
Step 2782 (26 ms): -244.82.
Step 2820 (26 ms): -223.37.
Step 2858 (26 ms): -229.49.
Step 2895 (25 ms): -232.46.
Step 2933 (26 ms): -221.84.
Step 2970 (26 ms): -213.79.
Step 3008 (12 ms): -200.23.

Epoch 8 (9.63 s):
    Evaluating model.
    Full set (4.94 s): ELBO: -230.03, ENRE: -223.29, KL: 6.739.
    Saving model parameters.
    Model parameters saved (71 ms).

Step 3046 (25 ms): -225.4.
Step 3083 (25 ms): -214.32.
Step 3121 (25 ms): -213.38.
Step 3158 (25 ms): -240.61.
Step 3196 (25 ms): -246.88.
Step 3234 (25 ms): -225.62.
Step 3271 (25 ms): -215.51.
Step 3309 (25 ms): -218.23.
Step 3346 (26 ms): -223.01.
Step 3384 (12 ms): -221.57.

Epoch 9 (9.48 s):
    Evaluating model.
    Full set (5.01 s): ELBO: -225.04, ENRE: -218.44, KL: 6.6055.
    Saving model parameters.
    Model parameters saved (72 ms).

Step 3422 (26 ms): -219.48.
Step 3459 (26 ms): -226.48.
Step 3497 (25 ms): -226.8.
Step 3534 (26 ms): -218.96.
Step 3572 (27 ms): -218.83.
Step 3610 (26 ms): -220.51.
Step 3647 (25 ms): -202.81.
Step 3685 (25 ms): -239.19.
Step 3722 (26 ms): -218.7.
Step 3760 (12 ms): -238.69.

Epoch 10 (9.63 s):
    Evaluating model.
    Full set (5.02 s): ELBO: -221.76, ENRE: -215.24, KL: 6.5208.
    Saving model parameters.
    Model parameters saved (73 ms).

Step 3798 (25 ms): -215.8.
Step 3835 (25 ms): -210.63.
Step 3873 (25 ms): -223.56.
Step 3910 (25 ms): -225.94.
Step 3948 (26 ms): -213.01.
Step 3986 (25 ms): -204.99.
Step 4023 (25 ms): -208.64.
Step 4061 (25 ms): -218.02.
Step 4098 (25 ms): -213.23.
Step 4136 (11 ms): -215.42.

Epoch 11 (9.49 s):
    Evaluating model.
    Full set (4.91 s): ELBO: -219.59, ENRE: -213.06, KL: 6.5359.
    Saving model parameters.
    Model parameters saved (74 ms).

Step 4174 (26 ms): -214.95.
Step 4211 (26 ms): -212.19.
Step 4249 (25 ms): -239.08.
Step 4286 (26 ms): -210.92.
Step 4324 (26 ms): -218.76.
Step 4362 (26 ms): -211.82.
Step 4399 (25 ms): -207.81.
Step 4437 (25 ms): -218.27.
Step 4474 (26 ms): -214.52.
Step 4512 (12 ms): -209.9.

Epoch 12 (9.64 s):
    Evaluating model.
    Full set (5.03 s): ELBO: -217.51, ENRE: -211.04, KL: 6.4709.
    Saving model parameters.
    Model parameters saved (72 ms).

Step 4550 (26 ms): -229.03.
Step 4587 (26 ms): -222.52.
Step 4625 (26 ms): -211.72.
Step 4662 (26 ms): -215.93.
Step 4700 (25 ms): -211.65.
Step 4738 (26 ms): -232.45.
Step 4775 (26 ms): -209.36.
Step 4813 (25 ms): -217.8.
Step 4850 (26 ms): -226.79.
Step 4888 (12 ms): -196.1.

Epoch 13 (9.65 s):
    Evaluating model.
    Full set (4.92 s): ELBO: -215.3, ENRE: -208.88, KL: 6.4248.
    Saving model parameters.
    Model parameters saved (70 ms).

Step 4926 (26 ms): -221.89.
Step 4963 (25 ms): -213.18.
Step 5001 (25 ms): -225.09.
Step 5038 (26 ms): -220.2.
Step 5076 (26 ms): -217.99.
Step 5114 (25 ms): -231.25.
Step 5151 (25 ms): -216.9.
Step 5189 (25 ms): -218.99.
Step 5226 (25 ms): -203.55.
Step 5264 (12 ms): -203.33.

Epoch 14 (9.54 s):
    Evaluating model.
    Full set (5.03 s): ELBO: -214.25, ENRE: -207.87, KL: 6.382.
    Saving model parameters.
    Model parameters saved (73 ms).

Step 5302 (26 ms): -208.68.
Step 5339 (26 ms): -214.52.
Step 5377 (26 ms): -243.25.
Step 5414 (26 ms): -220.41.
Step 5452 (25 ms): -211.34.
Step 5490 (26 ms): -217.98.
Step 5527 (26 ms): -203.03.
Step 5565 (25 ms): -213.57.
Step 5602 (26 ms): -212.
Step 5640 (12 ms): -505.34.

Epoch 15 (9.65 s):
    Evaluating model.
    Full set (5.01 s): ELBO: -213.64, ENRE: -207.04, KL: 6.6004.
    Saving model parameters.
    Model parameters saved (72 ms).

Step 5678 (25 ms): -210.41.
Step 5715 (25 ms): -213.52.
Step 5753 (25 ms): -213.64.
Step 5790 (25 ms): -214.57.
Step 5828 (25 ms): -205.83.
Step 5866 (25 ms): -222.65.
Step 5903 (25 ms): -203.27.
Step 5941 (25 ms): -224.32.
Step 5978 (25 ms): -193.56.
Step 6016 (11 ms): -194.91.

Epoch 16 (9.46 s):
    Evaluating model.
    Full set (4.92 s): ELBO: -212.27, ENRE: -206.09, KL: 6.1816.
    Saving model parameters.
    Model parameters saved (73 ms).

Step 6054 (25 ms): -209.29.
Step 6091 (26 ms): -218.15.
Step 6129 (26 ms): -217.07.
Step 6166 (25 ms): -205.64.
Step 6204 (26 ms): -202.07.
Step 6242 (25 ms): -209.99.
Step 6279 (25 ms): -204.47.
Step 6317 (26 ms): -209.3.
Step 6354 (26 ms): -205.47.
Step 6392 (12 ms): -243.58.

Epoch 17 (9.61 s):
    Evaluating model.
    Full set (5.01 s): ELBO: -211.52, ENRE: -205.17, KL: 6.3437.
    Saving model parameters.
    Model parameters saved (75 ms).

Step 6430 (26 ms): -211.58.
Step 6467 (26 ms): -218.29.
Step 6505 (25 ms): -234.8.
Step 6542 (25 ms): -206.45.
Step 6580 (26 ms): -204.87.
Step 6618 (25 ms): -212.08.
Step 6655 (25 ms): -200.71.
Step 6693 (25 ms): -201.62.
Step 6730 (25 ms): -210.64.
Step 6768 (11 ms): -191.24.

Epoch 18 (9.58 s):
    Evaluating model.
    Full set (4.91 s): ELBO: -210.49, ENRE: -204.51, KL: 5.9797.
    Saving model parameters.
    Model parameters saved (72 ms).

Step 6806 (25 ms): -212.82.
Step 6843 (26 ms): -214.7.
Step 6881 (25 ms): -210.41.
Step 6918 (25 ms): -196.06.
Step 6956 (26 ms): -218.98.
Step 6994 (25 ms): -201.09.
Step 7031 (25 ms): -204.12.
Step 7069 (25 ms): -210.67.
Step 7106 (26 ms): -211.16.
Step 7144 (12 ms): -263.05.

Epoch 19 (9.56 s):
    Evaluating model.
    Full set (5.03 s): ELBO: -209.47, ENRE: -203.41, KL: 6.0553.
    Saving model parameters.
    Model parameters saved (72 ms).

Step 7182 (26 ms): -198.39.
Step 7219 (26 ms): -205.56.
Step 7257 (26 ms): -217.74.
Step 7294 (26 ms): -203.95.
Step 7332 (26 ms): -210.14.
Step 7370 (25 ms): -217.25.
Step 7407 (26 ms): -202.47.
Step 7445 (25 ms): -207.84.
Step 7482 (26 ms): -225.96.
Step 7520 (12 ms): -188.11.

Epoch 20 (9.68 s):
    Evaluating model.
    Full set (5 s): ELBO: -208.98, ENRE: -203.08, KL: 5.9024.
    Saving model parameters.
    Model parameters saved (71 ms).

Step 7558 (26 ms): -210.41.
Step 7595 (25 ms): -196.1.
Step 7633 (25 ms): -226.08.
Step 7670 (26 ms): -203.32.
Step 7708 (25 ms): -195.94.
Step 7746 (25 ms): -199.45.
Step 7783 (25 ms): -209.04.
Step 7821 (25 ms): -200.11.
Step 7858 (25 ms): -213.29.
Step 7896 (12 ms): -268.01.

Epoch 21 (9.49 s):
    Evaluating model.
    Full set (4.95 s): ELBO: -208.18, ENRE: -202.25, KL: 5.9323.
    Saving model parameters.
    Model parameters saved (71 ms).

Step 7934 (26 ms): -217.11.
Step 7971 (25 ms): -209.21.
Step 8009 (25 ms): -203.13.
Step 8046 (26 ms): -215.54.
Step 8084 (26 ms): -222.27.
Step 8122 (26 ms): -212.75.
Step 8159 (26 ms): -201.27.
Step 8197 (26 ms): -198.26.
Step 8234 (26 ms): -228.7.
Step 8272 (12 ms): -238.1.

Epoch 22 (9.65 s):
    Evaluating model.
    Full set (5.03 s): ELBO: -207.75, ENRE: -201.74, KL: 6.0123.
    Saving model parameters.
    Model parameters saved (73 ms).

Step 8310 (25 ms): -197.18.
Step 8347 (25 ms): -203.71.
Step 8385 (25 ms): -193.7.
Step 8422 (26 ms): -207.22.
Step 8460 (25 ms): -203.72.
Step 8498 (25 ms): -201.83.
Step 8535 (25 ms): -195.63.
Step 8573 (25 ms): -205.69.
Step 8610 (25 ms): -227.73.
Step 8648 (11 ms): -228.27.

Epoch 23 (9.56 s):
    Evaluating model.
    Full set (4.9 s): ELBO: -207.18, ENRE: -201.27, KL: 5.9122.
    Saving model parameters.
    Model parameters saved (71 ms).

Step 8686 (25 ms): -222.76.
Step 8723 (25 ms): -212.4.
Step 8761 (25 ms): -221.92.
Step 8798 (25 ms): -216.26.
Step 8836 (26 ms): -212.51.
Step 8874 (26 ms): -207.62.
Step 8911 (26 ms): -205.69.
Step 8949 (25 ms): -199.8.
Step 8986 (26 ms): -212.52.
Step 9024 (12 ms): -214.56.

Epoch 24 (9.52 s):
    Evaluating model.
    Full set (5.02 s): ELBO: -206.67, ENRE: -200.68, KL: 5.9957.
    Saving model parameters.
    Model parameters saved (76 ms).

Step 9062 (26 ms): -203.63.
Step 9099 (25 ms): -210.15.
Step 9137 (25 ms): -198.95.
Step 9174 (26 ms): -199.87.
Step 9212 (25 ms): -199.03.
Step 9250 (26 ms): -202.56.
Step 9287 (26 ms): -191.75.
Step 9325 (25 ms): -200.54.
Step 9362 (27 ms): -214.95.
Step 9400 (12 ms): -189.83.

Epoch 25 (9.63 s):
    Evaluating model.
    Full set (4.98 s): ELBO: -206.17, ENRE: -200.32, KL: 5.8477.
    Saving model parameters.
    Model parameters saved (70 ms).

Step 9438 (25 ms): -201.37.
Step 9475 (25 ms): -213.28.
Step 9513 (26 ms): -210.39.
Step 9550 (25 ms): -216.72.
Step 9588 (25 ms): -194.34.
Step 9626 (25 ms): -205.16.
Step 9663 (25 ms): -208.48.
Step 9701 (25 ms): -206.7.
Step 9738 (25 ms): -200.25.
Step 9776 (12 ms): -221.87.

Epoch 26 (9.49 s):
    Evaluating model.
    Full set (4.99 s): ELBO: -206.04, ENRE: -200.21, KL: 5.8322.
    Saving model parameters.
    Model parameters saved (73 ms).

Step 9814 (25 ms): -205.04.
Step 9851 (25 ms): -202.86.
Step 9889 (26 ms): -198.62.
Step 9926 (25 ms): -203.7.
Step 9964 (26 ms): -212.31.
Step 10002 (26 ms): -206.48.
Step 10039 (26 ms): -194.88.
Step 10077 (26 ms): -198.22.
Step 10114 (26 ms): -213.4.
Step 10152 (12 ms): -270.41.

Epoch 27 (9.67 s):
    Evaluating model.
    Full set (5.05 s): ELBO: -205.51, ENRE: -199.63, KL: 5.8729.
    Saving model parameters.
    Model parameters saved (71 ms).

Step 10190 (26 ms): -219.74.
Step 10227 (25 ms): -196.95.
Step 10265 (26 ms): -201.99.
Step 10302 (26 ms): -208.73.
Step 10340 (25 ms): -202.19.
Step 10378 (25 ms): -204.21.
Step 10415 (25 ms): -190.75.
Step 10453 (25 ms): -207.94.
Step 10490 (27 ms): -217.66.
Step 10528 (12 ms): -203.92.

Epoch 28 (9.58 s):
    Evaluating model.
    Full set (4.91 s): ELBO: -205.31, ENRE: -199.56, KL: 5.7455.
    Saving model parameters.
    Model parameters saved (71 ms).

Step 10566 (25 ms): -209.62.
Step 10603 (25 ms): -219.51.
Step 10641 (25 ms): -201.39.
Step 10678 (26 ms): -195.41.
Step 10716 (26 ms): -191.6.
Step 10754 (27 ms): -201.55.
Step 10791 (25 ms): -203.85.
Step 10829 (25 ms): -191.97.
Step 10866 (25 ms): -194.45.
Step 10904 (12 ms): -202.92.

Epoch 29 (9.59 s):
    Evaluating model.
    Full set (5.02 s): ELBO: -205.24, ENRE: -199.42, KL: 5.814.
    Saving model parameters.
    Model parameters saved (72 ms).

Step 10942 (26 ms): -196.84.
Step 10979 (25 ms): -198.93.
Step 11017 (25 ms): -201.44.
Step 11054 (25 ms): -196.51.
Step 11092 (26 ms): -222.3.
Step 11130 (26 ms): -212.52.
Step 11167 (25 ms): -197.69.
Step 11205 (26 ms): -203.4.
Step 11242 (25 ms): -197.57.
Step 11280 (12 ms): -228.8.

Epoch 30 (9.61 s):
    Evaluating model.
    Full set (4.94 s): ELBO: -204.82, ENRE: -198.91, KL: 5.9132.
    Saving model parameters.
    Model parameters saved (68 ms).

Step 11318 (25 ms): -198.91.
Step 11355 (25 ms): -200.51.
Step 11393 (25 ms): -196.87.
Step 11430 (25 ms): -209.11.
Step 11468 (25 ms): -198.07.
Step 11506 (25 ms): -201.84.
Step 11543 (25 ms): -210.28.
Step 11581 (25 ms): -203.06.
Step 11618 (25 ms): -209.42.
Step 11656 (12 ms): -182.42.

Epoch 31 (9.44 s):
    Evaluating model.
    Full set (4.98 s): ELBO: -204.55, ENRE: -198.73, KL: 5.8229.
    Saving model parameters.
    Model parameters saved (76 ms).

Step 11694 (25 ms): -205.02.
Step 11731 (26 ms): -205.54.
Step 11769 (25 ms): -191.9.
Step 11806 (26 ms): -211.48.
Step 11844 (26 ms): -198.55.
Step 11882 (26 ms): -211.23.
Step 11919 (26 ms): -204.98.
Step 11957 (25 ms): -192.51.
Step 11994 (26 ms): -194.99.
Step 12032 (12 ms): -278.22.

Epoch 32 (9.62 s):
    Evaluating model.
    Full set (5.03 s): ELBO: -204.58, ENRE: -198.75, KL: 5.8284.
    Saving model parameters.
    Model parameters saved (72 ms).

Step 12070 (26 ms): -199.52.
Step 12107 (26 ms): -203.62.
Step 12145 (26 ms): -194.48.
Step 12182 (25 ms): -197.72.
Step 12220 (25 ms): -206.07.
Step 12258 (25 ms): -193.76.
Step 12295 (25 ms): -203.98.
Step 12333 (25 ms): -227.97.
Step 12370 (26 ms): -209.19.
Step 12408 (11 ms): -220.76.

Epoch 33 (9.57 s):
    Evaluating model.
    Full set (4.89 s): ELBO: -204.15, ENRE: -198.25, KL: 5.8993.
    Saving model parameters.
    Model parameters saved (72 ms).

Step 12446 (25 ms): -194.19.
Step 12483 (25 ms): -201.34.
Step 12521 (25 ms): -197.48.
Step 12558 (26 ms): -206.03.
Step 12596 (26 ms): -196.52.
Step 12634 (26 ms): -201.71.
Step 12671 (25 ms): -213.36.
Step 12709 (25 ms): -204.86.
Step 12746 (26 ms): -219.14.
Step 12784 (12 ms): -570.65.

Epoch 34 (9.6 s):
    Evaluating model.
    Full set (5.02 s): ELBO: -204.09, ENRE: -198.18, KL: 5.9113.
    Saving model parameters.
    Model parameters saved (73 ms).

Step 12822 (26 ms): -202.86.
Step 12859 (25 ms): -194.37.
Step 12897 (25 ms): -196.53.
Step 12934 (26 ms): -200.58.
Step 12972 (26 ms): -197.2.
Step 13010 (25 ms): -203.17.
Step 13047 (26 ms): -201.66.
Step 13085 (25 ms): -207.28.
Step 13122 (26 ms): -203.59.
Step 13160 (12 ms): -188.57.

Epoch 35 (9.63 s):
    Evaluating model.
    Full set (4.93 s): ELBO: -204.1, ENRE: -198.41, KL: 5.6924.
    Saving model parameters.
    Model parameters saved (70 ms).

Step 13198 (26 ms): -217.56.
Step 13235 (25 ms): -201.24.
Step 13273 (25 ms): -197.53.
Step 13310 (25 ms): -204.25.
Step 13348 (25 ms): -199.95.
Step 13386 (25 ms): -206.4.
Step 13423 (25 ms): -194.79.
Step 13461 (25 ms): -203.19.
Step 13498 (25 ms): -198.45.
Step 13536 (12 ms): -176.82.

Epoch 36 (9.43 s):
    Evaluating model.
    Full set (5.01 s): ELBO: -203.62, ENRE: -197.75, KL: 5.8696.
    Saving model parameters.
    Model parameters saved (70 ms).

Step 13574 (26 ms): -198.85.
Step 13611 (25 ms): -198.53.
Step 13649 (25 ms): -208.82.
Step 13686 (26 ms): -201.96.
Step 13724 (26 ms): -195.89.
Step 13762 (26 ms): -209.94.
Step 13799 (27 ms): -213.39.
Step 13837 (26 ms): -197.08.
Step 13874 (25 ms): -202.83.
Step 13912 (12 ms): -182.3.

Epoch 37 (9.58 s):
    Evaluating model.
    Full set (5 s): ELBO: -203.69, ENRE: -197.94, KL: 5.7496.
    Saving model parameters.
    Model parameters saved (73 ms).

Step 13950 (25 ms): -205.4.
Step 13987 (25 ms): -203.46.
Step 14025 (25 ms): -207.41.
Step 14062 (25 ms): -205.78.
Step 14100 (25 ms): -206.23.
Step 14138 (25 ms): -211.96.
Step 14175 (25 ms): -207.45.
Step 14213 (25 ms): -215.73.
Step 14250 (25 ms): -202.34.
Step 14288 (12 ms): -186.59.

Epoch 38 (9.48 s):
    Evaluating model.
    Full set (4.87 s): ELBO: -203.45, ENRE: -197.66, KL: 5.79.
    Saving model parameters.
    Model parameters saved (74 ms).

Step 14326 (25 ms): -203.54.
Step 14363 (25 ms): -227.58.
Step 14401 (25 ms): -199.73.
Step 14438 (26 ms): -201.1.
Step 14476 (26 ms): -206.7.
Step 14514 (26 ms): -194.31.
Step 14551 (25 ms): -222.45.
Step 14589 (25 ms): -194.81.
Step 14626 (26 ms): -199.22.
Step 14664 (12 ms): -215.9.

Epoch 39 (9.6 s):
    Evaluating model.
    Full set (5.02 s): ELBO: -203.3, ENRE: -197.52, KL: 5.7731.
    Saving model parameters.
    Model parameters saved (73 ms).

Step 14702 (28 ms): -211.35.
Step 14739 (26 ms): -203.89.
Step 14777 (25 ms): -208.12.
Step 14814 (26 ms): -212.57.
Step 14852 (26 ms): -206.65.
Step 14890 (26 ms): -198.96.
Step 14927 (25 ms): -192.37.
Step 14965 (25 ms): -192.85.
Step 15002 (26 ms): -191.75.
Step 15040 (12 ms): -199.44.

Epoch 40 (9.64 s):
    Evaluating model.
    Full set (4.93 s): ELBO: -203.16, ENRE: -197.42, KL: 5.7392.
    Saving model parameters.
    Model parameters saved (68 ms).

Step 15078 (25 ms): -202.67.
Step 15115 (25 ms): -200.11.
Step 15153 (25 ms): -206.78.
Step 15190 (25 ms): -206.46.
Step 15228 (25 ms): -193.5.
Step 15266 (26 ms): -207.8.
Step 15303 (25 ms): -197.26.
Step 15341 (25 ms): -217.36.
Step 15378 (25 ms): -216.19.
Step 15416 (12 ms): -213.31.

Epoch 41 (9.47 s):
    Evaluating model.
    Full set (5.01 s): ELBO: -203.02, ENRE: -197.3, KL: 5.7256.
    Saving model parameters.
    Model parameters saved (72 ms).

Step 15454 (25 ms): -209.88.
Step 15491 (25 ms): -201.35.
Step 15529 (25 ms): -193.79.
Step 15566 (26 ms): -205.19.
Step 15604 (26 ms): -189.61.
Step 15642 (25 ms): -198.63.
Step 15679 (26 ms): -187.92.
Step 15717 (25 ms): -205.7.
Step 15754 (26 ms): -214.23.
Step 15792 (12 ms): -237.71.

Epoch 42 (9.63 s):
    Evaluating model.
    Full set (5.01 s): ELBO: -202.95, ENRE: -197.2, KL: 5.751.
    Saving model parameters.
    Model parameters saved (74 ms).

Step 15830 (26 ms): -202.94.
Step 15867 (25 ms): -196.92.
Step 15905 (26 ms): -211.34.
Step 15942 (25 ms): -198.42.
Step 15980 (25 ms): -201.23.
Step 16018 (25 ms): -207.57.
Step 16055 (25 ms): -183.95.
Step 16093 (25 ms): -203.58.
Step 16130 (25 ms): -203.22.
Step 16168 (11 ms): -179.

Epoch 43 (9.49 s):
    Evaluating model.
    Full set (4.87 s): ELBO: -202.84, ENRE: -197, KL: 5.8416.
    Saving model parameters.
    Model parameters saved (71 ms).

Step 16206 (25 ms): -211.03.
Step 16243 (26 ms): -207.56.
Step 16281 (26 ms): -209.59.
Step 16318 (25 ms): -200.79.
Step 16356 (25 ms): -202.81.
Step 16394 (26 ms): -215.78.
Step 16431 (26 ms): -204.91.
Step 16469 (25 ms): -218.35.
Step 16506 (26 ms): -204.19.
Step 16544 (12 ms): -185.07.

Epoch 44 (9.57 s):
    Evaluating model.
    Full set (5 s): ELBO: -202.8, ENRE: -197.04, KL: 5.7567.
    Saving model parameters.
    Model parameters saved (73 ms).

Step 16582 (26 ms): -200.11.
Step 16619 (25 ms): -207.15.
Step 16657 (26 ms): -211.58.
Step 16694 (26 ms): -193.74.
Step 16732 (25 ms): -199.94.
Step 16770 (25 ms): -196.2.
Step 16807 (26 ms): -189.91.
Step 16845 (26 ms): -218.23.
Step 16882 (25 ms): -200.18.
Step 16920 (12 ms): -184.64.

Epoch 45 (9.6 s):
    Evaluating model.
    Full set (4.95 s): ELBO: -202.69, ENRE: -196.98, KL: 5.7065.
    Saving model parameters.
    Model parameters saved (70 ms).

Step 16958 (25 ms): -199.
Step 16995 (25 ms): -206.85.
Step 17033 (25 ms): -216.98.
Step 17070 (25 ms): -195.37.
Step 17108 (25 ms): -202.23.
Step 17146 (25 ms): -203.98.
Step 17183 (25 ms): -203.2.
Step 17221 (25 ms): -194.42.
Step 17258 (25 ms): -217.5.
Step 17296 (12 ms): -200.21.

Epoch 46 (9.5 s):
    Evaluating model.
    Full set (5.03 s): ELBO: -202.56, ENRE: -196.87, KL: 5.6862.
    Saving model parameters.
    Model parameters saved (71 ms).

Step 17334 (26 ms): -200.33.
Step 17371 (25 ms): -211.49.
Step 17409 (25 ms): -196.09.
Step 17446 (26 ms): -194.66.
Step 17484 (25 ms): -198.43.
Step 17522 (26 ms): -198.13.
Step 17559 (25 ms): -209.48.
Step 17597 (26 ms): -205.61.
Step 17634 (26 ms): -206.09.
Step 17672 (12 ms): -191.87.

Epoch 47 (9.66 s):
    Evaluating model.
    Full set (5.02 s): ELBO: -202.49, ENRE: -196.73, KL: 5.7592.
    Saving model parameters.
    Model parameters saved (74 ms).

Step 17710 (26 ms): -203.86.
Step 17747 (28 ms): -206.15.
Step 17785 (25 ms): -207.9.
Step 17822 (25 ms): -195.1.
Step 17860 (25 ms): -202.85.
Step 17898 (25 ms): -196.52.
Step 17935 (25 ms): -206.58.
Step 17973 (25 ms): -214.07.
Step 18010 (25 ms): -193.14.
Step 18048 (12 ms): -199.94.

Epoch 48 (9.5 s):
    Evaluating model.
    Full set (4.89 s): ELBO: -202.29, ENRE: -196.45, KL: 5.8408.
    Saving model parameters.
    Model parameters saved (73 ms).

Step 18086 (26 ms): -214.17.
Step 18123 (26 ms): -204.48.
Step 18161 (25 ms): -211.04.
Step 18198 (26 ms): -202.87.
Step 18236 (26 ms): -210.44.
Step 18274 (26 ms): -194.99.
Step 18311 (25 ms): -212.74.
Step 18349 (25 ms): -197.01.
Step 18386 (25 ms): -211.62.
Step 18424 (12 ms): -190.53.

Epoch 49 (9.61 s):
    Evaluating model.
    Full set (5.01 s): ELBO: -202.2, ENRE: -196.45, KL: 5.7581.
    Saving model parameters.
    Model parameters saved (73 ms).

Step 18462 (25 ms): -211.1.
Step 18499 (26 ms): -206.38.
Step 18537 (26 ms): -198.17.
Step 18574 (25 ms): -196.79.
Step 18612 (25 ms): -192.92.
Step 18650 (26 ms): -199.84.
Step 18687 (26 ms): -206.31.
Step 18725 (25 ms): -195.84.
Step 18762 (26 ms): -202.36.
Step 18800 (12 ms): -265.29.

Epoch 50 (9.58 s):
    Evaluating model.
    Full set (4.9 s): ELBO: -202.19, ENRE: -196.41, KL: 5.7833.
    Saving model parameters.
    Model parameters saved (70 ms).

Model trained for 50 epochs (12m 14s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (10 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (896 ms).

Converting data set value array to sparse matrix.
Data set value array converted (304 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.44 s):  ELBO: -418.61, ENRE: -412.82, KL: 5.7841.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (449 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.3138885179334705
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 48
kl weight: 1.3138885179334705
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (47 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.66 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 48
    hidden sizes: 73, 293, 118
    latent distribution: gaussian
    reconstruction distribution: gaussian
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.3138885179334705
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 2 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 73)
    ENCODER/1/DENSE/biases:0             (73,)
    ENCODER/1/BATCH_NORM/beta:0          (73,)
    ENCODER/2/DENSE/weights:0            (73, 293)
    ENCODER/2/DENSE/biases:0             (293,)
    ENCODER/2/BATCH_NORM/beta:0          (293,)
    ENCODER/3/DENSE/weights:0            (293, 118)
    ENCODER/3/DENSE/biases:0             (118,)
    ENCODER/3/BATCH_NORM/beta:0          (118,)
    POSTERIOR/MU/DENSE/weights:0         (118, 48)
    POSTERIOR/MU/DENSE/biases:0          (48,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (118, 48)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (48,)
    DECODER/3/DENSE/weights:0            (48, 118)
    DECODER/3/DENSE/biases:0             (118,)
    DECODER/3/BATCH_NORM/beta:0          (118,)
    DECODER/2/DENSE/weights:0            (118, 293)
    DECODER/2/DENSE/biases:0             (293,)
    DECODER/2/BATCH_NORM/beta:0          (293,)
    DECODER/1/DENSE/weights:0            (293, 73)
    DECODER/1/DENSE/biases:0             (73,)
    DECODER/1/BATCH_NORM/beta:0          (73,)
    X_TILDE/MU/DENSE/weights:0           (73, 2000)
    X_TILDE/MU/DENSE/biases:0            (2000,)
    X_TILDE/LOG_SIGMA/DENSE/weights:0    (73, 2000)
    X_TILDE/LOG_SIGMA/DENSE/biases:0     (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (391 ms).

Training model for 50 epochs on original values.

Step 38 (29 ms): -4173.3.
Step 75 (28 ms): -3312.
Step 113 (28 ms): -2778.2.
Step 150 (28 ms): -2469.4.
Step 188 (27 ms): -1956.9.
Step 226 (28 ms): -1528.2.
Step 263 (27 ms): -1203.4.
Step 301 (27 ms): -815.35.
Step 338 (29 ms): -489.02.
Step 376 (14 ms): -191.34.

Epoch 1 (12.5 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (5.22 s): ELBO: -2240.4, ENRE: -2205.5, KL: 34.97.
    Saving model parameters.
    Model parameters saved (148 ms).

Step 414 (28 ms): 107.39.
Step 451 (27 ms): 497.29.
Step 489 (27 ms): 746.98.
Step 526 (27 ms): 1065.4.
Step 564 (27 ms): 1244.2.
Step 602 (27 ms): 1589.2.
Step 639 (27 ms): 1817.
Step 677 (27 ms): 1952.2.
Step 714 (27 ms): 2176.1.
Step 752 (14 ms): 2091.8.

Epoch 2 (10.2 s):
    Warm-up weight: 0.5
    Evaluating model.
    Full set (4.66 s): ELBO: 374.14, ENRE: 392.07, KL: 17.935.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 790 (27 ms): 2297.6.
Step 827 (27 ms): 2254.8.
Step 865 (28 ms): 2267.4.
Step 902 (27 ms): 2398.6.
Step 940 (28 ms): 2255.2.
Step 978 (28 ms): 2317.1.
Step 1015 (27 ms): 2046.7.
Step 1053 (27 ms): 2332.5.
Step 1090 (28 ms): 2497.4.
Step 1128 (13 ms): 2637.7.

Epoch 3 (10.3 s):
    Evaluating model.
    Full set (4.73 s): ELBO: 1402.8, ENRE: 1414.6, KL: 11.806.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 1166 (28 ms): 2487.3.
Step 1203 (27 ms): 2422.5.
Step 1241 (29 ms): 2414.1.
Step 1278 (27 ms): 2373.5.
Step 1316 (27 ms): 2423.
Step 1354 (27 ms): 2430.8.
Step 1391 (27 ms): 2425.7.
Step 1429 (27 ms): 2442.
Step 1466 (27 ms): 2524.1.
Step 1504 (13 ms): 2249.3.

Epoch 4 (10.3 s):
    Evaluating model.
    Full set (4.62 s): ELBO: 1908, ENRE: 1920.1, KL: 12.055.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 1542 (27 ms): 2372.6.
Step 1579 (27 ms): 2354.
Step 1617 (27 ms): 2445.8.
Step 1654 (27 ms): 2486.9.
Step 1692 (27 ms): 2653.
Step 1730 (27 ms): 2372.7.
Step 1767 (27 ms): 2435.9.
Step 1805 (27 ms): 2488.1.
Step 1842 (27 ms): 2443.7.
Step 1880 (12 ms): 2426.7.

Epoch 5 (10.2 s):
    Evaluating model.
    Full set (4.73 s): ELBO: 2215.2, ENRE: 2229.1, KL: 13.907.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 1918 (27 ms): 2436.7.
Step 1955 (27 ms): 2444.5.
Step 1993 (27 ms): 2378.5.
Step 2030 (27 ms): 2332.
Step 2068 (27 ms): 2575.3.
Step 2106 (27 ms): 2565.4.
Step 2143 (27 ms): 2559.1.
Step 2181 (27 ms): 2420.2.
Step 2218 (27 ms): 2630.1.
Step 2256 (13 ms): 2392.9.

Epoch 6 (10.2 s):
    Evaluating model.
    Full set (4.64 s): ELBO: 2373.8, ENRE: 2390.3, KL: 16.435.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 2294 (27 ms): 2354.
Step 2331 (27 ms): 2366.7.
Step 2369 (27 ms): 2389.3.
Step 2406 (26 ms): 2544.7.
Step 2444 (26 ms): 2504.3.
Step 2482 (27 ms): 2425.2.
Step 2519 (27 ms): 2604.1.
Step 2557 (27 ms): 2546.8.
Step 2594 (27 ms): 2138.
Step 2632 (12 ms): 1160.5.

Epoch 7 (10.1 s):
    Evaluating model.
    Full set (4.67 s): ELBO: 2431, ENRE: 2449.2, KL: 18.174.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 2670 (27 ms): 2533.1.
Step 2707 (27 ms): 2552.8.
Step 2745 (27 ms): 2495.7.
Step 2782 (27 ms): 2572.3.
Step 2820 (28 ms): 2462.8.
Step 2858 (27 ms): 2495.6.
Step 2895 (27 ms): 2518.8.
Step 2933 (27 ms): 2493.5.
Step 2970 (27 ms): 2508.8.
Step 3008 (13 ms): 1710.5.

Epoch 8 (10.3 s):
    Evaluating model.
    Full set (4.7 s): ELBO: 2464.8, ENRE: 2484.5, KL: 19.724.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 3046 (27 ms): 2677.5.
Step 3083 (27 ms): 2545.7.
Step 3121 (27 ms): 2579.6.
Step 3158 (28 ms): 2623.2.
Step 3196 (27 ms): 2342.6.
Step 3234 (27 ms): 2149.4.
Step 3271 (27 ms): 2551.1.
Step 3309 (27 ms): 2654.7.
Step 3346 (27 ms): 2588.3.
Step 3384 (13 ms): 1745.5.

Epoch 9 (10.2 s):
    Evaluating model.
    Full set (4.56 s): ELBO: 2477, ENRE: 2497.3, KL: 20.22.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 3422 (26 ms): 2536.5.
Step 3459 (27 ms): 2549.5.
Step 3497 (27 ms): 2545.7.
Step 3534 (27 ms): 2613.7.
Step 3572 (27 ms): 2548.6.
Step 3610 (28 ms): 2529.7.
Step 3647 (27 ms): 2628.1.
Step 3685 (27 ms): 2600.2.
Step 3722 (27 ms): 2503.6.
Step 3760 (13 ms): 2554.8.

Epoch 10 (10.2 s):
    Evaluating model.
    Full set (4.7 s): ELBO: 2476, ENRE: 2497.2, KL: 21.139.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 3798 (27 ms): 2675.4.
Step 3835 (27 ms): 2477.7.
Step 3873 (27 ms): 2673.5.
Step 3910 (28 ms): 2570.6.
Step 3948 (27 ms): 2594.3.
Step 3986 (28 ms): 2579.6.
Step 4023 (27 ms): 2542.8.
Step 4061 (27 ms): 2669.8.
Step 4098 (27 ms): 2576.
Step 4136 (12 ms): 2066.7.

Epoch 11 (10.2 s):
    Evaluating model.
    Full set (4.6 s): ELBO: 2398.1, ENRE: 2420.8, KL: 22.767.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 4174 (27 ms): 2657.2.
Step 4211 (26 ms): 2629.6.
Step 4249 (27 ms): 2564.6.
Step 4286 (27 ms): 2634.8.
Step 4324 (26 ms): 2535.5.
Step 4362 (26 ms): 2692.8.
Step 4399 (27 ms): 2650.6.
Step 4437 (27 ms): 2654.3.
Step 4474 (27 ms): 2572.7.
Step 4512 (12 ms): 2300.4.

Epoch 12 (10.1 s):
    Evaluating model.
    Full set (4.68 s): ELBO: 2450, ENRE: 2472.1, KL: 22.064.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 4550 (27 ms): 2667.1.
Step 4587 (27 ms): 2548.9.
Step 4625 (27 ms): 2534.5.
Step 4662 (27 ms): 2503.1.
Step 4700 (27 ms): 2527.3.
Step 4738 (27 ms): 2641.2.
Step 4775 (28 ms): 2612.8.
Step 4813 (27 ms): 2574.2.
Step 4850 (27 ms): 2571.6.
Step 4888 (13 ms): 1489.7.

Epoch 13 (10.2 s):
    Evaluating model.
    Full set (4.68 s): ELBO: 2456.1, ENRE: 2477.8, KL: 21.685.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 4926 (27 ms): 2628.5.
Step 4963 (27 ms): 2505.7.
Step 5001 (28 ms): 2602.
Step 5038 (27 ms): 2569.8.
Step 5076 (27 ms): 2593.3.
Step 5114 (27 ms): 2645.3.
Step 5151 (27 ms): 2567.
Step 5189 (27 ms): 2572.8.
Step 5226 (27 ms): 2627.
Step 5264 (12 ms): 1932.9.

Epoch 14 (10.1 s):
    Evaluating model.
    Full set (4.6 s): ELBO: 2469.6, ENRE: 2490.4, KL: 20.85.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 5302 (27 ms): 2595.1.
Step 5339 (27 ms): 2637.7.
Step 5377 (28 ms): 2518.5.
Step 5414 (27 ms): 2489.2.
Step 5452 (27 ms): 2602.
Step 5490 (28 ms): 2636.9.
Step 5527 (28 ms): 2640.4.
Step 5565 (28 ms): 2695.6.
Step 5602 (28 ms): 2701.3.
Step 5640 (13 ms): 1313.7.

Epoch 15 (10.3 s):
    Evaluating model.
    Full set (4.69 s): ELBO: 2463.5, ENRE: 2485, KL: 21.549.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 5678 (28 ms): 2551.5.
Step 5715 (27 ms): 2508.6.
Step 5753 (27 ms): 2631.9.
Step 5790 (27 ms): 2701.9.
Step 5828 (27 ms): 2725.1.
Step 5866 (27 ms): 2558.1.
Step 5903 (27 ms): 2568.9.
Step 5941 (27 ms): 2695.6.
Step 5978 (27 ms): 2506.3.
Step 6016 (13 ms): 2609.

Epoch 16 (10.2 s):
    Evaluating model.
    Full set (4.58 s): ELBO: 2511.6, ENRE: 2532.4, KL: 20.771.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 6054 (26 ms): 2582.8.
Step 6091 (27 ms): 2401.9.
Step 6129 (27 ms): 2605.9.
Step 6166 (29 ms): 2617.3.
Step 6204 (27 ms): 2668.9.
Step 6242 (27 ms): 2683.1.
Step 6279 (27 ms): 2582.4.
Step 6317 (27 ms): 2597.6.
Step 6354 (27 ms): 2606.9.
Step 6392 (13 ms): 2182.5.

Epoch 17 (10.2 s):
    Evaluating model.
    Full set (4.68 s): ELBO: 2501.9, ENRE: 2522.1, KL: 20.236.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 6430 (27 ms): 2575.
Step 6467 (27 ms): 2675.7.
Step 6505 (27 ms): 2684.9.
Step 6542 (27 ms): 2675.6.
Step 6580 (28 ms): 2635.3.
Step 6618 (27 ms): 2621.
Step 6655 (27 ms): 2468.4.
Step 6693 (27 ms): 2645.7.
Step 6730 (27 ms): 2693.8.
Step 6768 (13 ms): 2236.6.

Epoch 18 (10.2 s):
    Evaluating model.
    Full set (4.64 s): ELBO: 2537, ENRE: 2557, KL: 19.985.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 6806 (28 ms): 2717.1.
Step 6843 (27 ms): 2639.1.
Step 6881 (27 ms): 2633.4.
Step 6918 (27 ms): 2410.
Step 6956 (26 ms): 2636.8.
Step 6994 (26 ms): 2626.6.
Step 7031 (27 ms): 2616.9.
Step 7069 (27 ms): 2543.8.
Step 7106 (26 ms): 2657.2.
Step 7144 (12 ms): 2698.9.

Epoch 19 (10.1 s):
    Evaluating model.
    Full set (4.63 s): ELBO: 2557.1, ENRE: 2576.3, KL: 19.285.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 7182 (27 ms): 2616.4.
Step 7219 (27 ms): 2605.3.
Step 7257 (27 ms): 2756.
Step 7294 (28 ms): 2553.3.
Step 7332 (28 ms): 2637.4.
Step 7370 (27 ms): 2636.8.
Step 7407 (27 ms): 2661.5.
Step 7445 (27 ms): 2674.4.
Step 7482 (27 ms): 2731.8.
Step 7520 (13 ms): 1914.3.

Epoch 20 (10.2 s):
    Evaluating model.
    Full set (4.69 s): ELBO: 2543, ENRE: 2563.8, KL: 20.709.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 7558 (27 ms): 2614.3.
Step 7595 (27 ms): 2645.
Step 7633 (28 ms): 2648.
Step 7670 (27 ms): 2614.9.
Step 7708 (28 ms): 2635.3.
Step 7746 (27 ms): 2628.7.
Step 7783 (27 ms): 2618.4.
Step 7821 (27 ms): 2737.3.
Step 7858 (27 ms): 2586.1.
Step 7896 (13 ms): 2025.9.

Epoch 21 (10.2 s):
    Evaluating model.
    Full set (4.56 s): ELBO: 2551.5, ENRE: 2572.2, KL: 20.684.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 7934 (29 ms): 2657.7.
Step 7971 (27 ms): 2607.2.
Step 8009 (27 ms): 2654.2.
Step 8046 (27 ms): 2665.5.
Step 8084 (27 ms): 2686.5.
Step 8122 (27 ms): 2655.7.
Step 8159 (27 ms): 2725.4.
Step 8197 (27 ms): 2555.4.
Step 8234 (29 ms): 2645.
Step 8272 (13 ms): 2598.8.

Epoch 22 (10.2 s):
    Evaluating model.
    Full set (4.7 s): ELBO: 2566.8, ENRE: 2587.4, KL: 20.595.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 8310 (27 ms): 2521.6.
Step 8347 (27 ms): 2716.
Step 8385 (27 ms): 2659.1.
Step 8422 (27 ms): 2642.4.
Step 8460 (27 ms): 2566.8.
Step 8498 (27 ms): 2685.3.
Step 8535 (27 ms): 2615.5.
Step 8573 (28 ms): 2713.2.
Step 8610 (28 ms): 2672.7.
Step 8648 (13 ms): 2356.9.

Epoch 23 (10.2 s):
    Evaluating model.
    Full set (4.6 s): ELBO: 2603.6, ENRE: 2622.9, KL: 19.321.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 8686 (27 ms): 2801.5.
Step 8723 (27 ms): 2692.2.
Step 8761 (27 ms): 2640.9.
Step 8798 (27 ms): 2652.8.
Step 8836 (27 ms): 2793.7.
Step 8874 (27 ms): 2508.4.
Step 8911 (27 ms): 2704.
Step 8949 (27 ms): 2566.
Step 8986 (27 ms): 2598.9.
Step 9024 (12 ms): 2106.

Epoch 24 (10.1 s):
    Evaluating model.
    Full set (4.69 s): ELBO: 2591.4, ENRE: 2611.4, KL: 19.964.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 9062 (27 ms): 2673.7.
Step 9099 (27 ms): 2654.9.
Step 9137 (27 ms): 2675.4.
Step 9174 (27 ms): 2744.4.
Step 9212 (27 ms): 2716.9.
Step 9250 (27 ms): 2680.9.
Step 9287 (27 ms): 2753.1.
Step 9325 (27 ms): 2585.6.
Step 9362 (27 ms): 2587.6.
Step 9400 (13 ms): 1975.

Epoch 25 (10.2 s):
    Evaluating model.
    Full set (4.67 s): ELBO: 2495.9, ENRE: 2519.4, KL: 23.515.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 9438 (27 ms): 2690.7.
Step 9475 (27 ms): 2712.1.
Step 9513 (27 ms): 2720.2.
Step 9550 (26 ms): 2749.5.
Step 9588 (27 ms): 2679.1.
Step 9626 (27 ms): 2705.3.
Step 9663 (27 ms): 2468.2.
Step 9701 (27 ms): 2720.4.
Step 9738 (27 ms): 2614.
Step 9776 (12 ms): 1256.3.

Epoch 26 (10.1 s):
    Evaluating model.
    Full set (4.55 s): ELBO: 2566.9, ENRE: 2588.1, KL: 21.166.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 9814 (27 ms): 2625.7.
Step 9851 (27 ms): 2664.
Step 9889 (27 ms): 2759.7.
Step 9926 (27 ms): 2679.
Step 9964 (28 ms): 2545.1.
Step 10002 (27 ms): 2640.8.
Step 10039 (27 ms): 2697.6.
Step 10077 (27 ms): 2623.9.
Step 10114 (27 ms): 2704.8.
Step 10152 (13 ms): 2276.

Epoch 27 (10.2 s):
    Evaluating model.
    Full set (4.7 s): ELBO: 2561.5, ENRE: 2583.1, KL: 21.644.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 10190 (27 ms): 2715.1.
Step 10227 (28 ms): 2655.3.
Step 10265 (27 ms): 2581.8.
Step 10302 (27 ms): 2651.8.
Step 10340 (27 ms): 2671.3.
Step 10378 (27 ms): 2735.4.
Step 10415 (27 ms): 2603.4.
Step 10453 (27 ms): 2768.9.
Step 10490 (27 ms): 2670.8.
Step 10528 (12 ms): -954.27.

Epoch 28 (10.2 s):
    Evaluating model.
    Full set (4.58 s): ELBO: 2540.9, ENRE: 2562.4, KL: 21.464.
    Saving model parameters.
    Model parameters saved (87 ms).

Step 10566 (27 ms): 2604.
Step 10603 (27 ms): 2705.9.
Step 10641 (27 ms): 2652.6.
Step 10678 (27 ms): 2660.9.
Step 10716 (27 ms): 2721.4.
Step 10754 (27 ms): 2774.3.
Step 10791 (27 ms): 2664.6.
Step 10829 (28 ms): 2640.4.
Step 10866 (27 ms): 2657.2.
Step 10904 (13 ms): -666.47.

Epoch 29 (10.1 s):
    Evaluating model.
    Full set (4.68 s): ELBO: 2546.1, ENRE: 2568.2, KL: 22.085.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 10942 (27 ms): 2684.5.
Step 10979 (27 ms): 2602.6.
Step 11017 (27 ms): 2578.5.
Step 11054 (27 ms): 2770.9.
Step 11092 (27 ms): 2718.7.
Step 11130 (28 ms): 2661.7.
Step 11167 (27 ms): 2707.
Step 11205 (28 ms): 2738.
Step 11242 (27 ms): 2714.1.
Step 11280 (13 ms): 2230.9.

Epoch 30 (10.2 s):
    Evaluating model.
    Full set (4.67 s): ELBO: 2539.9, ENRE: 2561.3, KL: 21.349.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 11318 (27 ms): 2748.9.
Step 11355 (26 ms): 2738.2.
Step 11393 (27 ms): 2735.4.
Step 11430 (27 ms): 2672.8.
Step 11468 (26 ms): 2717.
Step 11506 (26 ms): 2696.3.
Step 11543 (26 ms): 2735.
Step 11581 (26 ms): 2703.3.
Step 11618 (27 ms): 2665.8.
Step 11656 (12 ms): 1428.5.

Epoch 31 (10 s):
    Evaluating model.
    Full set (4.6 s): ELBO: 2560.7, ENRE: 2582.1, KL: 21.37.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 11694 (27 ms): 2718.8.
Step 11731 (27 ms): 2667.4.
Step 11769 (27 ms): 2676.4.
Step 11806 (27 ms): 2695.1.
Step 11844 (32 ms): 2726.6.
Step 11882 (26 ms): 2797.3.
Step 11919 (27 ms): 2762.5.
Step 11957 (27 ms): 2708.1.
Step 11994 (27 ms): 2604.8.
Step 12032 (13 ms): 2168.8.

Epoch 32 (10.2 s):
    Evaluating model.
    Full set (4.67 s): ELBO: 2531, ENRE: 2553.3, KL: 22.284.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 12070 (27 ms): 2591.8.
Step 12107 (27 ms): 2753.3.
Step 12145 (28 ms): 2802.8.
Step 12182 (28 ms): 2767.1.
Step 12220 (27 ms): 2718.7.
Step 12258 (27 ms): 2701.7.
Step 12295 (27 ms): 2626.5.
Step 12333 (27 ms): 2677.3.
Step 12370 (27 ms): 2672.8.
Step 12408 (13 ms): 1478.8.

Epoch 33 (10.1 s):
    Evaluating model.
    Full set (4.53 s): ELBO: 2580.2, ENRE: 2602.3, KL: 22.107.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 12446 (27 ms): 2639.7.
Step 12483 (27 ms): 2679.1.
Step 12521 (27 ms): 2726.5.
Step 12558 (27 ms): 2629.8.
Step 12596 (27 ms): 2699.2.
Step 12634 (27 ms): 2708.2.
Step 12671 (27 ms): 2755.
Step 12709 (28 ms): 2714.9.
Step 12746 (27 ms): 2784.7.
Step 12784 (13 ms): 2050.1.

Epoch 34 (10.2 s):
    Evaluating model.
    Full set (4.68 s): ELBO: 2565.2, ENRE: 2587.8, KL: 22.651.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 12822 (29 ms): 2783.2.
Step 12859 (27 ms): 2660.7.
Step 12897 (27 ms): 2743.4.
Step 12934 (27 ms): 2684.2.
Step 12972 (27 ms): 2695.2.
Step 13010 (27 ms): 2656.5.
Step 13047 (27 ms): 2737.3.
Step 13085 (28 ms): 2706.3.
Step 13122 (27 ms): 2697.5.
Step 13160 (13 ms): 1528.7.

Epoch 35 (10.3 s):
    Evaluating model.
    Full set (4.63 s): ELBO: 2618.2, ENRE: 2639.1, KL: 20.953.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 13198 (27 ms): 2749.2.
Step 13235 (27 ms): 2667.8.
Step 13273 (26 ms): 2762.1.
Step 13310 (26 ms): 2683.9.
Step 13348 (27 ms): 2706.9.
Step 13386 (27 ms): 2689.5.
Step 13423 (27 ms): 2646.8.
Step 13461 (27 ms): 2710.9.
Step 13498 (27 ms): 2730.5.
Step 13536 (13 ms): 1438.6.

Epoch 36 (10.1 s):
    Evaluating model.
    Full set (4.67 s): ELBO: 2545.8, ENRE: 2567.8, KL: 21.987.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 13574 (27 ms): 2674.3.
Step 13611 (27 ms): 2761.8.
Step 13649 (27 ms): 2681.9.
Step 13686 (27 ms): 2722.5.
Step 13724 (27 ms): 2710.6.
Step 13762 (27 ms): 2754.6.
Step 13799 (28 ms): 2563.6.
Step 13837 (27 ms): 2727.
Step 13874 (27 ms): 2762.9.
Step 13912 (13 ms): 1763.3.

Epoch 37 (10.2 s):
    Evaluating model.
    Full set (4.67 s): ELBO: 2616.9, ENRE: 2637.8, KL: 20.892.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 13950 (27 ms): 2778.2.
Step 13987 (27 ms): 2701.7.
Step 14025 (27 ms): 2774.6.
Step 14062 (27 ms): 2724.2.
Step 14100 (27 ms): 2728.9.
Step 14138 (27 ms): 2726.9.
Step 14175 (27 ms): 2783.5.
Step 14213 (26 ms): 2722.9.
Step 14250 (26 ms): 2709.7.
Step 14288 (12 ms): -3918.3.

Epoch 38 (10.1 s):
    Evaluating model.
    Full set (4.52 s): ELBO: 2620.2, ENRE: 2641.8, KL: 21.569.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 14326 (26 ms): 2697.1.
Step 14363 (26 ms): 2638.5.
Step 14401 (27 ms): 2747.1.
Step 14438 (27 ms): 2718.3.
Step 14476 (27 ms): 2643.3.
Step 14514 (27 ms): 2777.3.
Step 14551 (27 ms): 2796.3.
Step 14589 (27 ms): 2695.2.
Step 14626 (27 ms): 2721.7.
Step 14664 (13 ms): 2299.2.

Epoch 39 (10.2 s):
    Evaluating model.
    Full set (4.67 s): ELBO: 2564, ENRE: 2587.2, KL: 23.219.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 14702 (27 ms): 2626.8.
Step 14739 (27 ms): 2646.8.
Step 14777 (27 ms): 2793.8.
Step 14814 (27 ms): 2695.4.
Step 14852 (27 ms): 2740.2.
Step 14890 (27 ms): 2765.2.
Step 14927 (27 ms): 2690.5.
Step 14965 (27 ms): 2740.8.
Step 15002 (27 ms): 2717.7.
Step 15040 (13 ms): 974.93.

Epoch 40 (10.2 s):
    Evaluating model.
    Full set (4.57 s): ELBO: 2633.5, ENRE: 2655, KL: 21.507.
    Saving model parameters.
    Model parameters saved (87 ms).

Step 15078 (27 ms): 2665.5.
Step 15115 (26 ms): 2699.8.
Step 15153 (27 ms): 2690.5.
Step 15190 (27 ms): 2757.5.
Step 15228 (27 ms): 2703.4.
Step 15266 (27 ms): 2797.3.
Step 15303 (27 ms): 2794.4.
Step 15341 (28 ms): 2744.5.
Step 15378 (27 ms): 2612.5.
Step 15416 (13 ms): 2150.

Epoch 41 (10.1 s):
    Evaluating model.
    Full set (4.68 s): ELBO: 2631.7, ENRE: 2652.9, KL: 21.216.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 15454 (27 ms): 2742.3.
Step 15491 (28 ms): 2641.1.
Step 15529 (28 ms): 2756.8.
Step 15566 (27 ms): 2769.2.
Step 15604 (27 ms): 2693.4.
Step 15642 (27 ms): 2729.4.
Step 15679 (27 ms): 2711.5.
Step 15717 (28 ms): 2649.7.
Step 15754 (28 ms): 2733.5.
Step 15792 (12 ms): 1377.9.

Epoch 42 (10.3 s):
    Evaluating model.
    Full set (4.66 s): ELBO: 2653.6, ENRE: 2674.5, KL: 20.855.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 15830 (27 ms): 2816.7.
Step 15867 (27 ms): 2791.1.
Step 15905 (27 ms): 2641.4.
Step 15942 (26 ms): 2712.2.
Step 15980 (27 ms): 2625.9.
Step 16018 (26 ms): 2743.8.
Step 16055 (27 ms): 2727.5.
Step 16093 (27 ms): 2541.8.
Step 16130 (26 ms): 2771.2.
Step 16168 (13 ms): 2274.8.

Epoch 43 (10.1 s):
    Evaluating model.
    Full set (4.56 s): ELBO: 2670.1, ENRE: 2690.6, KL: 20.456.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 16206 (27 ms): 2659.4.
Step 16243 (28 ms): 2669.5.
Step 16281 (28 ms): 2757.5.
Step 16318 (27 ms): 2760.3.
Step 16356 (27 ms): 2683.5.
Step 16394 (27 ms): 2654.5.
Step 16431 (27 ms): 2717.8.
Step 16469 (27 ms): 2645.2.
Step 16506 (27 ms): 2777.
Step 16544 (13 ms): -5206.3.

Epoch 44 (10.2 s):
    Evaluating model.
    Full set (4.66 s): ELBO: 2686.9, ENRE: 2707, KL: 20.107.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 16582 (27 ms): 2757.4.
Step 16619 (27 ms): 2680.3.
Step 16657 (27 ms): 2721.7.
Step 16694 (27 ms): 2746.2.
Step 16732 (27 ms): 2691.1.
Step 16770 (27 ms): 2771.3.
Step 16807 (27 ms): 2714.3.
Step 16845 (27 ms): 2707.
Step 16882 (27 ms): 2725.5.
Step 16920 (13 ms): -1731.9.

Epoch 45 (10.1 s):
    Evaluating model.
    Full set (4.54 s): ELBO: 2615.8, ENRE: 2637.4, KL: 21.558.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 16958 (27 ms): 2749.4.
Step 16995 (26 ms): 2677.7.
Step 17033 (27 ms): 2732.
Step 17070 (26 ms): 2706.
Step 17108 (27 ms): 2772.6.
Step 17146 (27 ms): 2674.9.
Step 17183 (27 ms): 2711.6.
Step 17221 (28 ms): 2755.5.
Step 17258 (28 ms): 2726.3.
Step 17296 (13 ms): 205.32.

Epoch 46 (10.1 s):
    Evaluating model.
    Full set (4.68 s): ELBO: 2696, ENRE: 2716.2, KL: 20.152.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 17334 (28 ms): 2757.3.
Step 17371 (27 ms): 2733.8.
Step 17409 (27 ms): 2744.
Step 17446 (28 ms): 2765.9.
Step 17484 (27 ms): 2776.
Step 17522 (28 ms): 2710.3.
Step 17559 (28 ms): 2758.9.
Step 17597 (27 ms): 2679.6.
Step 17634 (27 ms): 2817.9.
Step 17672 (13 ms): 1684.6.

Epoch 47 (10.2 s):
    Evaluating model.
    Full set (4.61 s): ELBO: 2686.6, ENRE: 2707.2, KL: 20.65.
    Saving model parameters.
    Model parameters saved (87 ms).

Step 17710 (27 ms): 2736.8.
Step 17747 (27 ms): 2748.8.
Step 17785 (26 ms): 2807.2.
Step 17822 (27 ms): 2756.8.
Step 17860 (27 ms): 2746.
Step 17898 (27 ms): 2751.8.
Step 17935 (27 ms): 2731.3.
Step 17973 (26 ms): 2762.2.
Step 18010 (27 ms): 2678.4.
Step 18048 (13 ms): -3707.3.

Epoch 48 (10.1 s):
    Evaluating model.
    Full set (4.66 s): ELBO: 2717.5, ENRE: 2738.1, KL: 20.612.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 18086 (27 ms): 2667.
Step 18123 (27 ms): 2712.3.
Step 18161 (27 ms): 2783.5.
Step 18198 (27 ms): 2722.8.
Step 18236 (27 ms): 2786.4.
Step 18274 (27 ms): 2486.1.
Step 18311 (27 ms): 2758.
Step 18349 (27 ms): 2723.1.
Step 18386 (27 ms): 2728.6.
Step 18424 (13 ms): 2421.3.

Epoch 49 (10.2 s):
    Evaluating model.
    Full set (4.68 s): ELBO: 2732.7, ENRE: 2752.6, KL: 19.932.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 18462 (27 ms): 2728.4.
Step 18499 (28 ms): 2784.1.
Step 18537 (27 ms): 2790.6.
Step 18574 (27 ms): 2759.7.
Step 18612 (27 ms): 2766.3.
Step 18650 (27 ms): 2744.1.
Step 18687 (27 ms): 2736.
Step 18725 (27 ms): 2696.7.
Step 18762 (27 ms): 2843.3.
Step 18800 (12 ms): 1670.

Epoch 50 (10.1 s):
    Evaluating model.
    Full set (4.52 s): ELBO: 2715.6, ENRE: 2736.7, KL: 21.042.
    Saving model parameters.
    Model parameters saved (92 ms).

Model trained for 50 epochs (12m 30s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (10 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (866 ms).

Converting data set value array to sparse matrix.
Data set value array converted (267 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.47 s):  ELBO: -13129, ENRE: -13108, KL: 20.97.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (619 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.9651065925141176
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 20
kl weight: 1.9651065925141176
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (46 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (3.98 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.65 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 20
    hidden sizes: 153, 226, 77, 53
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.9651065925141176
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 1 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 153)
    ENCODER/1/DENSE/biases:0             (153,)
    ENCODER/1/BATCH_NORM/beta:0          (153,)
    ENCODER/2/DENSE/weights:0            (153, 226)
    ENCODER/2/DENSE/biases:0             (226,)
    ENCODER/2/BATCH_NORM/beta:0          (226,)
    ENCODER/3/DENSE/weights:0            (226, 77)
    ENCODER/3/DENSE/biases:0             (77,)
    ENCODER/3/BATCH_NORM/beta:0          (77,)
    ENCODER/4/DENSE/weights:0            (77, 53)
    ENCODER/4/DENSE/biases:0             (53,)
    ENCODER/4/BATCH_NORM/beta:0          (53,)
    POSTERIOR/MU/DENSE/weights:0         (53, 20)
    POSTERIOR/MU/DENSE/biases:0          (20,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (53, 20)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (20,)
    DECODER/4/DENSE/weights:0            (20, 53)
    DECODER/4/DENSE/biases:0             (53,)
    DECODER/4/BATCH_NORM/beta:0          (53,)
    DECODER/3/DENSE/weights:0            (53, 77)
    DECODER/3/DENSE/biases:0             (77,)
    DECODER/3/BATCH_NORM/beta:0          (77,)
    DECODER/2/DENSE/weights:0            (77, 226)
    DECODER/2/DENSE/biases:0             (226,)
    DECODER/2/BATCH_NORM/beta:0          (226,)
    DECODER/1/DENSE/weights:0            (226, 153)
    DECODER/1/DENSE/biases:0             (153,)
    DECODER/1/BATCH_NORM/beta:0          (153,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (153, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (449 ms).

Training model for 50 epochs on original values.

Step 38 (30 ms): -2163.7.
Step 75 (29 ms): -1795.
Step 113 (30 ms): -1462.7.
Step 150 (28 ms): -1268.2.
Step 188 (29 ms): -1087.1.
Step 226 (28 ms): -956.91.
Step 263 (29 ms): -829.24.
Step 301 (28 ms): -750.07.
Step 338 (29 ms): -654.7.
Step 376 (16 ms): -544.66.

Epoch 1 (13.2 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (5.89 s): ELBO: -1820.5, ENRE: -1811.5, KL: 9.0447.
    Saving model parameters.
    Model parameters saved (173 ms).

Step 414 (28 ms): -545.88.
Step 451 (28 ms): -505.09.
Step 489 (28 ms): -451.39.
Step 526 (29 ms): -435.07.
Step 564 (28 ms): -401.93.
Step 602 (28 ms): -390.86.
Step 639 (28 ms): -373.97.
Step 677 (29 ms): -363.92.
Step 714 (29 ms): -369.64.
Step 752 (16 ms): -306.27.

Epoch 2 (10.6 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -1027.2, ENRE: -1018.8, KL: 8.3089.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 790 (29 ms): -337.81.
Step 827 (29 ms): -328.87.
Step 865 (28 ms): -322.98.
Step 902 (28 ms): -290.14.
Step 940 (29 ms): -294.32.
Step 978 (28 ms): -281.94.
Step 1015 (28 ms): -280.2.
Step 1053 (29 ms): -298.8.
Step 1090 (28 ms): -267.84.
Step 1128 (14 ms): -533.42.

Epoch 3 (10.8 s):
    Evaluating model.
    Full set (5.38 s): ELBO: -589.89, ENRE: -583.24, KL: 6.6529.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 1166 (28 ms): -265.54.
Step 1203 (30 ms): -278.33.
Step 1241 (28 ms): -261.01.
Step 1278 (28 ms): -266.84.
Step 1316 (28 ms): -254.02.
Step 1354 (28 ms): -253.52.
Step 1391 (28 ms): -282.64.
Step 1429 (28 ms): -260.51.
Step 1466 (28 ms): -258.46.
Step 1504 (14 ms): -209.56.

Epoch 4 (10.6 s):
    Evaluating model.
    Full set (5.41 s): ELBO: -397.51, ENRE: -391.91, KL: 5.5945.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 1542 (29 ms): -264.06.
Step 1579 (29 ms): -261.69.
Step 1617 (28 ms): -259.48.
Step 1654 (29 ms): -234.05.
Step 1692 (29 ms): -249.44.
Step 1730 (28 ms): -245.81.
Step 1767 (29 ms): -240.3.
Step 1805 (29 ms): -256.
Step 1842 (28 ms): -248.25.
Step 1880 (14 ms): -275.96.

Epoch 5 (10.7 s):
    Evaluating model.
    Full set (5.43 s): ELBO: -309.16, ENRE: -304.02, KL: 5.1414.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 1918 (28 ms): -233.52.
Step 1955 (29 ms): -239.65.
Step 1993 (28 ms): -231.4.
Step 2030 (28 ms): -225.38.
Step 2068 (28 ms): -235.55.
Step 2106 (28 ms): -233.26.
Step 2143 (27 ms): -222.83.
Step 2181 (28 ms): -233.94.
Step 2218 (28 ms): -238.91.
Step 2256 (13 ms): -234.87.

Epoch 6 (10.6 s):
    Evaluating model.
    Full set (5.29 s): ELBO: -267.51, ENRE: -262.45, KL: 5.067.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 2294 (29 ms): -247.63.
Step 2331 (29 ms): -236.56.
Step 2369 (29 ms): -266.35.
Step 2406 (29 ms): -238.38.
Step 2444 (28 ms): -227.87.
Step 2482 (29 ms): -248.67.
Step 2519 (29 ms): -241.
Step 2557 (29 ms): -243.23.
Step 2594 (29 ms): -233.94.
Step 2632 (14 ms): -331.99.

Epoch 7 (10.8 s):
    Evaluating model.
    Full set (5.43 s): ELBO: -245.93, ENRE: -240.91, KL: 5.0188.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 2670 (28 ms): -219.26.
Step 2707 (28 ms): -216.38.
Step 2745 (29 ms): -216.41.
Step 2782 (29 ms): -214.8.
Step 2820 (28 ms): -234.18.
Step 2858 (28 ms): -228.4.
Step 2895 (28 ms): -230.21.
Step 2933 (28 ms): -229.19.
Step 2970 (28 ms): -234.42.
Step 3008 (14 ms): -203.43.

Epoch 8 (10.6 s):
    Evaluating model.
    Full set (5.24 s): ELBO: -234.26, ENRE: -229.06, KL: 5.1977.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 3046 (28 ms): -225.04.
Step 3083 (28 ms): -234.24.
Step 3121 (29 ms): -223.31.
Step 3158 (29 ms): -224.32.
Step 3196 (29 ms): -213.66.
Step 3234 (29 ms): -220.75.
Step 3271 (29 ms): -230.34.
Step 3309 (28 ms): -223.23.
Step 3346 (29 ms): -215.44.
Step 3384 (14 ms): -211.61.

Epoch 9 (10.8 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -226.26, ENRE: -221.14, KL: 5.1227.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 3422 (29 ms): -223.09.
Step 3459 (29 ms): -221.46.
Step 3497 (29 ms): -218.43.
Step 3534 (29 ms): -205.74.
Step 3572 (29 ms): -228.09.
Step 3610 (29 ms): -207.61.
Step 3647 (29 ms): -226.06.
Step 3685 (28 ms): -208.58.
Step 3722 (28 ms): -220.54.
Step 3760 (14 ms): -268.92.

Epoch 10 (10.8 s):
    Evaluating model.
    Full set (5.29 s): ELBO: -222.1, ENRE: -216.96, KL: 5.1401.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 3798 (28 ms): -244.98.
Step 3835 (29 ms): -218.11.
Step 3873 (28 ms): -210.6.
Step 3910 (29 ms): -229.03.
Step 3948 (28 ms): -225.13.
Step 3986 (28 ms): -226.44.
Step 4023 (29 ms): -214.57.
Step 4061 (28 ms): -225.21.
Step 4098 (29 ms): -217.77.
Step 4136 (14 ms): -219.96.

Epoch 11 (10.7 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -218.79, ENRE: -213.45, KL: 5.3331.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 4174 (29 ms): -234.42.
Step 4211 (29 ms): -228.14.
Step 4249 (29 ms): -201.21.
Step 4286 (28 ms): -208.15.
Step 4324 (29 ms): -208.04.
Step 4362 (29 ms): -213.72.
Step 4399 (28 ms): -217.9.
Step 4437 (29 ms): -207.36.
Step 4474 (29 ms): -226.16.
Step 4512 (14 ms): -596.19.

Epoch 12 (10.8 s):
    Evaluating model.
    Full set (5.34 s): ELBO: -217.59, ENRE: -212.5, KL: 5.0912.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 4550 (28 ms): -220.12.
Step 4587 (28 ms): -214.12.
Step 4625 (28 ms): -215.67.
Step 4662 (28 ms): -234.2.
Step 4700 (28 ms): -205.83.
Step 4738 (28 ms): -212.07.
Step 4775 (29 ms): -239.19.
Step 4813 (28 ms): -224.19.
Step 4850 (29 ms): -212.92.
Step 4888 (14 ms): -308.2.

Epoch 13 (10.6 s):
    Evaluating model.
    Full set (5.41 s): ELBO: -215.85, ENRE: -210.77, KL: 5.0846.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 4926 (29 ms): -250.06.
Step 4963 (28 ms): -207.93.
Step 5001 (29 ms): -222.95.
Step 5038 (28 ms): -205.35.
Step 5076 (29 ms): -221.
Step 5114 (28 ms): -201.55.
Step 5151 (31 ms): -217.58.
Step 5189 (28 ms): -206.49.
Step 5226 (29 ms): -205.1.
Step 5264 (14 ms): -335.33.

Epoch 14 (10.7 s):
    Evaluating model.
    Full set (5.38 s): ELBO: -215.51, ENRE: -210.36, KL: 5.153.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 5302 (28 ms): -219.75.
Step 5339 (28 ms): -207.1.
Step 5377 (28 ms): -213.57.
Step 5414 (28 ms): -201.39.
Step 5452 (28 ms): -208.76.
Step 5490 (28 ms): -199.5.
Step 5527 (28 ms): -215.97.
Step 5565 (28 ms): -212.29.
Step 5602 (28 ms): -201.21.
Step 5640 (14 ms): -309.6.

Epoch 15 (10.6 s):
    Evaluating model.
    Full set (5.36 s): ELBO: -213.91, ENRE: -208.93, KL: 4.9823.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 5678 (29 ms): -210.4.
Step 5715 (29 ms): -205.33.
Step 5753 (28 ms): -221.36.
Step 5790 (29 ms): -217.96.
Step 5828 (29 ms): -200.43.
Step 5866 (29 ms): -207.95.
Step 5903 (29 ms): -202.65.
Step 5941 (29 ms): -205.61.
Step 5978 (28 ms): -200.89.
Step 6016 (14 ms): -457.21.

Epoch 16 (10.8 s):
    Evaluating model.
    Full set (5.44 s): ELBO: -213.44, ENRE: -208.6, KL: 4.8471.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 6054 (29 ms): -208.35.
Step 6091 (29 ms): -218.12.
Step 6129 (28 ms): -223.64.
Step 6166 (28 ms): -211.53.
Step 6204 (28 ms): -202.39.
Step 6242 (28 ms): -196.95.
Step 6279 (28 ms): -205.36.
Step 6317 (28 ms): -201.43.
Step 6354 (28 ms): -207.46.
Step 6392 (14 ms): -381.29.

Epoch 17 (10.7 s):
    Evaluating model.
    Full set (5.27 s): ELBO: -212.51, ENRE: -207.73, KL: 4.7756.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 6430 (29 ms): -216.33.
Step 6467 (28 ms): -219.04.
Step 6505 (28 ms): -212.07.
Step 6542 (29 ms): -232.8.
Step 6580 (28 ms): -214.74.
Step 6618 (28 ms): -201.
Step 6655 (29 ms): -220.08.
Step 6693 (28 ms): -207.64.
Step 6730 (29 ms): -215.55.
Step 6768 (14 ms): -200.36.

Epoch 18 (10.8 s):
    Evaluating model.
    Full set (5.41 s): ELBO: -211.64, ENRE: -206.87, KL: 4.7725.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 6806 (29 ms): -207.12.
Step 6843 (29 ms): -201.43.
Step 6881 (29 ms): -196.85.
Step 6918 (29 ms): -217.81.
Step 6956 (29 ms): -215.14.
Step 6994 (28 ms): -211.35.
Step 7031 (28 ms): -209.67.
Step 7069 (28 ms): -209.11.
Step 7106 (28 ms): -206.92.
Step 7144 (14 ms): -194.68.

Epoch 19 (10.7 s):
    Evaluating model.
    Full set (5.26 s): ELBO: -210.91, ENRE: -206.21, KL: 4.6961.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 7182 (28 ms): -205.47.
Step 7219 (28 ms): -199.99.
Step 7257 (28 ms): -216.06.
Step 7294 (28 ms): -223.83.
Step 7332 (28 ms): -221.21.
Step 7370 (29 ms): -200.72.
Step 7407 (28 ms): -205.51.
Step 7445 (29 ms): -207.64.
Step 7482 (29 ms): -226.52.
Step 7520 (14 ms): -596.5.

Epoch 20 (10.7 s):
    Evaluating model.
    Full set (5.41 s): ELBO: -210.27, ENRE: -205.53, KL: 4.7375.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 7558 (28 ms): -217.5.
Step 7595 (28 ms): -207.82.
Step 7633 (28 ms): -221.73.
Step 7670 (28 ms): -212.52.
Step 7708 (29 ms): -211.28.
Step 7746 (29 ms): -220.59.
Step 7783 (28 ms): -206.19.
Step 7821 (29 ms): -206.13.
Step 7858 (29 ms): -221.34.
Step 7896 (15 ms): -316.23.

Epoch 21 (10.8 s):
    Evaluating model.
    Full set (5.57 s): ELBO: -210.46, ENRE: -205.88, KL: 4.5844.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 7934 (29 ms): -200.17.
Step 7971 (29 ms): -215.53.
Step 8009 (29 ms): -217.92.
Step 8046 (29 ms): -201.29.
Step 8084 (29 ms): -235.57.
Step 8122 (29 ms): -193.69.
Step 8159 (29 ms): -208.68.
Step 8197 (29 ms): -201.7.
Step 8234 (30 ms): -211.82.
Step 8272 (15 ms): -167.84.

Epoch 22 (11 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -209.6, ENRE: -204.96, KL: 4.6343.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 8310 (30 ms): -207.18.
Step 8347 (29 ms): -201.54.
Step 8385 (29 ms): -216.24.
Step 8422 (29 ms): -204.69.
Step 8460 (30 ms): -217.88.
Step 8498 (30 ms): -214.21.
Step 8535 (29 ms): -198.08.
Step 8573 (29 ms): -211.12.
Step 8610 (32 ms): -214.98.
Step 8648 (14 ms): -207.91.

Epoch 23 (11.1 s):
    Evaluating model.
    Full set (5.57 s): ELBO: -209.21, ENRE: -204.59, KL: 4.6277.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 8686 (29 ms): -218.56.
Step 8723 (29 ms): -206.79.
Step 8761 (29 ms): -206.47.
Step 8798 (29 ms): -214.09.
Step 8836 (29 ms): -210.46.
Step 8874 (30 ms): -216.79.
Step 8911 (29 ms): -195.6.
Step 8949 (29 ms): -213.86.
Step 8986 (30 ms): -207.42.
Step 9024 (14 ms): -254.81.

Epoch 24 (11 s):
    Evaluating model.
    Full set (5.58 s): ELBO: -208.54, ENRE: -203.94, KL: 4.6074.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 9062 (30 ms): -217.28.
Step 9099 (29 ms): -209.14.
Step 9137 (29 ms): -196.77.
Step 9174 (29 ms): -209.19.
Step 9212 (29 ms): -199.66.
Step 9250 (29 ms): -201.31.
Step 9287 (29 ms): -207.1.
Step 9325 (29 ms): -209.76.
Step 9362 (30 ms): -207.51.
Step 9400 (14 ms): -196.07.

Epoch 25 (11.1 s):
    Evaluating model.
    Full set (5.58 s): ELBO: -208.09, ENRE: -203.45, KL: 4.6429.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 9438 (30 ms): -214.03.
Step 9475 (29 ms): -205.61.
Step 9513 (29 ms): -204.92.
Step 9550 (30 ms): -219.56.
Step 9588 (29 ms): -207.77.
Step 9626 (29 ms): -199.62.
Step 9663 (28 ms): -208.6.
Step 9701 (29 ms): -197.67.
Step 9738 (30 ms): -202.07.
Step 9776 (14 ms): -189.11.

Epoch 26 (11 s):
    Evaluating model.
    Full set (5.54 s): ELBO: -207.92, ENRE: -203.25, KL: 4.6782.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 9814 (29 ms): -217.72.
Step 9851 (29 ms): -206.25.
Step 9889 (30 ms): -208.4.
Step 9926 (29 ms): -201.18.
Step 9964 (30 ms): -213.52.
Step 10002 (29 ms): -202.37.
Step 10039 (29 ms): -208.02.
Step 10077 (29 ms): -201.85.
Step 10114 (29 ms): -207.06.
Step 10152 (14 ms): -187.2.

Epoch 27 (11.1 s):
    Evaluating model.
    Full set (5.57 s): ELBO: -207.14, ENRE: -202.65, KL: 4.4909.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 10190 (30 ms): -201.35.
Step 10227 (29 ms): -194.28.
Step 10265 (29 ms): -197.05.
Step 10302 (29 ms): -199.68.
Step 10340 (29 ms): -223.82.
Step 10378 (29 ms): -212.78.
Step 10415 (29 ms): -208.23.
Step 10453 (30 ms): -204.43.
Step 10490 (29 ms): -204.01.
Step 10528 (14 ms): -223.3.

Epoch 28 (11 s):
    Evaluating model.
    Full set (5.53 s): ELBO: -206.97, ENRE: -202.52, KL: 4.4567.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 10566 (30 ms): -211.82.
Step 10603 (29 ms): -206.21.
Step 10641 (29 ms): -201.64.
Step 10678 (30 ms): -209.45.
Step 10716 (29 ms): -207.07.
Step 10754 (30 ms): -203.92.
Step 10791 (29 ms): -200.66.
Step 10829 (29 ms): -219.41.
Step 10866 (29 ms): -204.77.
Step 10904 (15 ms): -270.58.

Epoch 29 (11.1 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -206.81, ENRE: -202.28, KL: 4.5333.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 10942 (29 ms): -211.48.
Step 10979 (29 ms): -209.54.
Step 11017 (29 ms): -207.72.
Step 11054 (31 ms): -210.25.
Step 11092 (29 ms): -208.49.
Step 11130 (29 ms): -214.22.
Step 11167 (29 ms): -207.67.
Step 11205 (29 ms): -199.16.
Step 11242 (29 ms): -207.41.
Step 11280 (14 ms): -220.26.

Epoch 30 (11.1 s):
    Evaluating model.
    Full set (5.54 s): ELBO: -206.07, ENRE: -201.65, KL: 4.4233.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 11318 (29 ms): -219.61.
Step 11355 (30 ms): -208.14.
Step 11393 (29 ms): -201.86.
Step 11430 (29 ms): -205.33.
Step 11468 (29 ms): -195.84.
Step 11506 (29 ms): -204.97.
Step 11543 (29 ms): -214.22.
Step 11581 (29 ms): -216.96.
Step 11618 (29 ms): -207.65.
Step 11656 (14 ms): -329.21.

Epoch 31 (11 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -205.87, ENRE: -201.48, KL: 4.3929.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 11694 (30 ms): -202.7.
Step 11731 (29 ms): -195.05.
Step 11769 (29 ms): -203.82.
Step 11806 (32 ms): -202.24.
Step 11844 (29 ms): -201.53.
Step 11882 (30 ms): -207.36.
Step 11919 (29 ms): -207.13.
Step 11957 (29 ms): -214.09.
Step 11994 (29 ms): -199.32.
Step 12032 (14 ms): -240.07.

Epoch 32 (11 s):
    Evaluating model.
    Full set (5.53 s): ELBO: -205.77, ENRE: -201.42, KL: 4.3535.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 12070 (30 ms): -207.62.
Step 12107 (29 ms): -222.24.
Step 12145 (29 ms): -204.16.
Step 12182 (29 ms): -209.72.
Step 12220 (29 ms): -199.15.
Step 12258 (30 ms): -200.7.
Step 12295 (29 ms): -207.57.
Step 12333 (29 ms): -215.38.
Step 12370 (29 ms): -190.04.
Step 12408 (14 ms): -298.51.

Epoch 33 (11 s):
    Evaluating model.
    Full set (5.57 s): ELBO: -205.62, ENRE: -201.31, KL: 4.3043.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 12446 (30 ms): -203.11.
Step 12483 (29 ms): -203.94.
Step 12521 (29 ms): -204.42.
Step 12558 (29 ms): -209.42.
Step 12596 (30 ms): -204.48.
Step 12634 (30 ms): -196.06.
Step 12671 (29 ms): -201.28.
Step 12709 (29 ms): -200.8.
Step 12746 (30 ms): -202.34.
Step 12784 (14 ms): -241.96.

Epoch 34 (11.1 s):
    Evaluating model.
    Full set (5.55 s): ELBO: -205.2, ENRE: -200.83, KL: 4.3677.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 12822 (29 ms): -197.52.
Step 12859 (29 ms): -201.75.
Step 12897 (29 ms): -197.72.
Step 12934 (29 ms): -189.91.
Step 12972 (29 ms): -214.8.
Step 13010 (29 ms): -194.45.
Step 13047 (30 ms): -194.6.
Step 13085 (29 ms): -207.47.
Step 13122 (29 ms): -213.11.
Step 13160 (14 ms): -283.22.

Epoch 35 (11 s):
    Evaluating model.
    Full set (5.57 s): ELBO: -205.24, ENRE: -200.78, KL: 4.4553.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 13198 (30 ms): -215.4.
Step 13235 (30 ms): -209.33.
Step 13273 (30 ms): -205.46.
Step 13310 (29 ms): -211.13.
Step 13348 (30 ms): -210.79.
Step 13386 (29 ms): -208.72.
Step 13423 (30 ms): -203.57.
Step 13461 (29 ms): -197.36.
Step 13498 (30 ms): -212.31.
Step 13536 (15 ms): -231.84.

Epoch 36 (11.1 s):
    Evaluating model.
    Full set (5.59 s): ELBO: -204.83, ENRE: -200.45, KL: 4.3752.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 13574 (29 ms): -200.19.
Step 13611 (29 ms): -206.78.
Step 13649 (29 ms): -223.68.
Step 13686 (29 ms): -199.47.
Step 13724 (29 ms): -203.19.
Step 13762 (29 ms): -210.26.
Step 13799 (29 ms): -201.4.
Step 13837 (29 ms): -210.87.
Step 13874 (29 ms): -207.32.
Step 13912 (14 ms): -223.

Epoch 37 (11 s):
    Evaluating model.
    Full set (5.54 s): ELBO: -204.64, ENRE: -200.27, KL: 4.3707.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 13950 (29 ms): -206.69.
Step 13987 (29 ms): -213.72.
Step 14025 (29 ms): -196.58.
Step 14062 (29 ms): -192.34.
Step 14100 (29 ms): -213.
Step 14138 (29 ms): -205.54.
Step 14175 (30 ms): -197.86.
Step 14213 (29 ms): -204.37.
Step 14250 (29 ms): -206.55.
Step 14288 (14 ms): -206.89.

Epoch 38 (11 s):
    Evaluating model.
    Full set (5.58 s): ELBO: -204.72, ENRE: -200.32, KL: 4.4023.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 14326 (30 ms): -206.57.
Step 14363 (30 ms): -194.18.
Step 14401 (29 ms): -193.4.
Step 14438 (29 ms): -198.81.
Step 14476 (30 ms): -203.9.
Step 14514 (29 ms): -192.16.
Step 14551 (29 ms): -207.48.
Step 14589 (29 ms): -202.44.
Step 14626 (29 ms): -203.69.
Step 14664 (15 ms): -197.11.

Epoch 39 (11 s):
    Evaluating model.
    Full set (5.54 s): ELBO: -204.61, ENRE: -200.24, KL: 4.3673.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 14702 (29 ms): -197.38.
Step 14739 (28 ms): -209.8.
Step 14777 (29 ms): -205.84.
Step 14814 (29 ms): -214.87.
Step 14852 (29 ms): -204.85.
Step 14890 (29 ms): -195.03.
Step 14927 (29 ms): -206.25.
Step 14965 (29 ms): -220.93.
Step 15002 (29 ms): -223.32.
Step 15040 (15 ms): -183.31.

Epoch 40 (11 s):
    Evaluating model.
    Full set (5.57 s): ELBO: -204.14, ENRE: -199.78, KL: 4.3533.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 15078 (29 ms): -192.62.
Step 15115 (29 ms): -196.83.
Step 15153 (29 ms): -208.16.
Step 15190 (29 ms): -212.12.
Step 15228 (29 ms): -204.02.
Step 15266 (29 ms): -209.72.
Step 15303 (29 ms): -203.99.
Step 15341 (29 ms): -198.32.
Step 15378 (30 ms): -202.39.
Step 15416 (14 ms): -281.85.

Epoch 41 (11.1 s):
    Evaluating model.
    Full set (5.56 s): ELBO: -204.13, ENRE: -199.74, KL: 4.3838.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 15454 (30 ms): -195.41.
Step 15491 (29 ms): -204.8.
Step 15529 (29 ms): -209.12.
Step 15566 (29 ms): -211.08.
Step 15604 (29 ms): -213.35.
Step 15642 (29 ms): -199.02.
Step 15679 (29 ms): -203.39.
Step 15717 (29 ms): -199.33.
Step 15754 (29 ms): -209.26.
Step 15792 (14 ms): -327.47.

Epoch 42 (11 s):
    Evaluating model.
    Full set (5.59 s): ELBO: -204.24, ENRE: -199.84, KL: 4.3912.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 15830 (29 ms): -210.41.
Step 15867 (30 ms): -197.85.
Step 15905 (29 ms): -188.19.
Step 15942 (30 ms): -201.6.
Step 15980 (29 ms): -202.34.
Step 16018 (31 ms): -206.52.
Step 16055 (29 ms): -210.67.
Step 16093 (30 ms): -207.07.
Step 16130 (29 ms): -199.69.
Step 16168 (14 ms): -192.15.

Epoch 43 (11.1 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -203.5, ENRE: -199.07, KL: 4.4294.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 16206 (29 ms): -190.92.
Step 16243 (29 ms): -195.1.
Step 16281 (29 ms): -206.25.
Step 16318 (30 ms): -206.62.
Step 16356 (29 ms): -209.03.
Step 16394 (29 ms): -201.76.
Step 16431 (29 ms): -216.75.
Step 16469 (29 ms): -196.99.
Step 16506 (29 ms): -198.24.
Step 16544 (14 ms): -331.92.

Epoch 44 (11 s):
    Evaluating model.
    Full set (5.54 s): ELBO: -203.38, ENRE: -198.85, KL: 4.5298.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 16582 (29 ms): -207.78.
Step 16619 (29 ms): -193.
Step 16657 (29 ms): -195.94.
Step 16694 (30 ms): -207.52.
Step 16732 (29 ms): -196.41.
Step 16770 (29 ms): -196.92.
Step 16807 (29 ms): -205.26.
Step 16845 (29 ms): -205.07.
Step 16882 (29 ms): -201.46.
Step 16920 (14 ms): -194.24.

Epoch 45 (11 s):
    Evaluating model.
    Full set (5.59 s): ELBO: -203.16, ENRE: -198.71, KL: 4.4559.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 16958 (29 ms): -205.45.
Step 16995 (29 ms): -208.92.
Step 17033 (29 ms): -206.64.
Step 17070 (29 ms): -191.
Step 17108 (29 ms): -206.89.
Step 17146 (29 ms): -206.56.
Step 17183 (29 ms): -201.73.
Step 17221 (29 ms): -212.99.
Step 17258 (29 ms): -212.19.
Step 17296 (14 ms): -199.85.

Epoch 46 (11 s):
    Evaluating model.
    Full set (5.52 s): ELBO: -203.17, ENRE: -198.72, KL: 4.4472.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 17334 (29 ms): -199.32.
Step 17371 (29 ms): -202.08.
Step 17409 (29 ms): -192.66.
Step 17446 (29 ms): -205.97.
Step 17484 (29 ms): -202.75.
Step 17522 (29 ms): -204.76.
Step 17559 (29 ms): -209.98.
Step 17597 (29 ms): -198.92.
Step 17634 (29 ms): -210.23.
Step 17672 (15 ms): -218.36.

Epoch 47 (11 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -203.08, ENRE: -198.55, KL: 4.5326.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 17710 (29 ms): -202.51.
Step 17747 (29 ms): -194.4.
Step 17785 (29 ms): -211.4.
Step 17822 (30 ms): -197.08.
Step 17860 (30 ms): -216.95.
Step 17898 (30 ms): -198.05.
Step 17935 (29 ms): -221.17.
Step 17973 (29 ms): -214.45.
Step 18010 (29 ms): -206.53.
Step 18048 (15 ms): -213.48.

Epoch 48 (11.1 s):
    Evaluating model.
    Full set (5.56 s): ELBO: -202.82, ENRE: -198.34, KL: 4.4771.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 18086 (29 ms): -196.36.
Step 18123 (29 ms): -208.7.
Step 18161 (29 ms): -199.1.
Step 18198 (30 ms): -203.31.
Step 18236 (29 ms): -195.67.
Step 18274 (29 ms): -214.59.
Step 18311 (29 ms): -198.35.
Step 18349 (29 ms): -205.26.
Step 18386 (29 ms): -207.57.
Step 18424 (14 ms): -183.23.

Epoch 49 (11 s):
    Evaluating model.
    Full set (5.58 s): ELBO: -202.72, ENRE: -198.24, KL: 4.4784.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 18462 (30 ms): -195.82.
Step 18499 (29 ms): -208.7.
Step 18537 (29 ms): -201.16.
Step 18574 (30 ms): -195.76.
Step 18612 (30 ms): -190.15.
Step 18650 (30 ms): -191.61.
Step 18687 (29 ms): -201.01.
Step 18725 (29 ms): -209.3.
Step 18762 (29 ms): -206.53.
Step 18800 (15 ms): -190.17.

Epoch 50 (11.1 s):
    Evaluating model.
    Full set (5.56 s): ELBO: -202.39, ENRE: -197.82, KL: 4.5734.
    Saving model parameters.
    Model parameters saved (109 ms).

Model trained for 50 epochs (13m 50s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (906 ms).

Converting data set value array to sparse matrix.
Data set value array converted (311 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2 s):  ELBO: -414.54, ENRE: -409.96, KL: 4.5737.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (639 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.6464359529926271
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 8
kl weight: 1.6464359529926271
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (52 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.27 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.88 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 8
    hidden sizes: 84
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.6464359529926271
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 2 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 84)
    ENCODER/1/DENSE/biases:0             (84,)
    ENCODER/1/BATCH_NORM/beta:0          (84,)
    POSTERIOR/MU/DENSE/weights:0         (84, 8)
    POSTERIOR/MU/DENSE/biases:0          (8,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (84, 8)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (8,)
    DECODER/1/DENSE/weights:0            (8, 84)
    DECODER/1/DENSE/biases:0             (84,)
    DECODER/1/BATCH_NORM/beta:0          (84,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (84, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (199 ms).

Training model for 50 epochs on original values.

Step 38 (22 ms): -2226.4.
Step 75 (21 ms): -2085.6.
Step 113 (20 ms): -1828.5.
Step 150 (21 ms): -1748.4.
Step 188 (20 ms): -1500.9.
Step 226 (21 ms): -1386.6.
Step 263 (21 ms): -1280.9.
Step 301 (21 ms): -1164.5.
Step 338 (21 ms): -1093.9.
Step 376 (11 ms): -929.96.

Epoch 1 (9.18 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (4.79 s): ELBO: -1268.1, ENRE: -1252.4, KL: 15.67.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 414 (21 ms): -905.06.
Step 451 (22 ms): -845.37.
Step 489 (21 ms): -812.95.
Step 526 (21 ms): -739.62.
Step 564 (21 ms): -728.93.
Step 602 (21 ms): -657.8.
Step 639 (21 ms): -647.1.
Step 677 (21 ms): -626.85.
Step 714 (21 ms): -613.47.
Step 752 (12 ms): -592.6.

Epoch 2 (7.9 s):
    Warm-up weight: 0.5
    Evaluating model.
    Full set (4.46 s): ELBO: -826.86, ENRE: -812.37, KL: 14.497.
    Saving model parameters.
    Model parameters saved (57 ms).

Step 790 (21 ms): -510.21.
Step 827 (20 ms): -486.18.
Step 865 (21 ms): -480.15.
Step 902 (21 ms): -447.02.
Step 940 (21 ms): -428.02.
Step 978 (21 ms): -406.96.
Step 1015 (21 ms): -437.71.
Step 1053 (21 ms): -408.51.
Step 1090 (21 ms): -406.35.
Step 1128 (10 ms): -509.05.

Epoch 3 (7.84 s):
    Evaluating model.
    Full set (4.44 s): ELBO: -583.91, ENRE: -572.12, KL: 11.791.
    Saving model parameters.
    Model parameters saved (57 ms).

Step 1166 (21 ms): -369.42.
Step 1203 (20 ms): -382.48.
Step 1241 (21 ms): -367.49.
Step 1278 (21 ms): -328.51.
Step 1316 (21 ms): -356.98.
Step 1354 (21 ms): -336.33.
Step 1391 (21 ms): -318.52.
Step 1429 (21 ms): -316.41.
Step 1466 (21 ms): -322.96.
Step 1504 (11 ms): -274.36.

Epoch 4 (7.86 s):
    Evaluating model.
    Full set (4.5 s): ELBO: -429.63, ENRE: -417.35, KL: 12.278.
    Saving model parameters.
    Model parameters saved (57 ms).

Step 1542 (21 ms): -308.96.
Step 1579 (21 ms): -295.75.
Step 1617 (21 ms): -277.62.
Step 1654 (21 ms): -298.39.
Step 1692 (21 ms): -295.84.
Step 1730 (21 ms): -302.25.
Step 1767 (21 ms): -310.59.
Step 1805 (21 ms): -325.78.
Step 1842 (21 ms): -285.64.
Step 1880 (11 ms): -273.21.

Epoch 5 (7.92 s):
    Evaluating model.
    Full set (4.47 s): ELBO: -344.72, ENRE: -333.57, KL: 11.155.
    Saving model parameters.
    Model parameters saved (53 ms).

Step 1918 (21 ms): -266.31.
Step 1955 (21 ms): -267.33.
Step 1993 (21 ms): -246.53.
Step 2030 (21 ms): -246.53.
Step 2068 (21 ms): -270.52.
Step 2106 (21 ms): -257.92.
Step 2143 (21 ms): -269.45.
Step 2181 (21 ms): -262.35.
Step 2218 (21 ms): -271.42.
Step 2256 (12 ms): -250.23.

Epoch 6 (7.87 s):
    Evaluating model.
    Full set (4.45 s): ELBO: -285.45, ENRE: -274.68, KL: 10.772.
    Saving model parameters.
    Model parameters saved (56 ms).

Step 2294 (21 ms): -234.93.
Step 2331 (21 ms): -259.05.
Step 2369 (21 ms): -261.32.
Step 2406 (21 ms): -257.27.
Step 2444 (21 ms): -243.71.
Step 2482 (21 ms): -254.09.
Step 2519 (21 ms): -245.18.
Step 2557 (21 ms): -239.82.
Step 2594 (21 ms): -250.89.
Step 2632 (11 ms): -252.76.

Epoch 7 (7.89 s):
    Evaluating model.
    Full set (4.49 s): ELBO: -256.82, ENRE: -246.61, KL: 10.202.
    Saving model parameters.
    Model parameters saved (58 ms).

Step 2670 (21 ms): -241.17.
Step 2707 (21 ms): -271.67.
Step 2745 (21 ms): -262.23.
Step 2782 (22 ms): -247.48.
Step 2820 (21 ms): -240.36.
Step 2858 (21 ms): -236.4.
Step 2895 (21 ms): -223.34.
Step 2933 (21 ms): -229.74.
Step 2970 (21 ms): -252.69.
Step 3008 (11 ms): -605.8.

Epoch 8 (7.94 s):
    Evaluating model.
    Full set (4.48 s): ELBO: -240.78, ENRE: -231.08, KL: 9.709.
    Saving model parameters.
    Model parameters saved (56 ms).

Step 3046 (21 ms): -228.36.
Step 3083 (21 ms): -233.16.
Step 3121 (21 ms): -243.57.
Step 3158 (21 ms): -230.63.
Step 3196 (21 ms): -238.22.
Step 3234 (21 ms): -231.49.
Step 3271 (21 ms): -227.83.
Step 3309 (21 ms): -223.22.
Step 3346 (21 ms): -216.27.
Step 3384 (10 ms): -237.06.

Epoch 9 (7.89 s):
    Evaluating model.
    Full set (4.45 s): ELBO: -230.56, ENRE: -221.14, KL: 9.4234.
    Saving model parameters.
    Model parameters saved (55 ms).

Step 3422 (21 ms): -222.96.
Step 3459 (21 ms): -239.16.
Step 3497 (21 ms): -244.02.
Step 3534 (21 ms): -226.69.
Step 3572 (21 ms): -247.86.
Step 3610 (21 ms): -229.58.
Step 3647 (21 ms): -233.47.
Step 3685 (21 ms): -232.1.
Step 3722 (21 ms): -212.85.
Step 3760 (10 ms): -199.98.

Epoch 10 (7.88 s):
    Evaluating model.
    Full set (4.5 s): ELBO: -226.37, ENRE: -216.97, KL: 9.3986.
    Saving model parameters.
    Model parameters saved (58 ms).

Step 3798 (21 ms): -213.08.
Step 3835 (21 ms): -238.16.
Step 3873 (21 ms): -240.41.
Step 3910 (21 ms): -229.83.
Step 3948 (21 ms): -225.9.
Step 3986 (21 ms): -220.01.
Step 4023 (21 ms): -215.21.
Step 4061 (21 ms): -228.22.
Step 4098 (21 ms): -218.59.
Step 4136 (10 ms): -286.73.

Epoch 11 (7.92 s):
    Evaluating model.
    Full set (4.49 s): ELBO: -222.35, ENRE: -213.2, KL: 9.147.
    Saving model parameters.
    Model parameters saved (56 ms).

Step 4174 (21 ms): -229.68.
Step 4211 (21 ms): -209.53.
Step 4249 (20 ms): -214.34.
Step 4286 (20 ms): -209.4.
Step 4324 (21 ms): -213.11.
Step 4362 (21 ms): -213.71.
Step 4399 (21 ms): -221.14.
Step 4437 (20 ms): -212.61.
Step 4474 (21 ms): -235.11.
Step 4512 (10 ms): -234.26.

Epoch 12 (7.83 s):
    Evaluating model.
    Full set (4.43 s): ELBO: -219.74, ENRE: -210.76, KL: 8.9766.
    Saving model parameters.
    Model parameters saved (54 ms).

Step 4550 (21 ms): -209.87.
Step 4587 (21 ms): -206.88.
Step 4625 (21 ms): -213.17.
Step 4662 (20 ms): -215.81.
Step 4700 (21 ms): -242.78.
Step 4738 (20 ms): -219.77.
Step 4775 (21 ms): -203.08.
Step 4813 (21 ms): -212.35.
Step 4850 (21 ms): -211.94.
Step 4888 (10 ms): -349.29.

Epoch 13 (7.83 s):
    Evaluating model.
    Full set (4.46 s): ELBO: -217.78, ENRE: -209.13, KL: 8.6545.
    Saving model parameters.
    Model parameters saved (61 ms).

Step 4926 (20 ms): -213.14.
Step 4963 (21 ms): -219.13.
Step 5001 (21 ms): -215.83.
Step 5038 (21 ms): -216.72.
Step 5076 (21 ms): -248.31.
Step 5114 (21 ms): -221.65.
Step 5151 (21 ms): -208.28.
Step 5189 (20 ms): -227.15.
Step 5226 (21 ms): -215.35.
Step 5264 (10 ms): -230.96.

Epoch 14 (7.88 s):
    Evaluating model.
    Full set (4.48 s): ELBO: -215.89, ENRE: -207.04, KL: 8.8545.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 5302 (21 ms): -209.4.
Step 5339 (21 ms): -208.7.
Step 5377 (21 ms): -209.3.
Step 5414 (21 ms): -215.7.
Step 5452 (21 ms): -204.12.
Step 5490 (21 ms): -217.99.
Step 5527 (21 ms): -228.36.
Step 5565 (20 ms): -216.62.
Step 5602 (21 ms): -221.32.
Step 5640 (12 ms): -272.15.

Epoch 15 (7.87 s):
    Evaluating model.
    Full set (4.44 s): ELBO: -214.96, ENRE: -206.34, KL: 8.6161.
    Saving model parameters.
    Model parameters saved (54 ms).

Step 5678 (21 ms): -218.28.
Step 5715 (21 ms): -206.45.
Step 5753 (21 ms): -220.55.
Step 5790 (21 ms): -198.75.
Step 5828 (21 ms): -219.14.
Step 5866 (21 ms): -219.63.
Step 5903 (21 ms): -219.16.
Step 5941 (21 ms): -206.28.
Step 5978 (21 ms): -204.86.
Step 6016 (11 ms): -232.67.

Epoch 16 (7.86 s):
    Evaluating model.
    Full set (4.44 s): ELBO: -213.97, ENRE: -205.56, KL: 8.411.
    Saving model parameters.
    Model parameters saved (58 ms).

Step 6054 (21 ms): -201.12.
Step 6091 (21 ms): -211.56.
Step 6129 (21 ms): -219.96.
Step 6166 (21 ms): -192.72.
Step 6204 (21 ms): -222.38.
Step 6242 (22 ms): -204.74.
Step 6279 (21 ms): -210.44.
Step 6317 (21 ms): -200.17.
Step 6354 (21 ms): -215.9.
Step 6392 (10 ms): -367.18.

Epoch 17 (7.94 s):
    Evaluating model.
    Full set (4.48 s): ELBO: -212.81, ENRE: -204.41, KL: 8.3989.
    Saving model parameters.
    Model parameters saved (58 ms).

Step 6430 (21 ms): -215.98.
Step 6467 (21 ms): -221.64.
Step 6505 (22 ms): -215.14.
Step 6542 (21 ms): -210.01.
Step 6580 (21 ms): -220.16.
Step 6618 (21 ms): -207.24.
Step 6655 (21 ms): -212.44.
Step 6693 (21 ms): -211.96.
Step 6730 (20 ms): -210.6.
Step 6768 (10 ms): -217.97.

Epoch 18 (7.91 s):
    Evaluating model.
    Full set (4.44 s): ELBO: -212.09, ENRE: -203.73, KL: 8.3638.
    Saving model parameters.
    Model parameters saved (54 ms).

Step 6806 (21 ms): -241.25.
Step 6843 (21 ms): -214.93.
Step 6881 (20 ms): -221.85.
Step 6918 (21 ms): -210.26.
Step 6956 (21 ms): -206.96.
Step 6994 (21 ms): -214.
Step 7031 (21 ms): -213.39.
Step 7069 (21 ms): -217.51.
Step 7106 (21 ms): -221.5.
Step 7144 (11 ms): -181.4.

Epoch 19 (7.87 s):
    Evaluating model.
    Full set (4.45 s): ELBO: -211.73, ENRE: -203.32, KL: 8.4106.
    Saving model parameters.
    Model parameters saved (55 ms).

Step 7182 (21 ms): -199.75.
Step 7219 (21 ms): -217.96.
Step 7257 (21 ms): -218.52.
Step 7294 (21 ms): -197.82.
Step 7332 (22 ms): -201.82.
Step 7370 (21 ms): -211.84.
Step 7407 (21 ms): -203.22.
Step 7445 (22 ms): -213.6.
Step 7482 (21 ms): -199.2.
Step 7520 (10 ms): -214.57.

Epoch 20 (7.91 s):
    Evaluating model.
    Full set (4.48 s): ELBO: -210.71, ENRE: -202.64, KL: 8.073.
    Saving model parameters.
    Model parameters saved (57 ms).

Step 7558 (21 ms): -199.42.
Step 7595 (21 ms): -198.38.
Step 7633 (21 ms): -225.71.
Step 7670 (20 ms): -217.73.
Step 7708 (21 ms): -209.38.
Step 7746 (21 ms): -219.67.
Step 7783 (21 ms): -202.51.
Step 7821 (20 ms): -191.94.
Step 7858 (21 ms): -246.6.
Step 7896 (10 ms): -202.59.

Epoch 21 (7.89 s):
    Evaluating model.
    Full set (4.45 s): ELBO: -210.29, ENRE: -202.04, KL: 8.2564.
    Saving model parameters.
    Model parameters saved (55 ms).

Step 7934 (21 ms): -205.28.
Step 7971 (21 ms): -220.15.
Step 8009 (21 ms): -213.62.
Step 8046 (21 ms): -212.58.
Step 8084 (21 ms): -206.78.
Step 8122 (20 ms): -209.58.
Step 8159 (20 ms): -204.73.
Step 8197 (21 ms): -197.35.
Step 8234 (21 ms): -199.59.
Step 8272 (10 ms): -235.23.

Epoch 22 (7.84 s):
    Evaluating model.
    Full set (4.42 s): ELBO: -209.79, ENRE: -201.58, KL: 8.2089.
    Saving model parameters.
    Model parameters saved (56 ms).

Step 8310 (21 ms): -207.72.
Step 8347 (21 ms): -202.15.
Step 8385 (21 ms): -202.1.
Step 8422 (21 ms): -214.62.
Step 8460 (21 ms): -202.38.
Step 8498 (21 ms): -197.2.
Step 8535 (21 ms): -220.07.
Step 8573 (21 ms): -220.04.
Step 8610 (21 ms): -209.85.
Step 8648 (11 ms): -336.15.

Epoch 23 (7.88 s):
    Evaluating model.
    Full set (4.48 s): ELBO: -209.26, ENRE: -200.97, KL: 8.2897.
    Saving model parameters.
    Model parameters saved (57 ms).

Step 8686 (21 ms): -209.74.
Step 8723 (21 ms): -197.48.
Step 8761 (21 ms): -199.33.
Step 8798 (21 ms): -209.06.
Step 8836 (21 ms): -201.91.
Step 8874 (21 ms): -215.85.
Step 8911 (21 ms): -203.5.
Step 8949 (21 ms): -206.98.
Step 8986 (21 ms): -198.13.
Step 9024 (10 ms): -251.12.

Epoch 24 (7.88 s):
    Evaluating model.
    Full set (4.44 s): ELBO: -208.96, ENRE: -200.83, KL: 8.1365.
    Saving model parameters.
    Model parameters saved (58 ms).

Step 9062 (21 ms): -211.19.
Step 9099 (21 ms): -205.57.
Step 9137 (21 ms): -211.6.
Step 9174 (20 ms): -202.24.
Step 9212 (20 ms): -213.58.
Step 9250 (21 ms): -210.98.
Step 9287 (21 ms): -195.75.
Step 9325 (21 ms): -200.55.
Step 9362 (21 ms): -221.99.
Step 9400 (11 ms): -193.9.

Epoch 25 (7.83 s):
    Evaluating model.
    Full set (4.43 s): ELBO: -208.55, ENRE: -200.39, KL: 8.1691.
    Saving model parameters.
    Model parameters saved (57 ms).

Step 9438 (21 ms): -195.67.
Step 9475 (21 ms): -215.11.
Step 9513 (21 ms): -209.72.
Step 9550 (20 ms): -207.86.
Step 9588 (20 ms): -199.17.
Step 9626 (21 ms): -204.14.
Step 9663 (21 ms): -213.21.
Step 9701 (21 ms): -216.86.
Step 9738 (21 ms): -207.52.
Step 9776 (11 ms): -214.08.

Epoch 26 (7.87 s):
    Evaluating model.
    Full set (4.48 s): ELBO: -208.34, ENRE: -200.24, KL: 8.0956.
    Saving model parameters.
    Model parameters saved (58 ms).

Step 9814 (21 ms): -208.94.
Step 9851 (21 ms): -215.71.
Step 9889 (21 ms): -221.37.
Step 9926 (21 ms): -204.42.
Step 9964 (21 ms): -209.81.
Step 10002 (21 ms): -206.07.
Step 10039 (21 ms): -201.33.
Step 10077 (21 ms): -207.09.
Step 10114 (21 ms): -207.99.
Step 10152 (10 ms): -207.66.

Epoch 27 (7.93 s):
    Evaluating model.
    Full set (4.46 s): ELBO: -208.07, ENRE: -200.11, KL: 7.9596.
    Saving model parameters.
    Model parameters saved (57 ms).

Step 10190 (21 ms): -197.62.
Step 10227 (21 ms): -200.93.
Step 10265 (21 ms): -215.12.
Step 10302 (21 ms): -198.27.
Step 10340 (21 ms): -204.25.
Step 10378 (21 ms): -195.94.
Step 10415 (21 ms): -197.26.
Step 10453 (21 ms): -231.2.
Step 10490 (21 ms): -211.4.
Step 10528 (10 ms): -214.05.

Epoch 28 (7.87 s):
    Evaluating model.
    Full set (4.44 s): ELBO: -207.68, ENRE: -199.49, KL: 8.1837.
    Saving model parameters.
    Model parameters saved (57 ms).

Step 10566 (22 ms): -211.56.
Step 10603 (21 ms): -193.69.
Step 10641 (21 ms): -213.47.
Step 10678 (21 ms): -197.9.
Step 10716 (20 ms): -201.06.
Step 10754 (21 ms): -207.34.
Step 10791 (21 ms): -197.46.
Step 10829 (21 ms): -204.84.
Step 10866 (21 ms): -220.3.
Step 10904 (10 ms): -230.76.

Epoch 29 (7.92 s):
    Evaluating model.
    Full set (4.49 s): ELBO: -207.55, ENRE: -199.48, KL: 8.07.
    Saving model parameters.
    Model parameters saved (57 ms).

Step 10942 (21 ms): -202.37.
Step 10979 (21 ms): -234.55.
Step 11017 (23 ms): -195.52.
Step 11054 (21 ms): -208.62.
Step 11092 (21 ms): -209.29.
Step 11130 (21 ms): -213.2.
Step 11167 (21 ms): -206.43.
Step 11205 (21 ms): -229.37.
Step 11242 (21 ms): -212.05.
Step 11280 (10 ms): -227.03.

Epoch 30 (7.93 s):
    Evaluating model.
    Full set (4.47 s): ELBO: -207.19, ENRE: -199.18, KL: 8.0135.
    Saving model parameters.
    Model parameters saved (55 ms).

Step 11318 (21 ms): -204.43.
Step 11355 (21 ms): -213.49.
Step 11393 (21 ms): -201.22.
Step 11430 (21 ms): -207.25.
Step 11468 (21 ms): -203.45.
Step 11506 (21 ms): -227.45.
Step 11543 (21 ms): -224.39.
Step 11581 (21 ms): -203.35.
Step 11618 (21 ms): -212.13.
Step 11656 (11 ms): -217.37.

Epoch 31 (7.87 s):
    Evaluating model.
    Full set (4.45 s): ELBO: -206.81, ENRE: -198.78, KL: 8.0244.
    Saving model parameters.
    Model parameters saved (54 ms).

Step 11694 (21 ms): -210.67.
Step 11731 (21 ms): -205.05.
Step 11769 (21 ms): -209.02.
Step 11806 (21 ms): -201.92.
Step 11844 (21 ms): -202.54.
Step 11882 (21 ms): -212.36.
Step 11919 (21 ms): -203.87.
Step 11957 (21 ms): -236.63.
Step 11994 (21 ms): -215.66.
Step 12032 (10 ms): -326.54.

Epoch 32 (7.84 s):
    Evaluating model.
    Full set (4.48 s): ELBO: -206.93, ENRE: -199.01, KL: 7.9178.
    Saving model parameters.
    Model parameters saved (56 ms).

Step 12070 (21 ms): -214.37.
Step 12107 (21 ms): -206.31.
Step 12145 (21 ms): -206.8.
Step 12182 (21 ms): -213.45.
Step 12220 (21 ms): -194.23.
Step 12258 (21 ms): -205.2.
Step 12295 (21 ms): -217.41.
Step 12333 (21 ms): -200.04.
Step 12370 (21 ms): -209.39.
Step 12408 (10 ms): -721.71.

Epoch 33 (7.9 s):
    Evaluating model.
    Full set (4.48 s): ELBO: -206.66, ENRE: -198.87, KL: 7.783.
    Saving model parameters.
    Model parameters saved (56 ms).

Step 12446 (21 ms): -216.46.
Step 12483 (21 ms): -208.99.
Step 12521 (20 ms): -201.39.
Step 12558 (21 ms): -209.25.
Step 12596 (21 ms): -209.29.
Step 12634 (21 ms): -201.68.
Step 12671 (21 ms): -201.27.
Step 12709 (21 ms): -202.56.
Step 12746 (21 ms): -199.47.
Step 12784 (11 ms): -180.64.

Epoch 34 (7.83 s):
    Evaluating model.
    Full set (4.43 s): ELBO: -206.31, ENRE: -198.36, KL: 7.9556.
    Saving model parameters.
    Model parameters saved (56 ms).

Step 12822 (21 ms): -219.18.
Step 12859 (21 ms): -208.58.
Step 12897 (23 ms): -209.38.
Step 12934 (21 ms): -199.04.
Step 12972 (20 ms): -206.
Step 13010 (21 ms): -217.36.
Step 13047 (21 ms): -210.14.
Step 13085 (21 ms): -203.29.
Step 13122 (21 ms): -207.81.
Step 13160 (12 ms): -209.67.

Epoch 35 (7.84 s):
    Evaluating model.
    Full set (4.47 s): ELBO: -206.34, ENRE: -198.69, KL: 7.6459.
    Saving model parameters.
    Model parameters saved (57 ms).

Step 13198 (21 ms): -210.35.
Step 13235 (21 ms): -212.42.
Step 13273 (20 ms): -207.91.
Step 13310 (21 ms): -210.94.
Step 13348 (21 ms): -210.82.
Step 13386 (21 ms): -210.91.
Step 13423 (21 ms): -202.67.
Step 13461 (21 ms): -200.68.
Step 13498 (21 ms): -203.87.
Step 13536 (10 ms): -198.19.

Epoch 36 (7.9 s):
    Evaluating model.
    Full set (4.47 s): ELBO: -205.9, ENRE: -198.14, KL: 7.759.
    Saving model parameters.
    Model parameters saved (59 ms).

Step 13574 (21 ms): -208.86.
Step 13611 (21 ms): -209.65.
Step 13649 (22 ms): -198.06.
Step 13686 (21 ms): -208.55.
Step 13724 (21 ms): -206.98.
Step 13762 (21 ms): -212.6.
Step 13799 (21 ms): -197.75.
Step 13837 (21 ms): -202.58.
Step 13874 (21 ms): -210.06.
Step 13912 (10 ms): -217.35.

Epoch 37 (7.88 s):
    Evaluating model.
    Full set (4.44 s): ELBO: -205.99, ENRE: -198.24, KL: 7.7462.
    Saving model parameters.
    Model parameters saved (56 ms).

Step 13950 (21 ms): -199.66.
Step 13987 (21 ms): -211.55.
Step 14025 (21 ms): -218.87.
Step 14062 (20 ms): -196.83.
Step 14100 (21 ms): -204.
Step 14138 (21 ms): -204.03.
Step 14175 (21 ms): -204.97.
Step 14213 (21 ms): -196.77.
Step 14250 (21 ms): -195.85.
Step 14288 (11 ms): -403.32.

Epoch 38 (7.87 s):
    Evaluating model.
    Full set (4.45 s): ELBO: -205.68, ENRE: -197.91, KL: 7.7649.
    Saving model parameters.
    Model parameters saved (57 ms).

Step 14326 (21 ms): -203.3.
Step 14363 (21 ms): -210.78.
Step 14401 (21 ms): -197.36.
Step 14438 (21 ms): -211.64.
Step 14476 (21 ms): -207.98.
Step 14514 (21 ms): -207.75.
Step 14551 (21 ms): -202.44.
Step 14589 (21 ms): -202.56.
Step 14626 (21 ms): -203.14.
Step 14664 (11 ms): -234.53.

Epoch 39 (7.95 s):
    Evaluating model.
    Full set (4.49 s): ELBO: -205.79, ENRE: -198.02, KL: 7.7746.
    Saving model parameters.
    Model parameters saved (61 ms).

Step 14702 (21 ms): -208.4.
Step 14739 (21 ms): -221.26.
Step 14777 (21 ms): -193.17.
Step 14814 (21 ms): -186.47.
Step 14852 (21 ms): -208.59.
Step 14890 (21 ms): -214.65.
Step 14927 (21 ms): -201.92.
Step 14965 (21 ms): -212.51.
Step 15002 (21 ms): -202.25.
Step 15040 (11 ms): -193.43.

Epoch 40 (7.89 s):
    Evaluating model.
    Full set (4.44 s): ELBO: -205.4, ENRE: -197.59, KL: 7.8076.
    Saving model parameters.
    Model parameters saved (55 ms).

Step 15078 (21 ms): -210.24.
Step 15115 (21 ms): -203.89.
Step 15153 (21 ms): -196.06.
Step 15190 (21 ms): -215.89.
Step 15228 (21 ms): -191.33.
Step 15266 (21 ms): -196.76.
Step 15303 (21 ms): -206.39.
Step 15341 (21 ms): -197.27.
Step 15378 (21 ms): -212.84.
Step 15416 (11 ms): -207.09.

Epoch 41 (7.85 s):
    Evaluating model.
    Full set (4.45 s): ELBO: -205.35, ENRE: -197.75, KL: 7.6009.
    Saving model parameters.
    Model parameters saved (57 ms).

Step 15454 (21 ms): -216.23.
Step 15491 (21 ms): -210.15.
Step 15529 (21 ms): -206.59.
Step 15566 (21 ms): -213.46.
Step 15604 (22 ms): -194.08.
Step 15642 (21 ms): -211.33.
Step 15679 (21 ms): -201.21.
Step 15717 (21 ms): -203.15.
Step 15754 (21 ms): -213.33.
Step 15792 (12 ms): -193.51.

Epoch 42 (7.89 s):
    Evaluating model.
    Full set (4.48 s): ELBO: -205.53, ENRE: -197.82, KL: 7.7075.
    Saving model parameters.
    Model parameters saved (57 ms).

Step 15830 (21 ms): -202.64.
Step 15867 (21 ms): -208.63.
Step 15905 (21 ms): -199.76.
Step 15942 (21 ms): -206.07.
Step 15980 (21 ms): -202.45.
Step 16018 (21 ms): -212.08.
Step 16055 (21 ms): -215.61.
Step 16093 (21 ms): -230.14.
Step 16130 (21 ms): -199.15.
Step 16168 (10 ms): -189.92.

Epoch 43 (7.86 s):
    Evaluating model.
    Full set (4.44 s): ELBO: -204.97, ENRE: -197.26, KL: 7.7126.
    Saving model parameters.
    Model parameters saved (56 ms).

Step 16206 (21 ms): -201.77.
Step 16243 (21 ms): -196.15.
Step 16281 (21 ms): -203.21.
Step 16318 (21 ms): -204.48.
Step 16356 (21 ms): -198.27.
Step 16394 (21 ms): -207.36.
Step 16431 (21 ms): -207.15.
Step 16469 (20 ms): -198.45.
Step 16506 (21 ms): -202.26.
Step 16544 (12 ms): -285.59.

Epoch 44 (7.82 s):
    Evaluating model.
    Full set (4.42 s): ELBO: -205.02, ENRE: -197.43, KL: 7.598.
    Saving model parameters.
    Model parameters saved (60 ms).

Step 16582 (21 ms): -209.85.
Step 16619 (21 ms): -204.94.
Step 16657 (21 ms): -201.14.
Step 16694 (21 ms): -194.02.
Step 16732 (21 ms): -219.79.
Step 16770 (21 ms): -192.93.
Step 16807 (21 ms): -212.07.
Step 16845 (21 ms): -203.79.
Step 16882 (21 ms): -192.67.
Step 16920 (10 ms): -179.66.

Epoch 45 (7.89 s):
    Evaluating model.
    Full set (4.48 s): ELBO: -205.02, ENRE: -197.35, KL: 7.6696.
    Saving model parameters.
    Model parameters saved (58 ms).

Step 16958 (21 ms): -208.25.
Step 16995 (20 ms): -192.25.
Step 17033 (21 ms): -213.24.
Step 17070 (21 ms): -200.04.
Step 17108 (21 ms): -196.19.
Step 17146 (21 ms): -201.15.
Step 17183 (21 ms): -198.21.
Step 17221 (21 ms): -204.45.
Step 17258 (21 ms): -217.97.
Step 17296 (10 ms): -228.6.

Epoch 46 (7.89 s):
    Evaluating model.
    Full set (4.43 s): ELBO: -204.73, ENRE: -196.98, KL: 7.7518.
    Saving model parameters.
    Model parameters saved (54 ms).

Step 17334 (20 ms): -200.48.
Step 17371 (21 ms): -204.25.
Step 17409 (21 ms): -191.6.
Step 17446 (21 ms): -212.52.
Step 17484 (20 ms): -185.67.
Step 17522 (21 ms): -220.06.
Step 17559 (21 ms): -217.32.
Step 17597 (21 ms): -210.92.
Step 17634 (21 ms): -209.3.
Step 17672 (11 ms): -253.34.

Epoch 47 (7.87 s):
    Evaluating model.
    Full set (4.44 s): ELBO: -204.62, ENRE: -196.99, KL: 7.6352.
    Saving model parameters.
    Model parameters saved (56 ms).

Step 17710 (21 ms): -209.72.
Step 17747 (21 ms): -221.96.
Step 17785 (21 ms): -220.16.
Step 17822 (21 ms): -200.09.
Step 17860 (21 ms): -208.88.
Step 17898 (21 ms): -197.46.
Step 17935 (21 ms): -200.04.
Step 17973 (21 ms): -208.87.
Step 18010 (21 ms): -206.23.
Step 18048 (10 ms): -182.57.

Epoch 48 (7.92 s):
    Evaluating model.
    Full set (4.49 s): ELBO: -204.61, ENRE: -196.99, KL: 7.619.
    Saving model parameters.
    Model parameters saved (56 ms).

Step 18086 (21 ms): -196.66.
Step 18123 (21 ms): -213.24.
Step 18161 (21 ms): -217.58.
Step 18198 (21 ms): -200.91.
Step 18236 (21 ms): -215.78.
Step 18274 (21 ms): -203.76.
Step 18311 (21 ms): -210.88.
Step 18349 (21 ms): -189.54.
Step 18386 (21 ms): -197.81.
Step 18424 (10 ms): -220.46.

Epoch 49 (7.95 s):
    Evaluating model.
    Full set (4.46 s): ELBO: -204.7, ENRE: -197.23, KL: 7.4745.
    Saving model parameters.
    Model parameters saved (61 ms).

Step 18462 (21 ms): -209.62.
Step 18499 (21 ms): -207.64.
Step 18537 (21 ms): -203.71.
Step 18574 (21 ms): -203.55.
Step 18612 (21 ms): -202.19.
Step 18650 (21 ms): -195.72.
Step 18687 (21 ms): -195.24.
Step 18725 (21 ms): -203.81.
Step 18762 (21 ms): -204.55.
Step 18800 (11 ms): -213.82.

Epoch 50 (7.86 s):
    Evaluating model.
    Full set (4.43 s): ELBO: -204.4, ENRE: -196.79, KL: 7.6096.
    Saving model parameters.
    Model parameters saved (58 ms).

Model trained for 50 epochs (10m 22s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (12 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (859 ms).

Converting data set value array to sparse matrix.
Data set value array converted (276 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.25 s):  ELBO: -425.24, ENRE: -417.62, KL: 7.626.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (350 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.2907784917018328
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 45
kl weight: 1.2907784917018328
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (51 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.08 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.69 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 45
    hidden sizes: 219, 254, 145, 223
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.2907784917018328
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 3 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 219)
    ENCODER/1/DENSE/biases:0             (219,)
    ENCODER/1/BATCH_NORM/beta:0          (219,)
    ENCODER/2/DENSE/weights:0            (219, 254)
    ENCODER/2/DENSE/biases:0             (254,)
    ENCODER/2/BATCH_NORM/beta:0          (254,)
    ENCODER/3/DENSE/weights:0            (254, 145)
    ENCODER/3/DENSE/biases:0             (145,)
    ENCODER/3/BATCH_NORM/beta:0          (145,)
    ENCODER/4/DENSE/weights:0            (145, 223)
    ENCODER/4/DENSE/biases:0             (223,)
    ENCODER/4/BATCH_NORM/beta:0          (223,)
    POSTERIOR/MU/DENSE/weights:0         (223, 45)
    POSTERIOR/MU/DENSE/biases:0          (45,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (223, 45)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (45,)
    DECODER/4/DENSE/weights:0            (45, 223)
    DECODER/4/DENSE/biases:0             (223,)
    DECODER/4/BATCH_NORM/beta:0          (223,)
    DECODER/3/DENSE/weights:0            (223, 145)
    DECODER/3/DENSE/biases:0             (145,)
    DECODER/3/BATCH_NORM/beta:0          (145,)
    DECODER/2/DENSE/weights:0            (145, 254)
    DECODER/2/DENSE/biases:0             (254,)
    DECODER/2/BATCH_NORM/beta:0          (254,)
    DECODER/1/DENSE/weights:0            (254, 219)
    DECODER/1/DENSE/biases:0             (219,)
    DECODER/1/BATCH_NORM/beta:0          (219,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (219, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (461 ms).

Training model for 50 epochs on original values.

Step 38 (36 ms): -2122.1.
Step 75 (38 ms): -1705.7.
Step 113 (36 ms): -1386.6.
Step 150 (36 ms): -1154.
Step 188 (35 ms): -964.64.
Step 226 (35 ms): -817.92.
Step 263 (35 ms): -740.19.
Step 301 (35 ms): -672.77.
Step 338 (35 ms): -609.01.
Step 376 (18 ms): -535.63.

Epoch 1 (15.9 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.71 s): ELBO: -1694, ENRE: -1674.6, KL: 19.459.
    Saving model parameters.
    Model parameters saved (179 ms).

Step 414 (35 ms): -465.17.
Step 451 (35 ms): -417.88.
Step 489 (35 ms): -400.2.
Step 526 (35 ms): -387.57.
Step 564 (35 ms): -356.33.
Step 602 (35 ms): -335.15.
Step 639 (35 ms): -329.49.
Step 677 (35 ms): -309.76.
Step 714 (36 ms): -321.61.
Step 752 (16 ms): -296.09.

Epoch 2 (13.2 s):
    Warm-up weight: 0.33
    Evaluating model.
    Full set (6.13 s): ELBO: -819.96, ENRE: -803.22, KL: 16.736.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 790 (36 ms): -285.89.
Step 827 (35 ms): -286.78.
Step 865 (36 ms): -283.54.
Step 902 (35 ms): -281.21.
Step 940 (35 ms): -271.02.
Step 978 (35 ms): -266.03.
Step 1015 (35 ms): -281.77.
Step 1053 (35 ms): -257.22.
Step 1090 (36 ms): -253.62.
Step 1128 (16 ms): -242.56.

Epoch 3 (13.2 s):
    Warm-up weight: 0.67
    Evaluating model.
    Full set (6.19 s): ELBO: -487.78, ENRE: -475.71, KL: 12.071.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 1166 (35 ms): -267.56.
Step 1203 (35 ms): -252.23.
Step 1241 (35 ms): -241.77.
Step 1278 (35 ms): -264.65.
Step 1316 (35 ms): -235.27.
Step 1354 (35 ms): -256.95.
Step 1391 (35 ms): -263.08.
Step 1429 (35 ms): -257.28.
Step 1466 (36 ms): -258.25.
Step 1504 (18 ms): -824.83.

Epoch 4 (13.3 s):
    Evaluating model.
    Full set (6.13 s): ELBO: -350.55, ENRE: -341.15, KL: 9.3913.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 1542 (36 ms): -247.41.
Step 1579 (35 ms): -223.34.
Step 1617 (36 ms): -233.36.
Step 1654 (35 ms): -229.32.
Step 1692 (35 ms): -229.1.
Step 1730 (35 ms): -231.15.
Step 1767 (35 ms): -234.25.
Step 1805 (35 ms): -235.2.
Step 1842 (35 ms): -229.73.
Step 1880 (16 ms): -232.16.

Epoch 5 (13.2 s):
    Evaluating model.
    Full set (6.15 s): ELBO: -284, ENRE: -275.24, KL: 8.7632.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 1918 (35 ms): -227.44.
Step 1955 (35 ms): -214.73.
Step 1993 (35 ms): -225.81.
Step 2030 (35 ms): -234.72.
Step 2068 (36 ms): -211.75.
Step 2106 (35 ms): -227.54.
Step 2143 (35 ms): -249.41.
Step 2181 (36 ms): -229.82.
Step 2218 (35 ms): -239.76.
Step 2256 (17 ms): -246.7.

Epoch 6 (13.3 s):
    Evaluating model.
    Full set (6.14 s): ELBO: -253.67, ENRE: -245.55, KL: 8.1106.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 2294 (35 ms): -222.37.
Step 2331 (38 ms): -223.71.
Step 2369 (35 ms): -223.97.
Step 2406 (35 ms): -237.93.
Step 2444 (34 ms): -232.21.
Step 2482 (35 ms): -220.04.
Step 2519 (35 ms): -213.86.
Step 2557 (35 ms): -225.88.
Step 2594 (35 ms): -230.07.
Step 2632 (16 ms): -257.87.

Epoch 7 (13.1 s):
    Evaluating model.
    Full set (6.16 s): ELBO: -237.31, ENRE: -229.53, KL: 7.7786.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 2670 (35 ms): -221.85.
Step 2707 (35 ms): -213.68.
Step 2745 (35 ms): -242.05.
Step 2782 (35 ms): -223.05.
Step 2820 (36 ms): -213.63.
Step 2858 (35 ms): -206.1.
Step 2895 (35 ms): -216.73.
Step 2933 (35 ms): -231.36.
Step 2970 (35 ms): -205.7.
Step 3008 (16 ms): -194.45.

Epoch 8 (13.2 s):
    Evaluating model.
    Full set (6.12 s): ELBO: -227.03, ENRE: -219.61, KL: 7.4246.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 3046 (35 ms): -216.06.
Step 3083 (36 ms): -232.07.
Step 3121 (38 ms): -218.54.
Step 3158 (35 ms): -206.91.
Step 3196 (35 ms): -222.78.
Step 3234 (35 ms): -214.05.
Step 3271 (35 ms): -216.59.
Step 3309 (35 ms): -221.08.
Step 3346 (35 ms): -202.78.
Step 3384 (16 ms): -216.17.

Epoch 9 (13.2 s):
    Evaluating model.
    Full set (6.19 s): ELBO: -220.47, ENRE: -213.14, KL: 7.331.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 3422 (35 ms): -211.71.
Step 3459 (35 ms): -206.64.
Step 3497 (35 ms): -208.51.
Step 3534 (35 ms): -207.86.
Step 3572 (35 ms): -221.71.
Step 3610 (36 ms): -211.93.
Step 3647 (36 ms): -236.96.
Step 3685 (35 ms): -214.95.
Step 3722 (36 ms): -213.58.
Step 3760 (16 ms): -226.69.

Epoch 10 (13.3 s):
    Evaluating model.
    Full set (6.14 s): ELBO: -218.5, ENRE: -211.26, KL: 7.2447.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 3798 (35 ms): -215.73.
Step 3835 (36 ms): -225.36.
Step 3873 (35 ms): -225.35.
Step 3910 (35 ms): -200.51.
Step 3948 (36 ms): -217.96.
Step 3986 (35 ms): -212.02.
Step 4023 (35 ms): -212.25.
Step 4061 (35 ms): -216.18.
Step 4098 (34 ms): -209.6.
Step 4136 (16 ms): -219.96.

Epoch 11 (13.2 s):
    Evaluating model.
    Full set (6.17 s): ELBO: -216.14, ENRE: -209.16, KL: 6.9781.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 4174 (35 ms): -222.03.
Step 4211 (35 ms): -224.06.
Step 4249 (35 ms): -220.47.
Step 4286 (35 ms): -214.76.
Step 4324 (35 ms): -207.99.
Step 4362 (36 ms): -209.29.
Step 4399 (36 ms): -214.57.
Step 4437 (35 ms): -222.74.
Step 4474 (35 ms): -217.44.
Step 4512 (16 ms): -198.84.

Epoch 12 (13.3 s):
    Evaluating model.
    Full set (6.14 s): ELBO: -214.42, ENRE: -207.75, KL: 6.6707.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 4550 (35 ms): -208.51.
Step 4587 (35 ms): -206.18.
Step 4625 (35 ms): -212.01.
Step 4662 (34 ms): -209.32.
Step 4700 (35 ms): -217.13.
Step 4738 (35 ms): -205.28.
Step 4775 (34 ms): -207.85.
Step 4813 (35 ms): -215.62.
Step 4850 (34 ms): -215.08.
Step 4888 (16 ms): -220.87.

Epoch 13 (13.1 s):
    Evaluating model.
    Full set (6.17 s): ELBO: -213.16, ENRE: -206.37, KL: 6.7929.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 4926 (35 ms): -216.2.
Step 4963 (35 ms): -202.03.
Step 5001 (35 ms): -211.95.
Step 5038 (35 ms): -217.41.
Step 5076 (37 ms): -211.84.
Step 5114 (35 ms): -206.51.
Step 5151 (35 ms): -224.81.
Step 5189 (36 ms): -199.7.
Step 5226 (35 ms): -200.25.
Step 5264 (16 ms): -251.44.

Epoch 14 (13.2 s):
    Evaluating model.
    Full set (6.14 s): ELBO: -211.87, ENRE: -205.52, KL: 6.3564.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 5302 (35 ms): -207.85.
Step 5339 (36 ms): -206.89.
Step 5377 (36 ms): -206.49.
Step 5414 (35 ms): -209.28.
Step 5452 (34 ms): -203.68.
Step 5490 (35 ms): -208.38.
Step 5527 (35 ms): -201.35.
Step 5565 (35 ms): -204.36.
Step 5602 (35 ms): -205.86.
Step 5640 (16 ms): -228.06.

Epoch 15 (13.2 s):
    Evaluating model.
    Full set (6.19 s): ELBO: -211.47, ENRE: -205.17, KL: 6.2944.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 5678 (35 ms): -220.15.
Step 5715 (35 ms): -198.14.
Step 5753 (36 ms): -209.2.
Step 5790 (35 ms): -199.58.
Step 5828 (35 ms): -213.96.
Step 5866 (35 ms): -208.63.
Step 5903 (35 ms): -199.81.
Step 5941 (35 ms): -206.47.
Step 5978 (36 ms): -208.52.
Step 6016 (16 ms): -214.29.

Epoch 16 (13.3 s):
    Evaluating model.
    Full set (6.14 s): ELBO: -211.38, ENRE: -205.1, KL: 6.2829.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 6054 (35 ms): -198.64.
Step 6091 (35 ms): -201.47.
Step 6129 (35 ms): -205.61.
Step 6166 (34 ms): -203.37.
Step 6204 (35 ms): -213.94.
Step 6242 (35 ms): -213.15.
Step 6279 (35 ms): -203.44.
Step 6317 (35 ms): -208.8.
Step 6354 (35 ms): -206.18.
Step 6392 (16 ms): -212.13.

Epoch 17 (13.2 s):
    Evaluating model.
    Full set (6.18 s): ELBO: -209.78, ENRE: -203.53, KL: 6.2474.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 6430 (35 ms): -205.51.
Step 6467 (35 ms): -217.14.
Step 6505 (35 ms): -206.7.
Step 6542 (35 ms): -214.38.
Step 6580 (35 ms): -199.67.
Step 6618 (35 ms): -206.74.
Step 6655 (36 ms): -210.34.
Step 6693 (35 ms): -201.59.
Step 6730 (36 ms): -214.04.
Step 6768 (16 ms): -404.57.

Epoch 18 (13.3 s):
    Evaluating model.
    Full set (6.13 s): ELBO: -208.72, ENRE: -202.52, KL: 6.2015.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 6806 (35 ms): -210.63.
Step 6843 (35 ms): -200.79.
Step 6881 (35 ms): -202.09.
Step 6918 (34 ms): -194.05.
Step 6956 (35 ms): -215.5.
Step 6994 (35 ms): -209.57.
Step 7031 (35 ms): -195.83.
Step 7069 (35 ms): -208.45.
Step 7106 (35 ms): -211.06.
Step 7144 (16 ms): -217.26.

Epoch 19 (13.1 s):
    Evaluating model.
    Full set (6.17 s): ELBO: -207.91, ENRE: -201.82, KL: 6.0928.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 7182 (35 ms): -194.82.
Step 7219 (34 ms): -192.78.
Step 7257 (36 ms): -216.64.
Step 7294 (35 ms): -218.44.
Step 7332 (35 ms): -205.3.
Step 7370 (35 ms): -198.
Step 7407 (35 ms): -208.61.
Step 7445 (35 ms): -219.04.
Step 7482 (35 ms): -208.81.
Step 7520 (16 ms): -198.81.

Epoch 20 (13.2 s):
    Evaluating model.
    Full set (6.12 s): ELBO: -207.13, ENRE: -201.1, KL: 6.031.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 7558 (35 ms): -204.47.
Step 7595 (35 ms): -204.42.
Step 7633 (35 ms): -206.2.
Step 7670 (35 ms): -202.37.
Step 7708 (34 ms): -198.9.
Step 7746 (35 ms): -199.61.
Step 7783 (35 ms): -214.93.
Step 7821 (35 ms): -211.33.
Step 7858 (35 ms): -200.2.
Step 7896 (16 ms): -323.77.

Epoch 21 (13.2 s):
    Evaluating model.
    Full set (6.2 s): ELBO: -207.11, ENRE: -201.01, KL: 6.0959.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 7934 (35 ms): -199.07.
Step 7971 (35 ms): -205.64.
Step 8009 (36 ms): -199.52.
Step 8046 (35 ms): -205.22.
Step 8084 (36 ms): -207.51.
Step 8122 (35 ms): -208.61.
Step 8159 (36 ms): -198.82.
Step 8197 (36 ms): -195.75.
Step 8234 (38 ms): -213.62.
Step 8272 (16 ms): -239.72.

Epoch 22 (13.3 s):
    Evaluating model.
    Full set (6.16 s): ELBO: -207, ENRE: -200.78, KL: 6.215.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 8310 (35 ms): -207.65.
Step 8347 (35 ms): -195.76.
Step 8385 (36 ms): -199.41.
Step 8422 (35 ms): -197.67.
Step 8460 (35 ms): -207.08.
Step 8498 (34 ms): -203.6.
Step 8535 (35 ms): -211.4.
Step 8573 (35 ms): -207.13.
Step 8610 (35 ms): -199.68.
Step 8648 (16 ms): -177.18.

Epoch 23 (13.2 s):
    Evaluating model.
    Full set (6.18 s): ELBO: -205.7, ENRE: -199.79, KL: 5.9052.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 8686 (35 ms): -195.11.
Step 8723 (35 ms): -195.02.
Step 8761 (35 ms): -205.12.
Step 8798 (35 ms): -205.61.
Step 8836 (36 ms): -210.78.
Step 8874 (35 ms): -204.17.
Step 8911 (36 ms): -214.65.
Step 8949 (35 ms): -199.81.
Step 8986 (36 ms): -189.57.
Step 9024 (16 ms): -266.77.

Epoch 24 (13.3 s):
    Evaluating model.
    Full set (6.14 s): ELBO: -205.23, ENRE: -199.32, KL: 5.9127.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 9062 (35 ms): -202.27.
Step 9099 (35 ms): -195.86.
Step 9137 (35 ms): -201.13.
Step 9174 (34 ms): -199.16.
Step 9212 (35 ms): -206.14.
Step 9250 (35 ms): -197.96.
Step 9287 (35 ms): -206.75.
Step 9325 (35 ms): -204.62.
Step 9362 (35 ms): -200.64.
Step 9400 (16 ms): -236.14.

Epoch 25 (13.2 s):
    Evaluating model.
    Full set (6.18 s): ELBO: -205.44, ENRE: -199.57, KL: 5.8641.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 9438 (35 ms): -211.81.
Step 9475 (35 ms): -209.29.
Step 9513 (35 ms): -191.44.
Step 9550 (35 ms): -201.25.
Step 9588 (36 ms): -203.19.
Step 9626 (35 ms): -208.58.
Step 9663 (35 ms): -208.72.
Step 9701 (35 ms): -219.79.
Step 9738 (35 ms): -200.65.
Step 9776 (16 ms): -260.31.

Epoch 26 (13.2 s):
    Evaluating model.
    Full set (6.12 s): ELBO: -205.46, ENRE: -199.53, KL: 5.929.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 9814 (35 ms): -209.85.
Step 9851 (35 ms): -194.61.
Step 9889 (35 ms): -221.59.
Step 9926 (35 ms): -203.37.
Step 9964 (34 ms): -206.73.
Step 10002 (35 ms): -203.3.
Step 10039 (35 ms): -204.
Step 10077 (35 ms): -194.57.
Step 10114 (34 ms): -200.47.
Step 10152 (16 ms): -208.

Epoch 27 (13.1 s):
    Evaluating model.
    Full set (6.18 s): ELBO: -203.87, ENRE: -198.04, KL: 5.8292.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 10190 (36 ms): -194.32.
Step 10227 (35 ms): -214.56.
Step 10265 (35 ms): -207.74.
Step 10302 (36 ms): -192.67.
Step 10340 (35 ms): -198.17.
Step 10378 (35 ms): -200.91.
Step 10415 (36 ms): -201.27.
Step 10453 (35 ms): -210.12.
Step 10490 (36 ms): -189.84.
Step 10528 (17 ms): -374.11.

Epoch 28 (13.3 s):
    Evaluating model.
    Full set (6.17 s): ELBO: -203.65, ENRE: -197.69, KL: 5.9616.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 10566 (35 ms): -200.38.
Step 10603 (35 ms): -199.63.
Step 10641 (35 ms): -196.08.
Step 10678 (35 ms): -206.61.
Step 10716 (35 ms): -206.99.
Step 10754 (35 ms): -197.99.
Step 10791 (35 ms): -207.78.
Step 10829 (35 ms): -199.65.
Step 10866 (35 ms): -203.33.
Step 10904 (16 ms): -433.53.

Epoch 29 (13.2 s):
    Evaluating model.
    Full set (6.17 s): ELBO: -203.12, ENRE: -197.14, KL: 5.9752.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 10942 (35 ms): -201.55.
Step 10979 (35 ms): -195.53.
Step 11017 (35 ms): -208.35.
Step 11054 (36 ms): -201.96.
Step 11092 (36 ms): -203.44.
Step 11130 (36 ms): -209.03.
Step 11167 (36 ms): -204.16.
Step 11205 (35 ms): -198.64.
Step 11242 (36 ms): -194.09.
Step 11280 (16 ms): -476.37.

Epoch 30 (13.3 s):
    Evaluating model.
    Full set (6.13 s): ELBO: -202.77, ENRE: -196.68, KL: 6.0936.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 11318 (35 ms): -201.11.
Step 11355 (35 ms): -202.76.
Step 11393 (36 ms): -190.18.
Step 11430 (35 ms): -200.56.
Step 11468 (34 ms): -211.58.
Step 11506 (34 ms): -213.31.
Step 11543 (35 ms): -210.31.
Step 11581 (34 ms): -212.91.
Step 11618 (35 ms): -203.3.
Step 11656 (16 ms): -386.06.

Epoch 31 (13.1 s):
    Evaluating model.
    Full set (6.17 s): ELBO: -202.55, ENRE: -196.45, KL: 6.0954.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 11694 (35 ms): -198.77.
Step 11731 (35 ms): -187.55.
Step 11769 (35 ms): -191.99.
Step 11806 (35 ms): -194.93.
Step 11844 (35 ms): -208.25.
Step 11882 (35 ms): -191.4.
Step 11919 (35 ms): -202.57.
Step 11957 (35 ms): -210.55.
Step 11994 (35 ms): -205.85.
Step 12032 (16 ms): -204.14.

Epoch 32 (13.2 s):
    Evaluating model.
    Full set (6.12 s): ELBO: -202.29, ENRE: -196.22, KL: 6.0717.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 12070 (35 ms): -218.83.
Step 12107 (35 ms): -203.27.
Step 12145 (35 ms): -206.8.
Step 12182 (34 ms): -211.38.
Step 12220 (34 ms): -224.7.
Step 12258 (34 ms): -196.49.
Step 12295 (35 ms): -205.42.
Step 12333 (35 ms): -194.69.
Step 12370 (34 ms): -185.7.
Step 12408 (16 ms): -210.82.

Epoch 33 (13.1 s):
    Evaluating model.
    Full set (6.18 s): ELBO: -201.88, ENRE: -195.95, KL: 5.93.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 12446 (35 ms): -209.17.
Step 12483 (35 ms): -206.84.
Step 12521 (36 ms): -198.42.
Step 12558 (35 ms): -192.79.
Step 12596 (35 ms): -212.49.
Step 12634 (36 ms): -198.11.
Step 12671 (36 ms): -189.
Step 12709 (35 ms): -199.06.
Step 12746 (37 ms): -207.94.
Step 12784 (16 ms): -236.5.

Epoch 34 (13.3 s):
    Evaluating model.
    Full set (6.16 s): ELBO: -201.79, ENRE: -195.84, KL: 5.9446.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 12822 (35 ms): -191.8.
Step 12859 (36 ms): -216.08.
Step 12897 (35 ms): -202.5.
Step 12934 (35 ms): -199.45.
Step 12972 (35 ms): -195.8.
Step 13010 (35 ms): -202.24.
Step 13047 (36 ms): -205.93.
Step 13085 (35 ms): -196.79.
Step 13122 (35 ms): -208.38.
Step 13160 (16 ms): -254.43.

Epoch 35 (13.2 s):
    Evaluating model.
    Full set (6.19 s): ELBO: -201.85, ENRE: -195.86, KL: 5.9909.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 13198 (35 ms): -194.47.
Step 13235 (35 ms): -194.89.
Step 13273 (35 ms): -206.2.
Step 13310 (35 ms): -196.63.
Step 13348 (35 ms): -201.76.
Step 13386 (35 ms): -205.5.
Step 13423 (35 ms): -186.59.
Step 13461 (35 ms): -207.37.
Step 13498 (35 ms): -195.75.
Step 13536 (16 ms): -225.47.

Epoch 36 (13.3 s):
    Evaluating model.
    Full set (6.14 s): ELBO: -201.5, ENRE: -195.49, KL: 6.012.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 13574 (35 ms): -201.99.
Step 13611 (35 ms): -201.68.
Step 13649 (35 ms): -189.97.
Step 13686 (35 ms): -210.73.
Step 13724 (35 ms): -204.69.
Step 13762 (34 ms): -209.23.
Step 13799 (35 ms): -213.16.
Step 13837 (35 ms): -200.34.
Step 13874 (34 ms): -201.72.
Step 13912 (16 ms): -386.97.

Epoch 37 (13.1 s):
    Evaluating model.
    Full set (6.18 s): ELBO: -202.36, ENRE: -196.33, KL: 6.0283.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 13950 (35 ms): -194.78.
Step 13987 (35 ms): -192.63.
Step 14025 (38 ms): -195.03.
Step 14062 (35 ms): -204.84.
Step 14100 (35 ms): -200.63.
Step 14138 (35 ms): -203.51.
Step 14175 (36 ms): -202.82.
Step 14213 (35 ms): -195.58.
Step 14250 (36 ms): -201.11.
Step 14288 (16 ms): -283.57.

Epoch 38 (13.2 s):
    Evaluating model.
    Full set (6.13 s): ELBO: -201.65, ENRE: -195.65, KL: 5.9966.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 14326 (35 ms): -198.42.
Step 14363 (35 ms): -195.8.
Step 14401 (35 ms): -193.38.
Step 14438 (35 ms): -208.59.
Step 14476 (34 ms): -192.1.
Step 14514 (34 ms): -202.59.
Step 14551 (35 ms): -207.1.
Step 14589 (35 ms): -180.96.
Step 14626 (35 ms): -203.16.
Step 14664 (16 ms): -194.94.

Epoch 39 (13.1 s):
    Evaluating model.
    Full set (6.17 s): ELBO: -201.12, ENRE: -195.19, KL: 5.9346.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 14702 (35 ms): -201.7.
Step 14739 (35 ms): -206.72.
Step 14777 (35 ms): -202.36.
Step 14814 (35 ms): -194.89.
Step 14852 (35 ms): -218.09.
Step 14890 (36 ms): -200.25.
Step 14927 (36 ms): -209.92.
Step 14965 (35 ms): -200.83.
Step 15002 (36 ms): -194.01.
Step 15040 (17 ms): -193.59.

Epoch 40 (13.3 s):
    Evaluating model.
    Full set (6.15 s): ELBO: -200.81, ENRE: -194.77, KL: 6.0389.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 15078 (36 ms): -197.75.
Step 15115 (35 ms): -207.27.
Step 15153 (35 ms): -193.
Step 15190 (35 ms): -198.68.
Step 15228 (35 ms): -194.49.
Step 15266 (36 ms): -216.19.
Step 15303 (35 ms): -195.54.
Step 15341 (35 ms): -198.3.
Step 15378 (35 ms): -195.17.
Step 15416 (16 ms): -222.2.

Epoch 41 (13.2 s):
    Evaluating model.
    Full set (6.19 s): ELBO: -201.53, ENRE: -195.53, KL: 6.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 15454 (35 ms): -203.8.
Step 15491 (35 ms): -200.31.
Step 15529 (35 ms): -205.32.
Step 15566 (36 ms): -206.56.
Step 15604 (36 ms): -209.76.
Step 15642 (35 ms): -205.52.
Step 15679 (35 ms): -200.72.
Step 15717 (36 ms): -210.3.
Step 15754 (35 ms): -192.79.
Step 15792 (16 ms): -520.55.

Epoch 42 (13.3 s):
    Evaluating model.
    Full set (6.13 s): ELBO: -200.86, ENRE: -194.78, KL: 6.0798.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 15830 (36 ms): -215.42.
Step 15867 (35 ms): -203.23.
Step 15905 (35 ms): -198.78.
Step 15942 (35 ms): -199.6.
Step 15980 (35 ms): -202.65.
Step 16018 (35 ms): -204.55.
Step 16055 (35 ms): -200.27.
Step 16093 (35 ms): -211.95.
Step 16130 (35 ms): -211.18.
Step 16168 (16 ms): -190.65.

Epoch 43 (13.2 s):
    Evaluating model.
    Full set (6.17 s): ELBO: -200.81, ENRE: -194.74, KL: 6.0673.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 16206 (35 ms): -202.51.
Step 16243 (35 ms): -204.99.
Step 16281 (35 ms): -206.56.
Step 16318 (35 ms): -220.87.
Step 16356 (35 ms): -203.89.
Step 16394 (35 ms): -208.2.
Step 16431 (35 ms): -199.78.
Step 16469 (35 ms): -192.26.
Step 16506 (36 ms): -198.22.
Step 16544 (16 ms): -182.58.

Epoch 44 (13.2 s):
    Evaluating model.
    Full set (6.14 s): ELBO: -200.88, ENRE: -194.83, KL: 6.0575.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 16582 (35 ms): -211.14.
Step 16619 (35 ms): -200.68.
Step 16657 (35 ms): -198.34.
Step 16694 (36 ms): -205.91.
Step 16732 (34 ms): -196.68.
Step 16770 (35 ms): -202.08.
Step 16807 (35 ms): -201.91.
Step 16845 (35 ms): -201.73.
Step 16882 (34 ms): -203.64.
Step 16920 (16 ms): -284.2.

Epoch 45 (13.1 s):
    Evaluating model.
    Full set (6.18 s): ELBO: -200.34, ENRE: -194.33, KL: 6.0123.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 16958 (35 ms): -198.53.
Step 16995 (35 ms): -201.66.
Step 17033 (35 ms): -208.49.
Step 17070 (35 ms): -207.
Step 17108 (35 ms): -188.89.
Step 17146 (35 ms): -195.57.
Step 17183 (35 ms): -196.9.
Step 17221 (35 ms): -190.03.
Step 17258 (35 ms): -189.92.
Step 17296 (17 ms): -230.75.

Epoch 46 (13.3 s):
    Evaluating model.
    Full set (6.14 s): ELBO: -200.27, ENRE: -194.32, KL: 5.946.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 17334 (35 ms): -210.64.
Step 17371 (35 ms): -200.36.
Step 17409 (35 ms): -211.01.
Step 17446 (35 ms): -200.6.
Step 17484 (35 ms): -199.08.
Step 17522 (34 ms): -194.95.
Step 17559 (35 ms): -194.89.
Step 17597 (35 ms): -190.5.
Step 17634 (35 ms): -193.6.
Step 17672 (16 ms): -217.52.

Epoch 47 (13.2 s):
    Evaluating model.
    Full set (6.18 s): ELBO: -200.43, ENRE: -194.43, KL: 6.0057.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 17710 (35 ms): -209.52.
Step 17747 (35 ms): -198.63.
Step 17785 (36 ms): -196.94.
Step 17822 (35 ms): -202.79.
Step 17860 (35 ms): -193.09.
Step 17898 (35 ms): -192.24.
Step 17935 (36 ms): -208.48.
Step 17973 (35 ms): -202.4.
Step 18010 (36 ms): -196.29.
Step 18048 (16 ms): -230.83.

Epoch 48 (13.3 s):
    Evaluating model.
    Full set (6.13 s): ELBO: -200.1, ENRE: -194.1, KL: 5.9989.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 18086 (36 ms): -194.17.
Step 18123 (36 ms): -195.09.
Step 18161 (35 ms): -194.17.
Step 18198 (34 ms): -200.47.
Step 18236 (35 ms): -192.38.
Step 18274 (35 ms): -213.61.
Step 18311 (35 ms): -197.14.
Step 18349 (36 ms): -205.45.
Step 18386 (35 ms): -204.24.
Step 18424 (16 ms): -222.34.

Epoch 49 (13.2 s):
    Evaluating model.
    Full set (6.17 s): ELBO: -200.37, ENRE: -194.38, KL: 5.9901.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 18462 (35 ms): -200.24.
Step 18499 (35 ms): -193.53.
Step 18537 (35 ms): -211.56.
Step 18574 (35 ms): -202.56.
Step 18612 (35 ms): -202.53.
Step 18650 (35 ms): -207.51.
Step 18687 (35 ms): -202.67.
Step 18725 (35 ms): -196.89.
Step 18762 (35 ms): -192.8.
Step 18800 (16 ms): -331.37.

Epoch 50 (13.2 s):
    Evaluating model.
    Full set (6.13 s): ELBO: -200.21, ENRE: -194.21, KL: 6.0061.
    Saving model parameters.
    Model parameters saved (115 ms).

Model trained for 50 epochs (16m 21s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (846 ms).

Converting data set value array to sparse matrix.
Data set value array converted (275 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2.17 s):  ELBO: -423.98, ENRE: -417.99, KL: 5.9922.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (706 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 0.9125112104331029
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 47
kl weight: 0.9125112104331029
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (53 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.15 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.89 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 47
    hidden sizes: 228, 199, 239, 223
    latent distribution: gaussian
    reconstruction distribution: gaussian
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 0.9125112104331029
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 3 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 228)
    ENCODER/1/DENSE/biases:0             (228,)
    ENCODER/1/BATCH_NORM/beta:0          (228,)
    ENCODER/2/DENSE/weights:0            (228, 199)
    ENCODER/2/DENSE/biases:0             (199,)
    ENCODER/2/BATCH_NORM/beta:0          (199,)
    ENCODER/3/DENSE/weights:0            (199, 239)
    ENCODER/3/DENSE/biases:0             (239,)
    ENCODER/3/BATCH_NORM/beta:0          (239,)
    ENCODER/4/DENSE/weights:0            (239, 223)
    ENCODER/4/DENSE/biases:0             (223,)
    ENCODER/4/BATCH_NORM/beta:0          (223,)
    POSTERIOR/MU/DENSE/weights:0         (223, 47)
    POSTERIOR/MU/DENSE/biases:0          (47,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (223, 47)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (47,)
    DECODER/4/DENSE/weights:0            (47, 223)
    DECODER/4/DENSE/biases:0             (223,)
    DECODER/4/BATCH_NORM/beta:0          (223,)
    DECODER/3/DENSE/weights:0            (223, 239)
    DECODER/3/DENSE/biases:0             (239,)
    DECODER/3/BATCH_NORM/beta:0          (239,)
    DECODER/2/DENSE/weights:0            (239, 199)
    DECODER/2/DENSE/biases:0             (199,)
    DECODER/2/BATCH_NORM/beta:0          (199,)
    DECODER/1/DENSE/weights:0            (199, 228)
    DECODER/1/DENSE/biases:0             (228,)
    DECODER/1/BATCH_NORM/beta:0          (228,)
    X_TILDE/MU/DENSE/weights:0           (228, 2000)
    X_TILDE/MU/DENSE/biases:0            (2000,)
    X_TILDE/LOG_SIGMA/DENSE/weights:0    (228, 2000)
    X_TILDE/LOG_SIGMA/DENSE/biases:0     (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (499 ms).

Training model for 50 epochs on original values.

Step 38 (41 ms): -3082.2.
Step 75 (41 ms): -2187.3.
Step 113 (40 ms): -1450.5.
Step 150 (41 ms): -1052.7.
Step 188 (41 ms): -483.32.
Step 226 (40 ms): 21.038.
Step 263 (41 ms): 342.37.
Step 301 (40 ms): 856.58.
Step 338 (41 ms): 994.73.
Step 376 (21 ms): -250.77.

Epoch 1 (17.9 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.76 s): ELBO: -1795.3, ENRE: -1537.5, KL: 257.75.
    Saving model parameters.
    Model parameters saved (196 ms).

Step 414 (41 ms): 1392.5.
Step 451 (41 ms): 1620.4.
Step 489 (41 ms): 1844.1.
Step 526 (40 ms): 1849.1.
Step 564 (40 ms): 1907.4.
Step 602 (40 ms): 2032.
Step 639 (40 ms): 1833.8.
Step 677 (40 ms): 2015.3.
Step 714 (40 ms): 2339.7.
Step 752 (19 ms): 848.9.

Epoch 2 (15.3 s):
    Warm-up weight: 0.33
    Evaluating model.
    Full set (6.15 s): ELBO: 765.49, ENRE: 904.18, KL: 138.69.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 790 (40 ms): 2265.1.
Step 827 (40 ms): 1950.8.
Step 865 (40 ms): 2277.3.
Step 902 (41 ms): 2270.6.
Step 940 (41 ms): 2379.9.
Step 978 (41 ms): 2307.2.
Step 1015 (41 ms): 2286.9.
Step 1053 (41 ms): 2354.3.
Step 1090 (41 ms): 2357.4.
Step 1128 (20 ms): 1624.5.

Epoch 3 (15.3 s):
    Warm-up weight: 0.67
    Evaluating model.
    Full set (6.14 s): ELBO: 2027.7, ENRE: 2111.5, KL: 83.717.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 1166 (40 ms): 2376.7.
Step 1203 (41 ms): 2497.6.
Step 1241 (40 ms): 2203.2.
Step 1278 (42 ms): 2329.4.
Step 1316 (40 ms): 2260.1.
Step 1354 (40 ms): 2230.9.
Step 1391 (42 ms): 2211.6.
Step 1429 (40 ms): 2262.6.
Step 1466 (40 ms): 2480.9.
Step 1504 (19 ms): 1363.9.

Epoch 4 (15.2 s):
    Evaluating model.
    Full set (6.15 s): ELBO: 2111.6, ENRE: 2169.2, KL: 57.566.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 1542 (40 ms): 2479.6.
Step 1579 (41 ms): 2487.7.
Step 1617 (40 ms): 2498.4.
Step 1654 (41 ms): 2323.6.
Step 1692 (40 ms): 2317.2.
Step 1730 (41 ms): 2386.9.
Step 1767 (40 ms): 2466.4.
Step 1805 (41 ms): 2555.1.
Step 1842 (40 ms): 2421.8.
Step 1880 (19 ms): 1061.6.

Epoch 5 (15.3 s):
    Evaluating model.
    Full set (6.15 s): ELBO: 2031.4, ENRE: 2077.2, KL: 45.819.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 1918 (41 ms): 2549.2.
Step 1955 (40 ms): 2344.9.
Step 1993 (41 ms): 2388.2.
Step 2030 (40 ms): 2473.4.
Step 2068 (40 ms): 2606.
Step 2106 (41 ms): 2369.7.
Step 2143 (41 ms): 2412.
Step 2181 (40 ms): 2432.9.
Step 2218 (41 ms): 2506.8.
Step 2256 (19 ms): 1132.9.

Epoch 6 (15.2 s):
    Evaluating model.
    Full set (6.16 s): ELBO: 2182.8, ENRE: 2224, KL: 41.175.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 2294 (41 ms): 2403.6.
Step 2331 (41 ms): 2590.2.
Step 2369 (41 ms): 2554.5.
Step 2406 (41 ms): 2608.4.
Step 2444 (41 ms): 2481.8.
Step 2482 (42 ms): 2327.1.
Step 2519 (41 ms): 2492.5.
Step 2557 (43 ms): 2603.2.
Step 2594 (41 ms): 2486.1.
Step 2632 (19 ms): 1514.3.

Epoch 7 (15.4 s):
    Evaluating model.
    Full set (6.13 s): ELBO: 2277.9, ENRE: 2315.3, KL: 37.362.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 2670 (40 ms): 2570.4.
Step 2707 (41 ms): 2465.3.
Step 2745 (40 ms): 2608.6.
Step 2782 (40 ms): 2510.8.
Step 2820 (40 ms): 2655.6.
Step 2858 (40 ms): 2555.8.
Step 2895 (40 ms): 2527.8.
Step 2933 (41 ms): 2521.
Step 2970 (40 ms): 2317.4.
Step 3008 (18 ms): -2714.7.

Epoch 8 (15.2 s):
    Evaluating model.
    Full set (6.16 s): ELBO: 2246.7, ENRE: 2284.2, KL: 37.445.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 3046 (41 ms): 2520.7.
Step 3083 (40 ms): 2630.5.
Step 3121 (40 ms): 2610.7.
Step 3158 (40 ms): 2571.4.
Step 3196 (42 ms): 2621.6.
Step 3234 (41 ms): 2548.2.
Step 3271 (40 ms): 2625.6.
Step 3309 (40 ms): 2379.1.
Step 3346 (40 ms): 2504.4.
Step 3384 (19 ms): 734.17.

Epoch 9 (15.2 s):
    Evaluating model.
    Full set (6.13 s): ELBO: 2185.8, ENRE: 2224.6, KL: 38.849.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 3422 (40 ms): 2640.1.
Step 3459 (40 ms): 2598.6.
Step 3497 (40 ms): 2607.8.
Step 3534 (40 ms): 2430.3.
Step 3572 (40 ms): 2634.7.
Step 3610 (40 ms): 2582.1.
Step 3647 (42 ms): 2482.6.
Step 3685 (40 ms): 2541.9.
Step 3722 (41 ms): 2562.1.
Step 3760 (19 ms): 701.52.

Epoch 10 (15.2 s):
    Evaluating model.
    Full set (6.14 s): ELBO: 2231.1, ENRE: 2267.2, KL: 36.103.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 3798 (40 ms): 2643.9.
Step 3835 (40 ms): 2624.1.
Step 3873 (40 ms): 2600.6.
Step 3910 (40 ms): 2667.5.
Step 3948 (40 ms): 2550.7.
Step 3986 (40 ms): 2634.2.
Step 4023 (40 ms): 2602.7.
Step 4061 (40 ms): 2567.5.
Step 4098 (41 ms): 2552.4.
Step 4136 (19 ms): -12462.

Epoch 11 (15.2 s):
    Evaluating model.
    Full set (6.12 s): ELBO: 2318.6, ENRE: 2349.5, KL: 30.884.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 4174 (40 ms): 2572.8.
Step 4211 (40 ms): 2557.2.
Step 4249 (40 ms): 2590.2.
Step 4286 (41 ms): 2601.2.
Step 4324 (40 ms): 2584.7.
Step 4362 (43 ms): 2679.3.
Step 4399 (41 ms): 2643.1.
Step 4437 (41 ms): 2464.
Step 4474 (41 ms): 2509.
Step 4512 (19 ms): 1301.6.

Epoch 12 (15.2 s):
    Evaluating model.
    Full set (6.17 s): ELBO: 2351, ENRE: 2381.5, KL: 30.508.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 4550 (41 ms): 2638.1.
Step 4587 (41 ms): 2606.3.
Step 4625 (41 ms): 2540.3.
Step 4662 (40 ms): 2608.1.
Step 4700 (41 ms): 2686.5.
Step 4738 (40 ms): 2605.4.
Step 4775 (40 ms): 2588.2.
Step 4813 (42 ms): 2707.4.
Step 4850 (40 ms): 2622.7.
Step 4888 (19 ms): 1378.2.

Epoch 13 (15.2 s):
    Evaluating model.
    Full set (6.13 s): ELBO: 2391.7, ENRE: 2422, KL: 30.284.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 4926 (41 ms): 2557.2.
Step 4963 (41 ms): 2426.3.
Step 5001 (41 ms): 2645.2.
Step 5038 (41 ms): 2638.3.
Step 5076 (41 ms): 2560.5.
Step 5114 (41 ms): 2691.1.
Step 5151 (41 ms): 2726.6.
Step 5189 (41 ms): 2445.6.
Step 5226 (41 ms): 2689.3.
Step 5264 (18 ms): 1624.2.

Epoch 14 (15.3 s):
    Evaluating model.
    Full set (6.15 s): ELBO: 2398.4, ENRE: 2428.2, KL: 29.869.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 5302 (41 ms): 2602.2.
Step 5339 (40 ms): 2613.5.
Step 5377 (40 ms): 2667.7.
Step 5414 (41 ms): 2601.4.
Step 5452 (40 ms): 2339.6.
Step 5490 (40 ms): 2708.9.
Step 5527 (40 ms): 2652.3.
Step 5565 (40 ms): 2696.1.
Step 5602 (41 ms): 2525.6.
Step 5640 (18 ms): -2191.

Epoch 15 (15.1 s):
    Evaluating model.
    Full set (6.13 s): ELBO: 2375.9, ENRE: 2404.9, KL: 29.063.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 5678 (40 ms): 2631.1.
Step 5715 (41 ms): 2653.2.
Step 5753 (41 ms): 2634.4.
Step 5790 (40 ms): 2470.6.
Step 5828 (40 ms): 2637.2.
Step 5866 (40 ms): 2635.7.
Step 5903 (41 ms): 2556.3.
Step 5941 (40 ms): 2517.1.
Step 5978 (41 ms): 2655.5.
Step 6016 (18 ms): -2259.4.

Epoch 16 (15.3 s):
    Evaluating model.
    Full set (6.11 s): ELBO: 2444.9, ENRE: 2472, KL: 27.139.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 6054 (40 ms): 2602.
Step 6091 (40 ms): 2690.8.
Step 6129 (40 ms): 2684.3.
Step 6166 (40 ms): 2682.2.
Step 6204 (41 ms): 2622.2.
Step 6242 (40 ms): 2535.1.
Step 6279 (40 ms): 2594.
Step 6317 (41 ms): 2596.4.
Step 6354 (40 ms): 2641.4.
Step 6392 (19 ms): -19.231.

Epoch 17 (15.1 s):
    Evaluating model.
    Full set (6.14 s): ELBO: 2492.1, ENRE: 2517.5, KL: 25.459.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 6430 (41 ms): 2627.4.
Step 6467 (40 ms): 2389.7.
Step 6505 (40 ms): 2673.9.
Step 6542 (41 ms): 2648.9.
Step 6580 (40 ms): 2602.9.
Step 6618 (40 ms): 2555.2.
Step 6655 (40 ms): 2673.4.
Step 6693 (40 ms): 2671.2.
Step 6730 (40 ms): 2643.9.
Step 6768 (19 ms): -6831.6.

Epoch 18 (15.2 s):
    Evaluating model.
    Full set (6.13 s): ELBO: 2418.4, ENRE: 2446.3, KL: 27.973.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 6806 (40 ms): 2739.4.
Step 6843 (40 ms): 2706.9.
Step 6881 (40 ms): 2709.6.
Step 6918 (40 ms): 2728.4.
Step 6956 (41 ms): 2709.1.
Step 6994 (41 ms): 2693.
Step 7031 (41 ms): 2635.
Step 7069 (40 ms): 2580.3.
Step 7106 (42 ms): 2699.2.
Step 7144 (19 ms): -6370.8.

Epoch 19 (15.2 s):
    Evaluating model.
    Full set (6.16 s): ELBO: 2492.6, ENRE: 2516.5, KL: 23.915.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 7182 (41 ms): 2673.6.
Step 7219 (40 ms): 2632.8.
Step 7257 (40 ms): 2620.5.
Step 7294 (41 ms): 2632.
Step 7332 (40 ms): 2629.6.
Step 7370 (40 ms): 2708.1.
Step 7407 (40 ms): 2661.
Step 7445 (40 ms): 2660.3.
Step 7482 (41 ms): 2702.2.
Step 7520 (19 ms): -57633.

Epoch 20 (15.3 s):
    Evaluating model.
    Full set (6.14 s): ELBO: 2488.7, ENRE: 2511.6, KL: 22.908.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 7558 (40 ms): 2693.8.
Step 7595 (40 ms): 2657.4.
Step 7633 (41 ms): 2756.3.
Step 7670 (41 ms): 2646.5.
Step 7708 (40 ms): 2627.7.
Step 7746 (41 ms): 2596.
Step 7783 (40 ms): 2697.
Step 7821 (42 ms): 2679.6.
Step 7858 (41 ms): 2695.1.
Step 7896 (19 ms): 1372.4.

Epoch 21 (15.3 s):
    Evaluating model.
    Full set (6.18 s): ELBO: 2519.6, ENRE: 2542.6, KL: 22.946.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 7934 (41 ms): 2681.9.
Step 7971 (41 ms): 2672.6.
Step 8009 (40 ms): 2702.1.
Step 8046 (41 ms): 2730.8.
Step 8084 (40 ms): 2603.
Step 8122 (40 ms): 2702.
Step 8159 (40 ms): 2721.1.
Step 8197 (41 ms): 2680.3.
Step 8234 (41 ms): 2714.3.
Step 8272 (19 ms): -1217.1.

Epoch 22 (15.2 s):
    Evaluating model.
    Full set (6.14 s): ELBO: 2569.6, ENRE: 2592.1, KL: 22.486.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 8310 (40 ms): 2628.9.
Step 8347 (40 ms): 2660.3.
Step 8385 (41 ms): 2716.1.
Step 8422 (41 ms): 2616.9.
Step 8460 (41 ms): 2640.3.
Step 8498 (40 ms): 2741.6.
Step 8535 (40 ms): 2686.4.
Step 8573 (40 ms): 2676.7.
Step 8610 (40 ms): 2598.2.
Step 8648 (19 ms): 49.516.

Epoch 23 (15.2 s):
    Evaluating model.
    Full set (6.17 s): ELBO: 2601.4, ENRE: 2622.8, KL: 21.361.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 8686 (40 ms): 2675.4.
Step 8723 (40 ms): 2759.7.
Step 8761 (41 ms): 2650.3.
Step 8798 (41 ms): 2736.2.
Step 8836 (41 ms): 2611.4.
Step 8874 (40 ms): 2691.3.
Step 8911 (40 ms): 2659.4.
Step 8949 (40 ms): 2662.1.
Step 8986 (41 ms): 2681.3.
Step 9024 (19 ms): -3412.8.

Epoch 24 (15.2 s):
    Evaluating model.
    Full set (6.15 s): ELBO: 2481.3, ENRE: 2509.5, KL: 28.198.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 9062 (41 ms): 2742.6.
Step 9099 (41 ms): 2726.
Step 9137 (41 ms): 2626.7.
Step 9174 (40 ms): 2628.
Step 9212 (41 ms): 2681.4.
Step 9250 (40 ms): 2674.9.
Step 9287 (41 ms): 2740.4.
Step 9325 (41 ms): 2632.8.
Step 9362 (41 ms): 2614.8.
Step 9400 (19 ms): -3416.7.

Epoch 25 (15.3 s):
    Evaluating model.
    Full set (6.12 s): ELBO: 2599.8, ENRE: 2622.5, KL: 22.736.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 9438 (40 ms): 2716.5.
Step 9475 (41 ms): 2748.3.
Step 9513 (40 ms): 2588.9.
Step 9550 (40 ms): 2592.
Step 9588 (41 ms): 2722.7.
Step 9626 (41 ms): 2691.8.
Step 9663 (40 ms): 2719.6.
Step 9701 (41 ms): 2726.9.
Step 9738 (40 ms): 2600.3.
Step 9776 (19 ms): -2753.4.

Epoch 26 (15.2 s):
    Evaluating model.
    Full set (6.13 s): ELBO: 2638.5, ENRE: 2659.8, KL: 21.32.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 9814 (41 ms): 2657.5.
Step 9851 (41 ms): 2757.8.
Step 9889 (40 ms): 2681.5.
Step 9926 (41 ms): 2782.8.
Step 9964 (41 ms): 2710.8.
Step 10002 (40 ms): 2689.4.
Step 10039 (41 ms): 2671.3.
Step 10077 (40 ms): 2632.4.
Step 10114 (40 ms): 2655.6.
Step 10152 (18 ms): 1427.3.

Epoch 27 (15.2 s):
    Evaluating model.
    Full set (6.11 s): ELBO: 2605.2, ENRE: 2628.1, KL: 22.885.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 10190 (40 ms): 2734.8.
Step 10227 (40 ms): 2654.7.
Step 10265 (40 ms): 2733.1.
Step 10302 (40 ms): 2741.1.
Step 10340 (40 ms): 2720.3.
Step 10378 (40 ms): 2673.7.
Step 10415 (39 ms): 2626.2.
Step 10453 (40 ms): 2642.4.
Step 10490 (41 ms): 2703.6.
Step 10528 (19 ms): -1263.6.

Epoch 28 (15.1 s):
    Evaluating model.
    Full set (6.17 s): ELBO: 2642.6, ENRE: 2663.1, KL: 20.516.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 10566 (41 ms): 2777.2.
Step 10603 (41 ms): 2715.2.
Step 10641 (41 ms): 2726.6.
Step 10678 (40 ms): 2529.3.
Step 10716 (41 ms): 2748.
Step 10754 (40 ms): 2759.9.
Step 10791 (40 ms): 2665.5.
Step 10829 (40 ms): 2581.5.
Step 10866 (41 ms): 2745.2.
Step 10904 (19 ms): -1050.9.

Epoch 29 (15.3 s):
    Evaluating model.
    Full set (6.14 s): ELBO: 2485.3, ENRE: 2512.9, KL: 27.597.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 10942 (41 ms): 2711.8.
Step 10979 (40 ms): 2664.7.
Step 11017 (42 ms): 2711.
Step 11054 (40 ms): 2691.
Step 11092 (41 ms): 2759.3.
Step 11130 (42 ms): 2677.8.
Step 11167 (41 ms): 2724.8.
Step 11205 (40 ms): 2731.1.
Step 11242 (41 ms): 2749.9.
Step 11280 (19 ms): -1313.5.

Epoch 30 (15.3 s):
    Evaluating model.
    Full set (6.16 s): ELBO: 2568, ENRE: 2592.5, KL: 24.487.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 11318 (41 ms): 2717.1.
Step 11355 (41 ms): 2651.4.
Step 11393 (40 ms): 2734.7.
Step 11430 (40 ms): 2737.6.
Step 11468 (40 ms): 2767.5.
Step 11506 (40 ms): 2668.7.
Step 11543 (41 ms): 2686.5.
Step 11581 (40 ms): 2576.6.
Step 11618 (40 ms): 2756.
Step 11656 (19 ms): -4131.2.

Epoch 31 (15.2 s):
    Evaluating model.
    Full set (6.12 s): ELBO: 2689.4, ENRE: 2708.4, KL: 18.993.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 11694 (41 ms): 2725.6.
Step 11731 (40 ms): 2721.7.
Step 11769 (41 ms): 2763.
Step 11806 (41 ms): 2698.6.
Step 11844 (40 ms): 2706.2.
Step 11882 (41 ms): 2749.4.
Step 11919 (41 ms): 2652.8.
Step 11957 (40 ms): 2681.7.
Step 11994 (40 ms): 2715.1.
Step 12032 (19 ms): 535.4.

Epoch 32 (15.2 s):
    Evaluating model.
    Full set (6.16 s): ELBO: 2647.6, ENRE: 2667.2, KL: 19.539.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 12070 (41 ms): 2681.8.
Step 12107 (40 ms): 2706.5.
Step 12145 (40 ms): 2771.6.
Step 12182 (41 ms): 2736.6.
Step 12220 (41 ms): 2691.9.
Step 12258 (40 ms): 2694.8.
Step 12295 (39 ms): 2694.3.
Step 12333 (40 ms): 2793.5.
Step 12370 (40 ms): 2653.3.
Step 12408 (19 ms): -1967.5.

Epoch 33 (15.1 s):
    Evaluating model.
    Full set (6.12 s): ELBO: 2679.7, ENRE: 2699.2, KL: 19.509.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 12446 (40 ms): 2569.1.
Step 12483 (40 ms): 2639.1.
Step 12521 (40 ms): 2666.3.
Step 12558 (40 ms): 2792.1.
Step 12596 (41 ms): 2742.4.
Step 12634 (41 ms): 2744.7.
Step 12671 (41 ms): 2633.7.
Step 12709 (41 ms): 2736.7.
Step 12746 (42 ms): 2705.
Step 12784 (19 ms): -146.3.

Epoch 34 (15.3 s):
    Evaluating model.
    Full set (6.17 s): ELBO: 2606.1, ENRE: 2630.5, KL: 24.436.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 12822 (40 ms): 2725.8.
Step 12859 (41 ms): 2742.9.
Step 12897 (40 ms): 2775.6.
Step 12934 (42 ms): 2773.6.
Step 12972 (40 ms): 2710.4.
Step 13010 (40 ms): 2743.2.
Step 13047 (41 ms): 2702.4.
Step 13085 (40 ms): 2719.
Step 13122 (41 ms): 2791.4.
Step 13160 (19 ms): -3623.6.

Epoch 35 (15.3 s):
    Evaluating model.
    Full set (6.16 s): ELBO: 2713.5, ENRE: 2732.5, KL: 19.009.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 13198 (42 ms): 2677.
Step 13235 (40 ms): 2769.2.
Step 13273 (40 ms): 2619.9.
Step 13310 (42 ms): 2773.2.
Step 13348 (40 ms): 2718.
Step 13386 (42 ms): 2678.7.
Step 13423 (41 ms): 2794.4.
Step 13461 (41 ms): 2692.6.
Step 13498 (40 ms): 2736.6.
Step 13536 (19 ms): -2006.8.

Epoch 36 (15.3 s):
    Evaluating model.
    Full set (6.12 s): ELBO: 2669.1, ENRE: 2689.5, KL: 20.413.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 13574 (40 ms): 2780.7.
Step 13611 (41 ms): 2708.6.
Step 13649 (40 ms): 2671.5.
Step 13686 (41 ms): 2805.5.
Step 13724 (40 ms): 2791.6.
Step 13762 (40 ms): 2767.8.
Step 13799 (41 ms): 2657.2.
Step 13837 (40 ms): 2661.
Step 13874 (41 ms): 2746.7.
Step 13912 (19 ms): -195.49.

Epoch 37 (15.2 s):
    Evaluating model.
    Full set (6.15 s): ELBO: 2680.9, ENRE: 2700.6, KL: 19.671.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 13950 (41 ms): 2773.
Step 13987 (40 ms): 2561.6.
Step 14025 (41 ms): 2751.4.
Step 14062 (40 ms): 2793.
Step 14100 (40 ms): 2833.5.
Step 14138 (40 ms): 2778.2.
Step 14175 (40 ms): 2674.2.
Step 14213 (41 ms): 2693.4.
Step 14250 (41 ms): 2784.9.
Step 14288 (19 ms): -1284.7.

Epoch 38 (15.2 s):
    Evaluating model.
    Full set (6.15 s): ELBO: 2705.5, ENRE: 2724.3, KL: 18.758.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 14326 (41 ms): 2751.6.
Step 14363 (40 ms): 2799.
Step 14401 (40 ms): 2747.1.
Step 14438 (40 ms): 2725.3.
Step 14476 (40 ms): 2623.4.
Step 14514 (41 ms): 2740.6.
Step 14551 (41 ms): 2754.
Step 14589 (41 ms): 2723.8.
Step 14626 (40 ms): 2748.2.
Step 14664 (19 ms): 169.02.

Epoch 39 (15.3 s):
    Evaluating model.
    Full set (6.19 s): ELBO: 2696.2, ENRE: 2715.2, KL: 19.004.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 14702 (41 ms): 2778.5.
Step 14739 (41 ms): 2754.8.
Step 14777 (40 ms): 2742.2.
Step 14814 (40 ms): 2764.
Step 14852 (41 ms): 2813.7.
Step 14890 (40 ms): 2752.9.
Step 14927 (41 ms): 2761.6.
Step 14965 (40 ms): 2631.1.
Step 15002 (40 ms): 2620.2.
Step 15040 (19 ms): -2639.1.

Epoch 40 (15.3 s):
    Evaluating model.
    Full set (6.15 s): ELBO: 2716.7, ENRE: 2734.9, KL: 18.218.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 15078 (41 ms): 2616.9.
Step 15115 (41 ms): 2806.
Step 15153 (40 ms): 2687.1.
Step 15190 (41 ms): 2745.
Step 15228 (40 ms): 2730.3.
Step 15266 (40 ms): 2726.4.
Step 15303 (41 ms): 2752.2.
Step 15341 (41 ms): 2720.1.
Step 15378 (41 ms): 2709.1.
Step 15416 (19 ms): -538.94.

Epoch 41 (15.3 s):
    Evaluating model.
    Full set (6.17 s): ELBO: 2692.7, ENRE: 2712.2, KL: 19.521.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 15454 (41 ms): 2758.4.
Step 15491 (40 ms): 2825.9.
Step 15529 (40 ms): 2677.1.
Step 15566 (41 ms): 2750.8.
Step 15604 (40 ms): 2793.9.
Step 15642 (41 ms): 2721.2.
Step 15679 (40 ms): 2808.4.
Step 15717 (40 ms): 2739.2.
Step 15754 (40 ms): 2652.9.
Step 15792 (19 ms): -2820.1.

Epoch 42 (15.2 s):
    Evaluating model.
    Full set (6.12 s): ELBO: 2698.7, ENRE: 2718.2, KL: 19.462.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 15830 (40 ms): 2741.7.
Step 15867 (40 ms): 2774.4.
Step 15905 (40 ms): 2608.5.
Step 15942 (41 ms): 2709.
Step 15980 (42 ms): 2766.1.
Step 16018 (41 ms): 2759.4.
Step 16055 (41 ms): 2811.6.
Step 16093 (40 ms): 2741.6.
Step 16130 (40 ms): 2799.4.
Step 16168 (19 ms): -1057.6.

Epoch 43 (15.2 s):
    Evaluating model.
    Full set (6.16 s): ELBO: 2733.9, ENRE: 2751.7, KL: 17.892.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 16206 (42 ms): 2795.8.
Step 16243 (42 ms): 2760.3.
Step 16281 (40 ms): 2725.
Step 16318 (41 ms): 2759.3.
Step 16356 (40 ms): 2797.9.
Step 16394 (40 ms): 2723.5.
Step 16431 (41 ms): 2743.8.
Step 16469 (41 ms): 2747.7.
Step 16506 (40 ms): 2743.9.
Step 16544 (19 ms): -1986.

Epoch 44 (15.2 s):
    Evaluating model.
    Full set (6.16 s): ELBO: 2741.2, ENRE: 2759.3, KL: 18.055.
    Saving model parameters.
    Model parameters saved (204 ms).

Step 16582 (40 ms): 2767.2.
Step 16619 (41 ms): 2767.4.
Step 16657 (42 ms): 2674.3.
Step 16694 (41 ms): 2717.2.
Step 16732 (40 ms): 2695.1.
Step 16770 (41 ms): 2789.6.
Step 16807 (40 ms): 2792.4.
Step 16845 (41 ms): 2790.4.
Step 16882 (40 ms): 2756.8.
Step 16920 (19 ms): -2163.3.

Epoch 45 (15.4 s):
    Evaluating model.
    Full set (6.15 s): ELBO: 2735, ENRE: 2752.8, KL: 17.778.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 16958 (40 ms): 2764.1.
Step 16995 (41 ms): 2708.1.
Step 17033 (40 ms): 2585.2.
Step 17070 (41 ms): 2849.6.
Step 17108 (40 ms): 2703.6.
Step 17146 (41 ms): 2766.9.
Step 17183 (41 ms): 2758.5.
Step 17221 (40 ms): 2772.1.
Step 17258 (40 ms): 2796.3.
Step 17296 (19 ms): -389.66.

Epoch 46 (15.2 s):
    Evaluating model.
    Full set (6.19 s): ELBO: 2729.5, ENRE: 2747.7, KL: 18.27.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 17334 (41 ms): 2783.1.
Step 17371 (41 ms): 2735.8.
Step 17409 (41 ms): 2687.5.
Step 17446 (41 ms): 2752.6.
Step 17484 (42 ms): 2810.8.
Step 17522 (41 ms): 2809.5.
Step 17559 (41 ms): 2755.5.
Step 17597 (41 ms): 2800.4.
Step 17634 (40 ms): 2839.5.
Step 17672 (19 ms): -5546.3.

Epoch 47 (15.3 s):
    Evaluating model.
    Full set (6.12 s): ELBO: 2654.3, ENRE: 2675.2, KL: 20.903.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 17710 (40 ms): 2775.7.
Step 17747 (40 ms): 2750.3.
Step 17785 (41 ms): 2759.9.
Step 17822 (40 ms): 2809.1.
Step 17860 (40 ms): 2755.8.
Step 17898 (40 ms): 2806.3.
Step 17935 (40 ms): 2703.3.
Step 17973 (41 ms): 2754.5.
Step 18010 (41 ms): 2814.8.
Step 18048 (19 ms): -12063.

Epoch 48 (15.2 s):
    Evaluating model.
    Full set (6.17 s): ELBO: 2751.5, ENRE: 2769.3, KL: 17.842.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 18086 (41 ms): 2752.2.
Step 18123 (40 ms): 2693.8.
Step 18161 (40 ms): 2780.8.
Step 18198 (40 ms): 2755.2.
Step 18236 (40 ms): 2789.4.
Step 18274 (40 ms): 2801.6.
Step 18311 (43 ms): 2802.3.
Step 18349 (41 ms): 2742.1.
Step 18386 (40 ms): 2733.9.
Step 18424 (19 ms): -4025.7.

Epoch 49 (15.2 s):
    Evaluating model.
    Full set (6.12 s): ELBO: 2745, ENRE: 2762.8, KL: 17.724.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 18462 (40 ms): 2776.9.
Step 18499 (41 ms): 2760.1.
Step 18537 (40 ms): 2796.8.
Step 18574 (41 ms): 2776.1.
Step 18612 (41 ms): 2788.
Step 18650 (40 ms): 2811.1.
Step 18687 (41 ms): 2770.6.
Step 18725 (40 ms): 2774.5.
Step 18762 (40 ms): 2721.
Step 18800 (19 ms): 730.78.

Epoch 50 (15.3 s):
    Evaluating model.
    Full set (6.18 s): ELBO: 2704.9, ENRE: 2723.9, KL: 18.916.
    Saving model parameters.
    Model parameters saved (123 ms).

Model trained for 50 epochs (18m 2s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (861 ms).

Converting data set value array to sparse matrix.
Data set value array converted (270 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.91 s):  ELBO: -12651, ENRE: -12633, KL: 18.71.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (869 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.7297170434118785
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 31
kl weight: 1.7297170434118785
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (49 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.11 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.89 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 31
    hidden sizes: 175, 127, 154, 213, 284
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.7297170434118785
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 1 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 175)
    ENCODER/1/DENSE/biases:0             (175,)
    ENCODER/1/BATCH_NORM/beta:0          (175,)
    ENCODER/2/DENSE/weights:0            (175, 127)
    ENCODER/2/DENSE/biases:0             (127,)
    ENCODER/2/BATCH_NORM/beta:0          (127,)
    ENCODER/3/DENSE/weights:0            (127, 154)
    ENCODER/3/DENSE/biases:0             (154,)
    ENCODER/3/BATCH_NORM/beta:0          (154,)
    ENCODER/4/DENSE/weights:0            (154, 213)
    ENCODER/4/DENSE/biases:0             (213,)
    ENCODER/4/BATCH_NORM/beta:0          (213,)
    ENCODER/5/DENSE/weights:0            (213, 284)
    ENCODER/5/DENSE/biases:0             (284,)
    ENCODER/5/BATCH_NORM/beta:0          (284,)
    POSTERIOR/MU/DENSE/weights:0         (284, 31)
    POSTERIOR/MU/DENSE/biases:0          (31,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (284, 31)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (31,)
    DECODER/5/DENSE/weights:0            (31, 284)
    DECODER/5/DENSE/biases:0             (284,)
    DECODER/5/BATCH_NORM/beta:0          (284,)
    DECODER/4/DENSE/weights:0            (284, 213)
    DECODER/4/DENSE/biases:0             (213,)
    DECODER/4/BATCH_NORM/beta:0          (213,)
    DECODER/3/DENSE/weights:0            (213, 154)
    DECODER/3/DENSE/biases:0             (154,)
    DECODER/3/BATCH_NORM/beta:0          (154,)
    DECODER/2/DENSE/weights:0            (154, 127)
    DECODER/2/DENSE/biases:0             (127,)
    DECODER/2/BATCH_NORM/beta:0          (127,)
    DECODER/1/DENSE/weights:0            (127, 175)
    DECODER/1/DENSE/biases:0             (175,)
    DECODER/1/BATCH_NORM/beta:0          (175,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (175, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (563 ms).

Training model for 50 epochs on original values.

Step 38 (36 ms): -2128.3.
Step 75 (37 ms): -1753.9.
Step 113 (36 ms): -1527.5.
Step 150 (35 ms): -1279.8.
Step 188 (35 ms): -1148.4.
Step 226 (38 ms): -1033.6.
Step 263 (35 ms): -948.63.
Step 301 (35 ms): -842.09.
Step 338 (35 ms): -796.41.
Step 376 (19 ms): -714.51.

Epoch 1 (16.3 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (7.05 s): ELBO: -1825.2, ENRE: -1807, KL: 18.282.
    Saving model parameters.
    Model parameters saved (199 ms).

Step 414 (36 ms): -555.72.
Step 451 (35 ms): -500.6.
Step 489 (35 ms): -443.57.
Step 526 (35 ms): -402.61.
Step 564 (35 ms): -385.49.
Step 602 (35 ms): -369.63.
Step 639 (35 ms): -355.44.
Step 677 (35 ms): -357.92.
Step 714 (35 ms): -332.85.
Step 752 (19 ms): -329.56.

Epoch 2 (13.2 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -935.47, ENRE: -925.73, KL: 9.7387.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 790 (35 ms): -322.58.
Step 827 (35 ms): -305.95.
Step 865 (35 ms): -302.85.
Step 902 (35 ms): -280.56.
Step 940 (36 ms): -285.41.
Step 978 (35 ms): -285.71.
Step 1015 (36 ms): -274.56.
Step 1053 (35 ms): -281.13.
Step 1090 (35 ms): -270.45.
Step 1128 (17 ms): -289.01.

Epoch 3 (13.2 s):
    Evaluating model.
    Full set (6.31 s): ELBO: -475.88, ENRE: -468.37, KL: 7.5137.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 1166 (35 ms): -277.72.
Step 1203 (35 ms): -256.22.
Step 1241 (37 ms): -260.82.
Step 1278 (35 ms): -274.9.
Step 1316 (35 ms): -244.6.
Step 1354 (35 ms): -253.84.
Step 1391 (35 ms): -248.67.
Step 1429 (35 ms): -248.81.
Step 1466 (35 ms): -245.44.
Step 1504 (17 ms): -347.74.

Epoch 4 (13.2 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -346.63, ENRE: -339.62, KL: 7.006.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 1542 (35 ms): -243.44.
Step 1579 (36 ms): -241.84.
Step 1617 (37 ms): -234.21.
Step 1654 (35 ms): -237.55.
Step 1692 (36 ms): -224.24.
Step 1730 (36 ms): -260.64.
Step 1767 (35 ms): -225.51.
Step 1805 (36 ms): -239.33.
Step 1842 (35 ms): -250.25.
Step 1880 (17 ms): -273.43.

Epoch 5 (13.4 s):
    Evaluating model.
    Full set (6.32 s): ELBO: -287.93, ENRE: -281.88, KL: 6.0508.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 1918 (36 ms): -232.58.
Step 1955 (35 ms): -236.41.
Step 1993 (35 ms): -253.11.
Step 2030 (35 ms): -241.99.
Step 2068 (35 ms): -255.42.
Step 2106 (35 ms): -241.36.
Step 2143 (36 ms): -240.45.
Step 2181 (35 ms): -216.66.
Step 2218 (35 ms): -247.08.
Step 2256 (17 ms): -263.21.

Epoch 6 (13.3 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -256.15, ENRE: -249.95, KL: 6.1982.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 2294 (35 ms): -221.17.
Step 2331 (37 ms): -225.25.
Step 2369 (35 ms): -244.
Step 2406 (36 ms): -223.12.
Step 2444 (35 ms): -216.27.
Step 2482 (35 ms): -210.54.
Step 2519 (35 ms): -238.99.
Step 2557 (35 ms): -215.29.
Step 2594 (35 ms): -229.22.
Step 2632 (16 ms): -218.46.

Epoch 7 (13.3 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -240.06, ENRE: -234.07, KL: 5.9846.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 2670 (35 ms): -206.17.
Step 2707 (35 ms): -223.75.
Step 2745 (35 ms): -222.33.
Step 2782 (35 ms): -227.04.
Step 2820 (35 ms): -220.95.
Step 2858 (35 ms): -221.32.
Step 2895 (34 ms): -205.54.
Step 2933 (35 ms): -212.44.
Step 2970 (35 ms): -225.39.
Step 3008 (17 ms): -266.88.

Epoch 8 (13.2 s):
    Evaluating model.
    Full set (6.26 s): ELBO: -229.75, ENRE: -224.1, KL: 5.6532.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 3046 (36 ms): -215.11.
Step 3083 (35 ms): -208.03.
Step 3121 (35 ms): -220.56.
Step 3158 (35 ms): -219.19.
Step 3196 (35 ms): -222.91.
Step 3234 (35 ms): -224.29.
Step 3271 (35 ms): -223.29.
Step 3309 (35 ms): -224.94.
Step 3346 (36 ms): -213.31.
Step 3384 (17 ms): -250.53.

Epoch 9 (13.3 s):
    Evaluating model.
    Full set (6.33 s): ELBO: -223.53, ENRE: -217.84, KL: 5.6961.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 3422 (36 ms): -201.4.
Step 3459 (35 ms): -223.27.
Step 3497 (35 ms): -222.06.
Step 3534 (36 ms): -218.65.
Step 3572 (35 ms): -204.03.
Step 3610 (35 ms): -210.76.
Step 3647 (36 ms): -221.93.
Step 3685 (36 ms): -211.47.
Step 3722 (35 ms): -218.71.
Step 3760 (17 ms): -214.93.

Epoch 10 (13.3 s):
    Evaluating model.
    Full set (6.26 s): ELBO: -220.12, ENRE: -214.8, KL: 5.323.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 3798 (35 ms): -213.95.
Step 3835 (35 ms): -225.52.
Step 3873 (35 ms): -213.33.
Step 3910 (35 ms): -215.34.
Step 3948 (36 ms): -211.95.
Step 3986 (35 ms): -211.97.
Step 4023 (36 ms): -208.56.
Step 4061 (35 ms): -214.92.
Step 4098 (35 ms): -230.58.
Step 4136 (17 ms): -257.71.

Epoch 11 (13.3 s):
    Evaluating model.
    Full set (6.31 s): ELBO: -217.53, ENRE: -212.23, KL: 5.3007.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 4174 (35 ms): -228.5.
Step 4211 (36 ms): -215.3.
Step 4249 (36 ms): -208.32.
Step 4286 (35 ms): -221.62.
Step 4324 (35 ms): -211.4.
Step 4362 (35 ms): -208.85.
Step 4399 (36 ms): -221.02.
Step 4437 (35 ms): -219.42.
Step 4474 (35 ms): -237.92.
Step 4512 (16 ms): -423.56.

Epoch 12 (13.2 s):
    Evaluating model.
    Full set (6.26 s): ELBO: -218.42, ENRE: -213.13, KL: 5.2848.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 4550 (35 ms): -214.67.
Step 4587 (35 ms): -214.67.
Step 4625 (35 ms): -207.52.
Step 4662 (35 ms): -203.04.
Step 4700 (35 ms): -208.5.
Step 4738 (35 ms): -211.96.
Step 4775 (35 ms): -201.98.
Step 4813 (35 ms): -212.23.
Step 4850 (35 ms): -202.41.
Step 4888 (17 ms): -225.37.

Epoch 13 (13.3 s):
    Evaluating model.
    Full set (6.3 s): ELBO: -215.03, ENRE: -210.06, KL: 4.9736.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 4926 (35 ms): -221.34.
Step 4963 (34 ms): -211.21.
Step 5001 (35 ms): -217.56.
Step 5038 (36 ms): -188.21.
Step 5076 (35 ms): -231.54.
Step 5114 (34 ms): -200.26.
Step 5151 (35 ms): -202.6.
Step 5189 (35 ms): -206.45.
Step 5226 (35 ms): -203.66.
Step 5264 (17 ms): -241.38.

Epoch 14 (13.2 s):
    Evaluating model.
    Full set (6.23 s): ELBO: -212.98, ENRE: -208.32, KL: 4.6553.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 5302 (35 ms): -205.62.
Step 5339 (35 ms): -202.38.
Step 5377 (35 ms): -217.14.
Step 5414 (35 ms): -194.02.
Step 5452 (35 ms): -203.62.
Step 5490 (35 ms): -223.91.
Step 5527 (35 ms): -212.9.
Step 5565 (35 ms): -207.03.
Step 5602 (35 ms): -201.73.
Step 5640 (17 ms): -216.83.

Epoch 15 (13.3 s):
    Evaluating model.
    Full set (6.32 s): ELBO: -212.3, ENRE: -207.64, KL: 4.6653.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 5678 (36 ms): -187.76.
Step 5715 (35 ms): -203.95.
Step 5753 (35 ms): -214.51.
Step 5790 (35 ms): -206.34.
Step 5828 (36 ms): -215.7.
Step 5866 (36 ms): -209.49.
Step 5903 (35 ms): -218.86.
Step 5941 (35 ms): -230.08.
Step 5978 (35 ms): -205.47.
Step 6016 (17 ms): -447.95.

Epoch 16 (13.3 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -210.86, ENRE: -206.28, KL: 4.5711.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 6054 (35 ms): -212.24.
Step 6091 (35 ms): -209.1.
Step 6129 (35 ms): -221.98.
Step 6166 (36 ms): -195.31.
Step 6204 (35 ms): -205.34.
Step 6242 (36 ms): -206.19.
Step 6279 (35 ms): -195.03.
Step 6317 (36 ms): -210.05.
Step 6354 (35 ms): -207.67.
Step 6392 (16 ms): -245.83.

Epoch 17 (13.3 s):
    Evaluating model.
    Full set (6.29 s): ELBO: -210.39, ENRE: -205.84, KL: 4.5442.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 6430 (36 ms): -206.99.
Step 6467 (35 ms): -204.92.
Step 6505 (35 ms): -211.66.
Step 6542 (35 ms): -204.92.
Step 6580 (35 ms): -201.29.
Step 6618 (35 ms): -204.57.
Step 6655 (35 ms): -216.07.
Step 6693 (35 ms): -214.6.
Step 6730 (35 ms): -198.45.
Step 6768 (17 ms): -203.41.

Epoch 18 (13.2 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -209.51, ENRE: -204.9, KL: 4.6019.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 6806 (35 ms): -205.04.
Step 6843 (36 ms): -207.78.
Step 6881 (35 ms): -200.33.
Step 6918 (36 ms): -206.59.
Step 6956 (35 ms): -205.89.
Step 6994 (35 ms): -210.
Step 7031 (35 ms): -210.99.
Step 7069 (35 ms): -193.34.
Step 7106 (36 ms): -209.75.
Step 7144 (16 ms): -211.17.

Epoch 19 (13.3 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -208.25, ENRE: -203.8, KL: 4.4499.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 7182 (35 ms): -197.45.
Step 7219 (36 ms): -227.22.
Step 7257 (35 ms): -205.97.
Step 7294 (35 ms): -207.87.
Step 7332 (35 ms): -197.85.
Step 7370 (34 ms): -200.05.
Step 7407 (35 ms): -213.82.
Step 7445 (35 ms): -210.18.
Step 7482 (35 ms): -199.94.
Step 7520 (17 ms): -211.44.

Epoch 20 (13.2 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -210.31, ENRE: -205.85, KL: 4.4524.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 7558 (35 ms): -195.93.
Step 7595 (35 ms): -198.18.
Step 7633 (35 ms): -211.74.
Step 7670 (35 ms): -216.85.
Step 7708 (35 ms): -200.28.
Step 7746 (35 ms): -210.4.
Step 7783 (35 ms): -204.9.
Step 7821 (35 ms): -200.9.
Step 7858 (35 ms): -209.93.
Step 7896 (17 ms): -190.52.

Epoch 21 (13.3 s):
    Evaluating model.
    Full set (6.3 s): ELBO: -207.43, ENRE: -202.92, KL: 4.5071.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 7934 (35 ms): -204.05.
Step 7971 (35 ms): -200.65.
Step 8009 (36 ms): -211.03.
Step 8046 (35 ms): -202.01.
Step 8084 (35 ms): -195.71.
Step 8122 (35 ms): -203.05.
Step 8159 (35 ms): -214.67.
Step 8197 (34 ms): -196.41.
Step 8234 (36 ms): -199.59.
Step 8272 (16 ms): -193.91.

Epoch 22 (13.3 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -206.15, ENRE: -201.72, KL: 4.4335.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 8310 (35 ms): -200.63.
Step 8347 (36 ms): -192.98.
Step 8385 (35 ms): -213.61.
Step 8422 (35 ms): -200.44.
Step 8460 (36 ms): -219.77.
Step 8498 (36 ms): -195.
Step 8535 (36 ms): -214.07.
Step 8573 (35 ms): -204.67.
Step 8610 (35 ms): -208.78.
Step 8648 (17 ms): -197.22.

Epoch 23 (13.4 s):
    Evaluating model.
    Full set (6.29 s): ELBO: -206.49, ENRE: -202.06, KL: 4.4319.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 8686 (35 ms): -208.56.
Step 8723 (35 ms): -199.64.
Step 8761 (35 ms): -196.23.
Step 8798 (35 ms): -203.01.
Step 8836 (35 ms): -210.16.
Step 8874 (35 ms): -205.43.
Step 8911 (35 ms): -203.45.
Step 8949 (35 ms): -209.56.
Step 8986 (35 ms): -224.72.
Step 9024 (16 ms): -312.96.

Epoch 24 (13.2 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -205.81, ENRE: -201.38, KL: 4.4246.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 9062 (36 ms): -216.68.
Step 9099 (35 ms): -200.4.
Step 9137 (35 ms): -193.96.
Step 9174 (35 ms): -202.4.
Step 9212 (37 ms): -205.34.
Step 9250 (35 ms): -210.05.
Step 9287 (35 ms): -203.09.
Step 9325 (35 ms): -202.02.
Step 9362 (35 ms): -199.36.
Step 9400 (17 ms): -269.45.

Epoch 25 (13.3 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -205.28, ENRE: -200.74, KL: 4.5385.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 9438 (35 ms): -202.05.
Step 9475 (35 ms): -204.63.
Step 9513 (35 ms): -199.53.
Step 9550 (34 ms): -217.39.
Step 9588 (34 ms): -205.41.
Step 9626 (35 ms): -191.78.
Step 9663 (35 ms): -212.6.
Step 9701 (35 ms): -208.79.
Step 9738 (35 ms): -200.81.
Step 9776 (17 ms): -232.6.

Epoch 26 (13.2 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -204.35, ENRE: -199.8, KL: 4.551.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 9814 (37 ms): -219.48.
Step 9851 (35 ms): -215.79.
Step 9889 (36 ms): -208.4.
Step 9926 (35 ms): -219.91.
Step 9964 (36 ms): -228.09.
Step 10002 (36 ms): -199.95.
Step 10039 (35 ms): -199.19.
Step 10077 (36 ms): -211.36.
Step 10114 (36 ms): -211.58.
Step 10152 (17 ms): -240.3.

Epoch 27 (13.4 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -204.57, ENRE: -199.94, KL: 4.6325.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 10190 (36 ms): -195.67.
Step 10227 (36 ms): -214.85.
Step 10265 (35 ms): -208.16.
Step 10302 (35 ms): -191.67.
Step 10340 (36 ms): -198.34.
Step 10378 (36 ms): -206.29.
Step 10415 (35 ms): -187.92.
Step 10453 (35 ms): -213.39.
Step 10490 (35 ms): -201.6.
Step 10528 (16 ms): -189.55.

Epoch 28 (13.3 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -203.87, ENRE: -199.17, KL: 4.6953.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 10566 (35 ms): -216.34.
Step 10603 (35 ms): -201.26.
Step 10641 (35 ms): -194.28.
Step 10678 (36 ms): -201.04.
Step 10716 (35 ms): -201.08.
Step 10754 (35 ms): -214.38.
Step 10791 (35 ms): -201.27.
Step 10829 (36 ms): -199.37.
Step 10866 (36 ms): -187.86.
Step 10904 (17 ms): -228.93.

Epoch 29 (13.3 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -203.34, ENRE: -198.76, KL: 4.5787.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 10942 (35 ms): -205.95.
Step 10979 (35 ms): -199.58.
Step 11017 (35 ms): -201.82.
Step 11054 (35 ms): -192.53.
Step 11092 (35 ms): -205.68.
Step 11130 (35 ms): -202.06.
Step 11167 (35 ms): -188.71.
Step 11205 (35 ms): -204.15.
Step 11242 (35 ms): -203.3.
Step 11280 (17 ms): -219.14.

Epoch 30 (13.2 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -203.68, ENRE: -198.92, KL: 4.7592.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 11318 (35 ms): -210.9.
Step 11355 (35 ms): -203.73.
Step 11393 (35 ms): -204.3.
Step 11430 (35 ms): -197.95.
Step 11468 (35 ms): -201.16.
Step 11506 (35 ms): -200.05.
Step 11543 (36 ms): -187.93.
Step 11581 (35 ms): -189.86.
Step 11618 (35 ms): -203.02.
Step 11656 (17 ms): -385.64.

Epoch 31 (13.3 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -203.44, ENRE: -198.72, KL: 4.7213.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 11694 (35 ms): -199.43.
Step 11731 (35 ms): -205.72.
Step 11769 (35 ms): -200.74.
Step 11806 (35 ms): -209.54.
Step 11844 (35 ms): -201.66.
Step 11882 (37 ms): -212.95.
Step 11919 (35 ms): -205.59.
Step 11957 (35 ms): -210.75.
Step 11994 (35 ms): -196.93.
Step 12032 (17 ms): -256.04.

Epoch 32 (13.2 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -203.39, ENRE: -198.66, KL: 4.7333.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 12070 (35 ms): -200.4.
Step 12107 (36 ms): -209.62.
Step 12145 (35 ms): -207.45.
Step 12182 (35 ms): -191.6.
Step 12220 (35 ms): -201.33.
Step 12258 (35 ms): -209.55.
Step 12295 (36 ms): -197.
Step 12333 (35 ms): -223.35.
Step 12370 (36 ms): -210.26.
Step 12408 (17 ms): -248.24.

Epoch 33 (13.4 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -202.52, ENRE: -197.87, KL: 4.6491.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 12446 (34 ms): -201.42.
Step 12483 (35 ms): -214.44.
Step 12521 (35 ms): -202.92.
Step 12558 (36 ms): -199.5.
Step 12596 (36 ms): -207.68.
Step 12634 (35 ms): -207.01.
Step 12671 (35 ms): -192.84.
Step 12709 (36 ms): -191.34.
Step 12746 (35 ms): -222.03.
Step 12784 (16 ms): -222.91.

Epoch 34 (13.2 s):
    Evaluating model.
    Full set (6.3 s): ELBO: -203.12, ENRE: -198.4, KL: 4.7213.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 12822 (35 ms): -203.87.
Step 12859 (36 ms): -204.69.
Step 12897 (37 ms): -198.81.
Step 12934 (35 ms): -213.4.
Step 12972 (35 ms): -201.26.
Step 13010 (35 ms): -200.44.
Step 13047 (35 ms): -219.27.
Step 13085 (35 ms): -193.93.
Step 13122 (36 ms): -200.11.
Step 13160 (17 ms): -199.82.

Epoch 35 (13.3 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -202.64, ENRE: -197.86, KL: 4.7786.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 13198 (35 ms): -208.65.
Step 13235 (35 ms): -213.61.
Step 13273 (35 ms): -215.77.
Step 13310 (35 ms): -198.32.
Step 13348 (35 ms): -192.55.
Step 13386 (35 ms): -200.72.
Step 13423 (35 ms): -199.81.
Step 13461 (35 ms): -209.36.
Step 13498 (35 ms): -211.41.
Step 13536 (16 ms): -220.94.

Epoch 36 (13.2 s):
    Evaluating model.
    Full set (6.26 s): ELBO: -201.98, ENRE: -197.22, KL: 4.757.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 13574 (36 ms): -195.81.
Step 13611 (35 ms): -188.87.
Step 13649 (35 ms): -188.49.
Step 13686 (36 ms): -206.64.
Step 13724 (35 ms): -188.89.
Step 13762 (36 ms): -207.47.
Step 13799 (36 ms): -203.38.
Step 13837 (35 ms): -211.51.
Step 13874 (35 ms): -203.47.
Step 13912 (17 ms): -368.7.

Epoch 37 (13.3 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -202.04, ENRE: -197.26, KL: 4.7812.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 13950 (35 ms): -199.42.
Step 13987 (35 ms): -214.76.
Step 14025 (35 ms): -213.15.
Step 14062 (35 ms): -200.52.
Step 14100 (35 ms): -212.52.
Step 14138 (35 ms): -201.29.
Step 14175 (35 ms): -204.17.
Step 14213 (35 ms): -190.46.
Step 14250 (35 ms): -193.11.
Step 14288 (16 ms): -231.92.

Epoch 38 (13.1 s):
    Evaluating model.
    Full set (6.3 s): ELBO: -202.06, ENRE: -197.33, KL: 4.7306.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 14326 (35 ms): -198.25.
Step 14363 (35 ms): -188.75.
Step 14401 (35 ms): -205.32.
Step 14438 (35 ms): -194.11.
Step 14476 (36 ms): -200.47.
Step 14514 (35 ms): -210.72.
Step 14551 (35 ms): -210.76.
Step 14589 (35 ms): -198.17.
Step 14626 (35 ms): -192.01.
Step 14664 (17 ms): -764.12.

Epoch 39 (13.4 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -202.23, ENRE: -197.34, KL: 4.8873.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 14702 (35 ms): -205.91.
Step 14739 (35 ms): -209.95.
Step 14777 (35 ms): -202.65.
Step 14814 (35 ms): -198.84.
Step 14852 (35 ms): -206.6.
Step 14890 (36 ms): -194.68.
Step 14927 (35 ms): -205.45.
Step 14965 (35 ms): -216.47.
Step 15002 (36 ms): -208.42.
Step 15040 (17 ms): -201.97.

Epoch 40 (13.3 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -201.59, ENRE: -196.77, KL: 4.8229.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 15078 (35 ms): -191.5.
Step 15115 (35 ms): -189.93.
Step 15153 (35 ms): -213.66.
Step 15190 (36 ms): -204.28.
Step 15228 (37 ms): -210.67.
Step 15266 (35 ms): -221.76.
Step 15303 (36 ms): -206.82.
Step 15341 (35 ms): -203.66.
Step 15378 (35 ms): -204.73.
Step 15416 (16 ms): -211.98.

Epoch 41 (13.3 s):
    Evaluating model.
    Full set (6.26 s): ELBO: -201.66, ENRE: -196.87, KL: 4.786.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 15454 (35 ms): -207.53.
Step 15491 (35 ms): -204.52.
Step 15529 (35 ms): -205.
Step 15566 (35 ms): -202.2.
Step 15604 (35 ms): -198.66.
Step 15642 (35 ms): -193.75.
Step 15679 (35 ms): -183.01.
Step 15717 (35 ms): -202.68.
Step 15754 (35 ms): -196.
Step 15792 (17 ms): -240.9.

Epoch 42 (13.2 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -201.43, ENRE: -196.58, KL: 4.8526.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 15830 (35 ms): -194.75.
Step 15867 (35 ms): -220.76.
Step 15905 (36 ms): -204.18.
Step 15942 (36 ms): -198.16.
Step 15980 (35 ms): -199.33.
Step 16018 (35 ms): -203.78.
Step 16055 (35 ms): -203.59.
Step 16093 (36 ms): -213.29.
Step 16130 (35 ms): -193.68.
Step 16168 (17 ms): -238.04.

Epoch 43 (13.3 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -201.61, ENRE: -196.78, KL: 4.8304.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 16206 (35 ms): -218.86.
Step 16243 (35 ms): -209.79.
Step 16281 (35 ms): -209.43.
Step 16318 (35 ms): -203.74.
Step 16356 (37 ms): -196.7.
Step 16394 (35 ms): -206.16.
Step 16431 (35 ms): -207.55.
Step 16469 (36 ms): -193.45.
Step 16506 (36 ms): -207.08.
Step 16544 (17 ms): -204.8.

Epoch 44 (13.2 s):
    Evaluating model.
    Full set (6.32 s): ELBO: -201.2, ENRE: -196.42, KL: 4.7775.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 16582 (36 ms): -206.34.
Step 16619 (35 ms): -207.77.
Step 16657 (36 ms): -207.87.
Step 16694 (36 ms): -203.84.
Step 16732 (35 ms): -199.03.
Step 16770 (35 ms): -193.15.
Step 16807 (36 ms): -205.88.
Step 16845 (35 ms): -202.11.
Step 16882 (35 ms): -189.51.
Step 16920 (17 ms): -303.7.

Epoch 45 (13.4 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -201.35, ENRE: -196.58, KL: 4.769.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 16958 (37 ms): -198.37.
Step 16995 (35 ms): -193.16.
Step 17033 (35 ms): -196.69.
Step 17070 (35 ms): -201.08.
Step 17108 (35 ms): -206.1.
Step 17146 (35 ms): -203.32.
Step 17183 (35 ms): -196.77.
Step 17221 (35 ms): -192.01.
Step 17258 (36 ms): -197.76.
Step 17296 (17 ms): -252.96.

Epoch 46 (13.3 s):
    Evaluating model.
    Full set (6.31 s): ELBO: -201.41, ENRE: -196.63, KL: 4.7809.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 17334 (37 ms): -193.49.
Step 17371 (36 ms): -206.44.
Step 17409 (35 ms): -195.73.
Step 17446 (35 ms): -209.48.
Step 17484 (35 ms): -208.61.
Step 17522 (36 ms): -208.43.
Step 17559 (35 ms): -211.81.
Step 17597 (35 ms): -195.89.
Step 17634 (35 ms): -204.45.
Step 17672 (17 ms): -200.35.

Epoch 47 (13.3 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -201.36, ENRE: -196.62, KL: 4.7329.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 17710 (35 ms): -191.21.
Step 17747 (35 ms): -194.39.
Step 17785 (35 ms): -189.88.
Step 17822 (35 ms): -198.41.
Step 17860 (35 ms): -199.93.
Step 17898 (34 ms): -203.55.
Step 17935 (35 ms): -201.35.
Step 17973 (35 ms): -207.04.
Step 18010 (35 ms): -218.07.
Step 18048 (16 ms): -211.21.

Epoch 48 (13.2 s):
    Evaluating model.
    Full set (6.3 s): ELBO: -201.11, ENRE: -196.19, KL: 4.9114.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 18086 (35 ms): -201.35.
Step 18123 (35 ms): -195.58.
Step 18161 (35 ms): -205.24.
Step 18198 (35 ms): -198.43.
Step 18236 (35 ms): -207.69.
Step 18274 (37 ms): -209.63.
Step 18311 (35 ms): -195.72.
Step 18349 (35 ms): -191.01.
Step 18386 (35 ms): -202.75.
Step 18424 (17 ms): -227.82.

Epoch 49 (13.3 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -200.96, ENRE: -196.22, KL: 4.7378.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 18462 (35 ms): -189.55.
Step 18499 (35 ms): -206.91.
Step 18537 (35 ms): -204.57.
Step 18574 (35 ms): -200.4.
Step 18612 (35 ms): -207.94.
Step 18650 (35 ms): -196.21.
Step 18687 (35 ms): -188.54.
Step 18725 (35 ms): -206.84.
Step 18762 (36 ms): -201.18.
Step 18800 (17 ms): -187.38.

Epoch 50 (13.3 s):
    Evaluating model.
    Full set (6.32 s): ELBO: -201.25, ENRE: -196.54, KL: 4.7168.
    Saving model parameters.
    Model parameters saved (122 ms).

Model trained for 50 epochs (16m 29s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (859 ms).

Converting data set value array to sparse matrix.
Data set value array converted (281 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2.01 s):  ELBO: -418.34, ENRE: -413.61, KL: 4.7233.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (784 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.6371580787518207
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 64
kl weight: 1.6371580787518207
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (48 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.22 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.85 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 64
    hidden sizes: 194, 204, 186, 123
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.6371580787518207
    using analytical KL term
    using batch normalisation for minibatches
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 194)
    ENCODER/1/DENSE/biases:0             (194,)
    ENCODER/1/BATCH_NORM/beta:0          (194,)
    ENCODER/2/DENSE/weights:0            (194, 204)
    ENCODER/2/DENSE/biases:0             (204,)
    ENCODER/2/BATCH_NORM/beta:0          (204,)
    ENCODER/3/DENSE/weights:0            (204, 186)
    ENCODER/3/DENSE/biases:0             (186,)
    ENCODER/3/BATCH_NORM/beta:0          (186,)
    ENCODER/4/DENSE/weights:0            (186, 123)
    ENCODER/4/DENSE/biases:0             (123,)
    ENCODER/4/BATCH_NORM/beta:0          (123,)
    POSTERIOR/MU/DENSE/weights:0         (123, 64)
    POSTERIOR/MU/DENSE/biases:0          (64,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (123, 64)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (64,)
    DECODER/4/DENSE/weights:0            (64, 123)
    DECODER/4/DENSE/biases:0             (123,)
    DECODER/4/BATCH_NORM/beta:0          (123,)
    DECODER/3/DENSE/weights:0            (123, 186)
    DECODER/3/DENSE/biases:0             (186,)
    DECODER/3/BATCH_NORM/beta:0          (186,)
    DECODER/2/DENSE/weights:0            (186, 204)
    DECODER/2/DENSE/biases:0             (204,)
    DECODER/2/BATCH_NORM/beta:0          (204,)
    DECODER/1/DENSE/weights:0            (204, 194)
    DECODER/1/DENSE/biases:0             (194,)
    DECODER/1/BATCH_NORM/beta:0          (194,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (194, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (458 ms).

Training model for 50 epochs on original values.

Step 38 (41 ms): -2031.1.
Step 75 (34 ms): -1619.8.
Step 113 (33 ms): -1381.9.
Step 150 (32 ms): -1120.3.
Step 188 (33 ms): -966.36.
Step 226 (33 ms): -835.64.
Step 263 (32 ms): -707.08.
Step 301 (32 ms): -665.49.
Step 338 (33 ms): -567.42.
Step 376 (19 ms): -452.83.

Epoch 1 (14.9 s):
    Evaluating model.
    Full set (6.49 s): ELBO: -1793.8, ENRE: -1778.3, KL: 15.547.
    Saving model parameters.
    Model parameters saved (193 ms).

Step 414 (33 ms): -515.93.
Step 451 (33 ms): -445.51.
Step 489 (32 ms): -426.56.
Step 526 (33 ms): -386.1.
Step 564 (32 ms): -379.3.
Step 602 (32 ms): -352.45.
Step 639 (32 ms): -336.89.
Step 677 (33 ms): -328.38.
Step 714 (32 ms): -356.54.
Step 752 (16 ms): -409.79.

Epoch 2 (12.3 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -959.1, ENRE: -947.74, KL: 11.354.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 790 (32 ms): -314.15.
Step 827 (32 ms): -302.47.
Step 865 (32 ms): -290.72.
Step 902 (32 ms): -266.23.
Step 940 (32 ms): -278.29.
Step 978 (32 ms): -260.88.
Step 1015 (33 ms): -284.17.
Step 1053 (32 ms): -260.42.
Step 1090 (32 ms): -260.19.
Step 1128 (15 ms): -307.93.

Epoch 3 (12.1 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -524.86, ENRE: -515.71, KL: 9.1527.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 1166 (34 ms): -275.
Step 1203 (32 ms): -271.99.
Step 1241 (33 ms): -251.97.
Step 1278 (32 ms): -243.21.
Step 1316 (33 ms): -257.67.
Step 1354 (32 ms): -253.57.
Step 1391 (32 ms): -243.64.
Step 1429 (32 ms): -235.99.
Step 1466 (33 ms): -251.16.
Step 1504 (19 ms): -255.39.

Epoch 4 (12.3 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -358.21, ENRE: -349.84, KL: 8.3688.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 1542 (32 ms): -242.31.
Step 1579 (32 ms): -240.89.
Step 1617 (33 ms): -237.58.
Step 1654 (33 ms): -242.19.
Step 1692 (32 ms): -231.35.
Step 1730 (32 ms): -231.6.
Step 1767 (33 ms): -259.8.
Step 1805 (32 ms): -252.53.
Step 1842 (34 ms): -240.06.
Step 1880 (16 ms): -306.2.

Epoch 5 (12.3 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -293.49, ENRE: -285.75, KL: 7.7476.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 1918 (32 ms): -259.17.
Step 1955 (32 ms): -240.73.
Step 1993 (33 ms): -232.67.
Step 2030 (33 ms): -232.41.
Step 2068 (33 ms): -238.78.
Step 2106 (33 ms): -247.26.
Step 2143 (32 ms): -225.51.
Step 2181 (32 ms): -238.83.
Step 2218 (33 ms): -251.61.
Step 2256 (16 ms): -221.38.

Epoch 6 (12.3 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -259.41, ENRE: -251.9, KL: 7.5157.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 2294 (34 ms): -223.24.
Step 2331 (32 ms): -218.84.
Step 2369 (32 ms): -232.58.
Step 2406 (32 ms): -221.24.
Step 2444 (32 ms): -244.06.
Step 2482 (33 ms): -216.62.
Step 2519 (32 ms): -225.96.
Step 2557 (32 ms): -222.58.
Step 2594 (32 ms): -221.65.
Step 2632 (16 ms): -266.42.

Epoch 7 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -240.46, ENRE: -233.14, KL: 7.3161.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 2670 (32 ms): -224.67.
Step 2707 (33 ms): -235.93.
Step 2745 (32 ms): -242.54.
Step 2782 (33 ms): -220.12.
Step 2820 (33 ms): -215.96.
Step 2858 (32 ms): -230.8.
Step 2895 (33 ms): -234.27.
Step 2933 (32 ms): -218.6.
Step 2970 (33 ms): -217.07.
Step 3008 (15 ms): -227.17.

Epoch 8 (12.2 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -232.09, ENRE: -225.23, KL: 6.8624.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 3046 (32 ms): -222.49.
Step 3083 (32 ms): -220.98.
Step 3121 (33 ms): -215.23.
Step 3158 (32 ms): -229.48.
Step 3196 (32 ms): -223.66.
Step 3234 (32 ms): -219.61.
Step 3271 (33 ms): -207.61.
Step 3309 (33 ms): -235.27.
Step 3346 (32 ms): -223.34.
Step 3384 (15 ms): -242.35.

Epoch 9 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -226.01, ENRE: -219.4, KL: 6.6147.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 3422 (32 ms): -207.79.
Step 3459 (33 ms): -227.23.
Step 3497 (32 ms): -213.11.
Step 3534 (33 ms): -223.14.
Step 3572 (32 ms): -224.82.
Step 3610 (33 ms): -214.96.
Step 3647 (33 ms): -219.41.
Step 3685 (33 ms): -221.35.
Step 3722 (33 ms): -217.65.
Step 3760 (16 ms): -184.03.

Epoch 10 (12.2 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -222.78, ENRE: -216.41, KL: 6.3687.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 3798 (33 ms): -208.68.
Step 3835 (33 ms): -232.32.
Step 3873 (33 ms): -213.62.
Step 3910 (33 ms): -216.18.
Step 3948 (33 ms): -213.08.
Step 3986 (32 ms): -231.31.
Step 4023 (32 ms): -219.57.
Step 4061 (32 ms): -202.61.
Step 4098 (33 ms): -227.57.
Step 4136 (15 ms): -354.14.

Epoch 11 (12.3 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -220.26, ENRE: -213.97, KL: 6.2893.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 4174 (32 ms): -211.19.
Step 4211 (32 ms): -221.35.
Step 4249 (32 ms): -213.29.
Step 4286 (32 ms): -197.77.
Step 4324 (32 ms): -209.2.
Step 4362 (33 ms): -218.38.
Step 4399 (32 ms): -229.23.
Step 4437 (33 ms): -211.15.
Step 4474 (32 ms): -216.34.
Step 4512 (15 ms): -464.43.

Epoch 12 (12.2 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -217.95, ENRE: -211.44, KL: 6.5082.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 4550 (32 ms): -226.23.
Step 4587 (33 ms): -230.64.
Step 4625 (34 ms): -216.34.
Step 4662 (32 ms): -218.62.
Step 4700 (34 ms): -203.46.
Step 4738 (32 ms): -212.07.
Step 4775 (33 ms): -213.97.
Step 4813 (32 ms): -204.94.
Step 4850 (32 ms): -205.7.
Step 4888 (16 ms): -249.25.

Epoch 13 (12.3 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -217.24, ENRE: -210.96, KL: 6.2759.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 4926 (33 ms): -205.05.
Step 4963 (32 ms): -236.61.
Step 5001 (32 ms): -210.13.
Step 5038 (32 ms): -220.31.
Step 5076 (32 ms): -200.01.
Step 5114 (32 ms): -214.41.
Step 5151 (32 ms): -201.34.
Step 5189 (32 ms): -243.38.
Step 5226 (33 ms): -219.47.
Step 5264 (16 ms): -250.6.

Epoch 14 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -215.78, ENRE: -209.51, KL: 6.2632.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 5302 (32 ms): -227.23.
Step 5339 (32 ms): -220.93.
Step 5377 (33 ms): -219.09.
Step 5414 (32 ms): -209.31.
Step 5452 (32 ms): -218.35.
Step 5490 (33 ms): -211.73.
Step 5527 (32 ms): -209.6.
Step 5565 (33 ms): -221.79.
Step 5602 (32 ms): -218.98.
Step 5640 (15 ms): -355.19.

Epoch 15 (12.2 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -214.9, ENRE: -208.73, KL: 6.1695.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 5678 (32 ms): -216.27.
Step 5715 (32 ms): -202.63.
Step 5753 (32 ms): -222.02.
Step 5790 (32 ms): -203.66.
Step 5828 (32 ms): -201.61.
Step 5866 (32 ms): -208.99.
Step 5903 (33 ms): -224.16.
Step 5941 (32 ms): -211.44.
Step 5978 (32 ms): -210.34.
Step 6016 (15 ms): -265.2.

Epoch 16 (12.1 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -214.16, ENRE: -208.14, KL: 6.0165.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 6054 (33 ms): -220.83.
Step 6091 (33 ms): -200.48.
Step 6129 (32 ms): -214.69.
Step 6166 (33 ms): -217.
Step 6204 (33 ms): -224.56.
Step 6242 (32 ms): -211.62.
Step 6279 (33 ms): -215.96.
Step 6317 (34 ms): -221.94.
Step 6354 (32 ms): -209.73.
Step 6392 (16 ms): -226.46.

Epoch 17 (12.3 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -212.99, ENRE: -206.85, KL: 6.1443.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 6430 (32 ms): -210.05.
Step 6467 (32 ms): -204.42.
Step 6505 (33 ms): -211.19.
Step 6542 (33 ms): -208.63.
Step 6580 (33 ms): -210.86.
Step 6618 (33 ms): -236.48.
Step 6655 (32 ms): -205.15.
Step 6693 (32 ms): -204.39.
Step 6730 (32 ms): -223.57.
Step 6768 (16 ms): -244.91.

Epoch 18 (12.3 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -212.43, ENRE: -206.67, KL: 5.7683.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 6806 (33 ms): -212.78.
Step 6843 (33 ms): -216.38.
Step 6881 (32 ms): -220.27.
Step 6918 (33 ms): -213.22.
Step 6956 (33 ms): -209.54.
Step 6994 (33 ms): -209.41.
Step 7031 (33 ms): -217.53.
Step 7069 (33 ms): -196.71.
Step 7106 (33 ms): -205.54.
Step 7144 (15 ms): -268.58.

Epoch 19 (12.3 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -211.93, ENRE: -206.17, KL: 5.7509.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 7182 (33 ms): -214.89.
Step 7219 (32 ms): -211.71.
Step 7257 (32 ms): -214.34.
Step 7294 (32 ms): -212.78.
Step 7332 (32 ms): -200.64.
Step 7370 (33 ms): -198.29.
Step 7407 (32 ms): -219.23.
Step 7445 (32 ms): -204.94.
Step 7482 (32 ms): -223.
Step 7520 (15 ms): -308.44.

Epoch 20 (12.2 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -211.28, ENRE: -205.61, KL: 5.6652.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 7558 (32 ms): -214.91.
Step 7595 (32 ms): -199.95.
Step 7633 (32 ms): -212.29.
Step 7670 (33 ms): -204.03.
Step 7708 (33 ms): -206.8.
Step 7746 (33 ms): -199.69.
Step 7783 (32 ms): -208.95.
Step 7821 (32 ms): -206.96.
Step 7858 (33 ms): -209.88.
Step 7896 (15 ms): -211.82.

Epoch 21 (12.2 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -210.34, ENRE: -204.56, KL: 5.7773.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 7934 (32 ms): -216.3.
Step 7971 (32 ms): -194.08.
Step 8009 (33 ms): -202.11.
Step 8046 (34 ms): -216.97.
Step 8084 (32 ms): -212.47.
Step 8122 (32 ms): -215.94.
Step 8159 (33 ms): -206.5.
Step 8197 (32 ms): -218.79.
Step 8234 (32 ms): -218.24.
Step 8272 (15 ms): -262.66.

Epoch 22 (12.1 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -209.79, ENRE: -204.07, KL: 5.7142.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 8310 (32 ms): -213.57.
Step 8347 (32 ms): -202.05.
Step 8385 (33 ms): -215.17.
Step 8422 (32 ms): -204.99.
Step 8460 (33 ms): -210.88.
Step 8498 (33 ms): -209.49.
Step 8535 (32 ms): -204.46.
Step 8573 (35 ms): -228.76.
Step 8610 (33 ms): -210.04.
Step 8648 (16 ms): -277.18.

Epoch 23 (12.3 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -209.84, ENRE: -204.36, KL: 5.4774.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 8686 (33 ms): -209.95.
Step 8723 (32 ms): -207.84.
Step 8761 (32 ms): -207.73.
Step 8798 (33 ms): -210.6.
Step 8836 (33 ms): -213.61.
Step 8874 (32 ms): -205.3.
Step 8911 (33 ms): -203.16.
Step 8949 (32 ms): -198.22.
Step 8986 (33 ms): -199.94.
Step 9024 (16 ms): -279.21.

Epoch 24 (12.3 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -209.29, ENRE: -203.8, KL: 5.496.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 9062 (32 ms): -216.18.
Step 9099 (32 ms): -201.29.
Step 9137 (34 ms): -221.31.
Step 9174 (33 ms): -215.93.
Step 9212 (33 ms): -225.46.
Step 9250 (33 ms): -215.07.
Step 9287 (32 ms): -210.22.
Step 9325 (32 ms): -208.25.
Step 9362 (33 ms): -209.27.
Step 9400 (15 ms): -218.95.

Epoch 25 (12.2 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -208.54, ENRE: -203.1, KL: 5.4369.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 9438 (32 ms): -207.26.
Step 9475 (33 ms): -208.58.
Step 9513 (32 ms): -202.14.
Step 9550 (32 ms): -208.92.
Step 9588 (34 ms): -209.15.
Step 9626 (33 ms): -190.6.
Step 9663 (32 ms): -197.1.
Step 9701 (32 ms): -197.64.
Step 9738 (32 ms): -203.35.
Step 9776 (15 ms): -236.51.

Epoch 26 (12.2 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -208.39, ENRE: -203.14, KL: 5.25.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 9814 (32 ms): -221.52.
Step 9851 (33 ms): -215.38.
Step 9889 (32 ms): -222.48.
Step 9926 (32 ms): -204.88.
Step 9964 (33 ms): -198.29.
Step 10002 (32 ms): -196.94.
Step 10039 (32 ms): -205.32.
Step 10077 (32 ms): -197.25.
Step 10114 (33 ms): -197.45.
Step 10152 (16 ms): -482.51.

Epoch 27 (12.2 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -207.49, ENRE: -202.3, KL: 5.1921.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 10190 (32 ms): -202.75.
Step 10227 (32 ms): -204.53.
Step 10265 (32 ms): -201.22.
Step 10302 (32 ms): -201.06.
Step 10340 (32 ms): -195.82.
Step 10378 (33 ms): -197.42.
Step 10415 (32 ms): -218.93.
Step 10453 (32 ms): -211.25.
Step 10490 (33 ms): -192.26.
Step 10528 (15 ms): -255.48.

Epoch 28 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -207.08, ENRE: -201.87, KL: 5.2108.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 10566 (32 ms): -193.8.
Step 10603 (32 ms): -209.92.
Step 10641 (32 ms): -200.03.
Step 10678 (33 ms): -204.99.
Step 10716 (32 ms): -217.88.
Step 10754 (32 ms): -216.91.
Step 10791 (33 ms): -215.39.
Step 10829 (32 ms): -209.44.
Step 10866 (32 ms): -200.37.
Step 10904 (15 ms): -205.18.

Epoch 29 (12.2 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -206.64, ENRE: -201.42, KL: 5.2278.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 10942 (34 ms): -207.6.
Step 10979 (33 ms): -212.18.
Step 11017 (33 ms): -198.29.
Step 11054 (32 ms): -201.9.
Step 11092 (33 ms): -195.57.
Step 11130 (32 ms): -199.66.
Step 11167 (32 ms): -199.79.
Step 11205 (33 ms): -206.83.
Step 11242 (33 ms): -207.41.
Step 11280 (16 ms): -245.3.

Epoch 30 (12.4 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -206.45, ENRE: -201.34, KL: 5.1138.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 11318 (32 ms): -208.45.
Step 11355 (33 ms): -209.27.
Step 11393 (32 ms): -211.31.
Step 11430 (33 ms): -207.74.
Step 11468 (32 ms): -194.66.
Step 11506 (32 ms): -206.39.
Step 11543 (32 ms): -204.05.
Step 11581 (33 ms): -196.26.
Step 11618 (32 ms): -201.51.
Step 11656 (15 ms): -430.53.

Epoch 31 (12.2 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -206.34, ENRE: -201.25, KL: 5.0869.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 11694 (33 ms): -218.54.
Step 11731 (33 ms): -197.19.
Step 11769 (32 ms): -205.1.
Step 11806 (32 ms): -212.25.
Step 11844 (35 ms): -212.11.
Step 11882 (32 ms): -219.21.
Step 11919 (33 ms): -201.
Step 11957 (32 ms): -189.88.
Step 11994 (33 ms): -201.8.
Step 12032 (15 ms): -272.5.

Epoch 32 (12.3 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -205.5, ENRE: -200.49, KL: 5.0128.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 12070 (34 ms): -219.41.
Step 12107 (32 ms): -199.74.
Step 12145 (32 ms): -208.2.
Step 12182 (32 ms): -207.84.
Step 12220 (32 ms): -205.19.
Step 12258 (32 ms): -207.02.
Step 12295 (32 ms): -206.78.
Step 12333 (32 ms): -203.29.
Step 12370 (32 ms): -208.71.
Step 12408 (15 ms): -175.57.

Epoch 33 (12.1 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -205.44, ENRE: -200.4, KL: 5.0387.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 12446 (32 ms): -197.11.
Step 12483 (32 ms): -197.55.
Step 12521 (33 ms): -188.
Step 12558 (33 ms): -211.97.
Step 12596 (32 ms): -223.43.
Step 12634 (32 ms): -206.7.
Step 12671 (33 ms): -221.93.
Step 12709 (32 ms): -211.62.
Step 12746 (33 ms): -201.74.
Step 12784 (15 ms): -227.52.

Epoch 34 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -205.28, ENRE: -200.25, KL: 5.026.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 12822 (32 ms): -201.81.
Step 12859 (32 ms): -200.17.
Step 12897 (33 ms): -202.01.
Step 12934 (32 ms): -192.88.
Step 12972 (32 ms): -201.98.
Step 13010 (32 ms): -212.66.
Step 13047 (33 ms): -211.24.
Step 13085 (32 ms): -197.03.
Step 13122 (32 ms): -213.45.
Step 13160 (15 ms): -237.89.

Epoch 35 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -204.73, ENRE: -199.8, KL: 4.921.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 13198 (32 ms): -186.72.
Step 13235 (32 ms): -217.03.
Step 13273 (33 ms): -221.11.
Step 13310 (33 ms): -200.44.
Step 13348 (33 ms): -197.41.
Step 13386 (33 ms): -203.31.
Step 13423 (33 ms): -198.08.
Step 13461 (33 ms): -194.96.
Step 13498 (33 ms): -214.34.
Step 13536 (16 ms): -232.47.

Epoch 36 (12.3 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -204.48, ENRE: -199.57, KL: 4.9147.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 13574 (32 ms): -215.52.
Step 13611 (32 ms): -214.01.
Step 13649 (32 ms): -208.35.
Step 13686 (32 ms): -205.39.
Step 13724 (33 ms): -197.29.
Step 13762 (32 ms): -202.82.
Step 13799 (32 ms): -195.38.
Step 13837 (33 ms): -201.84.
Step 13874 (33 ms): -184.79.
Step 13912 (15 ms): -793.46.

Epoch 37 (12.2 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -204.29, ENRE: -199.39, KL: 4.9007.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 13950 (32 ms): -199.18.
Step 13987 (32 ms): -199.48.
Step 14025 (33 ms): -215.5.
Step 14062 (32 ms): -215.44.
Step 14100 (33 ms): -196.77.
Step 14138 (33 ms): -207.29.
Step 14175 (33 ms): -200.43.
Step 14213 (33 ms): -211.61.
Step 14250 (33 ms): -200.94.
Step 14288 (16 ms): -266.76.

Epoch 38 (12.3 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -204.15, ENRE: -199.28, KL: 4.867.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 14326 (33 ms): -193.27.
Step 14363 (32 ms): -198.38.
Step 14401 (32 ms): -210.45.
Step 14438 (32 ms): -205.95.
Step 14476 (33 ms): -202.5.
Step 14514 (32 ms): -191.78.
Step 14551 (32 ms): -213.69.
Step 14589 (32 ms): -199.51.
Step 14626 (33 ms): -199.03.
Step 14664 (15 ms): -183.17.

Epoch 39 (12.2 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -203.62, ENRE: -198.78, KL: 4.8392.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 14702 (32 ms): -206.44.
Step 14739 (32 ms): -208.3.
Step 14777 (32 ms): -208.74.
Step 14814 (32 ms): -201.52.
Step 14852 (32 ms): -205.45.
Step 14890 (33 ms): -194.78.
Step 14927 (33 ms): -211.47.
Step 14965 (32 ms): -207.31.
Step 15002 (32 ms): -201.95.
Step 15040 (16 ms): -329.14.

Epoch 40 (12.2 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -203.7, ENRE: -198.9, KL: 4.7999.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 15078 (32 ms): -212.43.
Step 15115 (33 ms): -211.82.
Step 15153 (32 ms): -201.9.
Step 15190 (33 ms): -200.62.
Step 15228 (32 ms): -218.13.
Step 15266 (32 ms): -194.49.
Step 15303 (33 ms): -202.04.
Step 15341 (32 ms): -212.91.
Step 15378 (32 ms): -202.25.
Step 15416 (15 ms): -235.75.

Epoch 41 (12.2 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -203.51, ENRE: -198.66, KL: 4.8467.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 15454 (33 ms): -196.64.
Step 15491 (33 ms): -196.48.
Step 15529 (33 ms): -198.54.
Step 15566 (35 ms): -200.34.
Step 15604 (32 ms): -196.46.
Step 15642 (32 ms): -200.21.
Step 15679 (33 ms): -211.71.
Step 15717 (32 ms): -200.49.
Step 15754 (33 ms): -206.74.
Step 15792 (16 ms): -223.96.

Epoch 42 (12.2 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -203.32, ENRE: -198.36, KL: 4.9593.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 15830 (33 ms): -201.73.
Step 15867 (33 ms): -202.32.
Step 15905 (33 ms): -192.39.
Step 15942 (33 ms): -196.9.
Step 15980 (33 ms): -207.2.
Step 16018 (32 ms): -196.94.
Step 16055 (32 ms): -207.65.
Step 16093 (33 ms): -199.3.
Step 16130 (33 ms): -201.7.
Step 16168 (16 ms): -170.92.

Epoch 43 (12.3 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -203.48, ENRE: -198.62, KL: 4.8568.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 16206 (32 ms): -198.21.
Step 16243 (32 ms): -203.73.
Step 16281 (33 ms): -204.82.
Step 16318 (32 ms): -191.44.
Step 16356 (32 ms): -201.79.
Step 16394 (32 ms): -219.02.
Step 16431 (33 ms): -207.64.
Step 16469 (34 ms): -205.11.
Step 16506 (32 ms): -204.66.
Step 16544 (15 ms): -241.93.

Epoch 44 (12.2 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -203.17, ENRE: -198.26, KL: 4.9079.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 16582 (32 ms): -201.52.
Step 16619 (32 ms): -195.14.
Step 16657 (33 ms): -202.24.
Step 16694 (32 ms): -205.22.
Step 16732 (32 ms): -216.25.
Step 16770 (32 ms): -205.93.
Step 16807 (32 ms): -195.42.
Step 16845 (32 ms): -197.59.
Step 16882 (32 ms): -189.61.
Step 16920 (15 ms): -232.01.

Epoch 45 (12.2 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -202.91, ENRE: -198.17, KL: 4.741.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 16958 (33 ms): -194.61.
Step 16995 (34 ms): -201.76.
Step 17033 (32 ms): -202.19.
Step 17070 (32 ms): -201.86.
Step 17108 (32 ms): -205.07.
Step 17146 (32 ms): -217.66.
Step 17183 (32 ms): -198.84.
Step 17221 (32 ms): -191.66.
Step 17258 (32 ms): -194.66.
Step 17296 (16 ms): -208.78.

Epoch 46 (12.1 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -202.79, ENRE: -198, KL: 4.793.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 17334 (34 ms): -215.07.
Step 17371 (33 ms): -210.68.
Step 17409 (32 ms): -199.42.
Step 17446 (33 ms): -214.36.
Step 17484 (32 ms): -207.24.
Step 17522 (33 ms): -202.15.
Step 17559 (33 ms): -199.78.
Step 17597 (32 ms): -210.87.
Step 17634 (33 ms): -204.41.
Step 17672 (16 ms): -182.1.

Epoch 47 (12.3 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -202.64, ENRE: -197.75, KL: 4.8894.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 17710 (33 ms): -201.6.
Step 17747 (32 ms): -207.81.
Step 17785 (32 ms): -191.11.
Step 17822 (33 ms): -209.76.
Step 17860 (32 ms): -197.74.
Step 17898 (32 ms): -195.67.
Step 17935 (32 ms): -204.5.
Step 17973 (32 ms): -212.11.
Step 18010 (32 ms): -212.31.
Step 18048 (16 ms): -186.75.

Epoch 48 (12.3 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -202.54, ENRE: -197.61, KL: 4.932.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 18086 (33 ms): -210.48.
Step 18123 (32 ms): -191.69.
Step 18161 (33 ms): -194.61.
Step 18198 (33 ms): -193.
Step 18236 (32 ms): -196.13.
Step 18274 (34 ms): -199.17.
Step 18311 (32 ms): -197.79.
Step 18349 (32 ms): -189.94.
Step 18386 (33 ms): -204.34.
Step 18424 (16 ms): -205.69.

Epoch 49 (12.3 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -202.16, ENRE: -197.27, KL: 4.8898.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 18462 (32 ms): -207.41.
Step 18499 (32 ms): -203.65.
Step 18537 (32 ms): -209.52.
Step 18574 (33 ms): -210.08.
Step 18612 (33 ms): -203.44.
Step 18650 (33 ms): -213.19.
Step 18687 (32 ms): -197.74.
Step 18725 (33 ms): -211.71.
Step 18762 (33 ms): -198.59.
Step 18800 (15 ms): -234.24.

Epoch 50 (12.2 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -202.24, ENRE: -197.35, KL: 4.8881.
    Saving model parameters.
    Model parameters saved (114 ms).

Model trained for 50 epochs (15m 18s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (861 ms).

Converting data set value array to sparse matrix.
Data set value array converted (278 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.84 s):  ELBO: -416.52, ENRE: -411.64, KL: 4.8863.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (689 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.4134058410576058
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 45
kl weight: 1.4134058410576058
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (53 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (3.95 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.69 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 45
    hidden sizes: 231, 263, 121
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.4134058410576058
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 5 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 231)
    ENCODER/1/DENSE/biases:0             (231,)
    ENCODER/1/BATCH_NORM/beta:0          (231,)
    ENCODER/2/DENSE/weights:0            (231, 263)
    ENCODER/2/DENSE/biases:0             (263,)
    ENCODER/2/BATCH_NORM/beta:0          (263,)
    ENCODER/3/DENSE/weights:0            (263, 121)
    ENCODER/3/DENSE/biases:0             (121,)
    ENCODER/3/BATCH_NORM/beta:0          (121,)
    POSTERIOR/MU/DENSE/weights:0         (121, 45)
    POSTERIOR/MU/DENSE/biases:0          (45,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (121, 45)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (45,)
    DECODER/3/DENSE/weights:0            (45, 121)
    DECODER/3/DENSE/biases:0             (121,)
    DECODER/3/BATCH_NORM/beta:0          (121,)
    DECODER/2/DENSE/weights:0            (121, 263)
    DECODER/2/DENSE/biases:0             (263,)
    DECODER/2/BATCH_NORM/beta:0          (263,)
    DECODER/1/DENSE/weights:0            (263, 231)
    DECODER/1/DENSE/biases:0             (231,)
    DECODER/1/BATCH_NORM/beta:0          (231,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (231, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (389 ms).

Training model for 50 epochs on original values.

Step 38 (33 ms): -2071.9.
Step 75 (34 ms): -1642.7.
Step 113 (34 ms): -1307.2.
Step 150 (32 ms): -1057.9.
Step 188 (33 ms): -872.95.
Step 226 (33 ms): -763.68.
Step 263 (32 ms): -665.46.
Step 301 (32 ms): -588.01.
Step 338 (33 ms): -528.66.
Step 376 (17 ms): -462.7.

Epoch 1 (14.5 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.44 s): ELBO: -1652.7, ENRE: -1608.9, KL: 43.788.
    Saving model parameters.
    Model parameters saved (152 ms).

Step 414 (34 ms): -441.26.
Step 451 (32 ms): -410.02.
Step 489 (32 ms): -385.92.
Step 526 (33 ms): -384.76.
Step 564 (32 ms): -352.66.
Step 602 (32 ms): -361.78.
Step 639 (33 ms): -356.43.
Step 677 (34 ms): -355.48.
Step 714 (33 ms): -314.48.
Step 752 (17 ms): -306.04.

Epoch 2 (12.3 s):
    Warm-up weight: 0.2
    Evaluating model.
    Full set (5.99 s): ELBO: -885.28, ENRE: -858.05, KL: 27.231.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 790 (33 ms): -287.39.
Step 827 (33 ms): -287.97.
Step 865 (33 ms): -283.74.
Step 902 (33 ms): -270.68.
Step 940 (32 ms): -282.76.
Step 978 (33 ms): -295.92.
Step 1015 (33 ms): -263.67.
Step 1053 (33 ms): -268.38.
Step 1090 (33 ms): -251.44.
Step 1128 (16 ms): -303.23.

Epoch 3 (12.3 s):
    Warm-up weight: 0.4
    Evaluating model.
    Full set (5.97 s): ELBO: -529.3, ENRE: -511.8, KL: 17.499.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 1166 (33 ms): -247.47.
Step 1203 (32 ms): -256.34.
Step 1241 (33 ms): -261.24.
Step 1278 (33 ms): -232.5.
Step 1316 (33 ms): -241.48.
Step 1354 (33 ms): -242.13.
Step 1391 (33 ms): -245.12.
Step 1429 (33 ms): -245.02.
Step 1466 (32 ms): -229.75.
Step 1504 (15 ms): -236.38.

Epoch 4 (12.3 s):
    Warm-up weight: 0.6
    Evaluating model.
    Full set (6.01 s): ELBO: -365.98, ENRE: -352.34, KL: 13.64.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 1542 (33 ms): -237.07.
Step 1579 (33 ms): -230.25.
Step 1617 (32 ms): -229.6.
Step 1654 (32 ms): -238.04.
Step 1692 (33 ms): -235.04.
Step 1730 (33 ms): -228.12.
Step 1767 (32 ms): -225.61.
Step 1805 (32 ms): -252.03.
Step 1842 (32 ms): -222.25.
Step 1880 (15 ms): -226.99.

Epoch 5 (12.3 s):
    Warm-up weight: 0.8
    Evaluating model.
    Full set (5.94 s): ELBO: -294.82, ENRE: -283.7, KL: 11.125.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 1918 (33 ms): -222.45.
Step 1955 (32 ms): -217.25.
Step 1993 (33 ms): -215.86.
Step 2030 (32 ms): -228.
Step 2068 (33 ms): -224.4.
Step 2106 (33 ms): -233.4.
Step 2143 (32 ms): -227.19.
Step 2181 (32 ms): -232.31.
Step 2218 (32 ms): -230.1.
Step 2256 (15 ms): -233.65.

Epoch 6 (12.2 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -256.96, ENRE: -247.35, KL: 9.6117.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 2294 (33 ms): -224.7.
Step 2331 (32 ms): -234.23.
Step 2369 (32 ms): -219.35.
Step 2406 (33 ms): -227.09.
Step 2444 (33 ms): -242.84.
Step 2482 (32 ms): -212.72.
Step 2519 (32 ms): -226.85.
Step 2557 (33 ms): -231.99.
Step 2594 (33 ms): -225.62.
Step 2632 (15 ms): -297.71.

Epoch 7 (12.3 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -237.7, ENRE: -228.82, KL: 8.8831.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 2670 (32 ms): -243.71.
Step 2707 (32 ms): -223.92.
Step 2745 (33 ms): -249.52.
Step 2782 (32 ms): -204.5.
Step 2820 (32 ms): -215.43.
Step 2858 (32 ms): -216.27.
Step 2895 (33 ms): -212.5.
Step 2933 (32 ms): -254.33.
Step 2970 (32 ms): -204.12.
Step 3008 (15 ms): -267.04.

Epoch 8 (12.2 s):
    Evaluating model.
    Full set (6 s): ELBO: -226.51, ENRE: -218.15, KL: 8.3595.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 3046 (33 ms): -225.92.
Step 3083 (33 ms): -212.98.
Step 3121 (33 ms): -229.22.
Step 3158 (33 ms): -209.11.
Step 3196 (32 ms): -206.36.
Step 3234 (33 ms): -222.71.
Step 3271 (32 ms): -224.3.
Step 3309 (33 ms): -208.3.
Step 3346 (33 ms): -203.68.
Step 3384 (16 ms): -282.71.

Epoch 9 (12.4 s):
    Evaluating model.
    Full set (5.96 s): ELBO: -221.38, ENRE: -213.47, KL: 7.9113.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 3422 (33 ms): -214.95.
Step 3459 (32 ms): -214.41.
Step 3497 (32 ms): -207.38.
Step 3534 (33 ms): -218.27.
Step 3572 (32 ms): -214.18.
Step 3610 (33 ms): -203.8.
Step 3647 (33 ms): -229.8.
Step 3685 (32 ms): -213.54.
Step 3722 (33 ms): -213.24.
Step 3760 (15 ms): -236.59.

Epoch 10 (12.3 s):
    Evaluating model.
    Full set (5.98 s): ELBO: -218.14, ENRE: -210.47, KL: 7.673.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 3798 (33 ms): -213.47.
Step 3835 (33 ms): -208.74.
Step 3873 (32 ms): -210.97.
Step 3910 (32 ms): -201.14.
Step 3948 (33 ms): -252.19.
Step 3986 (33 ms): -211.85.
Step 4023 (33 ms): -212.02.
Step 4061 (33 ms): -213.32.
Step 4098 (33 ms): -226.39.
Step 4136 (15 ms): -188.5.

Epoch 11 (12.3 s):
    Evaluating model.
    Full set (5.96 s): ELBO: -216.02, ENRE: -208.49, KL: 7.5308.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 4174 (33 ms): -207.37.
Step 4211 (32 ms): -217.2.
Step 4249 (33 ms): -222.47.
Step 4286 (32 ms): -209.62.
Step 4324 (32 ms): -212.01.
Step 4362 (32 ms): -220.52.
Step 4399 (32 ms): -226.29.
Step 4437 (32 ms): -220.38.
Step 4474 (32 ms): -211.41.
Step 4512 (15 ms): -190.86.

Epoch 12 (12.2 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -214.61, ENRE: -207.22, KL: 7.3859.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 4550 (32 ms): -205.46.
Step 4587 (32 ms): -212.85.
Step 4625 (32 ms): -210.2.
Step 4662 (33 ms): -202.5.
Step 4700 (32 ms): -213.11.
Step 4738 (33 ms): -220.32.
Step 4775 (33 ms): -213.27.
Step 4813 (32 ms): -222.01.
Step 4850 (32 ms): -212.84.
Step 4888 (15 ms): -236.52.

Epoch 13 (12.3 s):
    Evaluating model.
    Full set (5.98 s): ELBO: -213.14, ENRE: -205.68, KL: 7.4551.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 4926 (33 ms): -203.
Step 4963 (33 ms): -221.83.
Step 5001 (32 ms): -212.61.
Step 5038 (32 ms): -198.78.
Step 5076 (32 ms): -219.07.
Step 5114 (32 ms): -226.54.
Step 5151 (32 ms): -214.78.
Step 5189 (33 ms): -202.53.
Step 5226 (32 ms): -218.94.
Step 5264 (15 ms): -217.23.

Epoch 14 (12.2 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -212.51, ENRE: -205.14, KL: 7.3744.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 5302 (33 ms): -216.05.
Step 5339 (32 ms): -202.08.
Step 5377 (33 ms): -206.66.
Step 5414 (32 ms): -205.82.
Step 5452 (33 ms): -222.23.
Step 5490 (33 ms): -204.49.
Step 5527 (33 ms): -213.47.
Step 5565 (33 ms): -209.3.
Step 5602 (33 ms): -208.28.
Step 5640 (16 ms): -219.02.

Epoch 15 (12.3 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -211.57, ENRE: -204.37, KL: 7.1943.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 5678 (32 ms): -207.4.
Step 5715 (33 ms): -221.31.
Step 5753 (33 ms): -217.44.
Step 5790 (33 ms): -225.58.
Step 5828 (32 ms): -221.46.
Step 5866 (32 ms): -206.76.
Step 5903 (32 ms): -205.51.
Step 5941 (33 ms): -223.85.
Step 5978 (33 ms): -230.58.
Step 6016 (15 ms): -200.66.

Epoch 16 (12.3 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -210.59, ENRE: -203.63, KL: 6.9622.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 6054 (32 ms): -205.14.
Step 6091 (35 ms): -205.57.
Step 6129 (32 ms): -211.46.
Step 6166 (32 ms): -200.43.
Step 6204 (33 ms): -210.97.
Step 6242 (33 ms): -202.62.
Step 6279 (33 ms): -205.08.
Step 6317 (32 ms): -213.78.
Step 6354 (33 ms): -202.89.
Step 6392 (15 ms): -213.24.

Epoch 17 (12.3 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -210.06, ENRE: -203.21, KL: 6.8581.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 6430 (33 ms): -207.86.
Step 6467 (33 ms): -219.77.
Step 6505 (33 ms): -210.55.
Step 6542 (33 ms): -215.27.
Step 6580 (32 ms): -201.36.
Step 6618 (33 ms): -212.58.
Step 6655 (32 ms): -202.23.
Step 6693 (32 ms): -216.29.
Step 6730 (32 ms): -201.98.
Step 6768 (15 ms): -224.63.

Epoch 18 (12.2 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -209.32, ENRE: -202.47, KL: 6.8452.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 6806 (34 ms): -225.13.
Step 6843 (32 ms): -202.69.
Step 6881 (32 ms): -207.3.
Step 6918 (33 ms): -195.26.
Step 6956 (32 ms): -202.44.
Step 6994 (32 ms): -206.16.
Step 7031 (32 ms): -217.63.
Step 7069 (32 ms): -206.81.
Step 7106 (32 ms): -219.06.
Step 7144 (15 ms): -325.55.

Epoch 19 (12.2 s):
    Evaluating model.
    Full set (5.98 s): ELBO: -208.68, ENRE: -201.99, KL: 6.6939.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 7182 (32 ms): -206.34.
Step 7219 (32 ms): -201.51.
Step 7257 (33 ms): -218.06.
Step 7294 (32 ms): -213.69.
Step 7332 (33 ms): -198.01.
Step 7370 (32 ms): -210.27.
Step 7407 (33 ms): -211.73.
Step 7445 (32 ms): -191.45.
Step 7482 (32 ms): -215.37.
Step 7520 (15 ms): -222.17.

Epoch 20 (12.2 s):
    Evaluating model.
    Full set (5.96 s): ELBO: -208.34, ENRE: -201.68, KL: 6.6602.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 7558 (33 ms): -230.07.
Step 7595 (32 ms): -212.71.
Step 7633 (33 ms): -197.76.
Step 7670 (33 ms): -209.77.
Step 7708 (32 ms): -211.72.
Step 7746 (33 ms): -199.8.
Step 7783 (33 ms): -211.1.
Step 7821 (32 ms): -201.45.
Step 7858 (33 ms): -200.96.
Step 7896 (16 ms): -220.52.

Epoch 21 (12.3 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -207.47, ENRE: -200.77, KL: 6.6963.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 7934 (33 ms): -204.48.
Step 7971 (34 ms): -202.86.
Step 8009 (33 ms): -219.91.
Step 8046 (33 ms): -197.98.
Step 8084 (33 ms): -217.41.
Step 8122 (33 ms): -217.3.
Step 8159 (33 ms): -207.16.
Step 8197 (33 ms): -203.95.
Step 8234 (33 ms): -202.35.
Step 8272 (15 ms): -179.14.

Epoch 22 (12.4 s):
    Evaluating model.
    Full set (5.97 s): ELBO: -206.9, ENRE: -200.37, KL: 6.5316.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 8310 (33 ms): -198.47.
Step 8347 (33 ms): -192.5.
Step 8385 (33 ms): -204.41.
Step 8422 (33 ms): -220.25.
Step 8460 (32 ms): -204.8.
Step 8498 (33 ms): -220.6.
Step 8535 (33 ms): -222.74.
Step 8573 (32 ms): -204.35.
Step 8610 (32 ms): -204.53.
Step 8648 (15 ms): -242.17.

Epoch 23 (12.3 s):
    Evaluating model.
    Full set (5.97 s): ELBO: -206.68, ENRE: -200.09, KL: 6.5889.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 8686 (33 ms): -202.68.
Step 8723 (32 ms): -200.86.
Step 8761 (32 ms): -210.94.
Step 8798 (33 ms): -211.27.
Step 8836 (33 ms): -210.54.
Step 8874 (33 ms): -211.
Step 8911 (32 ms): -207.34.
Step 8949 (32 ms): -200.83.
Step 8986 (33 ms): -192.71.
Step 9024 (15 ms): -217.68.

Epoch 24 (12.3 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -206.35, ENRE: -199.82, KL: 6.5321.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 9062 (33 ms): -199.63.
Step 9099 (32 ms): -214.48.
Step 9137 (32 ms): -202.72.
Step 9174 (33 ms): -203.73.
Step 9212 (33 ms): -206.65.
Step 9250 (33 ms): -198.82.
Step 9287 (32 ms): -198.29.
Step 9325 (32 ms): -200.27.
Step 9362 (33 ms): -200.88.
Step 9400 (15 ms): -240.34.

Epoch 25 (12.2 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -205.63, ENRE: -199.23, KL: 6.4001.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 9438 (33 ms): -204.25.
Step 9475 (32 ms): -200.06.
Step 9513 (33 ms): -213.25.
Step 9550 (33 ms): -198.92.
Step 9588 (33 ms): -199.35.
Step 9626 (33 ms): -202.16.
Step 9663 (33 ms): -208.19.
Step 9701 (32 ms): -203.99.
Step 9738 (33 ms): -212.45.
Step 9776 (15 ms): -204.15.

Epoch 26 (12.3 s):
    Evaluating model.
    Full set (5.97 s): ELBO: -205.17, ENRE: -198.76, KL: 6.4041.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 9814 (33 ms): -205.31.
Step 9851 (32 ms): -212.67.
Step 9889 (33 ms): -203.11.
Step 9926 (32 ms): -211.8.
Step 9964 (32 ms): -204.52.
Step 10002 (33 ms): -211.43.
Step 10039 (33 ms): -192.71.
Step 10077 (33 ms): -206.95.
Step 10114 (32 ms): -202.09.
Step 10152 (15 ms): -207.45.

Epoch 27 (12.2 s):
    Evaluating model.
    Full set (5.97 s): ELBO: -204.78, ENRE: -198.49, KL: 6.2885.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 10190 (33 ms): -199.81.
Step 10227 (33 ms): -213.47.
Step 10265 (33 ms): -199.4.
Step 10302 (33 ms): -201.1.
Step 10340 (32 ms): -202.88.
Step 10378 (33 ms): -199.11.
Step 10415 (32 ms): -197.47.
Step 10453 (33 ms): -199.81.
Step 10490 (33 ms): -201.17.
Step 10528 (16 ms): -194.76.

Epoch 28 (12.4 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -204.66, ENRE: -198.37, KL: 6.2962.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 10566 (33 ms): -212.7.
Step 10603 (32 ms): -198.58.
Step 10641 (32 ms): -207.05.
Step 10678 (32 ms): -207.15.
Step 10716 (33 ms): -205.7.
Step 10754 (33 ms): -210.87.
Step 10791 (32 ms): -192.29.
Step 10829 (32 ms): -204.9.
Step 10866 (34 ms): -203.02.
Step 10904 (15 ms): -213.36.

Epoch 29 (12.3 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -204.27, ENRE: -197.95, KL: 6.3225.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 10942 (33 ms): -203.8.
Step 10979 (32 ms): -208.09.
Step 11017 (33 ms): -196.42.
Step 11054 (32 ms): -198.22.
Step 11092 (32 ms): -214.
Step 11130 (33 ms): -220.97.
Step 11167 (33 ms): -202.
Step 11205 (33 ms): -221.67.
Step 11242 (32 ms): -206.44.
Step 11280 (16 ms): -251.07.

Epoch 30 (12.3 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -203.75, ENRE: -197.55, KL: 6.1998.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 11318 (33 ms): -204.83.
Step 11355 (33 ms): -205.78.
Step 11393 (32 ms): -202.91.
Step 11430 (35 ms): -206.96.
Step 11468 (33 ms): -211.92.
Step 11506 (32 ms): -210.86.
Step 11543 (32 ms): -203.89.
Step 11581 (32 ms): -202.17.
Step 11618 (32 ms): -204.83.
Step 11656 (15 ms): -181.56.

Epoch 31 (12.2 s):
    Evaluating model.
    Full set (5.96 s): ELBO: -203.6, ENRE: -197.39, KL: 6.2162.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 11694 (32 ms): -196.4.
Step 11731 (32 ms): -209.12.
Step 11769 (32 ms): -191.85.
Step 11806 (32 ms): -227.88.
Step 11844 (33 ms): -213.21.
Step 11882 (32 ms): -207.24.
Step 11919 (33 ms): -210.12.
Step 11957 (32 ms): -216.39.
Step 11994 (32 ms): -215.47.
Step 12032 (15 ms): -225.78.

Epoch 32 (12.2 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -203.32, ENRE: -197.1, KL: 6.2171.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 12070 (34 ms): -210.6.
Step 12107 (32 ms): -201.05.
Step 12145 (32 ms): -202.28.
Step 12182 (32 ms): -204.76.
Step 12220 (32 ms): -211.92.
Step 12258 (33 ms): -199.36.
Step 12295 (32 ms): -207.91.
Step 12333 (32 ms): -195.11.
Step 12370 (32 ms): -200.39.
Step 12408 (17 ms): -182.53.

Epoch 33 (12.2 s):
    Evaluating model.
    Full set (5.98 s): ELBO: -203.32, ENRE: -197.17, KL: 6.1517.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 12446 (33 ms): -207.17.
Step 12483 (33 ms): -195.52.
Step 12521 (32 ms): -213.34.
Step 12558 (33 ms): -195.95.
Step 12596 (32 ms): -202.16.
Step 12634 (33 ms): -187.5.
Step 12671 (32 ms): -210.62.
Step 12709 (32 ms): -200.95.
Step 12746 (33 ms): -197.17.
Step 12784 (15 ms): -223.43.

Epoch 34 (12.3 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -202.88, ENRE: -196.67, KL: 6.2174.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 12822 (33 ms): -191.6.
Step 12859 (33 ms): -199.22.
Step 12897 (33 ms): -208.08.
Step 12934 (33 ms): -209.07.
Step 12972 (33 ms): -209.37.
Step 13010 (33 ms): -211.02.
Step 13047 (33 ms): -194.55.
Step 13085 (32 ms): -194.62.
Step 13122 (33 ms): -195.66.
Step 13160 (15 ms): -247.57.

Epoch 35 (12.4 s):
    Evaluating model.
    Full set (5.96 s): ELBO: -202.8, ENRE: -196.65, KL: 6.1507.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 13198 (33 ms): -203.46.
Step 13235 (32 ms): -211.97.
Step 13273 (33 ms): -207.26.
Step 13310 (33 ms): -201.13.
Step 13348 (32 ms): -203.56.
Step 13386 (33 ms): -204.07.
Step 13423 (32 ms): -205.9.
Step 13461 (33 ms): -193.73.
Step 13498 (32 ms): -215.48.
Step 13536 (15 ms): -204.62.

Epoch 36 (12.3 s):
    Evaluating model.
    Full set (6 s): ELBO: -202.42, ENRE: -196.24, KL: 6.1873.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 13574 (32 ms): -195.55.
Step 13611 (33 ms): -201.94.
Step 13649 (33 ms): -204.81.
Step 13686 (33 ms): -189.05.
Step 13724 (32 ms): -206.07.
Step 13762 (34 ms): -203.74.
Step 13799 (33 ms): -197.07.
Step 13837 (33 ms): -203.13.
Step 13874 (32 ms): -211.03.
Step 13912 (15 ms): -198.38.

Epoch 37 (12.3 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -202.32, ENRE: -196.18, KL: 6.1368.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 13950 (32 ms): -207.85.
Step 13987 (32 ms): -219.12.
Step 14025 (32 ms): -204.23.
Step 14062 (32 ms): -206.47.
Step 14100 (32 ms): -206.51.
Step 14138 (32 ms): -207.05.
Step 14175 (32 ms): -195.74.
Step 14213 (32 ms): -208.25.
Step 14250 (33 ms): -192.55.
Step 14288 (15 ms): -173.68.

Epoch 38 (12.2 s):
    Evaluating model.
    Full set (5.96 s): ELBO: -202.02, ENRE: -195.78, KL: 6.2306.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 14326 (33 ms): -208.27.
Step 14363 (33 ms): -199.79.
Step 14401 (33 ms): -215.01.
Step 14438 (33 ms): -199.49.
Step 14476 (33 ms): -190.66.
Step 14514 (35 ms): -206.17.
Step 14551 (33 ms): -194.61.
Step 14589 (33 ms): -202.92.
Step 14626 (33 ms): -201.76.
Step 14664 (16 ms): -201.83.

Epoch 39 (12.3 s):
    Evaluating model.
    Full set (5.98 s): ELBO: -201.75, ENRE: -195.51, KL: 6.2449.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 14702 (33 ms): -201.4.
Step 14739 (33 ms): -225.77.
Step 14777 (33 ms): -209.75.
Step 14814 (33 ms): -206.45.
Step 14852 (32 ms): -199.66.
Step 14890 (33 ms): -199.75.
Step 14927 (33 ms): -201.48.
Step 14965 (33 ms): -203.73.
Step 15002 (32 ms): -192.4.
Step 15040 (15 ms): -168.67.

Epoch 40 (12.3 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -201.82, ENRE: -195.66, KL: 6.1583.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 15078 (33 ms): -211.98.
Step 15115 (33 ms): -187.6.
Step 15153 (33 ms): -208.5.
Step 15190 (33 ms): -201.11.
Step 15228 (32 ms): -203.85.
Step 15266 (33 ms): -204.63.
Step 15303 (33 ms): -190.99.
Step 15341 (33 ms): -196.1.
Step 15378 (33 ms): -209.07.
Step 15416 (15 ms): -227.98.

Epoch 41 (12.4 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -201.71, ENRE: -195.48, KL: 6.2256.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 15454 (33 ms): -200.39.
Step 15491 (32 ms): -196.45.
Step 15529 (33 ms): -216.32.
Step 15566 (32 ms): -195.95.
Step 15604 (32 ms): -210.49.
Step 15642 (32 ms): -182.
Step 15679 (32 ms): -209.77.
Step 15717 (33 ms): -215.33.
Step 15754 (32 ms): -218.73.
Step 15792 (15 ms): -171.93.

Epoch 42 (12.2 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -201.63, ENRE: -195.45, KL: 6.1774.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 15830 (32 ms): -194.9.
Step 15867 (32 ms): -203.92.
Step 15905 (32 ms): -192.08.
Step 15942 (33 ms): -195.47.
Step 15980 (32 ms): -208.07.
Step 16018 (32 ms): -205.17.
Step 16055 (33 ms): -193.64.
Step 16093 (33 ms): -214.42.
Step 16130 (33 ms): -199.34.
Step 16168 (15 ms): -304.17.

Epoch 43 (12.3 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -201.42, ENRE: -195.27, KL: 6.1526.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 16206 (32 ms): -199.
Step 16243 (33 ms): -209.41.
Step 16281 (33 ms): -203.56.
Step 16318 (32 ms): -201.69.
Step 16356 (32 ms): -195.8.
Step 16394 (32 ms): -193.23.
Step 16431 (32 ms): -206.55.
Step 16469 (32 ms): -192.35.
Step 16506 (32 ms): -204.94.
Step 16544 (15 ms): -200.03.

Epoch 44 (12.2 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -201.44, ENRE: -195.32, KL: 6.1122.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 16582 (33 ms): -191.88.
Step 16619 (32 ms): -201.86.
Step 16657 (32 ms): -198.25.
Step 16694 (33 ms): -195.19.
Step 16732 (32 ms): -188.68.
Step 16770 (32 ms): -200.39.
Step 16807 (33 ms): -210.05.
Step 16845 (33 ms): -201.24.
Step 16882 (35 ms): -210.6.
Step 16920 (15 ms): -318.72.

Epoch 45 (12.2 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -201.27, ENRE: -195.17, KL: 6.0997.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 16958 (33 ms): -208.05.
Step 16995 (33 ms): -197.21.
Step 17033 (33 ms): -195.23.
Step 17070 (33 ms): -204.66.
Step 17108 (33 ms): -203.77.
Step 17146 (32 ms): -195.74.
Step 17183 (32 ms): -191.77.
Step 17221 (32 ms): -201.14.
Step 17258 (32 ms): -198.26.
Step 17296 (15 ms): -261.35.

Epoch 46 (12.3 s):
    Evaluating model.
    Full set (5.96 s): ELBO: -201.06, ENRE: -194.9, KL: 6.1639.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 17334 (33 ms): -198.16.
Step 17371 (33 ms): -208.69.
Step 17409 (32 ms): -191.47.
Step 17446 (33 ms): -209.39.
Step 17484 (33 ms): -209.34.
Step 17522 (33 ms): -197.31.
Step 17559 (33 ms): -197.76.
Step 17597 (33 ms): -209.62.
Step 17634 (33 ms): -205.48.
Step 17672 (15 ms): -211.31.

Epoch 47 (12.3 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -200.98, ENRE: -194.76, KL: 6.2154.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 17710 (34 ms): -212.76.
Step 17747 (33 ms): -191.51.
Step 17785 (33 ms): -196.97.
Step 17822 (32 ms): -194.83.
Step 17860 (32 ms): -199.8.
Step 17898 (32 ms): -203.64.
Step 17935 (33 ms): -202.56.
Step 17973 (33 ms): -198.08.
Step 18010 (32 ms): -204.2.
Step 18048 (15 ms): -321.64.

Epoch 48 (12.3 s):
    Evaluating model.
    Full set (5.96 s): ELBO: -200.77, ENRE: -194.67, KL: 6.1073.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 18086 (32 ms): -191.93.
Step 18123 (32 ms): -193.53.
Step 18161 (32 ms): -190.86.
Step 18198 (32 ms): -195.73.
Step 18236 (32 ms): -206.18.
Step 18274 (32 ms): -206.89.
Step 18311 (32 ms): -201.16.
Step 18349 (33 ms): -198.26.
Step 18386 (32 ms): -192.04.
Step 18424 (15 ms): -234.04.

Epoch 49 (12.2 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -200.61, ENRE: -194.53, KL: 6.0734.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 18462 (32 ms): -200.06.
Step 18499 (33 ms): -199.62.
Step 18537 (32 ms): -207.98.
Step 18574 (33 ms): -205.12.
Step 18612 (32 ms): -194.45.
Step 18650 (33 ms): -193.92.
Step 18687 (34 ms): -194.53.
Step 18725 (32 ms): -195.85.
Step 18762 (32 ms): -213.83.
Step 18800 (15 ms): -230.17.

Epoch 50 (12.2 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -200.6, ENRE: -194.48, KL: 6.1207.
    Saving model parameters.
    Model parameters saved (91 ms).

Model trained for 50 epochs (15m 22s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (12 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (912 ms).

Converting data set value array to sparse matrix.
Data set value array converted (315 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.76 s):  ELBO: -421.39, ENRE: -415.27, KL: 6.1119.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (613 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.3884571829280785
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 46
kl weight: 1.3884571829280785
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (47 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.23 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.87 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 46
    hidden sizes: 231, 251, 140
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.3884571829280785
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 4 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 231)
    ENCODER/1/DENSE/biases:0             (231,)
    ENCODER/1/BATCH_NORM/beta:0          (231,)
    ENCODER/2/DENSE/weights:0            (231, 251)
    ENCODER/2/DENSE/biases:0             (251,)
    ENCODER/2/BATCH_NORM/beta:0          (251,)
    ENCODER/3/DENSE/weights:0            (251, 140)
    ENCODER/3/DENSE/biases:0             (140,)
    ENCODER/3/BATCH_NORM/beta:0          (140,)
    POSTERIOR/MU/DENSE/weights:0         (140, 46)
    POSTERIOR/MU/DENSE/biases:0          (46,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (140, 46)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (46,)
    DECODER/3/DENSE/weights:0            (46, 140)
    DECODER/3/DENSE/biases:0             (140,)
    DECODER/3/BATCH_NORM/beta:0          (140,)
    DECODER/2/DENSE/weights:0            (140, 251)
    DECODER/2/DENSE/biases:0             (251,)
    DECODER/2/BATCH_NORM/beta:0          (251,)
    DECODER/1/DENSE/weights:0            (251, 231)
    DECODER/1/DENSE/biases:0             (231,)
    DECODER/1/BATCH_NORM/beta:0          (231,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (231, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (394 ms).

Training model for 50 epochs on original values.

Step 38 (34 ms): -2041.7.
Step 75 (35 ms): -1624.4.
Step 113 (34 ms): -1332.4.
Step 150 (34 ms): -1097.1.
Step 188 (33 ms): -952.16.
Step 226 (34 ms): -814.36.
Step 263 (34 ms): -739.55.
Step 301 (33 ms): -648.65.
Step 338 (33 ms): -598.79.
Step 376 (17 ms): -666.38.

Epoch 1 (14.6 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.45 s): ELBO: -1681, ENRE: -1505.9, KL: 175.12.
    Saving model parameters.
    Model parameters saved (154 ms).

Step 414 (33 ms): -494.77.
Step 451 (33 ms): -435.76.
Step 489 (33 ms): -397.01.
Step 526 (33 ms): -376.09.
Step 564 (33 ms): -355.6.
Step 602 (32 ms): -326.92.
Step 639 (33 ms): -337.68.
Step 677 (32 ms): -334.04.
Step 714 (33 ms): -319.78.
Step 752 (17 ms): -344.88.

Epoch 2 (12.3 s):
    Warm-up weight: 0.25
    Evaluating model.
    Full set (5.91 s): ELBO: -872.39, ENRE: -848.11, KL: 24.277.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 790 (33 ms): -284.93.
Step 827 (33 ms): -271.32.
Step 865 (33 ms): -280.62.
Step 902 (33 ms): -267.3.
Step 940 (34 ms): -280.55.
Step 978 (33 ms): -270.1.
Step 1015 (33 ms): -270.53.
Step 1053 (33 ms): -294.11.
Step 1090 (34 ms): -272.49.
Step 1128 (15 ms): -285.72.

Epoch 3 (12.4 s):
    Warm-up weight: 0.5
    Evaluating model.
    Full set (5.95 s): ELBO: -521.25, ENRE: -504.58, KL: 16.677.
    Saving model parameters.
    Model parameters saved (85 ms).

Step 1166 (33 ms): -254.55.
Step 1203 (33 ms): -242.08.
Step 1241 (33 ms): -250.26.
Step 1278 (33 ms): -251.5.
Step 1316 (33 ms): -243.76.
Step 1354 (33 ms): -221.31.
Step 1391 (32 ms): -243.7.
Step 1429 (32 ms): -241.51.
Step 1466 (32 ms): -233.06.
Step 1504 (15 ms): -295.42.

Epoch 4 (12.3 s):
    Warm-up weight: 0.75
    Evaluating model.
    Full set (5.92 s): ELBO: -371.17, ENRE: -358.18, KL: 12.99.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 1542 (32 ms): -231.7.
Step 1579 (32 ms): -243.
Step 1617 (32 ms): -251.29.
Step 1654 (33 ms): -248.34.
Step 1692 (33 ms): -233.17.
Step 1730 (32 ms): -249.92.
Step 1767 (33 ms): -257.08.
Step 1805 (33 ms): -270.44.
Step 1842 (33 ms): -237.73.
Step 1880 (15 ms): -543.28.

Epoch 5 (12.3 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -298.53, ENRE: -287.78, KL: 10.744.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 1918 (33 ms): -236.65.
Step 1955 (32 ms): -229.57.
Step 1993 (33 ms): -237.23.
Step 2030 (32 ms): -230.2.
Step 2068 (33 ms): -230.56.
Step 2106 (32 ms): -211.52.
Step 2143 (33 ms): -210.51.
Step 2181 (32 ms): -222.83.
Step 2218 (33 ms): -218.24.
Step 2256 (15 ms): -600.08.

Epoch 6 (12.2 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -257.74, ENRE: -248.08, KL: 9.6631.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 2294 (34 ms): -238.88.
Step 2331 (32 ms): -221.71.
Step 2369 (33 ms): -219.96.
Step 2406 (33 ms): -220.79.
Step 2444 (32 ms): -225.59.
Step 2482 (34 ms): -227.6.
Step 2519 (33 ms): -214.77.
Step 2557 (33 ms): -222.8.
Step 2594 (33 ms): -222.24.
Step 2632 (16 ms): -246.39.

Epoch 7 (12.3 s):
    Evaluating model.
    Full set (5.98 s): ELBO: -238.51, ENRE: -229.53, KL: 8.9827.
    Saving model parameters.
    Model parameters saved (99 ms).

Step 2670 (33 ms): -226.64.
Step 2707 (33 ms): -221.18.
Step 2745 (33 ms): -218.92.
Step 2782 (33 ms): -219.49.
Step 2820 (32 ms): -214.96.
Step 2858 (32 ms): -221.1.
Step 2895 (32 ms): -209.99.
Step 2933 (32 ms): -217.72.
Step 2970 (33 ms): -215.27.
Step 3008 (15 ms): -252.67.

Epoch 8 (12.3 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -229.07, ENRE: -220.71, KL: 8.3602.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 3046 (33 ms): -221.87.
Step 3083 (33 ms): -215.51.
Step 3121 (33 ms): -235.01.
Step 3158 (32 ms): -209.12.
Step 3196 (32 ms): -216.37.
Step 3234 (33 ms): -212.46.
Step 3271 (32 ms): -200.9.
Step 3309 (32 ms): -202.97.
Step 3346 (33 ms): -221.1.
Step 3384 (15 ms): -210.25.

Epoch 9 (12.3 s):
    Evaluating model.
    Full set (5.97 s): ELBO: -221.43, ENRE: -213.02, KL: 8.4091.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 3422 (33 ms): -219.72.
Step 3459 (32 ms): -211.27.
Step 3497 (32 ms): -213.51.
Step 3534 (33 ms): -220.2.
Step 3572 (32 ms): -229.59.
Step 3610 (35 ms): -220.37.
Step 3647 (33 ms): -211.66.
Step 3685 (32 ms): -223.24.
Step 3722 (32 ms): -206.01.
Step 3760 (15 ms): -216.14.

Epoch 10 (12.3 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -218.57, ENRE: -210.34, KL: 8.2238.
    Saving model parameters.
    Model parameters saved (97 ms).

Step 3798 (33 ms): -245.92.
Step 3835 (32 ms): -209.25.
Step 3873 (32 ms): -200.02.
Step 3910 (33 ms): -212.88.
Step 3948 (32 ms): -231.12.
Step 3986 (32 ms): -217.9.
Step 4023 (32 ms): -207.74.
Step 4061 (33 ms): -223.27.
Step 4098 (33 ms): -212.31.
Step 4136 (15 ms): -243.55.

Epoch 11 (12.2 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -215.87, ENRE: -208.06, KL: 7.8143.
    Saving model parameters.
    Model parameters saved (99 ms).

Step 4174 (32 ms): -200.09.
Step 4211 (33 ms): -205.81.
Step 4249 (33 ms): -212.2.
Step 4286 (32 ms): -206.23.
Step 4324 (33 ms): -207.8.
Step 4362 (33 ms): -220.09.
Step 4399 (32 ms): -216.41.
Step 4437 (33 ms): -214.67.
Step 4474 (32 ms): -205.92.
Step 4512 (15 ms): -205.18.

Epoch 12 (12.3 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -214.14, ENRE: -206.35, KL: 7.792.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 4550 (32 ms): -205.09.
Step 4587 (32 ms): -210.41.
Step 4625 (33 ms): -205.85.
Step 4662 (32 ms): -216.4.
Step 4700 (32 ms): -220.67.
Step 4738 (33 ms): -214.33.
Step 4775 (33 ms): -224.46.
Step 4813 (32 ms): -210.09.
Step 4850 (34 ms): -213.98.
Step 4888 (15 ms): -191.86.

Epoch 13 (12.3 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -213.85, ENRE: -206.34, KL: 7.5116.
    Saving model parameters.
    Model parameters saved (99 ms).

Step 4926 (33 ms): -197.27.
Step 4963 (33 ms): -195.61.
Step 5001 (33 ms): -230.05.
Step 5038 (33 ms): -214.52.
Step 5076 (33 ms): -223.59.
Step 5114 (33 ms): -211.11.
Step 5151 (33 ms): -222.44.
Step 5189 (33 ms): -213.04.
Step 5226 (33 ms): -209.71.
Step 5264 (15 ms): -268.4.

Epoch 14 (12.4 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -212.86, ENRE: -205.28, KL: 7.5763.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 5302 (32 ms): -211.37.
Step 5339 (33 ms): -209.39.
Step 5377 (33 ms): -202.23.
Step 5414 (33 ms): -207.6.
Step 5452 (34 ms): -210.2.
Step 5490 (32 ms): -196.25.
Step 5527 (34 ms): -200.17.
Step 5565 (32 ms): -210.32.
Step 5602 (33 ms): -211.08.
Step 5640 (15 ms): -210.09.

Epoch 15 (12.3 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -211.82, ENRE: -204.39, KL: 7.4352.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 5678 (32 ms): -222.25.
Step 5715 (32 ms): -199.53.
Step 5753 (33 ms): -209.53.
Step 5790 (32 ms): -216.08.
Step 5828 (33 ms): -199.46.
Step 5866 (33 ms): -220.61.
Step 5903 (33 ms): -192.69.
Step 5941 (33 ms): -222.48.
Step 5978 (33 ms): -222.48.
Step 6016 (15 ms): -240.79.

Epoch 16 (12.4 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -210.62, ENRE: -203.16, KL: 7.4541.
    Saving model parameters.
    Model parameters saved (99 ms).

Step 6054 (32 ms): -208.6.
Step 6091 (32 ms): -195.14.
Step 6129 (33 ms): -218.92.
Step 6166 (33 ms): -210.99.
Step 6204 (32 ms): -200.12.
Step 6242 (32 ms): -196.04.
Step 6279 (32 ms): -202.68.
Step 6317 (33 ms): -199.9.
Step 6354 (32 ms): -213.45.
Step 6392 (15 ms): -205.65.

Epoch 17 (12.2 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -210.36, ENRE: -203.2, KL: 7.1642.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 6430 (33 ms): -211.37.
Step 6467 (32 ms): -222.17.
Step 6505 (33 ms): -216.91.
Step 6542 (32 ms): -193.2.
Step 6580 (32 ms): -221.29.
Step 6618 (33 ms): -198.77.
Step 6655 (33 ms): -204.9.
Step 6693 (32 ms): -206.21.
Step 6730 (32 ms): -199.73.
Step 6768 (15 ms): -209.29.

Epoch 18 (12.3 s):
    Evaluating model.
    Full set (5.97 s): ELBO: -209.2, ENRE: -202.22, KL: 6.9705.
    Saving model parameters.
    Model parameters saved (100 ms).

Step 6806 (33 ms): -212.44.
Step 6843 (32 ms): -213.23.
Step 6881 (32 ms): -201.15.
Step 6918 (32 ms): -208.29.
Step 6956 (33 ms): -210.47.
Step 6994 (33 ms): -207.6.
Step 7031 (32 ms): -199.37.
Step 7069 (32 ms): -205.55.
Step 7106 (33 ms): -211.04.
Step 7144 (15 ms): -189.59.

Epoch 19 (12.3 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -208.6, ENRE: -201.59, KL: 7.0151.
    Saving model parameters.
    Model parameters saved (97 ms).

Step 7182 (32 ms): -186.95.
Step 7219 (32 ms): -202.46.
Step 7257 (33 ms): -221.49.
Step 7294 (34 ms): -212.1.
Step 7332 (32 ms): -203.29.
Step 7370 (33 ms): -207.15.
Step 7407 (33 ms): -216.72.
Step 7445 (34 ms): -208.81.
Step 7482 (33 ms): -210.92.
Step 7520 (15 ms): -316.18.

Epoch 20 (12.3 s):
    Evaluating model.
    Full set (5.96 s): ELBO: -208.02, ENRE: -201.15, KL: 6.8716.
    Saving model parameters.
    Model parameters saved (99 ms).

Step 7558 (33 ms): -210.98.
Step 7595 (33 ms): -209.13.
Step 7633 (33 ms): -196.08.
Step 7670 (33 ms): -205.92.
Step 7708 (32 ms): -197.64.
Step 7746 (32 ms): -201.71.
Step 7783 (33 ms): -183.65.
Step 7821 (32 ms): -205.43.
Step 7858 (33 ms): -208.54.
Step 7896 (15 ms): -221.75.

Epoch 21 (12.3 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -207.44, ENRE: -200.78, KL: 6.6599.
    Saving model parameters.
    Model parameters saved (86 ms).

Step 7934 (33 ms): -204.32.
Step 7971 (32 ms): -205.05.
Step 8009 (34 ms): -197.24.
Step 8046 (32 ms): -203.45.
Step 8084 (33 ms): -203.18.
Step 8122 (33 ms): -200.8.
Step 8159 (32 ms): -213.12.
Step 8197 (32 ms): -206.37.
Step 8234 (33 ms): -209.03.
Step 8272 (16 ms): -224.39.

Epoch 22 (12.3 s):
    Evaluating model.
    Full set (5.97 s): ELBO: -207.08, ENRE: -200.34, KL: 6.7447.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 8310 (32 ms): -198.31.
Step 8347 (33 ms): -202.84.
Step 8385 (33 ms): -202.26.
Step 8422 (33 ms): -203.61.
Step 8460 (32 ms): -208.67.
Step 8498 (33 ms): -201.78.
Step 8535 (32 ms): -213.16.
Step 8573 (33 ms): -212.31.
Step 8610 (34 ms): -191.95.
Step 8648 (15 ms): -190.02.

Epoch 23 (12.3 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -206.97, ENRE: -200.28, KL: 6.6924.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 8686 (32 ms): -202.66.
Step 8723 (32 ms): -197.86.
Step 8761 (33 ms): -208.22.
Step 8798 (33 ms): -198.24.
Step 8836 (33 ms): -212.5.
Step 8874 (33 ms): -202.12.
Step 8911 (32 ms): -211.53.
Step 8949 (32 ms): -204.83.
Step 8986 (33 ms): -195.75.
Step 9024 (15 ms): -204.09.

Epoch 24 (12.2 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -206.21, ENRE: -199.52, KL: 6.6815.
    Saving model parameters.
    Model parameters saved (100 ms).

Step 9062 (33 ms): -221.9.
Step 9099 (33 ms): -199.47.
Step 9137 (33 ms): -229.15.
Step 9174 (33 ms): -207.59.
Step 9212 (33 ms): -205.87.
Step 9250 (33 ms): -217.66.
Step 9287 (33 ms): -199.1.
Step 9325 (33 ms): -199.47.
Step 9362 (32 ms): -199.41.
Step 9400 (16 ms): -299.13.

Epoch 25 (12.3 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -205.83, ENRE: -199.18, KL: 6.6571.
    Saving model parameters.
    Model parameters saved (97 ms).

Step 9438 (33 ms): -212.91.
Step 9475 (33 ms): -201.85.
Step 9513 (33 ms): -194.94.
Step 9550 (33 ms): -212.38.
Step 9588 (33 ms): -204.71.
Step 9626 (33 ms): -203.06.
Step 9663 (32 ms): -197.67.
Step 9701 (33 ms): -218.76.
Step 9738 (33 ms): -205.89.
Step 9776 (15 ms): -361.66.

Epoch 26 (12.3 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -205.49, ENRE: -198.81, KL: 6.6863.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 9814 (33 ms): -207.33.
Step 9851 (33 ms): -211.43.
Step 9889 (33 ms): -214.83.
Step 9926 (33 ms): -199.84.
Step 9964 (33 ms): -197.46.
Step 10002 (33 ms): -194.32.
Step 10039 (33 ms): -203.08.
Step 10077 (33 ms): -203.33.
Step 10114 (32 ms): -196.75.
Step 10152 (15 ms): -192.03.

Epoch 27 (12.4 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -205, ENRE: -198.51, KL: 6.4906.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 10190 (33 ms): -207.94.
Step 10227 (33 ms): -193.12.
Step 10265 (33 ms): -210.33.
Step 10302 (33 ms): -213.25.
Step 10340 (33 ms): -210.97.
Step 10378 (33 ms): -207.77.
Step 10415 (33 ms): -200.65.
Step 10453 (33 ms): -204.27.
Step 10490 (33 ms): -218.99.
Step 10528 (15 ms): -197.57.

Epoch 28 (12.3 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -204.57, ENRE: -198.01, KL: 6.565.
    Saving model parameters.
    Model parameters saved (97 ms).

Step 10566 (32 ms): -200.17.
Step 10603 (33 ms): -210.23.
Step 10641 (33 ms): -196.01.
Step 10678 (35 ms): -220.44.
Step 10716 (33 ms): -211.77.
Step 10754 (32 ms): -203.61.
Step 10791 (32 ms): -198.1.
Step 10829 (32 ms): -201.19.
Step 10866 (33 ms): -193.39.
Step 10904 (16 ms): -271.56.

Epoch 29 (12.3 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -204.74, ENRE: -198.14, KL: 6.5909.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 10942 (32 ms): -207.04.
Step 10979 (32 ms): -209.18.
Step 11017 (33 ms): -204.18.
Step 11054 (33 ms): -202.74.
Step 11092 (33 ms): -187.21.
Step 11130 (32 ms): -195.41.
Step 11167 (33 ms): -210.56.
Step 11205 (32 ms): -212.73.
Step 11242 (32 ms): -198.54.
Step 11280 (15 ms): -272.6.

Epoch 30 (12.2 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -203.95, ENRE: -197.48, KL: 6.4745.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 11318 (33 ms): -209.96.
Step 11355 (33 ms): -208.
Step 11393 (32 ms): -215.77.
Step 11430 (33 ms): -218.02.
Step 11468 (33 ms): -200.43.
Step 11506 (32 ms): -202.21.
Step 11543 (32 ms): -191.51.
Step 11581 (33 ms): -195.69.
Step 11618 (33 ms): -193.96.
Step 11656 (16 ms): -198.12.

Epoch 31 (12.3 s):
    Evaluating model.
    Full set (5.98 s): ELBO: -203.84, ENRE: -197.37, KL: 6.4662.
    Saving model parameters.
    Model parameters saved (100 ms).

Step 11694 (33 ms): -200.23.
Step 11731 (33 ms): -204.9.
Step 11769 (32 ms): -198.97.
Step 11806 (33 ms): -210.98.
Step 11844 (34 ms): -214.05.
Step 11882 (32 ms): -199.32.
Step 11919 (33 ms): -205.
Step 11957 (33 ms): -192.83.
Step 11994 (32 ms): -197.
Step 12032 (15 ms): -241.05.

Epoch 32 (12.3 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -203.65, ENRE: -197.16, KL: 6.4889.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 12070 (32 ms): -196.38.
Step 12107 (32 ms): -206.17.
Step 12145 (34 ms): -220.63.
Step 12182 (33 ms): -189.83.
Step 12220 (33 ms): -214.1.
Step 12258 (32 ms): -210.57.
Step 12295 (33 ms): -205.51.
Step 12333 (33 ms): -198.82.
Step 12370 (33 ms): -199.58.
Step 12408 (16 ms): -194.68.

Epoch 33 (12.4 s):
    Evaluating model.
    Full set (5.97 s): ELBO: -203.39, ENRE: -197.02, KL: 6.3708.
    Saving model parameters.
    Model parameters saved (97 ms).

Step 12446 (33 ms): -211.21.
Step 12483 (32 ms): -190.33.
Step 12521 (33 ms): -209.43.
Step 12558 (32 ms): -210.73.
Step 12596 (32 ms): -198.74.
Step 12634 (32 ms): -219.13.
Step 12671 (32 ms): -213.83.
Step 12709 (33 ms): -182.35.
Step 12746 (33 ms): -199.11.
Step 12784 (15 ms): -202.4.

Epoch 34 (12.3 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -203.59, ENRE: -197.01, KL: 6.5805.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 12822 (32 ms): -202.81.
Step 12859 (33 ms): -206.64.
Step 12897 (34 ms): -204.39.
Step 12934 (33 ms): -192.57.
Step 12972 (32 ms): -201.96.
Step 13010 (33 ms): -205.53.
Step 13047 (32 ms): -205.19.
Step 13085 (33 ms): -191.84.
Step 13122 (33 ms): -220.07.
Step 13160 (15 ms): -222.54.

Epoch 35 (12.2 s):
    Evaluating model.
    Full set (5.97 s): ELBO: -203.02, ENRE: -196.57, KL: 6.4509.
    Saving model parameters.
    Model parameters saved (97 ms).

Step 13198 (32 ms): -203.81.
Step 13235 (33 ms): -201.25.
Step 13273 (34 ms): -213.66.
Step 13310 (33 ms): -210.51.
Step 13348 (33 ms): -195.87.
Step 13386 (32 ms): -198.93.
Step 13423 (33 ms): -205.26.
Step 13461 (33 ms): -211.17.
Step 13498 (32 ms): -212.15.
Step 13536 (15 ms): -190.03.

Epoch 36 (12.2 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -202.76, ENRE: -196.26, KL: 6.499.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 13574 (33 ms): -203.95.
Step 13611 (32 ms): -194.9.
Step 13649 (32 ms): -203.19.
Step 13686 (32 ms): -197.2.
Step 13724 (32 ms): -213.19.
Step 13762 (33 ms): -197.46.
Step 13799 (32 ms): -206.88.
Step 13837 (32 ms): -198.78.
Step 13874 (32 ms): -209.74.
Step 13912 (16 ms): -201.39.

Epoch 37 (12.2 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -202.94, ENRE: -196.39, KL: 6.5526.
    Saving model parameters.
    Model parameters saved (99 ms).

Step 13950 (33 ms): -203.76.
Step 13987 (32 ms): -219.75.
Step 14025 (33 ms): -203.4.
Step 14062 (33 ms): -197.84.
Step 14100 (33 ms): -204.44.
Step 14138 (33 ms): -200.92.
Step 14175 (33 ms): -209.32.
Step 14213 (33 ms): -206.19.
Step 14250 (33 ms): -204.89.
Step 14288 (15 ms): -201.67.

Epoch 38 (12.4 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -202.19, ENRE: -195.73, KL: 6.4662.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 14326 (33 ms): -208.83.
Step 14363 (33 ms): -207.01.
Step 14401 (33 ms): -218.18.
Step 14438 (33 ms): -199.96.
Step 14476 (33 ms): -203.
Step 14514 (32 ms): -204.14.
Step 14551 (33 ms): -199.84.
Step 14589 (33 ms): -200.2.
Step 14626 (33 ms): -201.94.
Step 14664 (15 ms): -234.5.

Epoch 39 (12.3 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -202.22, ENRE: -195.88, KL: 6.3414.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 14702 (34 ms): -198.34.
Step 14739 (32 ms): -203.4.
Step 14777 (33 ms): -197.81.
Step 14814 (33 ms): -203.1.
Step 14852 (34 ms): -198.49.
Step 14890 (33 ms): -212.37.
Step 14927 (32 ms): -204.57.
Step 14965 (33 ms): -191.78.
Step 15002 (33 ms): -192.52.
Step 15040 (16 ms): -371.1.

Epoch 40 (12.4 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -202.36, ENRE: -195.92, KL: 6.4414.
    Saving model parameters.
    Model parameters saved (97 ms).

Step 15078 (32 ms): -208.42.
Step 15115 (32 ms): -200.54.
Step 15153 (33 ms): -208.19.
Step 15190 (33 ms): -206.56.
Step 15228 (33 ms): -201.5.
Step 15266 (32 ms): -197.21.
Step 15303 (32 ms): -206.75.
Step 15341 (33 ms): -198.31.
Step 15378 (32 ms): -211.45.
Step 15416 (15 ms): -195.13.

Epoch 41 (12.2 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -201.84, ENRE: -195.31, KL: 6.5281.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 15454 (32 ms): -192.02.
Step 15491 (32 ms): -212.04.
Step 15529 (33 ms): -204.86.
Step 15566 (32 ms): -212.94.
Step 15604 (32 ms): -194.23.
Step 15642 (32 ms): -202.75.
Step 15679 (32 ms): -203.08.
Step 15717 (33 ms): -198.53.
Step 15754 (32 ms): -213.59.
Step 15792 (15 ms): -180.

Epoch 42 (12.3 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -201.52, ENRE: -195.15, KL: 6.3708.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 15830 (33 ms): -192.35.
Step 15867 (32 ms): -192.3.
Step 15905 (33 ms): -199.04.
Step 15942 (33 ms): -191.7.
Step 15980 (33 ms): -198.94.
Step 16018 (33 ms): -202.92.
Step 16055 (32 ms): -205.54.
Step 16093 (32 ms): -192.64.
Step 16130 (32 ms): -203.32.
Step 16168 (15 ms): -240.07.

Epoch 43 (12.2 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -201.55, ENRE: -195.11, KL: 6.4378.
    Saving model parameters.
    Model parameters saved (97 ms).

Step 16206 (32 ms): -198.54.
Step 16243 (33 ms): -195.01.
Step 16281 (33 ms): -203.93.
Step 16318 (33 ms): -190.72.
Step 16356 (33 ms): -201.55.
Step 16394 (33 ms): -192.78.
Step 16431 (33 ms): -196.49.
Step 16469 (33 ms): -199.88.
Step 16506 (33 ms): -213.33.
Step 16544 (16 ms): -187.91.

Epoch 44 (12.4 s):
    Evaluating model.
    Full set (5.98 s): ELBO: -201.27, ENRE: -194.86, KL: 6.4145.
    Saving model parameters.
    Model parameters saved (97 ms).

Step 16582 (33 ms): -202.74.
Step 16619 (33 ms): -204.76.
Step 16657 (33 ms): -197.03.
Step 16694 (33 ms): -209.32.
Step 16732 (32 ms): -205.76.
Step 16770 (33 ms): -191.12.
Step 16807 (33 ms): -203.51.
Step 16845 (32 ms): -202.67.
Step 16882 (33 ms): -196.47.
Step 16920 (15 ms): -281.08.

Epoch 45 (12.3 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -201.35, ENRE: -194.81, KL: 6.5401.
    Saving model parameters.
    Model parameters saved (97 ms).

Step 16958 (32 ms): -182.48.
Step 16995 (32 ms): -197.16.
Step 17033 (33 ms): -203.69.
Step 17070 (33 ms): -194.9.
Step 17108 (32 ms): -211.45.
Step 17146 (33 ms): -194.8.
Step 17183 (33 ms): -211.04.
Step 17221 (33 ms): -212.97.
Step 17258 (33 ms): -205.63.
Step 17296 (16 ms): -204.66.

Epoch 46 (12.3 s):
    Evaluating model.
    Full set (5.97 s): ELBO: -201.09, ENRE: -194.63, KL: 6.4599.
    Saving model parameters.
    Model parameters saved (100 ms).

Step 17334 (32 ms): -203.98.
Step 17371 (33 ms): -210.75.
Step 17409 (33 ms): -199.23.
Step 17446 (33 ms): -193.32.
Step 17484 (32 ms): -202.92.
Step 17522 (32 ms): -201.26.
Step 17559 (32 ms): -200.88.
Step 17597 (32 ms): -189.95.
Step 17634 (33 ms): -210.6.
Step 17672 (15 ms): -196.63.

Epoch 47 (12.3 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -200.9, ENRE: -194.46, KL: 6.4371.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 17710 (32 ms): -193.15.
Step 17747 (32 ms): -207.98.
Step 17785 (33 ms): -197.12.
Step 17822 (33 ms): -198.94.
Step 17860 (33 ms): -202.54.
Step 17898 (32 ms): -200.85.
Step 17935 (32 ms): -209.48.
Step 17973 (33 ms): -209.55.
Step 18010 (32 ms): -195.68.
Step 18048 (15 ms): -213.71.

Epoch 48 (12.2 s):
    Evaluating model.
    Full set (5.96 s): ELBO: -200.89, ENRE: -194.43, KL: 6.4608.
    Saving model parameters.
    Model parameters saved (99 ms).

Step 18086 (33 ms): -206.91.
Step 18123 (32 ms): -199.37.
Step 18161 (33 ms): -196.87.
Step 18198 (32 ms): -189.57.
Step 18236 (32 ms): -207.2.
Step 18274 (32 ms): -199.84.
Step 18311 (32 ms): -205.25.
Step 18349 (33 ms): -191.89.
Step 18386 (32 ms): -200.6.
Step 18424 (15 ms): -204.9.

Epoch 49 (12.3 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -200.59, ENRE: -194.2, KL: 6.3966.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 18462 (33 ms): -207.66.
Step 18499 (33 ms): -188.94.
Step 18537 (33 ms): -208.31.
Step 18574 (32 ms): -200.7.
Step 18612 (33 ms): -198.58.
Step 18650 (33 ms): -192.89.
Step 18687 (33 ms): -213.21.
Step 18725 (33 ms): -189.08.
Step 18762 (33 ms): -192.45.
Step 18800 (15 ms): -209.01.

Epoch 50 (12.3 s):
    Evaluating model.
    Full set (5.96 s): ELBO: -201.19, ENRE: -194.72, KL: 6.4655.
    Saving model parameters.
    Model parameters saved (90 ms).

Model trained for 50 epochs (15m 22s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (862 ms).

Converting data set value array to sparse matrix.
Data set value array converted (272 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.99 s):  ELBO: -422.47, ENRE: -416.02, KL: 6.4506.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (644 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.4757285333808614
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 57
kl weight: 1.4757285333808614
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (49 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.07 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.72 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 57
    hidden sizes: 248, 249, 139
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.4757285333808614
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 3 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 248)
    ENCODER/1/DENSE/biases:0             (248,)
    ENCODER/1/BATCH_NORM/beta:0          (248,)
    ENCODER/2/DENSE/weights:0            (248, 249)
    ENCODER/2/DENSE/biases:0             (249,)
    ENCODER/2/BATCH_NORM/beta:0          (249,)
    ENCODER/3/DENSE/weights:0            (249, 139)
    ENCODER/3/DENSE/biases:0             (139,)
    ENCODER/3/BATCH_NORM/beta:0          (139,)
    POSTERIOR/MU/DENSE/weights:0         (139, 57)
    POSTERIOR/MU/DENSE/biases:0          (57,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (139, 57)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (57,)
    DECODER/3/DENSE/weights:0            (57, 139)
    DECODER/3/DENSE/biases:0             (139,)
    DECODER/3/BATCH_NORM/beta:0          (139,)
    DECODER/2/DENSE/weights:0            (139, 249)
    DECODER/2/DENSE/biases:0             (249,)
    DECODER/2/BATCH_NORM/beta:0          (249,)
    DECODER/1/DENSE/weights:0            (249, 248)
    DECODER/1/DENSE/biases:0             (248,)
    DECODER/1/BATCH_NORM/beta:0          (248,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (248, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (392 ms).

Training model for 50 epochs on original values.

Step 38 (34 ms): -2070.2.
Step 75 (33 ms): -1579.
Step 113 (33 ms): -1258.
Step 150 (33 ms): -1024.1.
Step 188 (33 ms): -889.36.
Step 226 (33 ms): -742.32.
Step 263 (33 ms): -663.7.
Step 301 (33 ms): -573.76.
Step 338 (34 ms): -538.1.
Step 376 (18 ms): -438.12.

Epoch 1 (14.6 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.4 s): ELBO: -1660.6, ENRE: -1607.4, KL: 53.202.
    Saving model parameters.
    Model parameters saved (146 ms).

Step 414 (33 ms): -442.63.
Step 451 (33 ms): -404.71.
Step 489 (33 ms): -375.82.
Step 526 (33 ms): -385.1.
Step 564 (34 ms): -351.26.
Step 602 (33 ms): -338.35.
Step 639 (33 ms): -315.37.
Step 677 (33 ms): -318.7.
Step 714 (33 ms): -300.38.
Step 752 (16 ms): -281.26.

Epoch 2 (12.5 s):
    Warm-up weight: 0.33
    Evaluating model.
    Full set (5.93 s): ELBO: -964.89, ENRE: -940.98, KL: 23.914.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 790 (33 ms): -282.05.
Step 827 (33 ms): -275.01.
Step 865 (32 ms): -278.35.
Step 902 (33 ms): -251.38.
Step 940 (32 ms): -256.09.
Step 978 (33 ms): -255.78.
Step 1015 (35 ms): -266.71.
Step 1053 (32 ms): -255.95.
Step 1090 (33 ms): -247.66.
Step 1128 (17 ms): -271.68.

Epoch 3 (12.3 s):
    Warm-up weight: 0.67
    Evaluating model.
    Full set (5.91 s): ELBO: -554.47, ENRE: -539.49, KL: 14.978.
    Saving model parameters.
    Model parameters saved (100 ms).

Step 1166 (33 ms): -253.54.
Step 1203 (33 ms): -245.78.
Step 1241 (33 ms): -256.14.
Step 1278 (33 ms): -251.77.
Step 1316 (33 ms): -324.49.
Step 1354 (33 ms): -229.82.
Step 1391 (33 ms): -240.28.
Step 1429 (33 ms): -234.45.
Step 1466 (34 ms): -251.65.
Step 1504 (16 ms): -286.71.

Epoch 4 (12.4 s):
    Evaluating model.
    Full set (5.96 s): ELBO: -385.86, ENRE: -374.49, KL: 11.365.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 1542 (33 ms): -226.23.
Step 1579 (33 ms): -232.99.
Step 1617 (34 ms): -250.9.
Step 1654 (33 ms): -237.82.
Step 1692 (33 ms): -233.16.
Step 1730 (33 ms): -268.84.
Step 1767 (33 ms): -231.33.
Step 1805 (33 ms): -219.6.
Step 1842 (32 ms): -230.3.
Step 1880 (16 ms): -330.13.

Epoch 5 (12.4 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -295.76, ENRE: -285.72, KL: 10.041.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 1918 (33 ms): -243.24.
Step 1955 (33 ms): -215.08.
Step 1993 (32 ms): -227.69.
Step 2030 (32 ms): -222.45.
Step 2068 (33 ms): -230.22.
Step 2106 (34 ms): -233.05.
Step 2143 (32 ms): -232.35.
Step 2181 (33 ms): -217.01.
Step 2218 (33 ms): -222.39.
Step 2256 (16 ms): -297.6.

Epoch 6 (12.3 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -255.66, ENRE: -246.43, KL: 9.2298.
    Saving model parameters.
    Model parameters saved (99 ms).

Step 2294 (33 ms): -223.29.
Step 2331 (33 ms): -231.26.
Step 2369 (33 ms): -205.91.
Step 2406 (34 ms): -228.85.
Step 2444 (32 ms): -218.93.
Step 2482 (33 ms): -217.53.
Step 2519 (33 ms): -214.31.
Step 2557 (32 ms): -203.94.
Step 2594 (34 ms): -220.58.
Step 2632 (15 ms): -295.7.

Epoch 7 (12.3 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -238.03, ENRE: -229.72, KL: 8.3142.
    Saving model parameters.
    Model parameters saved (88 ms).

Step 2670 (32 ms): -234.85.
Step 2707 (32 ms): -236.21.
Step 2745 (33 ms): -224.26.
Step 2782 (32 ms): -216.44.
Step 2820 (33 ms): -215.67.
Step 2858 (32 ms): -227.38.
Step 2895 (33 ms): -211.85.
Step 2933 (32 ms): -217.57.
Step 2970 (33 ms): -213.61.
Step 3008 (15 ms): -228.94.

Epoch 8 (12.3 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -226.08, ENRE: -217.75, KL: 8.3277.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 3046 (33 ms): -216.18.
Step 3083 (32 ms): -220.92.
Step 3121 (33 ms): -204.77.
Step 3158 (33 ms): -237.6.
Step 3196 (33 ms): -226.62.
Step 3234 (33 ms): -217.85.
Step 3271 (33 ms): -206.65.
Step 3309 (33 ms): -224.02.
Step 3346 (33 ms): -210.79.
Step 3384 (16 ms): -439.74.

Epoch 9 (12.3 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -221.02, ENRE: -212.99, KL: 8.0286.
    Saving model parameters.
    Model parameters saved (100 ms).

Step 3422 (33 ms): -208.94.
Step 3459 (33 ms): -215.66.
Step 3497 (32 ms): -203.16.
Step 3534 (33 ms): -225.25.
Step 3572 (32 ms): -217.64.
Step 3610 (33 ms): -213.86.
Step 3647 (32 ms): -229.41.
Step 3685 (33 ms): -209.13.
Step 3722 (33 ms): -209.08.
Step 3760 (16 ms): -236.59.

Epoch 10 (12.3 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -219, ENRE: -211.17, KL: 7.8239.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 3798 (33 ms): -218.76.
Step 3835 (33 ms): -201.94.
Step 3873 (33 ms): -212.86.
Step 3910 (33 ms): -206.02.
Step 3948 (33 ms): -209.23.
Step 3986 (33 ms): -212.73.
Step 4023 (33 ms): -223.41.
Step 4061 (33 ms): -216.74.
Step 4098 (33 ms): -227.12.
Step 4136 (16 ms): -293.93.

Epoch 11 (12.4 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -216.77, ENRE: -209.21, KL: 7.5656.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 4174 (32 ms): -218.55.
Step 4211 (33 ms): -211.39.
Step 4249 (33 ms): -222.51.
Step 4286 (33 ms): -211.9.
Step 4324 (33 ms): -221.73.
Step 4362 (33 ms): -206.
Step 4399 (33 ms): -220.81.
Step 4437 (32 ms): -204.08.
Step 4474 (32 ms): -222.51.
Step 4512 (16 ms): -187.34.

Epoch 12 (12.3 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -215.03, ENRE: -207.47, KL: 7.5635.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 4550 (33 ms): -227.65.
Step 4587 (33 ms): -202.76.
Step 4625 (33 ms): -210.98.
Step 4662 (33 ms): -213.04.
Step 4700 (33 ms): -205.88.
Step 4738 (33 ms): -202.64.
Step 4775 (33 ms): -208.53.
Step 4813 (33 ms): -202.17.
Step 4850 (33 ms): -216.96.
Step 4888 (15 ms): -269.09.

Epoch 13 (12.4 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -213.79, ENRE: -206.37, KL: 7.4179.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 4926 (32 ms): -219.76.
Step 4963 (32 ms): -213.58.
Step 5001 (33 ms): -217.44.
Step 5038 (32 ms): -202.32.
Step 5076 (33 ms): -210.77.
Step 5114 (32 ms): -203.63.
Step 5151 (32 ms): -220.41.
Step 5189 (32 ms): -216.92.
Step 5226 (32 ms): -217.09.
Step 5264 (15 ms): -213.38.

Epoch 14 (12.2 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -213.27, ENRE: -205.91, KL: 7.3643.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 5302 (33 ms): -208.87.
Step 5339 (33 ms): -207.68.
Step 5377 (32 ms): -215.19.
Step 5414 (32 ms): -199.88.
Step 5452 (32 ms): -201.84.
Step 5490 (33 ms): -219.6.
Step 5527 (33 ms): -213.78.
Step 5565 (33 ms): -223.87.
Step 5602 (33 ms): -209.01.
Step 5640 (16 ms): -446.94.

Epoch 15 (12.3 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -212.26, ENRE: -204.79, KL: 7.4748.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 5678 (32 ms): -205.18.
Step 5715 (32 ms): -210.87.
Step 5753 (34 ms): -198.6.
Step 5790 (32 ms): -210.05.
Step 5828 (33 ms): -201.42.
Step 5866 (32 ms): -212.65.
Step 5903 (33 ms): -214.08.
Step 5941 (32 ms): -210.89.
Step 5978 (34 ms): -221.88.
Step 6016 (15 ms): -269.8.

Epoch 16 (12.2 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -211.24, ENRE: -204.01, KL: 7.2301.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 6054 (33 ms): -208.29.
Step 6091 (33 ms): -202.33.
Step 6129 (33 ms): -202.72.
Step 6166 (34 ms): -208.94.
Step 6204 (34 ms): -207.19.
Step 6242 (33 ms): -199.93.
Step 6279 (33 ms): -216.24.
Step 6317 (32 ms): -215.79.
Step 6354 (33 ms): -224.32.
Step 6392 (16 ms): -248.74.

Epoch 17 (12.4 s):
    Evaluating model.
    Full set (5.97 s): ELBO: -210.83, ENRE: -203.88, KL: 6.9431.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 6430 (33 ms): -211.13.
Step 6467 (33 ms): -211.8.
Step 6505 (33 ms): -208.32.
Step 6542 (33 ms): -211.3.
Step 6580 (33 ms): -217.85.
Step 6618 (33 ms): -204.76.
Step 6655 (33 ms): -203.32.
Step 6693 (33 ms): -206.88.
Step 6730 (34 ms): -218.23.
Step 6768 (16 ms): -258.44.

Epoch 18 (12.4 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -209.84, ENRE: -202.88, KL: 6.9672.
    Saving model parameters.
    Model parameters saved (97 ms).

Step 6806 (33 ms): -212.03.
Step 6843 (33 ms): -203.48.
Step 6881 (33 ms): -210.53.
Step 6918 (33 ms): -214.92.
Step 6956 (34 ms): -218.78.
Step 6994 (32 ms): -207.22.
Step 7031 (33 ms): -215.66.
Step 7069 (33 ms): -205.15.
Step 7106 (33 ms): -203.91.
Step 7144 (16 ms): -290.83.

Epoch 19 (12.4 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -209.43, ENRE: -202.52, KL: 6.9115.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 7182 (32 ms): -212.36.
Step 7219 (33 ms): -210.97.
Step 7257 (33 ms): -207.51.
Step 7294 (33 ms): -209.54.
Step 7332 (33 ms): -216.21.
Step 7370 (33 ms): -207.84.
Step 7407 (33 ms): -208.67.
Step 7445 (33 ms): -203.89.
Step 7482 (33 ms): -208.64.
Step 7520 (16 ms): -203.66.

Epoch 20 (12.3 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -208.59, ENRE: -201.88, KL: 6.7113.
    Saving model parameters.
    Model parameters saved (97 ms).

Step 7558 (32 ms): -211.55.
Step 7595 (32 ms): -204.09.
Step 7633 (32 ms): -199.5.
Step 7670 (33 ms): -223.85.
Step 7708 (32 ms): -207.36.
Step 7746 (32 ms): -211.54.
Step 7783 (32 ms): -213.64.
Step 7821 (32 ms): -218.95.
Step 7858 (33 ms): -201.83.
Step 7896 (15 ms): -213.52.

Epoch 21 (12.2 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -208.33, ENRE: -201.68, KL: 6.6476.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 7934 (32 ms): -205.38.
Step 7971 (33 ms): -215.45.
Step 8009 (33 ms): -210.
Step 8046 (33 ms): -216.86.
Step 8084 (33 ms): -219.3.
Step 8122 (34 ms): -203.13.
Step 8159 (33 ms): -200.27.
Step 8197 (33 ms): -213.87.
Step 8234 (33 ms): -209.67.
Step 8272 (15 ms): -227.28.

Epoch 22 (12.3 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -208.31, ENRE: -201.82, KL: 6.4917.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 8310 (32 ms): -197.25.
Step 8347 (32 ms): -205.98.
Step 8385 (32 ms): -211.76.
Step 8422 (32 ms): -201.66.
Step 8460 (32 ms): -200.77.
Step 8498 (32 ms): -200.74.
Step 8535 (33 ms): -220.11.
Step 8573 (32 ms): -204.55.
Step 8610 (33 ms): -205.47.
Step 8648 (15 ms): -191.44.

Epoch 23 (12.2 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -207.45, ENRE: -200.94, KL: 6.513.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 8686 (33 ms): -213.97.
Step 8723 (33 ms): -210.81.
Step 8761 (33 ms): -205.31.
Step 8798 (33 ms): -203.17.
Step 8836 (33 ms): -221.9.
Step 8874 (33 ms): -219.69.
Step 8911 (33 ms): -207.14.
Step 8949 (33 ms): -211.5.
Step 8986 (33 ms): -204.56.
Step 9024 (16 ms): -398.93.

Epoch 24 (12.4 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -207.09, ENRE: -200.67, KL: 6.414.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 9062 (32 ms): -198.87.
Step 9099 (33 ms): -201.56.
Step 9137 (33 ms): -206.61.
Step 9174 (33 ms): -211.75.
Step 9212 (33 ms): -196.36.
Step 9250 (33 ms): -212.32.
Step 9287 (33 ms): -209.47.
Step 9325 (33 ms): -193.35.
Step 9362 (33 ms): -213.01.
Step 9400 (16 ms): -223.59.

Epoch 25 (12.4 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -206.57, ENRE: -200.1, KL: 6.467.
    Saving model parameters.
    Model parameters saved (99 ms).

Step 9438 (33 ms): -216.9.
Step 9475 (33 ms): -200.03.
Step 9513 (33 ms): -212.11.
Step 9550 (33 ms): -210.05.
Step 9588 (33 ms): -191.34.
Step 9626 (33 ms): -200.28.
Step 9663 (32 ms): -192.91.
Step 9701 (33 ms): -202.59.
Step 9738 (33 ms): -205.28.
Step 9776 (16 ms): -216.28.

Epoch 26 (12.4 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -205.91, ENRE: -199.55, KL: 6.3546.
    Saving model parameters.
    Model parameters saved (98 ms).

Step 9814 (32 ms): -207.94.
Step 9851 (33 ms): -201.01.
Step 9889 (32 ms): -206.43.
Step 9926 (33 ms): -226.1.
Step 9964 (32 ms): -209.53.
Step 10002 (33 ms): -212.09.
Step 10039 (33 ms): -207.11.
Step 10077 (32 ms): -208.43.
Step 10114 (33 ms): -202.84.
Step 10152 (15 ms): -548.43.

Epoch 27 (12.3 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -206, ENRE: -199.76, KL: 6.2443.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 10190 (33 ms): -197.71.
Step 10227 (33 ms): -195.36.
Step 10265 (32 ms): -199.25.
Step 10302 (32 ms): -205.27.
Step 10340 (34 ms): -192.89.
Step 10378 (32 ms): -205.25.
Step 10415 (33 ms): -214.35.
Step 10453 (33 ms): -217.47.
Step 10490 (33 ms): -195.76.
Step 10528 (16 ms): -198.29.

Epoch 28 (12.3 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -205.5, ENRE: -199.13, KL: 6.3617.
    Saving model parameters.
    Model parameters saved (99 ms).

Step 10566 (32 ms): -196.52.
Step 10603 (34 ms): -210.41.
Step 10641 (32 ms): -201.66.
Step 10678 (33 ms): -213.69.
Step 10716 (33 ms): -206.
Step 10754 (32 ms): -200.74.
Step 10791 (33 ms): -205.32.
Step 10829 (33 ms): -199.07.
Step 10866 (32 ms): -200.17.
Step 10904 (15 ms): -285.9.

Epoch 29 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -205.17, ENRE: -198.87, KL: 6.2925.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 10942 (32 ms): -198.22.
Step 10979 (33 ms): -223.07.
Step 11017 (32 ms): -193.88.
Step 11054 (33 ms): -193.61.
Step 11092 (33 ms): -202.07.
Step 11130 (33 ms): -213.83.
Step 11167 (33 ms): -198.85.
Step 11205 (33 ms): -215.95.
Step 11242 (33 ms): -206.39.
Step 11280 (16 ms): -216.64.

Epoch 30 (12.3 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -204.71, ENRE: -198.52, KL: 6.1895.
    Saving model parameters.
    Model parameters saved (100 ms).

Step 11318 (33 ms): -210.7.
Step 11355 (33 ms): -210.88.
Step 11393 (33 ms): -193.96.
Step 11430 (33 ms): -203.55.
Step 11468 (33 ms): -193.41.
Step 11506 (32 ms): -196.83.
Step 11543 (34 ms): -201.59.
Step 11581 (33 ms): -226.52.
Step 11618 (32 ms): -209.
Step 11656 (16 ms): -186.11.

Epoch 31 (12.4 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -204.6, ENRE: -198.51, KL: 6.0854.
    Saving model parameters.
    Model parameters saved (89 ms).

Step 11694 (33 ms): -197.18.
Step 11731 (33 ms): -213.83.
Step 11769 (33 ms): -200.28.
Step 11806 (33 ms): -194.48.
Step 11844 (32 ms): -204.26.
Step 11882 (33 ms): -196.39.
Step 11919 (33 ms): -212.01.
Step 11957 (33 ms): -188.96.
Step 11994 (33 ms): -224.44.
Step 12032 (16 ms): -201.96.

Epoch 32 (12.4 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -204.22, ENRE: -198.08, KL: 6.1377.
    Saving model parameters.
    Model parameters saved (99 ms).

Step 12070 (33 ms): -206.11.
Step 12107 (33 ms): -211.43.
Step 12145 (33 ms): -206.86.
Step 12182 (34 ms): -198.09.
Step 12220 (33 ms): -214.41.
Step 12258 (33 ms): -203.52.
Step 12295 (34 ms): -195.64.
Step 12333 (33 ms): -203.06.
Step 12370 (32 ms): -196.43.
Step 12408 (16 ms): -221.98.

Epoch 33 (12.4 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -204.07, ENRE: -197.91, KL: 6.1638.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 12446 (33 ms): -207.44.
Step 12483 (33 ms): -204.18.
Step 12521 (32 ms): -207.93.
Step 12558 (32 ms): -205.05.
Step 12596 (32 ms): -214.76.
Step 12634 (32 ms): -194.29.
Step 12671 (33 ms): -199.9.
Step 12709 (32 ms): -203.26.
Step 12746 (33 ms): -207.35.
Step 12784 (16 ms): -261.85.

Epoch 34 (12.3 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -203.52, ENRE: -197.48, KL: 6.0421.
    Saving model parameters.
    Model parameters saved (97 ms).

Step 12822 (32 ms): -208.94.
Step 12859 (33 ms): -216.63.
Step 12897 (33 ms): -205.94.
Step 12934 (33 ms): -190.05.
Step 12972 (33 ms): -207.19.
Step 13010 (32 ms): -188.
Step 13047 (33 ms): -204.5.
Step 13085 (33 ms): -192.31.
Step 13122 (32 ms): -203.4.
Step 13160 (16 ms): -236.3.

Epoch 35 (12.3 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -203.16, ENRE: -197.04, KL: 6.114.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 13198 (32 ms): -196.66.
Step 13235 (32 ms): -191.49.
Step 13273 (32 ms): -192.34.
Step 13310 (32 ms): -190.55.
Step 13348 (32 ms): -206.92.
Step 13386 (32 ms): -204.77.
Step 13423 (33 ms): -191.39.
Step 13461 (32 ms): -186.54.
Step 13498 (32 ms): -210.33.
Step 13536 (16 ms): -192.01.

Epoch 36 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -203.23, ENRE: -197.18, KL: 6.044.
    Saving model parameters.
    Model parameters saved (101 ms).

Step 13574 (33 ms): -203.02.
Step 13611 (33 ms): -203.57.
Step 13649 (33 ms): -203.68.
Step 13686 (33 ms): -185.54.
Step 13724 (35 ms): -211.39.
Step 13762 (33 ms): -214.1.
Step 13799 (33 ms): -206.03.
Step 13837 (33 ms): -199.57.
Step 13874 (33 ms): -199.02.
Step 13912 (16 ms): -312.07.

Epoch 37 (12.4 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -203.06, ENRE: -197.16, KL: 5.9032.
    Saving model parameters.
    Model parameters saved (91 ms).

Step 13950 (33 ms): -196.4.
Step 13987 (33 ms): -200.53.
Step 14025 (33 ms): -190.71.
Step 14062 (33 ms): -193.13.
Step 14100 (33 ms): -206.53.
Step 14138 (32 ms): -212.81.
Step 14175 (33 ms): -202.48.
Step 14213 (33 ms): -206.69.
Step 14250 (33 ms): -200.57.
Step 14288 (16 ms): -259.73.

Epoch 38 (12.3 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -202.99, ENRE: -196.98, KL: 6.0156.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 14326 (33 ms): -192.18.
Step 14363 (32 ms): -199.95.
Step 14401 (34 ms): -199.83.
Step 14438 (33 ms): -205.13.
Step 14476 (33 ms): -207.31.
Step 14514 (33 ms): -212.06.
Step 14551 (33 ms): -187.9.
Step 14589 (33 ms): -207.56.
Step 14626 (33 ms): -204.62.
Step 14664 (16 ms): -249.4.

Epoch 39 (12.4 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -202.41, ENRE: -196.39, KL: 6.024.
    Saving model parameters.
    Model parameters saved (90 ms).

Step 14702 (33 ms): -208.94.
Step 14739 (32 ms): -210.89.
Step 14777 (32 ms): -200.45.
Step 14814 (33 ms): -195.65.
Step 14852 (32 ms): -204.49.
Step 14890 (32 ms): -197.93.
Step 14927 (32 ms): -195.79.
Step 14965 (32 ms): -194.52.
Step 15002 (33 ms): -202.91.
Step 15040 (16 ms): -245.04.

Epoch 40 (12.3 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -202.28, ENRE: -196.31, KL: 5.966.
    Saving model parameters.
    Model parameters saved (92 ms).

Step 15078 (32 ms): -195.5.
Step 15115 (33 ms): -188.59.
Step 15153 (32 ms): -186.84.
Step 15190 (33 ms): -215.38.
Step 15228 (32 ms): -195.53.
Step 15266 (32 ms): -211.23.
Step 15303 (33 ms): -202.57.
Step 15341 (32 ms): -203.15.
Step 15378 (32 ms): -191.53.
Step 15416 (16 ms): -173.8.

Epoch 41 (12.3 s):
    Evaluating model.
    Full set (5.93 s): ELBO: -202.13, ENRE: -196.26, KL: 5.8698.
    Saving model parameters.
    Model parameters saved (95 ms).

Step 15454 (33 ms): -204.92.
Step 15491 (32 ms): -197.74.
Step 15529 (33 ms): -200.85.
Step 15566 (32 ms): -199.01.
Step 15604 (32 ms): -197.95.
Step 15642 (33 ms): -206.46.
Step 15679 (33 ms): -190.06.
Step 15717 (32 ms): -206.58.
Step 15754 (32 ms): -190.12.
Step 15792 (15 ms): -211.69.

Epoch 42 (12.3 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -202.09, ENRE: -196.2, KL: 5.8901.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 15830 (32 ms): -210.94.
Step 15867 (32 ms): -192.74.
Step 15905 (32 ms): -193.99.
Step 15942 (33 ms): -202.24.
Step 15980 (33 ms): -197.26.
Step 16018 (33 ms): -206.85.
Step 16055 (33 ms): -215.23.
Step 16093 (32 ms): -203.78.
Step 16130 (33 ms): -183.11.
Step 16168 (16 ms): -203.54.

Epoch 43 (12.3 s):
    Evaluating model.
    Full set (5.97 s): ELBO: -202.02, ENRE: -196.14, KL: 5.8831.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 16206 (33 ms): -195.25.
Step 16243 (33 ms): -199.91.
Step 16281 (34 ms): -196.05.
Step 16318 (34 ms): -197.84.
Step 16356 (33 ms): -196.51.
Step 16394 (33 ms): -200.96.
Step 16431 (33 ms): -214.57.
Step 16469 (33 ms): -214.01.
Step 16506 (34 ms): -201.03.
Step 16544 (16 ms): -270.8.

Epoch 44 (12.4 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -201.82, ENRE: -195.95, KL: 5.8633.
    Saving model parameters.
    Model parameters saved (96 ms).

Step 16582 (33 ms): -200.41.
Step 16619 (32 ms): -196.06.
Step 16657 (33 ms): -197.33.
Step 16694 (33 ms): -204.09.
Step 16732 (33 ms): -193.45.
Step 16770 (32 ms): -211.65.
Step 16807 (33 ms): -220.
Step 16845 (32 ms): -187.66.
Step 16882 (34 ms): -235.27.
Step 16920 (16 ms): -210.72.

Epoch 45 (12.3 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -201.65, ENRE: -195.65, KL: 5.9918.
    Saving model parameters.
    Model parameters saved (100 ms).

Step 16958 (33 ms): -194.53.
Step 16995 (33 ms): -200.83.
Step 17033 (33 ms): -188.06.
Step 17070 (33 ms): -190.
Step 17108 (32 ms): -204.59.
Step 17146 (34 ms): -198.18.
Step 17183 (32 ms): -198.11.
Step 17221 (33 ms): -193.69.
Step 17258 (33 ms): -196.76.
Step 17296 (16 ms): -196.77.

Epoch 46 (12.4 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -201.72, ENRE: -195.82, KL: 5.909.
    Saving model parameters.
    Model parameters saved (97 ms).

Step 17334 (33 ms): -201.16.
Step 17371 (32 ms): -207.09.
Step 17409 (32 ms): -214.97.
Step 17446 (34 ms): -210.62.
Step 17484 (33 ms): -201.75.
Step 17522 (32 ms): -192.17.
Step 17559 (33 ms): -208.13.
Step 17597 (32 ms): -206.47.
Step 17634 (33 ms): -192.03.
Step 17672 (15 ms): -225.84.

Epoch 47 (12.3 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -201.46, ENRE: -195.6, KL: 5.8546.
    Saving model parameters.
    Model parameters saved (94 ms).

Step 17710 (33 ms): -205.44.
Step 17747 (33 ms): -189.33.
Step 17785 (33 ms): -197.65.
Step 17822 (32 ms): -215.83.
Step 17860 (32 ms): -186.12.
Step 17898 (32 ms): -214.54.
Step 17935 (33 ms): -191.08.
Step 17973 (33 ms): -200.03.
Step 18010 (33 ms): -200.57.
Step 18048 (16 ms): -237.9.

Epoch 48 (12.3 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -201.33, ENRE: -195.39, KL: 5.9425.
    Saving model parameters.
    Model parameters saved (100 ms).

Step 18086 (32 ms): -201.14.
Step 18123 (32 ms): -200.03.
Step 18161 (33 ms): -183.61.
Step 18198 (33 ms): -201.09.
Step 18236 (33 ms): -186.79.
Step 18274 (34 ms): -214.6.
Step 18311 (33 ms): -205.36.
Step 18349 (34 ms): -199.23.
Step 18386 (32 ms): -194.
Step 18424 (16 ms): -298.52.

Epoch 49 (12.3 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -201.27, ENRE: -195.43, KL: 5.8412.
    Saving model parameters.
    Model parameters saved (93 ms).

Step 18462 (33 ms): -208.
Step 18499 (33 ms): -205.08.
Step 18537 (33 ms): -214.86.
Step 18574 (33 ms): -201.44.
Step 18612 (33 ms): -204.45.
Step 18650 (33 ms): -200.33.
Step 18687 (33 ms): -203.6.
Step 18725 (34 ms): -199.05.
Step 18762 (33 ms): -214.62.
Step 18800 (16 ms): -284.95.

Epoch 50 (12.4 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -201.22, ENRE: -195.27, KL: 5.9562.
    Saving model parameters.
    Model parameters saved (94 ms).

Model trained for 50 epochs (15m 23s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (906 ms).

Converting data set value array to sparse matrix.
Data set value array converted (310 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.75 s):  ELBO: -422.93, ENRE: -416.98, KL: 5.9475.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (627 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.18141903276043
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 35
kl weight: 1.18141903276043
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (48 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.33 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.89 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 35
    hidden sizes: 170, 216, 179, 196
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.18141903276043
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 2 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 170)
    ENCODER/1/DENSE/biases:0             (170,)
    ENCODER/1/BATCH_NORM/beta:0          (170,)
    ENCODER/2/DENSE/weights:0            (170, 216)
    ENCODER/2/DENSE/biases:0             (216,)
    ENCODER/2/BATCH_NORM/beta:0          (216,)
    ENCODER/3/DENSE/weights:0            (216, 179)
    ENCODER/3/DENSE/biases:0             (179,)
    ENCODER/3/BATCH_NORM/beta:0          (179,)
    ENCODER/4/DENSE/weights:0            (179, 196)
    ENCODER/4/DENSE/biases:0             (196,)
    ENCODER/4/BATCH_NORM/beta:0          (196,)
    POSTERIOR/MU/DENSE/weights:0         (196, 35)
    POSTERIOR/MU/DENSE/biases:0          (35,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (196, 35)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (35,)
    DECODER/4/DENSE/weights:0            (35, 196)
    DECODER/4/DENSE/biases:0             (196,)
    DECODER/4/BATCH_NORM/beta:0          (196,)
    DECODER/3/DENSE/weights:0            (196, 179)
    DECODER/3/DENSE/biases:0             (179,)
    DECODER/3/BATCH_NORM/beta:0          (179,)
    DECODER/2/DENSE/weights:0            (179, 216)
    DECODER/2/DENSE/biases:0             (216,)
    DECODER/2/BATCH_NORM/beta:0          (216,)
    DECODER/1/DENSE/weights:0            (216, 170)
    DECODER/1/DENSE/biases:0             (170,)
    DECODER/1/BATCH_NORM/beta:0          (170,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (170, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (702 ms).

Training model for 50 epochs on original values.

Step 38 (33 ms): -2179.1.
Step 75 (34 ms): -1839.6.
Step 113 (33 ms): -1568.3.
Step 150 (32 ms): -1390.4.
Step 188 (32 ms): -1236.6.
Step 226 (32 ms): -1128.
Step 263 (32 ms): -1052.8.
Step 301 (33 ms): -923.16.
Step 338 (33 ms): -843.2.
Step 376 (19 ms): -785.72.

Epoch 1 (14.8 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.49 s): ELBO: -1791.3, ENRE: -1693.2, KL: 98.112.
    Saving model parameters.
    Model parameters saved (176 ms).

Step 414 (33 ms): -630.82.
Step 451 (32 ms): -520.25.
Step 489 (32 ms): -466.54.
Step 526 (32 ms): -438.27.
Step 564 (32 ms): -392.98.
Step 602 (33 ms): -435.85.
Step 639 (32 ms): -374.39.
Step 677 (32 ms): -374.41.
Step 714 (31 ms): -333.76.
Step 752 (18 ms): -419.21.

Epoch 2 (12.1 s):
    Warm-up weight: 0.5
    Evaluating model.
    Full set (5.83 s): ELBO: -1011.9, ENRE: -989.65, KL: 22.285.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 790 (32 ms): -328.87.
Step 827 (32 ms): -313.36.
Step 865 (32 ms): -298.38.
Step 902 (32 ms): -324.25.
Step 940 (31 ms): -289.81.
Step 978 (32 ms): -292.6.
Step 1015 (32 ms): -323.18.
Step 1053 (32 ms): -283.9.
Step 1090 (33 ms): -282.78.
Step 1128 (15 ms): -457.26.

Epoch 3 (12.1 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -600.32, ENRE: -588.65, KL: 11.67.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 1166 (32 ms): -277.43.
Step 1203 (32 ms): -265.83.
Step 1241 (33 ms): -257.18.
Step 1278 (33 ms): -243.8.
Step 1316 (32 ms): -260.35.
Step 1354 (32 ms): -264.71.
Step 1391 (32 ms): -269.71.
Step 1429 (34 ms): -281.07.
Step 1466 (32 ms): -239.64.
Step 1504 (16 ms): -324.21.

Epoch 4 (12.1 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -400.44, ENRE: -391.16, KL: 9.2798.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 1542 (32 ms): -263.92.
Step 1579 (33 ms): -234.55.
Step 1617 (32 ms): -223.
Step 1654 (32 ms): -251.44.
Step 1692 (32 ms): -231.39.
Step 1730 (33 ms): -225.88.
Step 1767 (31 ms): -221.97.
Step 1805 (32 ms): -256.32.
Step 1842 (32 ms): -265.84.
Step 1880 (15 ms): -232.55.

Epoch 5 (12.2 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -308.84, ENRE: -300.37, KL: 8.4639.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 1918 (33 ms): -239.12.
Step 1955 (33 ms): -240.38.
Step 1993 (32 ms): -250.9.
Step 2030 (32 ms): -240.55.
Step 2068 (33 ms): -229.78.
Step 2106 (33 ms): -226.89.
Step 2143 (32 ms): -238.15.
Step 2181 (32 ms): -222.66.
Step 2218 (32 ms): -244.52.
Step 2256 (15 ms): -254.03.

Epoch 6 (12.2 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -271.19, ENRE: -263.4, KL: 7.7893.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 2294 (32 ms): -219.77.
Step 2331 (32 ms): -231.94.
Step 2369 (32 ms): -226.57.
Step 2406 (33 ms): -215.63.
Step 2444 (32 ms): -242.93.
Step 2482 (33 ms): -223.06.
Step 2519 (32 ms): -238.37.
Step 2557 (32 ms): -218.51.
Step 2594 (31 ms): -220.07.
Step 2632 (15 ms): -250.78.

Epoch 7 (12.1 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -244.94, ENRE: -237.52, KL: 7.4285.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 2670 (33 ms): -215.49.
Step 2707 (32 ms): -236.3.
Step 2745 (32 ms): -210.49.
Step 2782 (32 ms): -213.14.
Step 2820 (32 ms): -216.84.
Step 2858 (32 ms): -210.54.
Step 2895 (32 ms): -222.13.
Step 2933 (33 ms): -211.65.
Step 2970 (33 ms): -227.56.
Step 3008 (15 ms): -242.49.

Epoch 8 (12.2 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -231.01, ENRE: -223.64, KL: 7.3786.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 3046 (32 ms): -208.66.
Step 3083 (32 ms): -218.29.
Step 3121 (32 ms): -213.66.
Step 3158 (32 ms): -220.09.
Step 3196 (32 ms): -222.74.
Step 3234 (33 ms): -229.8.
Step 3271 (32 ms): -207.84.
Step 3309 (31 ms): -210.22.
Step 3346 (32 ms): -222.53.
Step 3384 (17 ms): -256.17.

Epoch 9 (12 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -224.06, ENRE: -216.66, KL: 7.3972.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 3422 (32 ms): -219.96.
Step 3459 (32 ms): -224.54.
Step 3497 (32 ms): -229.45.
Step 3534 (32 ms): -211.36.
Step 3572 (32 ms): -236.57.
Step 3610 (32 ms): -208.17.
Step 3647 (33 ms): -218.02.
Step 3685 (32 ms): -224.93.
Step 3722 (33 ms): -225.86.
Step 3760 (16 ms): -214.83.

Epoch 10 (12.2 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -219.16, ENRE: -211.88, KL: 7.2838.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 3798 (32 ms): -218.49.
Step 3835 (32 ms): -231.52.
Step 3873 (33 ms): -217.52.
Step 3910 (32 ms): -205.47.
Step 3948 (32 ms): -220.45.
Step 3986 (32 ms): -213.39.
Step 4023 (32 ms): -207.31.
Step 4061 (32 ms): -215.71.
Step 4098 (32 ms): -226.69.
Step 4136 (15 ms): -197.09.

Epoch 11 (12.2 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -215.53, ENRE: -208.32, KL: 7.2143.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 4174 (32 ms): -206.07.
Step 4211 (32 ms): -210.8.
Step 4249 (32 ms): -207.73.
Step 4286 (32 ms): -217.16.
Step 4324 (32 ms): -228.99.
Step 4362 (32 ms): -211.49.
Step 4399 (33 ms): -229.92.
Step 4437 (32 ms): -197.06.
Step 4474 (32 ms): -210.48.
Step 4512 (15 ms): -223.54.

Epoch 12 (12.1 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -213.64, ENRE: -206.62, KL: 7.0272.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 4550 (32 ms): -219.02.
Step 4587 (32 ms): -213.43.
Step 4625 (32 ms): -220.6.
Step 4662 (32 ms): -220.4.
Step 4700 (32 ms): -214.81.
Step 4738 (32 ms): -210.79.
Step 4775 (32 ms): -230.24.
Step 4813 (32 ms): -227.36.
Step 4850 (32 ms): -200.01.
Step 4888 (15 ms): -202.66.

Epoch 13 (12.1 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -212.49, ENRE: -205.78, KL: 6.7151.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 4926 (32 ms): -217.61.
Step 4963 (32 ms): -195.37.
Step 5001 (32 ms): -226.68.
Step 5038 (32 ms): -203.96.
Step 5076 (32 ms): -230.73.
Step 5114 (32 ms): -197.5.
Step 5151 (32 ms): -205.63.
Step 5189 (33 ms): -208.87.
Step 5226 (32 ms): -218.9.
Step 5264 (15 ms): -226.62.

Epoch 14 (12.1 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -210.97, ENRE: -204.16, KL: 6.808.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 5302 (32 ms): -217.83.
Step 5339 (33 ms): -213.71.
Step 5377 (32 ms): -208.47.
Step 5414 (32 ms): -195.89.
Step 5452 (32 ms): -196.23.
Step 5490 (32 ms): -193.17.
Step 5527 (32 ms): -218.02.
Step 5565 (32 ms): -207.99.
Step 5602 (32 ms): -196.64.
Step 5640 (15 ms): -241.7.

Epoch 15 (12.1 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -209.54, ENRE: -202.9, KL: 6.6419.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 5678 (33 ms): -203.92.
Step 5715 (32 ms): -216.36.
Step 5753 (32 ms): -212.13.
Step 5790 (32 ms): -206.11.
Step 5828 (32 ms): -211.87.
Step 5866 (32 ms): -212.43.
Step 5903 (32 ms): -211.22.
Step 5941 (32 ms): -207.71.
Step 5978 (32 ms): -209.52.
Step 6016 (16 ms): -233.13.

Epoch 16 (12.1 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -208.76, ENRE: -202.08, KL: 6.6844.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 6054 (33 ms): -216.
Step 6091 (32 ms): -218.25.
Step 6129 (32 ms): -195.67.
Step 6166 (33 ms): -206.28.
Step 6204 (33 ms): -213.87.
Step 6242 (32 ms): -215.58.
Step 6279 (32 ms): -200.58.
Step 6317 (32 ms): -214.29.
Step 6354 (32 ms): -202.32.
Step 6392 (16 ms): -184.31.

Epoch 17 (12.2 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -208.36, ENRE: -201.63, KL: 6.7265.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 6430 (32 ms): -212.79.
Step 6467 (32 ms): -205.87.
Step 6505 (32 ms): -199.52.
Step 6542 (32 ms): -200.55.
Step 6580 (32 ms): -206.22.
Step 6618 (32 ms): -203.1.
Step 6655 (32 ms): -196.36.
Step 6693 (32 ms): -205.96.
Step 6730 (33 ms): -194.02.
Step 6768 (15 ms): -202.34.

Epoch 18 (12.1 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -210.17, ENRE: -203.23, KL: 6.9378.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 6806 (32 ms): -191.14.
Step 6843 (32 ms): -204.57.
Step 6881 (32 ms): -206.49.
Step 6918 (33 ms): -207.6.
Step 6956 (33 ms): -211.53.
Step 6994 (32 ms): -205.61.
Step 7031 (32 ms): -208.55.
Step 7069 (32 ms): -201.92.
Step 7106 (32 ms): -214.38.
Step 7144 (16 ms): -264.22.

Epoch 19 (12.1 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -206.7, ENRE: -200.3, KL: 6.4009.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 7182 (32 ms): -201.47.
Step 7219 (32 ms): -199.35.
Step 7257 (32 ms): -199.29.
Step 7294 (32 ms): -207.69.
Step 7332 (32 ms): -205.42.
Step 7370 (34 ms): -193.51.
Step 7407 (32 ms): -214.94.
Step 7445 (32 ms): -194.64.
Step 7482 (33 ms): -193.58.
Step 7520 (15 ms): -206.64.

Epoch 20 (12.1 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -207.67, ENRE: -201.03, KL: 6.641.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 7558 (32 ms): -217.31.
Step 7595 (32 ms): -200.62.
Step 7633 (33 ms): -215.44.
Step 7670 (32 ms): -207.49.
Step 7708 (32 ms): -204.94.
Step 7746 (32 ms): -193.55.
Step 7783 (33 ms): -204.76.
Step 7821 (33 ms): -196.81.
Step 7858 (32 ms): -193.96.
Step 7896 (15 ms): -239.41.

Epoch 21 (12.1 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -207.46, ENRE: -200.92, KL: 6.5474.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 7934 (34 ms): -200.29.
Step 7971 (32 ms): -206.04.
Step 8009 (32 ms): -202.96.
Step 8046 (33 ms): -204.89.
Step 8084 (33 ms): -221.25.
Step 8122 (33 ms): -196.15.
Step 8159 (32 ms): -197.44.
Step 8197 (32 ms): -207.78.
Step 8234 (32 ms): -207.72.
Step 8272 (16 ms): -206.94.

Epoch 22 (12.1 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -205.99, ENRE: -199.34, KL: 6.6437.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 8310 (32 ms): -196.55.
Step 8347 (32 ms): -212.12.
Step 8385 (33 ms): -214.83.
Step 8422 (32 ms): -204.62.
Step 8460 (33 ms): -202.8.
Step 8498 (32 ms): -209.99.
Step 8535 (33 ms): -199.08.
Step 8573 (33 ms): -195.81.
Step 8610 (33 ms): -194.24.
Step 8648 (16 ms): -217.52.

Epoch 23 (12.4 s):
    Evaluating model.
    Full set (5.94 s): ELBO: -205.89, ENRE: -199.22, KL: 6.6695.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 8686 (33 ms): -200.39.
Step 8723 (32 ms): -190.34.
Step 8761 (33 ms): -193.93.
Step 8798 (32 ms): -195.2.
Step 8836 (35 ms): -218.96.
Step 8874 (32 ms): -202.18.
Step 8911 (31 ms): -204.33.
Step 8949 (33 ms): -195.07.
Step 8986 (32 ms): -198.96.
Step 9024 (15 ms): -165.02.

Epoch 24 (12.3 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -204.72, ENRE: -198.24, KL: 6.4783.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 9062 (32 ms): -200.77.
Step 9099 (32 ms): -212.25.
Step 9137 (32 ms): -201.89.
Step 9174 (32 ms): -202.65.
Step 9212 (32 ms): -205.61.
Step 9250 (33 ms): -201.73.
Step 9287 (32 ms): -209.57.
Step 9325 (32 ms): -200.32.
Step 9362 (32 ms): -209.1.
Step 9400 (15 ms): -223.39.

Epoch 25 (12.1 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -204.28, ENRE: -197.85, KL: 6.4287.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 9438 (32 ms): -208.43.
Step 9475 (32 ms): -200.74.
Step 9513 (32 ms): -193.43.
Step 9550 (32 ms): -196.81.
Step 9588 (33 ms): -198.49.
Step 9626 (32 ms): -195.12.
Step 9663 (32 ms): -214.89.
Step 9701 (32 ms): -200.74.
Step 9738 (32 ms): -196.45.
Step 9776 (15 ms): -217.62.

Epoch 26 (12.1 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -205.55, ENRE: -198.97, KL: 6.5802.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 9814 (32 ms): -207.31.
Step 9851 (32 ms): -206.39.
Step 9889 (32 ms): -202.25.
Step 9926 (31 ms): -210.04.
Step 9964 (32 ms): -209.54.
Step 10002 (32 ms): -207.35.
Step 10039 (32 ms): -203.78.
Step 10077 (32 ms): -220.41.
Step 10114 (32 ms): -199.54.
Step 10152 (15 ms): -222.05.

Epoch 27 (12.1 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -204.47, ENRE: -197.82, KL: 6.6511.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 10190 (32 ms): -214.41.
Step 10227 (33 ms): -210.79.
Step 10265 (33 ms): -199.91.
Step 10302 (33 ms): -202.86.
Step 10340 (32 ms): -204.22.
Step 10378 (32 ms): -206.55.
Step 10415 (32 ms): -196.45.
Step 10453 (32 ms): -202.79.
Step 10490 (32 ms): -206.08.
Step 10528 (16 ms): -196.2.

Epoch 28 (12.2 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -203.61, ENRE: -197.02, KL: 6.5942.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 10566 (32 ms): -201.33.
Step 10603 (32 ms): -204.01.
Step 10641 (33 ms): -198.9.
Step 10678 (32 ms): -199.58.
Step 10716 (32 ms): -190.68.
Step 10754 (33 ms): -201.7.
Step 10791 (32 ms): -202.53.
Step 10829 (32 ms): -216.65.
Step 10866 (32 ms): -197.1.
Step 10904 (15 ms): -188.83.

Epoch 29 (12.2 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -203.32, ENRE: -196.85, KL: 6.4689.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 10942 (32 ms): -193.37.
Step 10979 (32 ms): -196.18.
Step 11017 (32 ms): -200.74.
Step 11054 (32 ms): -214.13.
Step 11092 (32 ms): -187.43.
Step 11130 (32 ms): -209.22.
Step 11167 (32 ms): -211.14.
Step 11205 (32 ms): -190.89.
Step 11242 (32 ms): -198.32.
Step 11280 (16 ms): -335.01.

Epoch 30 (12.2 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -203.46, ENRE: -196.88, KL: 6.5757.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 11318 (32 ms): -195.5.
Step 11355 (32 ms): -202.52.
Step 11393 (32 ms): -207.25.
Step 11430 (32 ms): -194.92.
Step 11468 (32 ms): -215.17.
Step 11506 (32 ms): -211.55.
Step 11543 (32 ms): -186.23.
Step 11581 (32 ms): -204.87.
Step 11618 (32 ms): -203.08.
Step 11656 (15 ms): -200.54.

Epoch 31 (12 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -202.74, ENRE: -196.27, KL: 6.4728.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 11694 (32 ms): -195.89.
Step 11731 (32 ms): -211.4.
Step 11769 (32 ms): -196.84.
Step 11806 (32 ms): -200.
Step 11844 (32 ms): -223.21.
Step 11882 (32 ms): -189.73.
Step 11919 (33 ms): -208.19.
Step 11957 (32 ms): -190.46.
Step 11994 (32 ms): -208.13.
Step 12032 (15 ms): -267.29.

Epoch 32 (12.1 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -202.47, ENRE: -195.98, KL: 6.4903.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 12070 (32 ms): -204.84.
Step 12107 (32 ms): -212.26.
Step 12145 (32 ms): -203.81.
Step 12182 (32 ms): -208.92.
Step 12220 (32 ms): -201.93.
Step 12258 (32 ms): -195.23.
Step 12295 (32 ms): -196.48.
Step 12333 (32 ms): -188.71.
Step 12370 (32 ms): -198.85.
Step 12408 (15 ms): -201.59.

Epoch 33 (12 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -202.2, ENRE: -195.59, KL: 6.6083.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 12446 (32 ms): -203.99.
Step 12483 (32 ms): -197.55.
Step 12521 (32 ms): -200.57.
Step 12558 (32 ms): -204.52.
Step 12596 (32 ms): -197.78.
Step 12634 (33 ms): -182.93.
Step 12671 (32 ms): -201.99.
Step 12709 (33 ms): -199.24.
Step 12746 (32 ms): -209.52.
Step 12784 (16 ms): -312.84.

Epoch 34 (12.1 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -202.06, ENRE: -195.55, KL: 6.5119.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 12822 (32 ms): -204.63.
Step 12859 (33 ms): -211.07.
Step 12897 (33 ms): -189.44.
Step 12934 (34 ms): -204.52.
Step 12972 (32 ms): -205.85.
Step 13010 (33 ms): -206.43.
Step 13047 (32 ms): -194.22.
Step 13085 (32 ms): -199.45.
Step 13122 (32 ms): -199.42.
Step 13160 (16 ms): -240.84.

Epoch 35 (12.2 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -201.73, ENRE: -195.23, KL: 6.501.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 13198 (32 ms): -194.97.
Step 13235 (33 ms): -212.15.
Step 13273 (32 ms): -195.08.
Step 13310 (32 ms): -214.56.
Step 13348 (32 ms): -209.61.
Step 13386 (32 ms): -205.4.
Step 13423 (32 ms): -205.87.
Step 13461 (32 ms): -208.48.
Step 13498 (33 ms): -205.83.
Step 13536 (16 ms): -268.34.

Epoch 36 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -201.74, ENRE: -195.33, KL: 6.403.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 13574 (32 ms): -188.05.
Step 13611 (32 ms): -201.81.
Step 13649 (33 ms): -207.71.
Step 13686 (32 ms): -205.86.
Step 13724 (32 ms): -206.12.
Step 13762 (32 ms): -198.29.
Step 13799 (33 ms): -195.33.
Step 13837 (41 ms): -208.62.
Step 13874 (32 ms): -215.73.
Step 13912 (27 ms): -193.04.

Epoch 37 (12.4 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -201.91, ENRE: -195.32, KL: 6.5848.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 13950 (45 ms): -202.8.
Step 13987 (32 ms): -205.7.
Step 14025 (32 ms): -198.04.
Step 14062 (32 ms): -198.43.
Step 14100 (32 ms): -205.5.
Step 14138 (32 ms): -194.25.
Step 14175 (31 ms): -191.65.
Step 14213 (32 ms): -191.6.
Step 14250 (32 ms): -202.58.
Step 14288 (15 ms): -183.64.

Epoch 38 (12.2 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -201.15, ENRE: -194.6, KL: 6.548.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 14326 (32 ms): -198.11.
Step 14363 (33 ms): -197.94.
Step 14401 (32 ms): -194.64.
Step 14438 (33 ms): -212.99.
Step 14476 (34 ms): -192.95.
Step 14514 (32 ms): -192.49.
Step 14551 (32 ms): -216.9.
Step 14589 (31 ms): -197.85.
Step 14626 (32 ms): -198.46.
Step 14664 (15 ms): -170.79.

Epoch 39 (12.2 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -201.03, ENRE: -194.4, KL: 6.6323.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 14702 (32 ms): -212.83.
Step 14739 (32 ms): -205.92.
Step 14777 (32 ms): -205.11.
Step 14814 (33 ms): -198.87.
Step 14852 (32 ms): -214.83.
Step 14890 (32 ms): -208.16.
Step 14927 (32 ms): -198.35.
Step 14965 (32 ms): -212.58.
Step 15002 (32 ms): -215.94.
Step 15040 (15 ms): -347.57.

Epoch 40 (12.1 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -200.97, ENRE: -194.39, KL: 6.5812.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 15078 (33 ms): -194.57.
Step 15115 (33 ms): -209.23.
Step 15153 (32 ms): -200.16.
Step 15190 (32 ms): -191.26.
Step 15228 (34 ms): -198.08.
Step 15266 (33 ms): -204.31.
Step 15303 (33 ms): -199.7.
Step 15341 (32 ms): -216.74.
Step 15378 (32 ms): -201.61.
Step 15416 (16 ms): -223.95.

Epoch 41 (12.2 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -200.96, ENRE: -194.35, KL: 6.6105.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 15454 (33 ms): -208.56.
Step 15491 (32 ms): -192.18.
Step 15529 (32 ms): -194.54.
Step 15566 (32 ms): -224.4.
Step 15604 (32 ms): -207.84.
Step 15642 (32 ms): -207.59.
Step 15679 (32 ms): -209.08.
Step 15717 (32 ms): -203.22.
Step 15754 (32 ms): -194.23.
Step 15792 (15 ms): -967.64.

Epoch 42 (12.1 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -200.5, ENRE: -193.92, KL: 6.5813.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 15830 (33 ms): -199.82.
Step 15867 (33 ms): -203.84.
Step 15905 (33 ms): -201.69.
Step 15942 (32 ms): -196.11.
Step 15980 (32 ms): -194.16.
Step 16018 (32 ms): -203.23.
Step 16055 (32 ms): -199.25.
Step 16093 (32 ms): -193.01.
Step 16130 (32 ms): -201.04.
Step 16168 (16 ms): -409.27.

Epoch 43 (12.2 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -200.54, ENRE: -193.98, KL: 6.5545.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 16206 (32 ms): -202.52.
Step 16243 (32 ms): -198.12.
Step 16281 (32 ms): -200.27.
Step 16318 (32 ms): -200.87.
Step 16356 (32 ms): -200.57.
Step 16394 (32 ms): -194.2.
Step 16431 (32 ms): -198.42.
Step 16469 (32 ms): -194.87.
Step 16506 (31 ms): -196.44.
Step 16544 (15 ms): -227.75.

Epoch 44 (12 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -200.71, ENRE: -194.06, KL: 6.6422.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 16582 (32 ms): -200.94.
Step 16619 (32 ms): -200.61.
Step 16657 (32 ms): -212.73.
Step 16694 (33 ms): -206.14.
Step 16732 (32 ms): -202.85.
Step 16770 (32 ms): -190.8.
Step 16807 (32 ms): -197.68.
Step 16845 (32 ms): -206.81.
Step 16882 (33 ms): -191.28.
Step 16920 (15 ms): -247.03.

Epoch 45 (12.1 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -200.78, ENRE: -194.19, KL: 6.5926.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 16958 (32 ms): -199.86.
Step 16995 (32 ms): -226.16.
Step 17033 (32 ms): -215.18.
Step 17070 (32 ms): -193.93.
Step 17108 (32 ms): -198.78.
Step 17146 (32 ms): -207.9.
Step 17183 (32 ms): -201.67.
Step 17221 (32 ms): -199.68.
Step 17258 (34 ms): -208.57.
Step 17296 (17 ms): -195.6.

Epoch 46 (12.1 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -200.14, ENRE: -193.63, KL: 6.514.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 17334 (32 ms): -202.88.
Step 17371 (32 ms): -201.49.
Step 17409 (32 ms): -203.35.
Step 17446 (33 ms): -207.66.
Step 17484 (32 ms): -205.02.
Step 17522 (32 ms): -190.9.
Step 17559 (32 ms): -201.13.
Step 17597 (33 ms): -186.1.
Step 17634 (32 ms): -194.06.
Step 17672 (15 ms): -224.75.

Epoch 47 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -199.98, ENRE: -193.39, KL: 6.5915.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 17710 (32 ms): -198.13.
Step 17747 (33 ms): -194.94.
Step 17785 (33 ms): -209.37.
Step 17822 (32 ms): -203.25.
Step 17860 (33 ms): -200.51.
Step 17898 (32 ms): -185.74.
Step 17935 (33 ms): -207.66.
Step 17973 (32 ms): -209.36.
Step 18010 (32 ms): -196.05.
Step 18048 (16 ms): -218.35.

Epoch 48 (12.2 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -200.13, ENRE: -193.67, KL: 6.4587.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 18086 (32 ms): -199.19.
Step 18123 (32 ms): -191.1.
Step 18161 (32 ms): -191.13.
Step 18198 (32 ms): -202.23.
Step 18236 (33 ms): -213.05.
Step 18274 (32 ms): -215.
Step 18311 (32 ms): -198.23.
Step 18349 (32 ms): -200.39.
Step 18386 (33 ms): -190.09.
Step 18424 (15 ms): -189.76.

Epoch 49 (12.1 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -199.82, ENRE: -193.31, KL: 6.5065.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 18462 (32 ms): -196.
Step 18499 (32 ms): -210.13.
Step 18537 (33 ms): -196.53.
Step 18574 (32 ms): -200.87.
Step 18612 (32 ms): -195.47.
Step 18650 (33 ms): -200.1.
Step 18687 (32 ms): -208.27.
Step 18725 (32 ms): -187.96.
Step 18762 (32 ms): -197.38.
Step 18800 (15 ms): -245.14.

Epoch 50 (12.2 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -199.84, ENRE: -193.37, KL: 6.4784.
    Saving model parameters.
    Model parameters saved (104 ms).

Model trained for 50 epochs (15m 11s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (912 ms).

Converting data set value array to sparse matrix.
Data set value array converted (309 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.85 s):  ELBO: -423.73, ENRE: -417.26, KL: 6.4653.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (679 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.6628663610141792
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 14
kl weight: 1.6628663610141792
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (47 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.21 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.94 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 14
    hidden sizes: 205, 294
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.6628663610141792
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 5 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 205)
    ENCODER/1/DENSE/biases:0             (205,)
    ENCODER/1/BATCH_NORM/beta:0          (205,)
    ENCODER/2/DENSE/weights:0            (205, 294)
    ENCODER/2/DENSE/biases:0             (294,)
    ENCODER/2/BATCH_NORM/beta:0          (294,)
    POSTERIOR/MU/DENSE/weights:0         (294, 14)
    POSTERIOR/MU/DENSE/biases:0          (14,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (294, 14)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (14,)
    DECODER/2/DENSE/weights:0            (14, 294)
    DECODER/2/DENSE/biases:0             (294,)
    DECODER/2/BATCH_NORM/beta:0          (294,)
    DECODER/1/DENSE/weights:0            (294, 205)
    DECODER/1/DENSE/biases:0             (205,)
    DECODER/1/BATCH_NORM/beta:0          (205,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (205, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (318 ms).

Training model for 50 epochs on original values.

Step 38 (30 ms): -2065.3.
Step 75 (29 ms): -1677.
Step 113 (29 ms): -1368.6.
Step 150 (31 ms): -1165.5.
Step 188 (38 ms): -1004.7.
Step 226 (30 ms): -830.48.
Step 263 (30 ms): -748.83.
Step 301 (30 ms): -683.18.
Step 338 (33 ms): -629.08.
Step 376 (15 ms): -559.46.

Epoch 1 (12.9 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (5.94 s): ELBO: -1293.7, ENRE: -1236.3, KL: 57.333.
    Saving model parameters.
    Model parameters saved (130 ms).

Step 414 (30 ms): -488.35.
Step 451 (30 ms): -444.53.
Step 489 (30 ms): -387.99.
Step 526 (30 ms): -356.07.
Step 564 (29 ms): -344.64.
Step 602 (29 ms): -320.46.
Step 639 (30 ms): -312.17.
Step 677 (30 ms): -310.77.
Step 714 (31 ms): -295.89.
Step 752 (15 ms): -296.85.

Epoch 2 (11.2 s):
    Warm-up weight: 0.2
    Evaluating model.
    Full set (5.51 s): ELBO: -837.33, ENRE: -818.23, KL: 19.105.
    Saving model parameters.
    Model parameters saved (75 ms).

Step 790 (29 ms): -284.19.
Step 827 (29 ms): -290.52.
Step 865 (30 ms): -273.86.
Step 902 (29 ms): -290.25.
Step 940 (29 ms): -276.82.
Step 978 (29 ms): -287.32.
Step 1015 (29 ms): -269.55.
Step 1053 (30 ms): -257.74.
Step 1090 (29 ms): -250.48.
Step 1128 (14 ms): -243.7.

Epoch 3 (11.2 s):
    Warm-up weight: 0.4
    Evaluating model.
    Full set (5.52 s): ELBO: -497.95, ENRE: -487.86, KL: 10.093.
    Saving model parameters.
    Model parameters saved (77 ms).

Step 1166 (30 ms): -258.09.
Step 1203 (30 ms): -265.1.
Step 1241 (30 ms): -242.96.
Step 1278 (30 ms): -243.33.
Step 1316 (30 ms): -232.2.
Step 1354 (30 ms): -234.81.
Step 1391 (30 ms): -242.67.
Step 1429 (30 ms): -232.02.
Step 1466 (31 ms): -259.4.
Step 1504 (14 ms): -269.09.

Epoch 4 (11.2 s):
    Warm-up weight: 0.6
    Evaluating model.
    Full set (5.46 s): ELBO: -335.92, ENRE: -327.84, KL: 8.0738.
    Saving model parameters.
    Model parameters saved (74 ms).

Step 1542 (29 ms): -226.85.
Step 1579 (30 ms): -228.1.
Step 1617 (30 ms): -234.57.
Step 1654 (30 ms): -245.46.
Step 1692 (29 ms): -226.41.
Step 1730 (30 ms): -229.12.
Step 1767 (29 ms): -220.42.
Step 1805 (29 ms): -251.61.
Step 1842 (29 ms): -227.53.
Step 1880 (14 ms): -245.33.

Epoch 5 (11.1 s):
    Warm-up weight: 0.8
    Evaluating model.
    Full set (5.45 s): ELBO: -272.34, ENRE: -265.14, KL: 7.2036.
    Saving model parameters.
    Model parameters saved (76 ms).

Step 1918 (29 ms): -224.41.
Step 1955 (29 ms): -238.71.
Step 1993 (30 ms): -212.2.
Step 2030 (29 ms): -219.49.
Step 2068 (30 ms): -245.74.
Step 2106 (30 ms): -230.76.
Step 2143 (30 ms): -222.27.
Step 2181 (30 ms): -231.97.
Step 2218 (30 ms): -222.92.
Step 2256 (13 ms): -271.39.

Epoch 6 (11.1 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -245, ENRE: -238.49, KL: 6.5159.
    Saving model parameters.
    Model parameters saved (75 ms).

Step 2294 (29 ms): -223.64.
Step 2331 (30 ms): -215.55.
Step 2369 (29 ms): -212.3.
Step 2406 (29 ms): -220.03.
Step 2444 (29 ms): -204.18.
Step 2482 (30 ms): -214.36.
Step 2519 (29 ms): -228.42.
Step 2557 (29 ms): -221.15.
Step 2594 (29 ms): -210.34.
Step 2632 (13 ms): -225.99.

Epoch 7 (11 s):
    Evaluating model.
    Full set (5.44 s): ELBO: -231.27, ENRE: -224.89, KL: 6.3768.
    Saving model parameters.
    Model parameters saved (78 ms).

Step 2670 (29 ms): -220.
Step 2707 (30 ms): -225.88.
Step 2745 (30 ms): -211.36.
Step 2782 (29 ms): -213.48.
Step 2820 (31 ms): -213.96.
Step 2858 (30 ms): -231.15.
Step 2895 (29 ms): -250.02.
Step 2933 (29 ms): -212.73.
Step 2970 (29 ms): -216.65.
Step 3008 (13 ms): -250.22.

Epoch 8 (11.1 s):
    Evaluating model.
    Full set (5.49 s): ELBO: -223.03, ENRE: -216.5, KL: 6.5294.
    Saving model parameters.
    Model parameters saved (76 ms).

Step 3046 (29 ms): -212.98.
Step 3083 (30 ms): -223.06.
Step 3121 (29 ms): -205.24.
Step 3158 (30 ms): -217.95.
Step 3196 (29 ms): -206.51.
Step 3234 (30 ms): -219.82.
Step 3271 (29 ms): -208.22.
Step 3309 (29 ms): -220.4.
Step 3346 (30 ms): -212.58.
Step 3384 (13 ms): -206.5.

Epoch 9 (11.1 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -217.27, ENRE: -210.58, KL: 6.6858.
    Saving model parameters.
    Model parameters saved (75 ms).

Step 3422 (30 ms): -207.3.
Step 3459 (31 ms): -201.05.
Step 3497 (29 ms): -222.64.
Step 3534 (30 ms): -205.79.
Step 3572 (30 ms): -211.18.
Step 3610 (30 ms): -203.22.
Step 3647 (29 ms): -200.83.
Step 3685 (29 ms): -212.33.
Step 3722 (29 ms): -219.35.
Step 3760 (13 ms): -186.18.

Epoch 10 (11.1 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -215.2, ENRE: -208.84, KL: 6.3549.
    Saving model parameters.
    Model parameters saved (76 ms).

Step 3798 (30 ms): -205.49.
Step 3835 (29 ms): -223.16.
Step 3873 (30 ms): -216.82.
Step 3910 (30 ms): -217.19.
Step 3948 (30 ms): -199.54.
Step 3986 (30 ms): -207.13.
Step 4023 (30 ms): -220.14.
Step 4061 (29 ms): -213.5.
Step 4098 (30 ms): -212.26.
Step 4136 (14 ms): -261.6.

Epoch 11 (11.2 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -212.26, ENRE: -205.82, KL: 6.4408.
    Saving model parameters.
    Model parameters saved (75 ms).

Step 4174 (30 ms): -202.05.
Step 4211 (30 ms): -199.73.
Step 4249 (29 ms): -210.54.
Step 4286 (30 ms): -200.53.
Step 4324 (31 ms): -214.19.
Step 4362 (30 ms): -212.06.
Step 4399 (29 ms): -204.72.
Step 4437 (30 ms): -217.11.
Step 4474 (29 ms): -214.15.
Step 4512 (13 ms): -256.02.

Epoch 12 (11.1 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -209.84, ENRE: -203.26, KL: 6.5784.
    Saving model parameters.
    Model parameters saved (74 ms).

Step 4550 (30 ms): -200.82.
Step 4587 (29 ms): -209.14.
Step 4625 (29 ms): -216.95.
Step 4662 (29 ms): -211.97.
Step 4700 (30 ms): -202.7.
Step 4738 (29 ms): -215.81.
Step 4775 (29 ms): -217.84.
Step 4813 (29 ms): -194.58.
Step 4850 (30 ms): -213.52.
Step 4888 (14 ms): -282.58.

Epoch 13 (11.1 s):
    Evaluating model.
    Full set (5.49 s): ELBO: -209.07, ENRE: -202.63, KL: 6.4378.
    Saving model parameters.
    Model parameters saved (77 ms).

Step 4926 (30 ms): -210.78.
Step 4963 (29 ms): -203.79.
Step 5001 (30 ms): -211.49.
Step 5038 (30 ms): -202.87.
Step 5076 (30 ms): -209.54.
Step 5114 (30 ms): -219.39.
Step 5151 (29 ms): -219.56.
Step 5189 (29 ms): -198.37.
Step 5226 (29 ms): -201.67.
Step 5264 (13 ms): -257.38.

Epoch 14 (11.1 s):
    Evaluating model.
    Full set (5.44 s): ELBO: -207.77, ENRE: -201.19, KL: 6.5807.
    Saving model parameters.
    Model parameters saved (75 ms).

Step 5302 (29 ms): -213.9.
Step 5339 (29 ms): -203.48.
Step 5377 (29 ms): -219.29.
Step 5414 (29 ms): -238.81.
Step 5452 (29 ms): -204.81.
Step 5490 (29 ms): -212.75.
Step 5527 (29 ms): -207.55.
Step 5565 (29 ms): -202.05.
Step 5602 (29 ms): -216.3.
Step 5640 (13 ms): -203.44.

Epoch 15 (11 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -207.42, ENRE: -200.85, KL: 6.5627.
    Saving model parameters.
    Model parameters saved (80 ms).

Step 5678 (30 ms): -209.03.
Step 5715 (29 ms): -202.18.
Step 5753 (29 ms): -207.65.
Step 5790 (29 ms): -217.98.
Step 5828 (29 ms): -204.2.
Step 5866 (30 ms): -210.3.
Step 5903 (30 ms): -204.28.
Step 5941 (29 ms): -206.24.
Step 5978 (29 ms): -195.52.
Step 6016 (14 ms): -180.92.

Epoch 16 (11.1 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -206.74, ENRE: -200.28, KL: 6.4555.
    Saving model parameters.
    Model parameters saved (77 ms).

Step 6054 (29 ms): -222.67.
Step 6091 (29 ms): -210.38.
Step 6129 (29 ms): -199.06.
Step 6166 (30 ms): -205.53.
Step 6204 (29 ms): -195.56.
Step 6242 (30 ms): -206.3.
Step 6279 (30 ms): -205.83.
Step 6317 (30 ms): -200.28.
Step 6354 (29 ms): -207.53.
Step 6392 (13 ms): -291.31.

Epoch 17 (11.1 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -206.17, ENRE: -199.66, KL: 6.5086.
    Saving model parameters.
    Model parameters saved (75 ms).

Step 6430 (29 ms): -195.27.
Step 6467 (29 ms): -212.88.
Step 6505 (30 ms): -200.7.
Step 6542 (30 ms): -200.28.
Step 6580 (30 ms): -204.85.
Step 6618 (31 ms): -213.39.
Step 6655 (30 ms): -198.96.
Step 6693 (30 ms): -218.53.
Step 6730 (30 ms): -207.97.
Step 6768 (14 ms): -200.57.

Epoch 18 (11.2 s):
    Evaluating model.
    Full set (5.49 s): ELBO: -205.42, ENRE: -198.75, KL: 6.6711.
    Saving model parameters.
    Model parameters saved (77 ms).

Step 6806 (29 ms): -193.59.
Step 6843 (29 ms): -215.47.
Step 6881 (29 ms): -211.27.
Step 6918 (29 ms): -210.09.
Step 6956 (29 ms): -209.99.
Step 6994 (29 ms): -205.51.
Step 7031 (29 ms): -204.38.
Step 7069 (29 ms): -202.09.
Step 7106 (30 ms): -196.32.
Step 7144 (13 ms): -325.74.

Epoch 19 (11.1 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -205.03, ENRE: -198.31, KL: 6.7186.
    Saving model parameters.
    Model parameters saved (74 ms).

Step 7182 (30 ms): -194.95.
Step 7219 (29 ms): -210.46.
Step 7257 (29 ms): -203.2.
Step 7294 (29 ms): -198.94.
Step 7332 (30 ms): -201.26.
Step 7370 (29 ms): -202.8.
Step 7407 (29 ms): -199.84.
Step 7445 (29 ms): -212.65.
Step 7482 (30 ms): -214.21.
Step 7520 (14 ms): -204.73.

Epoch 20 (11.1 s):
    Evaluating model.
    Full set (5.5 s): ELBO: -204.43, ENRE: -197.83, KL: 6.6066.
    Saving model parameters.
    Model parameters saved (77 ms).

Step 7558 (31 ms): -209.06.
Step 7595 (29 ms): -211.95.
Step 7633 (30 ms): -210.88.
Step 7670 (30 ms): -194.42.
Step 7708 (30 ms): -208.32.
Step 7746 (30 ms): -195.99.
Step 7783 (29 ms): -204.41.
Step 7821 (29 ms): -200.63.
Step 7858 (30 ms): -207.42.
Step 7896 (14 ms): -197.58.

Epoch 21 (11.1 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -204.64, ENRE: -198.13, KL: 6.5103.
    Saving model parameters.
    Model parameters saved (75 ms).

Step 7934 (29 ms): -209.04.
Step 7971 (29 ms): -199.73.
Step 8009 (29 ms): -192.94.
Step 8046 (29 ms): -198.16.
Step 8084 (29 ms): -202.65.
Step 8122 (30 ms): -214.1.
Step 8159 (29 ms): -207.71.
Step 8197 (29 ms): -231.9.
Step 8234 (29 ms): -207.35.
Step 8272 (13 ms): -183.3.

Epoch 22 (11 s):
    Evaluating model.
    Full set (5.44 s): ELBO: -204.21, ENRE: -197.68, KL: 6.5314.
    Saving model parameters.
    Model parameters saved (78 ms).

Step 8310 (30 ms): -212.07.
Step 8347 (29 ms): -199.42.
Step 8385 (29 ms): -210.15.
Step 8422 (30 ms): -217.44.
Step 8460 (29 ms): -212.23.
Step 8498 (30 ms): -195.72.
Step 8535 (30 ms): -207.79.
Step 8573 (29 ms): -201.4.
Step 8610 (29 ms): -207.27.
Step 8648 (14 ms): -208.69.

Epoch 23 (11.1 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -203.66, ENRE: -197.01, KL: 6.6511.
    Saving model parameters.
    Model parameters saved (78 ms).

Step 8686 (29 ms): -212.92.
Step 8723 (29 ms): -203.22.
Step 8761 (29 ms): -199.47.
Step 8798 (29 ms): -221.32.
Step 8836 (30 ms): -213.76.
Step 8874 (29 ms): -194.33.
Step 8911 (30 ms): -193.44.
Step 8949 (29 ms): -193.7.
Step 8986 (29 ms): -203.67.
Step 9024 (13 ms): -200.81.

Epoch 24 (11 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -203.79, ENRE: -197.27, KL: 6.5168.
    Saving model parameters.
    Model parameters saved (77 ms).

Step 9062 (30 ms): -201.61.
Step 9099 (29 ms): -198.19.
Step 9137 (29 ms): -209.81.
Step 9174 (29 ms): -213.84.
Step 9212 (30 ms): -212.9.
Step 9250 (30 ms): -197.18.
Step 9287 (29 ms): -203.1.
Step 9325 (30 ms): -193.65.
Step 9362 (30 ms): -208.88.
Step 9400 (15 ms): -188.99.

Epoch 25 (11.2 s):
    Evaluating model.
    Full set (5.5 s): ELBO: -203.07, ENRE: -196.44, KL: 6.6353.
    Saving model parameters.
    Model parameters saved (76 ms).

Step 9438 (30 ms): -192.13.
Step 9475 (29 ms): -197.33.
Step 9513 (29 ms): -195.56.
Step 9550 (30 ms): -209.07.
Step 9588 (29 ms): -204.53.
Step 9626 (30 ms): -201.02.
Step 9663 (29 ms): -211.11.
Step 9701 (29 ms): -195.99.
Step 9738 (30 ms): -207.69.
Step 9776 (13 ms): -198.15.

Epoch 26 (11.1 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -203.13, ENRE: -196.58, KL: 6.5545.
    Saving model parameters.
    Model parameters saved (75 ms).

Step 9814 (29 ms): -196.01.
Step 9851 (29 ms): -213.45.
Step 9889 (30 ms): -195.32.
Step 9926 (30 ms): -190.13.
Step 9964 (29 ms): -204.28.
Step 10002 (29 ms): -218.36.
Step 10039 (31 ms): -204.12.
Step 10077 (29 ms): -195.21.
Step 10114 (30 ms): -203.27.
Step 10152 (13 ms): -287.33.

Epoch 27 (11.1 s):
    Evaluating model.
    Full set (5.48 s): ELBO: -202.76, ENRE: -196.44, KL: 6.3199.
    Saving model parameters.
    Model parameters saved (76 ms).

Step 10190 (30 ms): -201.78.
Step 10227 (30 ms): -208.63.
Step 10265 (29 ms): -190.41.
Step 10302 (30 ms): -207.4.
Step 10340 (30 ms): -198.41.
Step 10378 (30 ms): -210.39.
Step 10415 (30 ms): -196.16.
Step 10453 (30 ms): -204.31.
Step 10490 (29 ms): -194.15.
Step 10528 (13 ms): -182.49.

Epoch 28 (11.2 s):
    Evaluating model.
    Full set (5.44 s): ELBO: -202.98, ENRE: -196.46, KL: 6.5159.
    Saving model parameters.
    Model parameters saved (73 ms).

Step 10566 (29 ms): -194.38.
Step 10603 (29 ms): -192.78.
Step 10641 (29 ms): -210.53.
Step 10678 (29 ms): -209.09.
Step 10716 (29 ms): -206.13.
Step 10754 (29 ms): -196.61.
Step 10791 (29 ms): -211.1.
Step 10829 (29 ms): -200.04.
Step 10866 (30 ms): -205.42.
Step 10904 (13 ms): -244.91.

Epoch 29 (11 s):
    Evaluating model.
    Full set (5.44 s): ELBO: -202.38, ENRE: -195.93, KL: 6.457.
    Saving model parameters.
    Model parameters saved (77 ms).

Step 10942 (29 ms): -200.4.
Step 10979 (30 ms): -191.55.
Step 11017 (29 ms): -203.41.
Step 11054 (30 ms): -204.21.
Step 11092 (29 ms): -193.87.
Step 11130 (29 ms): -214.65.
Step 11167 (29 ms): -195.
Step 11205 (29 ms): -201.12.
Step 11242 (30 ms): -220.43.
Step 11280 (13 ms): -218.11.

Epoch 30 (11.1 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -202.66, ENRE: -196.27, KL: 6.3937.
    Saving model parameters.
    Model parameters saved (77 ms).

Step 11318 (30 ms): -218.7.
Step 11355 (29 ms): -219.39.
Step 11393 (29 ms): -198.09.
Step 11430 (29 ms): -202.47.
Step 11468 (29 ms): -202.92.
Step 11506 (29 ms): -208.86.
Step 11543 (29 ms): -206.56.
Step 11581 (29 ms): -195.54.
Step 11618 (30 ms): -200.03.
Step 11656 (13 ms): -243.96.

Epoch 31 (11 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -202.3, ENRE: -195.91, KL: 6.3834.
    Saving model parameters.
    Model parameters saved (74 ms).

Step 11694 (29 ms): -209.34.
Step 11731 (29 ms): -200.14.
Step 11769 (30 ms): -212.68.
Step 11806 (29 ms): -207.15.
Step 11844 (29 ms): -193.03.
Step 11882 (29 ms): -192.62.
Step 11919 (29 ms): -214.79.
Step 11957 (29 ms): -189.38.
Step 11994 (29 ms): -196.21.
Step 12032 (14 ms): -215.99.

Epoch 32 (11.1 s):
    Evaluating model.
    Full set (5.5 s): ELBO: -202.08, ENRE: -195.61, KL: 6.4751.
    Saving model parameters.
    Model parameters saved (76 ms).

Step 12070 (30 ms): -201.76.
Step 12107 (30 ms): -208.48.
Step 12145 (29 ms): -201.98.
Step 12182 (30 ms): -210.14.
Step 12220 (30 ms): -197.42.
Step 12258 (29 ms): -197.95.
Step 12295 (29 ms): -195.14.
Step 12333 (30 ms): -207.02.
Step 12370 (30 ms): -199.08.
Step 12408 (13 ms): -205.62.

Epoch 33 (11.2 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -201.89, ENRE: -195.35, KL: 6.5409.
    Saving model parameters.
    Model parameters saved (74 ms).

Step 12446 (30 ms): -198.43.
Step 12483 (29 ms): -193.94.
Step 12521 (30 ms): -215.28.
Step 12558 (30 ms): -191.74.
Step 12596 (30 ms): -199.32.
Step 12634 (30 ms): -198.71.
Step 12671 (29 ms): -195.93.
Step 12709 (30 ms): -207.67.
Step 12746 (29 ms): -207.7.
Step 12784 (13 ms): -257.45.

Epoch 34 (11.1 s):
    Evaluating model.
    Full set (5.44 s): ELBO: -202.12, ENRE: -195.64, KL: 6.4855.
    Saving model parameters.
    Model parameters saved (75 ms).

Step 12822 (30 ms): -192.93.
Step 12859 (30 ms): -203.47.
Step 12897 (30 ms): -200.63.
Step 12934 (30 ms): -193.5.
Step 12972 (30 ms): -200.85.
Step 13010 (30 ms): -205.19.
Step 13047 (30 ms): -204.16.
Step 13085 (30 ms): -206.38.
Step 13122 (30 ms): -200.07.
Step 13160 (14 ms): -179.51.

Epoch 35 (11.2 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -201.7, ENRE: -195.21, KL: 6.4854.
    Saving model parameters.
    Model parameters saved (76 ms).

Step 13198 (30 ms): -206.32.
Step 13235 (29 ms): -196.58.
Step 13273 (29 ms): -204.01.
Step 13310 (29 ms): -207.12.
Step 13348 (29 ms): -208.73.
Step 13386 (30 ms): -194.36.
Step 13423 (29 ms): -198.35.
Step 13461 (29 ms): -194.97.
Step 13498 (29 ms): -188.56.
Step 13536 (13 ms): -228.32.

Epoch 36 (11.1 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -201.82, ENRE: -195.23, KL: 6.5854.
    Saving model parameters.
    Model parameters saved (74 ms).

Step 13574 (29 ms): -200.23.
Step 13611 (30 ms): -202.54.
Step 13649 (30 ms): -200.04.
Step 13686 (30 ms): -205.16.
Step 13724 (29 ms): -192.03.
Step 13762 (29 ms): -202.85.
Step 13799 (29 ms): -196.25.
Step 13837 (29 ms): -203.7.
Step 13874 (30 ms): -208.98.
Step 13912 (13 ms): -210.31.

Epoch 37 (11.1 s):
    Evaluating model.
    Full set (5.49 s): ELBO: -201.41, ENRE: -194.77, KL: 6.6436.
    Saving model parameters.
    Model parameters saved (76 ms).

Step 13950 (31 ms): -207.97.
Step 13987 (30 ms): -192.34.
Step 14025 (29 ms): -190.03.
Step 14062 (29 ms): -202.3.
Step 14100 (29 ms): -206.43.
Step 14138 (29 ms): -200.41.
Step 14175 (29 ms): -206.16.
Step 14213 (30 ms): -216.42.
Step 14250 (29 ms): -199.41.
Step 14288 (13 ms): -214.92.

Epoch 38 (11.1 s):
    Evaluating model.
    Full set (5.44 s): ELBO: -201.34, ENRE: -194.81, KL: 6.5289.
    Saving model parameters.
    Model parameters saved (78 ms).

Step 14326 (29 ms): -204.85.
Step 14363 (29 ms): -201.76.
Step 14401 (29 ms): -195.41.
Step 14438 (29 ms): -214.99.
Step 14476 (30 ms): -205.82.
Step 14514 (29 ms): -190.5.
Step 14551 (29 ms): -198.99.
Step 14589 (29 ms): -206.04.
Step 14626 (31 ms): -216.3.
Step 14664 (13 ms): -176.71.

Epoch 39 (11 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -201.45, ENRE: -195.13, KL: 6.3173.
    Saving model parameters.
    Model parameters saved (78 ms).

Step 14702 (30 ms): -207.49.
Step 14739 (32 ms): -226.53.
Step 14777 (29 ms): -193.51.
Step 14814 (30 ms): -194.6.
Step 14852 (30 ms): -211.07.
Step 14890 (30 ms): -196.72.
Step 14927 (31 ms): -198.51.
Step 14965 (30 ms): -203.41.
Step 15002 (30 ms): -199.96.
Step 15040 (13 ms): -214.67.

Epoch 40 (11.2 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -201.2, ENRE: -194.66, KL: 6.5379.
    Saving model parameters.
    Model parameters saved (75 ms).

Step 15078 (30 ms): -216.17.
Step 15115 (30 ms): -194.79.
Step 15153 (29 ms): -198.62.
Step 15190 (30 ms): -208.42.
Step 15228 (29 ms): -198.86.
Step 15266 (30 ms): -201.23.
Step 15303 (30 ms): -226.28.
Step 15341 (29 ms): -209.72.
Step 15378 (30 ms): -208.9.
Step 15416 (14 ms): -409.21.

Epoch 41 (11.1 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -201.37, ENRE: -194.84, KL: 6.531.
    Saving model parameters.
    Model parameters saved (76 ms).

Step 15454 (29 ms): -201.47.
Step 15491 (30 ms): -200.36.
Step 15529 (29 ms): -212.5.
Step 15566 (30 ms): -208.92.
Step 15604 (29 ms): -187.59.
Step 15642 (30 ms): -213.77.
Step 15679 (30 ms): -212.26.
Step 15717 (30 ms): -193.03.
Step 15754 (30 ms): -205.94.
Step 15792 (13 ms): -265.64.

Epoch 42 (11.2 s):
    Evaluating model.
    Full set (5.5 s): ELBO: -201.21, ENRE: -194.7, KL: 6.5107.
    Saving model parameters.
    Model parameters saved (78 ms).

Step 15830 (29 ms): -218.41.
Step 15867 (30 ms): -203.66.
Step 15905 (29 ms): -222.77.
Step 15942 (30 ms): -202.24.
Step 15980 (29 ms): -198.14.
Step 16018 (30 ms): -193.93.
Step 16055 (31 ms): -206.67.
Step 16093 (29 ms): -210.91.
Step 16130 (30 ms): -199.79.
Step 16168 (13 ms): -211.45.

Epoch 43 (11.1 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -200.76, ENRE: -194.4, KL: 6.3546.
    Saving model parameters.
    Model parameters saved (75 ms).

Step 16206 (29 ms): -191.21.
Step 16243 (29 ms): -200.85.
Step 16281 (30 ms): -189.59.
Step 16318 (29 ms): -196.37.
Step 16356 (29 ms): -202.23.
Step 16394 (29 ms): -190.53.
Step 16431 (29 ms): -194.68.
Step 16469 (29 ms): -204.71.
Step 16506 (30 ms): -205.94.
Step 16544 (13 ms): -186.06.

Epoch 44 (11.1 s):
    Evaluating model.
    Full set (5.49 s): ELBO: -200.84, ENRE: -194.3, KL: 6.535.
    Saving model parameters.
    Model parameters saved (76 ms).

Step 16582 (30 ms): -207.08.
Step 16619 (29 ms): -184.17.
Step 16657 (29 ms): -197.27.
Step 16694 (29 ms): -199.98.
Step 16732 (30 ms): -206.71.
Step 16770 (30 ms): -198.68.
Step 16807 (30 ms): -214.84.
Step 16845 (29 ms): -197.62.
Step 16882 (29 ms): -190.14.
Step 16920 (13 ms): -231.9.

Epoch 45 (11.1 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -200.67, ENRE: -194.26, KL: 6.4058.
    Saving model parameters.
    Model parameters saved (77 ms).

Step 16958 (30 ms): -207.29.
Step 16995 (29 ms): -205.51.
Step 17033 (29 ms): -205.93.
Step 17070 (29 ms): -201.91.
Step 17108 (29 ms): -190.86.
Step 17146 (30 ms): -198.98.
Step 17183 (29 ms): -197.2.
Step 17221 (29 ms): -178.22.
Step 17258 (30 ms): -194.33.
Step 17296 (13 ms): -198.41.

Epoch 46 (11.1 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -200.7, ENRE: -194.25, KL: 6.4439.
    Saving model parameters.
    Model parameters saved (75 ms).

Step 17334 (30 ms): -202.37.
Step 17371 (29 ms): -191.59.
Step 17409 (30 ms): -198.56.
Step 17446 (30 ms): -199.17.
Step 17484 (31 ms): -196.79.
Step 17522 (30 ms): -205.2.
Step 17559 (29 ms): -196.12.
Step 17597 (30 ms): -189.84.
Step 17634 (30 ms): -200.43.
Step 17672 (14 ms): -327.03.

Epoch 47 (11.2 s):
    Evaluating model.
    Full set (5.48 s): ELBO: -200.63, ENRE: -194.17, KL: 6.4532.
    Saving model parameters.
    Model parameters saved (73 ms).

Step 17710 (30 ms): -204.97.
Step 17747 (29 ms): -193.17.
Step 17785 (29 ms): -213.04.
Step 17822 (30 ms): -213.63.
Step 17860 (30 ms): -196.17.
Step 17898 (30 ms): -183.23.
Step 17935 (30 ms): -213.58.
Step 17973 (29 ms): -200.22.
Step 18010 (29 ms): -209.05.
Step 18048 (13 ms): -180.55.

Epoch 48 (11.1 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -200.51, ENRE: -194.16, KL: 6.3568.
    Saving model parameters.
    Model parameters saved (75 ms).

Step 18086 (30 ms): -199.65.
Step 18123 (29 ms): -209.46.
Step 18161 (29 ms): -204.3.
Step 18198 (29 ms): -208.41.
Step 18236 (30 ms): -202.15.
Step 18274 (30 ms): -193.36.
Step 18311 (29 ms): -189.28.
Step 18349 (29 ms): -196.26.
Step 18386 (30 ms): -210.06.
Step 18424 (14 ms): -190.07.

Epoch 49 (11.1 s):
    Evaluating model.
    Full set (5.5 s): ELBO: -200.54, ENRE: -193.99, KL: 6.5428.
    Saving model parameters.
    Model parameters saved (77 ms).

Step 18462 (30 ms): -193.67.
Step 18499 (30 ms): -195.93.
Step 18537 (29 ms): -198.61.
Step 18574 (29 ms): -206.23.
Step 18612 (30 ms): -189.31.
Step 18650 (29 ms): -202.36.
Step 18687 (29 ms): -194.62.
Step 18725 (29 ms): -202.67.
Step 18762 (29 ms): -213.17.
Step 18800 (13 ms): -202.95.

Epoch 50 (11.1 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -200.47, ENRE: -194.01, KL: 6.4672.
    Saving model parameters.
    Model parameters saved (74 ms).

Model trained for 50 epochs (13m 57s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (892 ms).

Converting data set value array to sparse matrix.
Data set value array converted (309 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.6 s):  ELBO: -424.81, ENRE: -418.36, KL: 6.4509.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (513 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.3153725576276276
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 44
kl weight: 1.3153725576276276
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (46 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.2 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.89 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 44
    hidden sizes: 230, 262, 75, 261
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.3153725576276276
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 4 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 230)
    ENCODER/1/DENSE/biases:0             (230,)
    ENCODER/1/BATCH_NORM/beta:0          (230,)
    ENCODER/2/DENSE/weights:0            (230, 262)
    ENCODER/2/DENSE/biases:0             (262,)
    ENCODER/2/BATCH_NORM/beta:0          (262,)
    ENCODER/3/DENSE/weights:0            (262, 75)
    ENCODER/3/DENSE/biases:0             (75,)
    ENCODER/3/BATCH_NORM/beta:0          (75,)
    ENCODER/4/DENSE/weights:0            (75, 261)
    ENCODER/4/DENSE/biases:0             (261,)
    ENCODER/4/BATCH_NORM/beta:0          (261,)
    POSTERIOR/MU/DENSE/weights:0         (261, 44)
    POSTERIOR/MU/DENSE/biases:0          (44,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (261, 44)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (44,)
    DECODER/4/DENSE/weights:0            (44, 261)
    DECODER/4/DENSE/biases:0             (261,)
    DECODER/4/BATCH_NORM/beta:0          (261,)
    DECODER/3/DENSE/weights:0            (261, 75)
    DECODER/3/DENSE/biases:0             (75,)
    DECODER/3/BATCH_NORM/beta:0          (75,)
    DECODER/2/DENSE/weights:0            (75, 262)
    DECODER/2/DENSE/biases:0             (262,)
    DECODER/2/BATCH_NORM/beta:0          (262,)
    DECODER/1/DENSE/weights:0            (262, 230)
    DECODER/1/DENSE/biases:0             (230,)
    DECODER/1/BATCH_NORM/beta:0          (230,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (230, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (472 ms).

Training model for 50 epochs on original values.

Step 38 (36 ms): -2147.1.
Step 75 (36 ms): -1736.6.
Step 113 (35 ms): -1457.1.
Step 150 (35 ms): -1264.2.
Step 188 (35 ms): -1080.
Step 226 (35 ms): -943.75.
Step 263 (35 ms): -852.97.
Step 301 (35 ms): -765.5.
Step 338 (35 ms): -697.9.
Step 376 (19 ms): -644.67.

Epoch 1 (15.7 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.71 s): ELBO: -1681.2, ENRE: -1651, KL: 30.24.
    Saving model parameters.
    Model parameters saved (183 ms).

Step 414 (35 ms): -532.23.
Step 451 (35 ms): -466.54.
Step 489 (34 ms): -400.56.
Step 526 (35 ms): -382.81.
Step 564 (34 ms): -352.16.
Step 602 (35 ms): -334.3.
Step 639 (35 ms): -330.82.
Step 677 (35 ms): -317.72.
Step 714 (34 ms): -304.13.
Step 752 (16 ms): -312.28.

Epoch 2 (13.1 s):
    Warm-up weight: 0.25
    Evaluating model.
    Full set (6.05 s): ELBO: -860.6, ENRE: -845.75, KL: 14.855.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 790 (35 ms): -292.94.
Step 827 (35 ms): -293.96.
Step 865 (35 ms): -267.94.
Step 902 (35 ms): -268.33.
Step 940 (35 ms): -277.75.
Step 978 (35 ms): -262.61.
Step 1015 (35 ms): -254.36.
Step 1053 (35 ms): -267.72.
Step 1090 (35 ms): -263.41.
Step 1128 (18 ms): -258.84.

Epoch 3 (13.1 s):
    Warm-up weight: 0.5
    Evaluating model.
    Full set (6.04 s): ELBO: -523.13, ENRE: -512.65, KL: 10.478.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 1166 (34 ms): -242.49.
Step 1203 (35 ms): -244.29.
Step 1241 (34 ms): -257.36.
Step 1278 (34 ms): -246.39.
Step 1316 (34 ms): -230.91.
Step 1354 (35 ms): -229.68.
Step 1391 (34 ms): -240.6.
Step 1429 (34 ms): -250.89.
Step 1466 (34 ms): -236.78.
Step 1504 (16 ms): -284.1.

Epoch 4 (12.9 s):
    Warm-up weight: 0.75
    Evaluating model.
    Full set (6.03 s): ELBO: -367.42, ENRE: -358.57, KL: 8.851.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 1542 (34 ms): -233.4.
Step 1579 (34 ms): -240.08.
Step 1617 (35 ms): -242.69.
Step 1654 (35 ms): -240.05.
Step 1692 (35 ms): -237.24.
Step 1730 (34 ms): -219.32.
Step 1767 (34 ms): -232.04.
Step 1805 (37 ms): -231.77.
Step 1842 (35 ms): -246.93.
Step 1880 (16 ms): -370.83.

Epoch 5 (13 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -292.04, ENRE: -284.64, KL: 7.4002.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 1918 (34 ms): -233.23.
Step 1955 (34 ms): -211.85.
Step 1993 (34 ms): -210.43.
Step 2030 (34 ms): -233.83.
Step 2068 (34 ms): -217.49.
Step 2106 (34 ms): -224.34.
Step 2143 (35 ms): -231.46.
Step 2181 (34 ms): -233.08.
Step 2218 (34 ms): -213.73.
Step 2256 (16 ms): -245.73.

Epoch 6 (12.9 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -256.48, ENRE: -249.57, KL: 6.9069.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 2294 (34 ms): -220.76.
Step 2331 (34 ms): -223.59.
Step 2369 (35 ms): -217.57.
Step 2406 (34 ms): -208.44.
Step 2444 (34 ms): -220.19.
Step 2482 (35 ms): -227.42.
Step 2519 (36 ms): -218.4.
Step 2557 (35 ms): -225.02.
Step 2594 (36 ms): -214.38.
Step 2632 (16 ms): -242.01.

Epoch 7 (13.1 s):
    Evaluating model.
    Full set (6.1 s): ELBO: -235.65, ENRE: -228.6, KL: 7.0508.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 2670 (35 ms): -228.34.
Step 2707 (35 ms): -226.05.
Step 2745 (34 ms): -229.44.
Step 2782 (35 ms): -226.42.
Step 2820 (35 ms): -224.03.
Step 2858 (34 ms): -211.12.
Step 2895 (35 ms): -224.74.
Step 2933 (35 ms): -240.01.
Step 2970 (35 ms): -225.02.
Step 3008 (16 ms): -268.24.

Epoch 8 (13.1 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -225.11, ENRE: -218.11, KL: 6.9952.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 3046 (34 ms): -210.96.
Step 3083 (34 ms): -217.34.
Step 3121 (35 ms): -210.1.
Step 3158 (35 ms): -211.85.
Step 3196 (35 ms): -218.83.
Step 3234 (34 ms): -218.1.
Step 3271 (35 ms): -218.92.
Step 3309 (34 ms): -201.24.
Step 3346 (34 ms): -222.63.
Step 3384 (16 ms): -281.12.

Epoch 9 (13.1 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -219.47, ENRE: -212.69, KL: 6.7754.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 3422 (35 ms): -217.38.
Step 3459 (35 ms): -217.83.
Step 3497 (34 ms): -227.3.
Step 3534 (34 ms): -205.58.
Step 3572 (34 ms): -209.91.
Step 3610 (34 ms): -224.64.
Step 3647 (34 ms): -206.79.
Step 3685 (34 ms): -215.96.
Step 3722 (34 ms): -213.3.
Step 3760 (16 ms): -278.79.

Epoch 10 (13 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -216.11, ENRE: -209.33, KL: 6.7791.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 3798 (34 ms): -216.16.
Step 3835 (34 ms): -202.35.
Step 3873 (34 ms): -229.41.
Step 3910 (36 ms): -221.17.
Step 3948 (36 ms): -219.83.
Step 3986 (34 ms): -208.06.
Step 4023 (34 ms): -209.49.
Step 4061 (34 ms): -211.26.
Step 4098 (35 ms): -215.43.
Step 4136 (16 ms): -384.75.

Epoch 11 (13 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -214.37, ENRE: -207.88, KL: 6.4947.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 4174 (34 ms): -218.41.
Step 4211 (34 ms): -209.86.
Step 4249 (34 ms): -217.21.
Step 4286 (34 ms): -217.7.
Step 4324 (35 ms): -200.35.
Step 4362 (34 ms): -214.39.
Step 4399 (35 ms): -214.16.
Step 4437 (34 ms): -207.67.
Step 4474 (34 ms): -223.89.
Step 4512 (16 ms): -263.37.

Epoch 12 (12.9 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -212.73, ENRE: -206.21, KL: 6.5283.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 4550 (34 ms): -205.03.
Step 4587 (36 ms): -210.2.
Step 4625 (34 ms): -213.04.
Step 4662 (34 ms): -205.2.
Step 4700 (35 ms): -206.58.
Step 4738 (34 ms): -226.36.
Step 4775 (35 ms): -220.8.
Step 4813 (34 ms): -200.47.
Step 4850 (35 ms): -213.48.
Step 4888 (16 ms): -355.2.

Epoch 13 (13 s):
    Evaluating model.
    Full set (6.1 s): ELBO: -212.12, ENRE: -205.71, KL: 6.4055.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 4926 (35 ms): -214.55.
Step 4963 (35 ms): -219.39.
Step 5001 (35 ms): -214.81.
Step 5038 (35 ms): -208.39.
Step 5076 (35 ms): -211.22.
Step 5114 (34 ms): -202.43.
Step 5151 (36 ms): -204.11.
Step 5189 (35 ms): -209.96.
Step 5226 (34 ms): -204.35.
Step 5264 (16 ms): -504.19.

Epoch 14 (13.1 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -212.15, ENRE: -205.83, KL: 6.3191.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 5302 (35 ms): -203.21.
Step 5339 (35 ms): -199.15.
Step 5377 (35 ms): -193.05.
Step 5414 (35 ms): -218.2.
Step 5452 (35 ms): -222.03.
Step 5490 (35 ms): -208.42.
Step 5527 (35 ms): -201.09.
Step 5565 (35 ms): -210.55.
Step 5602 (35 ms): -205.85.
Step 5640 (16 ms): -197.83.

Epoch 15 (13.1 s):
    Evaluating model.
    Full set (6.11 s): ELBO: -210.07, ENRE: -203.87, KL: 6.2016.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 5678 (35 ms): -200.87.
Step 5715 (34 ms): -206.73.
Step 5753 (36 ms): -215.53.
Step 5790 (35 ms): -210.35.
Step 5828 (35 ms): -214.94.
Step 5866 (34 ms): -195.59.
Step 5903 (34 ms): -219.84.
Step 5941 (34 ms): -193.84.
Step 5978 (35 ms): -227.14.
Step 6016 (16 ms): -202.55.

Epoch 16 (13 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -209.45, ENRE: -203.4, KL: 6.0424.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 6054 (34 ms): -200.35.
Step 6091 (34 ms): -210.47.
Step 6129 (34 ms): -211.52.
Step 6166 (34 ms): -191.72.
Step 6204 (34 ms): -221.62.
Step 6242 (34 ms): -210.76.
Step 6279 (35 ms): -210.86.
Step 6317 (35 ms): -199.2.
Step 6354 (34 ms): -198.49.
Step 6392 (16 ms): -218.31.

Epoch 17 (12.9 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -208.69, ENRE: -202.68, KL: 6.008.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 6430 (34 ms): -207.
Step 6467 (34 ms): -209.57.
Step 6505 (34 ms): -212.33.
Step 6542 (36 ms): -222.75.
Step 6580 (35 ms): -213.28.
Step 6618 (36 ms): -219.13.
Step 6655 (35 ms): -226.6.
Step 6693 (34 ms): -210.69.
Step 6730 (34 ms): -217.09.
Step 6768 (16 ms): -222.91.

Epoch 18 (13 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -208.12, ENRE: -202.2, KL: 5.9195.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 6806 (34 ms): -201.38.
Step 6843 (34 ms): -200.55.
Step 6881 (34 ms): -214.5.
Step 6918 (34 ms): -201.63.
Step 6956 (35 ms): -199.28.
Step 6994 (34 ms): -203.76.
Step 7031 (34 ms): -228.9.
Step 7069 (35 ms): -210.62.
Step 7106 (36 ms): -209.25.
Step 7144 (16 ms): -230.64.

Epoch 19 (13 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -206.87, ENRE: -201.02, KL: 5.8549.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 7182 (35 ms): -196.01.
Step 7219 (35 ms): -202.49.
Step 7257 (35 ms): -192.57.
Step 7294 (35 ms): -209.47.
Step 7332 (34 ms): -205.26.
Step 7370 (35 ms): -211.33.
Step 7407 (35 ms): -206.86.
Step 7445 (35 ms): -206.23.
Step 7482 (34 ms): -201.01.
Step 7520 (17 ms): -227.69.

Epoch 20 (13.2 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -206.81, ENRE: -200.96, KL: 5.8589.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 7558 (35 ms): -221.09.
Step 7595 (35 ms): -201.75.
Step 7633 (35 ms): -199.36.
Step 7670 (34 ms): -207.48.
Step 7708 (34 ms): -214.55.
Step 7746 (34 ms): -192.23.
Step 7783 (34 ms): -204.4.
Step 7821 (34 ms): -203.97.
Step 7858 (36 ms): -202.11.
Step 7896 (16 ms): -206.78.

Epoch 21 (13 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -206.22, ENRE: -200.32, KL: 5.8941.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 7934 (35 ms): -202.52.
Step 7971 (35 ms): -204.35.
Step 8009 (34 ms): -202.54.
Step 8046 (36 ms): -198.62.
Step 8084 (35 ms): -202.05.
Step 8122 (35 ms): -201.86.
Step 8159 (36 ms): -204.3.
Step 8197 (34 ms): -196.23.
Step 8234 (34 ms): -211.88.
Step 8272 (16 ms): -223.17.

Epoch 22 (13 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -205.38, ENRE: -199.63, KL: 5.7478.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 8310 (34 ms): -203.59.
Step 8347 (34 ms): -221.8.
Step 8385 (34 ms): -211.2.
Step 8422 (34 ms): -213.3.
Step 8460 (34 ms): -207.73.
Step 8498 (34 ms): -206.44.
Step 8535 (34 ms): -203.21.
Step 8573 (34 ms): -201.48.
Step 8610 (35 ms): -199.64.
Step 8648 (16 ms): -203.1.

Epoch 23 (12.9 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -204.98, ENRE: -199.24, KL: 5.7384.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 8686 (34 ms): -211.73.
Step 8723 (34 ms): -208.75.
Step 8761 (35 ms): -197.17.
Step 8798 (35 ms): -212.07.
Step 8836 (34 ms): -200.44.
Step 8874 (34 ms): -203.01.
Step 8911 (35 ms): -202.3.
Step 8949 (34 ms): -208.83.
Step 8986 (34 ms): -203.46.
Step 9024 (16 ms): -219.7.

Epoch 24 (13 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -205.04, ENRE: -199.24, KL: 5.8035.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 9062 (34 ms): -195.02.
Step 9099 (36 ms): -206.38.
Step 9137 (34 ms): -196.96.
Step 9174 (34 ms): -197.42.
Step 9212 (35 ms): -207.91.
Step 9250 (35 ms): -195.65.
Step 9287 (34 ms): -200.17.
Step 9325 (35 ms): -204.46.
Step 9362 (36 ms): -215.48.
Step 9400 (16 ms): -217.69.

Epoch 25 (13 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -204.56, ENRE: -198.76, KL: 5.8037.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 9438 (35 ms): -196.8.
Step 9475 (35 ms): -226.66.
Step 9513 (35 ms): -205.14.
Step 9550 (35 ms): -207.36.
Step 9588 (35 ms): -201.28.
Step 9626 (34 ms): -204.2.
Step 9663 (34 ms): -191.69.
Step 9701 (35 ms): -204.55.
Step 9738 (35 ms): -211.55.
Step 9776 (17 ms): -262.35.

Epoch 26 (13.2 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -204.36, ENRE: -198.55, KL: 5.8171.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 9814 (34 ms): -206.17.
Step 9851 (35 ms): -193.44.
Step 9889 (34 ms): -201.9.
Step 9926 (34 ms): -196.24.
Step 9964 (34 ms): -203.48.
Step 10002 (34 ms): -202.82.
Step 10039 (36 ms): -198.64.
Step 10077 (35 ms): -227.87.
Step 10114 (34 ms): -203.1.
Step 10152 (16 ms): -202.08.

Epoch 27 (13 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -203.75, ENRE: -197.87, KL: 5.8862.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 10190 (34 ms): -207.69.
Step 10227 (35 ms): -199.47.
Step 10265 (35 ms): -210.59.
Step 10302 (34 ms): -194.42.
Step 10340 (34 ms): -204.42.
Step 10378 (34 ms): -193.82.
Step 10415 (34 ms): -202.11.
Step 10453 (34 ms): -204.1.
Step 10490 (34 ms): -206.47.
Step 10528 (16 ms): -240.32.

Epoch 28 (13.1 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -203.72, ENRE: -197.79, KL: 5.9337.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 10566 (34 ms): -195.81.
Step 10603 (34 ms): -204.66.
Step 10641 (34 ms): -205.54.
Step 10678 (34 ms): -199.22.
Step 10716 (34 ms): -191.41.
Step 10754 (34 ms): -193.02.
Step 10791 (34 ms): -205.66.
Step 10829 (34 ms): -205.76.
Step 10866 (35 ms): -191.23.
Step 10904 (16 ms): -189.87.

Epoch 29 (12.9 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -202.7, ENRE: -196.95, KL: 5.751.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 10942 (34 ms): -196.07.
Step 10979 (35 ms): -209.34.
Step 11017 (34 ms): -208.49.
Step 11054 (34 ms): -214.67.
Step 11092 (34 ms): -214.22.
Step 11130 (34 ms): -204.46.
Step 11167 (34 ms): -194.57.
Step 11205 (35 ms): -202.92.
Step 11242 (34 ms): -195.73.
Step 11280 (16 ms): -218.95.

Epoch 30 (13 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -202.87, ENRE: -197.04, KL: 5.8324.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 11318 (34 ms): -202.95.
Step 11355 (34 ms): -219.59.
Step 11393 (36 ms): -197.36.
Step 11430 (34 ms): -206.31.
Step 11468 (36 ms): -209.44.
Step 11506 (34 ms): -202.29.
Step 11543 (34 ms): -195.
Step 11581 (36 ms): -200.98.
Step 11618 (35 ms): -212.06.
Step 11656 (16 ms): -287.17.

Epoch 31 (13 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -203.15, ENRE: -197.33, KL: 5.8268.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 11694 (34 ms): -212.21.
Step 11731 (35 ms): -196.82.
Step 11769 (36 ms): -206.55.
Step 11806 (34 ms): -192.59.
Step 11844 (35 ms): -197.14.
Step 11882 (35 ms): -191.38.
Step 11919 (38 ms): -208.88.
Step 11957 (35 ms): -195.43.
Step 11994 (35 ms): -205.02.
Step 12032 (17 ms): -251.58.

Epoch 32 (13.1 s):
    Evaluating model.
    Full set (6.11 s): ELBO: -202.87, ENRE: -196.97, KL: 5.8969.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 12070 (34 ms): -196.13.
Step 12107 (35 ms): -195.78.
Step 12145 (35 ms): -192.21.
Step 12182 (35 ms): -203.99.
Step 12220 (34 ms): -199.21.
Step 12258 (36 ms): -214.25.
Step 12295 (35 ms): -196.66.
Step 12333 (34 ms): -188.8.
Step 12370 (35 ms): -195.66.
Step 12408 (16 ms): -199.52.

Epoch 33 (13.1 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -202.3, ENRE: -196.47, KL: 5.8287.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 12446 (35 ms): -210.02.
Step 12483 (35 ms): -194.83.
Step 12521 (34 ms): -199.74.
Step 12558 (35 ms): -187.09.
Step 12596 (34 ms): -198.84.
Step 12634 (34 ms): -204.51.
Step 12671 (34 ms): -196.12.
Step 12709 (34 ms): -202.81.
Step 12746 (34 ms): -206.9.
Step 12784 (17 ms): -324.15.

Epoch 34 (13 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -201.83, ENRE: -196, KL: 5.8256.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 12822 (37 ms): -196.76.
Step 12859 (34 ms): -198.16.
Step 12897 (34 ms): -204.5.
Step 12934 (34 ms): -203.11.
Step 12972 (34 ms): -191.85.
Step 13010 (34 ms): -195.
Step 13047 (34 ms): -212.64.
Step 13085 (34 ms): -193.85.
Step 13122 (35 ms): -202.1.
Step 13160 (16 ms): -271.68.

Epoch 35 (13 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -201.65, ENRE: -195.83, KL: 5.8191.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 13198 (34 ms): -193.11.
Step 13235 (34 ms): -206.09.
Step 13273 (35 ms): -204.58.
Step 13310 (34 ms): -212.14.
Step 13348 (34 ms): -209.04.
Step 13386 (34 ms): -205.02.
Step 13423 (34 ms): -198.44.
Step 13461 (34 ms): -200.47.
Step 13498 (34 ms): -202.46.
Step 13536 (16 ms): -417.1.

Epoch 36 (12.9 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -202.33, ENRE: -196.3, KL: 6.0291.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 13574 (34 ms): -204.05.
Step 13611 (36 ms): -201.12.
Step 13649 (35 ms): -214.23.
Step 13686 (34 ms): -201.38.
Step 13724 (34 ms): -199.38.
Step 13762 (34 ms): -192.38.
Step 13799 (34 ms): -210.2.
Step 13837 (34 ms): -193.33.
Step 13874 (35 ms): -203.57.
Step 13912 (17 ms): -205.29.

Epoch 37 (13.1 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -201.27, ENRE: -195.38, KL: 5.8911.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 13950 (35 ms): -230.19.
Step 13987 (35 ms): -196.07.
Step 14025 (34 ms): -193.24.
Step 14062 (35 ms): -200.47.
Step 14100 (34 ms): -206.16.
Step 14138 (35 ms): -203.72.
Step 14175 (34 ms): -184.44.
Step 14213 (35 ms): -188.71.
Step 14250 (36 ms): -202.06.
Step 14288 (16 ms): -212.24.

Epoch 38 (13.1 s):
    Evaluating model.
    Full set (6.11 s): ELBO: -201.27, ENRE: -195.44, KL: 5.8242.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 14326 (35 ms): -188.74.
Step 14363 (35 ms): -189.34.
Step 14401 (35 ms): -207.35.
Step 14438 (35 ms): -203.2.
Step 14476 (34 ms): -203.33.
Step 14514 (35 ms): -205.17.
Step 14551 (34 ms): -204.51.
Step 14589 (34 ms): -204.4.
Step 14626 (35 ms): -206.52.
Step 14664 (16 ms): -211.37.

Epoch 39 (13.1 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -201.2, ENRE: -195.4, KL: 5.7931.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 14702 (34 ms): -191.47.
Step 14739 (35 ms): -197.56.
Step 14777 (34 ms): -220.6.
Step 14814 (35 ms): -204.35.
Step 14852 (35 ms): -206.6.
Step 14890 (34 ms): -202.04.
Step 14927 (34 ms): -200.35.
Step 14965 (34 ms): -197.41.
Step 15002 (34 ms): -203.48.
Step 15040 (16 ms): -227.76.

Epoch 40 (12.9 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -200.92, ENRE: -194.98, KL: 5.9328.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 15078 (35 ms): -201.49.
Step 15115 (34 ms): -194.51.
Step 15153 (34 ms): -207.58.
Step 15190 (35 ms): -200.55.
Step 15228 (34 ms): -199.33.
Step 15266 (34 ms): -210.34.
Step 15303 (34 ms): -191.02.
Step 15341 (34 ms): -201.68.
Step 15378 (34 ms): -194.
Step 15416 (16 ms): -259.58.

Epoch 41 (13 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -200.97, ENRE: -195.1, KL: 5.8702.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 15454 (34 ms): -192.99.
Step 15491 (35 ms): -203.84.
Step 15529 (35 ms): -210.37.
Step 15566 (35 ms): -198.
Step 15604 (35 ms): -201.07.
Step 15642 (34 ms): -203.89.
Step 15679 (34 ms): -194.51.
Step 15717 (34 ms): -193.
Step 15754 (35 ms): -202.61.
Step 15792 (18 ms): -203.88.

Epoch 42 (13 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -200.9, ENRE: -195.09, KL: 5.8071.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 15830 (35 ms): -203.95.
Step 15867 (34 ms): -190.42.
Step 15905 (36 ms): -201.73.
Step 15942 (35 ms): -202.97.
Step 15980 (35 ms): -197.62.
Step 16018 (35 ms): -189.56.
Step 16055 (34 ms): -219.89.
Step 16093 (35 ms): -188.61.
Step 16130 (34 ms): -188.55.
Step 16168 (16 ms): -206.66.

Epoch 43 (13.1 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -200.55, ENRE: -194.69, KL: 5.8586.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 16206 (35 ms): -201.86.
Step 16243 (35 ms): -202.39.
Step 16281 (34 ms): -201.77.
Step 16318 (35 ms): -209.06.
Step 16356 (35 ms): -190.6.
Step 16394 (35 ms): -190.61.
Step 16431 (35 ms): -190.64.
Step 16469 (35 ms): -195.8.
Step 16506 (35 ms): -210.08.
Step 16544 (16 ms): -220.19.

Epoch 44 (13 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -200.5, ENRE: -194.62, KL: 5.8818.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 16582 (35 ms): -205.83.
Step 16619 (35 ms): -213.79.
Step 16657 (34 ms): -195.78.
Step 16694 (35 ms): -197.36.
Step 16732 (35 ms): -195.31.
Step 16770 (34 ms): -198.33.
Step 16807 (34 ms): -190.28.
Step 16845 (35 ms): -188.61.
Step 16882 (35 ms): -197.28.
Step 16920 (16 ms): -200.52.

Epoch 45 (13.1 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -201.03, ENRE: -195.12, KL: 5.9166.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 16958 (34 ms): -205.7.
Step 16995 (34 ms): -197.76.
Step 17033 (34 ms): -200.58.
Step 17070 (34 ms): -187.7.
Step 17108 (34 ms): -201.78.
Step 17146 (34 ms): -187.61.
Step 17183 (34 ms): -202.88.
Step 17221 (34 ms): -209.87.
Step 17258 (34 ms): -202.68.
Step 17296 (16 ms): -278.48.

Epoch 46 (12.9 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -200.52, ENRE: -194.71, KL: 5.8091.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 17334 (34 ms): -187.56.
Step 17371 (34 ms): -191.35.
Step 17409 (34 ms): -204.77.
Step 17446 (35 ms): -208.8.
Step 17484 (34 ms): -210.84.
Step 17522 (35 ms): -189.5.
Step 17559 (35 ms): -196.
Step 17597 (35 ms): -197.13.
Step 17634 (35 ms): -208.3.
Step 17672 (16 ms): -196.3.

Epoch 47 (13 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -200.47, ENRE: -194.62, KL: 5.8547.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 17710 (34 ms): -199.11.
Step 17747 (34 ms): -203.56.
Step 17785 (34 ms): -217.42.
Step 17822 (34 ms): -201.48.
Step 17860 (34 ms): -201.19.
Step 17898 (36 ms): -201.47.
Step 17935 (35 ms): -197.42.
Step 17973 (34 ms): -193.58.
Step 18010 (34 ms): -206.51.
Step 18048 (16 ms): -228.28.

Epoch 48 (13 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -200.61, ENRE: -194.72, KL: 5.8875.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 18086 (36 ms): -195.53.
Step 18123 (34 ms): -198.93.
Step 18161 (35 ms): -208.63.
Step 18198 (35 ms): -200.84.
Step 18236 (35 ms): -196.24.
Step 18274 (34 ms): -194.71.
Step 18311 (36 ms): -187.82.
Step 18349 (35 ms): -198.28.
Step 18386 (34 ms): -207.73.
Step 18424 (17 ms): -355.16.

Epoch 49 (13.2 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -200.56, ENRE: -194.65, KL: 5.9096.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 18462 (35 ms): -204.69.
Step 18499 (35 ms): -205.12.
Step 18537 (35 ms): -194.33.
Step 18574 (35 ms): -196.82.
Step 18612 (35 ms): -203.3.
Step 18650 (35 ms): -197.79.
Step 18687 (34 ms): -202.69.
Step 18725 (34 ms): -200.06.
Step 18762 (35 ms): -192.05.
Step 18800 (16 ms): -229.79.

Epoch 50 (13 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -200.6, ENRE: -194.67, KL: 5.9377.
    Saving model parameters.
    Model parameters saved (115 ms).

Model trained for 50 epochs (16m 6s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (858 ms).

Converting data set value array to sparse matrix.
Data set value array converted (274 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.88 s):  ELBO: -424.56, ENRE: -418.62, KL: 5.9315.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (709 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.2216466913643662
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 36
kl weight: 1.2216466913643662
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (49 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (3.99 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.7 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 36
    hidden sizes: 271, 186, 80, 269, 61
    latent distribution: gaussian
    reconstruction distribution: gaussian
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.2216466913643662
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 4 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 271)
    ENCODER/1/DENSE/biases:0             (271,)
    ENCODER/1/BATCH_NORM/beta:0          (271,)
    ENCODER/2/DENSE/weights:0            (271, 186)
    ENCODER/2/DENSE/biases:0             (186,)
    ENCODER/2/BATCH_NORM/beta:0          (186,)
    ENCODER/3/DENSE/weights:0            (186, 80)
    ENCODER/3/DENSE/biases:0             (80,)
    ENCODER/3/BATCH_NORM/beta:0          (80,)
    ENCODER/4/DENSE/weights:0            (80, 269)
    ENCODER/4/DENSE/biases:0             (269,)
    ENCODER/4/BATCH_NORM/beta:0          (269,)
    ENCODER/5/DENSE/weights:0            (269, 61)
    ENCODER/5/DENSE/biases:0             (61,)
    ENCODER/5/BATCH_NORM/beta:0          (61,)
    POSTERIOR/MU/DENSE/weights:0         (61, 36)
    POSTERIOR/MU/DENSE/biases:0          (36,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (61, 36)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (36,)
    DECODER/5/DENSE/weights:0            (36, 61)
    DECODER/5/DENSE/biases:0             (61,)
    DECODER/5/BATCH_NORM/beta:0          (61,)
    DECODER/4/DENSE/weights:0            (61, 269)
    DECODER/4/DENSE/biases:0             (269,)
    DECODER/4/BATCH_NORM/beta:0          (269,)
    DECODER/3/DENSE/weights:0            (269, 80)
    DECODER/3/DENSE/biases:0             (80,)
    DECODER/3/BATCH_NORM/beta:0          (80,)
    DECODER/2/DENSE/weights:0            (80, 186)
    DECODER/2/DENSE/biases:0             (186,)
    DECODER/2/BATCH_NORM/beta:0          (186,)
    DECODER/1/DENSE/weights:0            (186, 271)
    DECODER/1/DENSE/biases:0             (271,)
    DECODER/1/BATCH_NORM/beta:0          (271,)
    X_TILDE/MU/DENSE/weights:0           (271, 2000)
    X_TILDE/MU/DENSE/biases:0            (2000,)
    X_TILDE/LOG_SIGMA/DENSE/weights:0    (271, 2000)
    X_TILDE/LOG_SIGMA/DENSE/biases:0     (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (596 ms).

Training model for 50 epochs on original values.

Step 38 (45 ms): -3206.3.
Step 75 (44 ms): -2123.3.
Step 113 (43 ms): -1119.8.
Step 150 (43 ms): -549.43.
Step 188 (43 ms): -132.96.
Step 226 (43 ms): 134.62.
Step 263 (44 ms): 613.12.
Step 301 (42 ms): 948.59.
Step 338 (43 ms): 1234.1.
Step 376 (25 ms): -2742.1.

Epoch 1 (19.2 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.91 s): ELBO: -1836.6, ENRE: -1684.8, KL: 151.8.
    Saving model parameters.
    Model parameters saved (213 ms).

Step 414 (42 ms): 1496.4.
Step 451 (42 ms): 1702.6.
Step 489 (42 ms): 1907.7.
Step 526 (44 ms): 1834.9.
Step 564 (43 ms): 2089.
Step 602 (43 ms): 1963.8.
Step 639 (42 ms): 2234.3.
Step 677 (43 ms): 2001.6.
Step 714 (43 ms): 2057.2.
Step 752 (22 ms): 1442.7.

Epoch 2 (16.1 s):
    Warm-up weight: 0.25
    Evaluating model.
    Full set (6.25 s): ELBO: 89.126, ENRE: 158.69, KL: 69.562.
    Saving model parameters.
    Model parameters saved (127 ms).

Step 790 (42 ms): 2238.6.
Step 827 (42 ms): 2185.5.
Step 865 (43 ms): 2062.8.
Step 902 (43 ms): 2300.4.
Step 940 (43 ms): 2366.1.
Step 978 (43 ms): 2298.1.
Step 1015 (42 ms): 2292.1.
Step 1053 (43 ms): 2254.4.
Step 1090 (43 ms): 2113.1.
Step 1128 (20 ms): 843.69.

Epoch 3 (16 s):
    Warm-up weight: 0.5
    Evaluating model.
    Full set (6.26 s): ELBO: 1947.2, ENRE: 1987.3, KL: 40.155.
    Saving model parameters.
    Model parameters saved (127 ms).

Step 1166 (43 ms): 2215.3.
Step 1203 (42 ms): 2349.4.
Step 1241 (43 ms): 2345.8.
Step 1278 (44 ms): 2100.8.
Step 1316 (43 ms): 2444.2.
Step 1354 (43 ms): 2239.6.
Step 1391 (43 ms): 2289.
Step 1429 (42 ms): 2369.8.
Step 1466 (43 ms): 2469.1.
Step 1504 (20 ms): 551.03.

Epoch 4 (16.2 s):
    Warm-up weight: 0.75
    Evaluating model.
    Full set (6.24 s): ELBO: 2062.9, ENRE: 2098.4, KL: 35.425.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 1542 (43 ms): 2235.7.
Step 1579 (42 ms): 2438.5.
Step 1617 (43 ms): 2028.9.
Step 1654 (42 ms): 2217.
Step 1692 (42 ms): 2479.
Step 1730 (44 ms): 2437.8.
Step 1767 (42 ms): 2583.1.
Step 1805 (44 ms): 2478.2.
Step 1842 (42 ms): 2412.3.
Step 1880 (20 ms): 476.35.

Epoch 5 (16 s):
    Evaluating model.
    Full set (6.28 s): ELBO: 1946.2, ENRE: 1974.8, KL: 28.567.
    Saving model parameters.
    Model parameters saved (127 ms).

Step 1918 (43 ms): 2553.3.
Step 1955 (48 ms): 2439.2.
Step 1993 (42 ms): 2513.1.
Step 2030 (43 ms): 2422.5.
Step 2068 (42 ms): 2498.2.
Step 2106 (42 ms): 2154.1.
Step 2143 (42 ms): 2296.9.
Step 2181 (43 ms): 2502.
Step 2218 (42 ms): 2627.4.
Step 2256 (20 ms): 89.599.

Epoch 6 (16 s):
    Evaluating model.
    Full set (6.23 s): ELBO: 1954.6, ENRE: 1981.5, KL: 26.853.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 2294 (42 ms): 2016.6.
Step 2331 (42 ms): 2449.6.
Step 2369 (42 ms): 2545.2.
Step 2406 (42 ms): 2464.
Step 2444 (44 ms): 2512.6.
Step 2482 (42 ms): 2205.7.
Step 2519 (42 ms): 2394.8.
Step 2557 (42 ms): 2482.5.
Step 2594 (42 ms): 2499.
Step 2632 (20 ms): 288.21.

Epoch 7 (15.9 s):
    Evaluating model.
    Full set (6.26 s): ELBO: 2198, ENRE: 2224, KL: 25.979.
    Saving model parameters.
    Model parameters saved (132 ms).

Step 2670 (44 ms): 2450.5.
Step 2707 (43 ms): 2448.4.
Step 2745 (42 ms): 2510.4.
Step 2782 (42 ms): 2421.2.
Step 2820 (43 ms): 2540.2.
Step 2858 (42 ms): 2550.7.
Step 2895 (42 ms): 2495.5.
Step 2933 (43 ms): 2389.
Step 2970 (42 ms): 2319.1.
Step 3008 (20 ms): -17746.

Epoch 8 (16 s):
    Evaluating model.
    Full set (6.25 s): ELBO: 2146.4, ENRE: 2171.5, KL: 25.083.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 3046 (42 ms): 2458.6.
Step 3083 (43 ms): 2512.
Step 3121 (42 ms): 2431.8.
Step 3158 (43 ms): 2473.
Step 3196 (43 ms): 2485.
Step 3234 (43 ms): 2612.4.
Step 3271 (43 ms): 2491.5.
Step 3309 (43 ms): 2417.7.
Step 3346 (44 ms): 2486.4.
Step 3384 (21 ms): -8477.3.

Epoch 9 (16.1 s):
    Evaluating model.
    Full set (6.29 s): ELBO: 2222.8, ENRE: 2253.1, KL: 30.275.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 3422 (42 ms): 2554.9.
Step 3459 (43 ms): 2460.3.
Step 3497 (42 ms): 2522.7.
Step 3534 (42 ms): 2536.8.
Step 3572 (43 ms): 2549.7.
Step 3610 (43 ms): 2518.8.
Step 3647 (43 ms): 2477.2.
Step 3685 (42 ms): 2445.4.
Step 3722 (42 ms): 2508.3.
Step 3760 (20 ms): -485.16.

Epoch 10 (16.1 s):
    Evaluating model.
    Full set (6.26 s): ELBO: 2207.3, ENRE: 2238.4, KL: 31.124.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 3798 (43 ms): 2583.2.
Step 3835 (43 ms): 2519.6.
Step 3873 (43 ms): 2446.2.
Step 3910 (43 ms): 2488.9.
Step 3948 (44 ms): 2641.5.
Step 3986 (43 ms): 2535.7.
Step 4023 (42 ms): 2618.4.
Step 4061 (42 ms): 2448.7.
Step 4098 (43 ms): 2607.3.
Step 4136 (20 ms): -185.27.

Epoch 11 (16.1 s):
    Evaluating model.
    Full set (6.25 s): ELBO: 2253.1, ENRE: 2281.8, KL: 28.664.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 4174 (42 ms): 2518.9.
Step 4211 (43 ms): 2543.
Step 4249 (42 ms): 2632.8.
Step 4286 (42 ms): 2362.5.
Step 4324 (42 ms): 2549.1.
Step 4362 (43 ms): 2482.3.
Step 4399 (42 ms): 2589.7.
Step 4437 (42 ms): 2485.9.
Step 4474 (42 ms): 2623.4.
Step 4512 (20 ms): 405.21.

Epoch 12 (15.9 s):
    Evaluating model.
    Full set (6.26 s): ELBO: 2265.8, ENRE: 2294.5, KL: 28.621.
    Saving model parameters.
    Model parameters saved (127 ms).

Step 4550 (42 ms): 2554.3.
Step 4587 (42 ms): 2610.
Step 4625 (42 ms): 2443.6.
Step 4662 (43 ms): 2597.6.
Step 4700 (43 ms): 2633.8.
Step 4738 (43 ms): 2596.8.
Step 4775 (42 ms): 2593.4.
Step 4813 (42 ms): 2468.9.
Step 4850 (42 ms): 2668.7.
Step 4888 (20 ms): 1249.1.

Epoch 13 (16 s):
    Evaluating model.
    Full set (6.23 s): ELBO: 2253.4, ENRE: 2280.2, KL: 26.815.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 4926 (42 ms): 2680.3.
Step 4963 (42 ms): 2629.9.
Step 5001 (43 ms): 2645.
Step 5038 (42 ms): 2632.7.
Step 5076 (42 ms): 2653.9.
Step 5114 (43 ms): 2640.3.
Step 5151 (42 ms): 2657.2.
Step 5189 (43 ms): 2611.2.
Step 5226 (42 ms): 2671.1.
Step 5264 (20 ms): -2598.6.

Epoch 14 (16 s):
    Evaluating model.
    Full set (6.3 s): ELBO: 2282.5, ENRE: 2308.3, KL: 25.848.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 5302 (44 ms): 2627.3.
Step 5339 (43 ms): 2566.3.
Step 5377 (43 ms): 2537.5.
Step 5414 (43 ms): 2500.5.
Step 5452 (43 ms): 2682.2.
Step 5490 (43 ms): 2524.3.
Step 5527 (43 ms): 2612.4.
Step 5565 (42 ms): 2664.4.
Step 5602 (43 ms): 2563.7.
Step 5640 (20 ms): 1702.4.

Epoch 15 (16.1 s):
    Evaluating model.
    Full set (6.27 s): ELBO: 2303.9, ENRE: 2329, KL: 25.121.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 5678 (43 ms): 2698.6.
Step 5715 (43 ms): 2468.2.
Step 5753 (42 ms): 2336.7.
Step 5790 (42 ms): 2632.7.
Step 5828 (43 ms): 2611.3.
Step 5866 (42 ms): 2687.9.
Step 5903 (43 ms): 2611.7.
Step 5941 (43 ms): 2672.
Step 5978 (44 ms): 2586.9.
Step 6016 (21 ms): 527.8.

Epoch 16 (16.1 s):
    Evaluating model.
    Full set (6.3 s): ELBO: 2319.1, ENRE: 2342.3, KL: 23.135.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 6054 (42 ms): 2690.
Step 6091 (44 ms): 2549.2.
Step 6129 (42 ms): 2708.1.
Step 6166 (43 ms): 2548.7.
Step 6204 (43 ms): 2650.3.
Step 6242 (42 ms): 2675.5.
Step 6279 (42 ms): 2645.3.
Step 6317 (42 ms): 2592.5.
Step 6354 (43 ms): 2726.4.
Step 6392 (20 ms): 594.8.

Epoch 17 (16 s):
    Evaluating model.
    Full set (6.24 s): ELBO: 2371, ENRE: 2393.5, KL: 22.48.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 6430 (43 ms): 2646.8.
Step 6467 (42 ms): 2674.2.
Step 6505 (42 ms): 2645.7.
Step 6542 (43 ms): 2578.6.
Step 6580 (43 ms): 2670.
Step 6618 (43 ms): 2625.6.
Step 6655 (42 ms): 2614.2.
Step 6693 (42 ms): 2613.5.
Step 6730 (43 ms): 2696.8.
Step 6768 (21 ms): 715.19.

Epoch 18 (16 s):
    Evaluating model.
    Full set (6.27 s): ELBO: 2491.5, ENRE: 2510.1, KL: 18.659.
    Saving model parameters.
    Model parameters saved (127 ms).

Step 6806 (43 ms): 2494.8.
Step 6843 (42 ms): 2541.
Step 6881 (42 ms): 2645.1.
Step 6918 (44 ms): 2694.8.
Step 6956 (44 ms): 2655.5.
Step 6994 (42 ms): 2649.9.
Step 7031 (42 ms): 2687.5.
Step 7069 (42 ms): 2604.7.
Step 7106 (43 ms): 2618.1.
Step 7144 (20 ms): -2813.1.

Epoch 19 (15.9 s):
    Evaluating model.
    Full set (6.24 s): ELBO: 2470.7, ENRE: 2491.3, KL: 20.676.
    Saving model parameters.
    Model parameters saved (131 ms).

Step 7182 (43 ms): 2625.3.
Step 7219 (43 ms): 2529.5.
Step 7257 (43 ms): 2374.6.
Step 7294 (42 ms): 2612.4.
Step 7332 (43 ms): 2710.5.
Step 7370 (43 ms): 2676.4.
Step 7407 (42 ms): 2665.3.
Step 7445 (42 ms): 2630.3.
Step 7482 (43 ms): 2574.
Step 7520 (20 ms): 338.31.

Epoch 20 (16.1 s):
    Evaluating model.
    Full set (6.26 s): ELBO: 2437.5, ENRE: 2459.6, KL: 22.054.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 7558 (43 ms): 2743.2.
Step 7595 (43 ms): 2590.6.
Step 7633 (42 ms): 2570.5.
Step 7670 (43 ms): 2654.5.
Step 7708 (42 ms): 2527.2.
Step 7746 (43 ms): 2689.1.
Step 7783 (43 ms): 2664.9.
Step 7821 (42 ms): 2772.4.
Step 7858 (43 ms): 2637.7.
Step 7896 (21 ms): 903.34.

Epoch 21 (16.1 s):
    Evaluating model.
    Full set (6.27 s): ELBO: 2538.6, ENRE: 2558.6, KL: 19.99.
    Saving model parameters.
    Model parameters saved (129 ms).

Step 7934 (43 ms): 2652.4.
Step 7971 (43 ms): 2692.7.
Step 8009 (43 ms): 2610.1.
Step 8046 (44 ms): 2655.
Step 8084 (43 ms): 2617.4.
Step 8122 (43 ms): 2657.8.
Step 8159 (42 ms): 2604.4.
Step 8197 (43 ms): 2659.1.
Step 8234 (43 ms): 2625.4.
Step 8272 (20 ms): 802.5.

Epoch 22 (16.1 s):
    Evaluating model.
    Full set (6.25 s): ELBO: 2576.8, ENRE: 2595.7, KL: 18.862.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 8310 (42 ms): 2594.8.
Step 8347 (42 ms): 2661.8.
Step 8385 (42 ms): 2660.5.
Step 8422 (42 ms): 2681.4.
Step 8460 (42 ms): 2686.8.
Step 8498 (42 ms): 2672.4.
Step 8535 (43 ms): 2571.9.
Step 8573 (42 ms): 2631.3.
Step 8610 (42 ms): 2680.4.
Step 8648 (20 ms): -1268.7.

Epoch 23 (16 s):
    Evaluating model.
    Full set (6.29 s): ELBO: 2538.1, ENRE: 2557.2, KL: 19.088.
    Saving model parameters.
    Model parameters saved (138 ms).

Step 8686 (43 ms): 2702.7.
Step 8723 (42 ms): 2662.9.
Step 8761 (44 ms): 2613.
Step 8798 (42 ms): 2644.6.
Step 8836 (42 ms): 2627.5.
Step 8874 (42 ms): 2606.2.
Step 8911 (44 ms): 2593.6.
Step 8949 (43 ms): 2676.3.
Step 8986 (42 ms): 2694.6.
Step 9024 (20 ms): 1267.5.

Epoch 24 (16 s):
    Evaluating model.
    Full set (6.24 s): ELBO: 2551.5, ENRE: 2571.1, KL: 19.633.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 9062 (43 ms): 2691.8.
Step 9099 (42 ms): 2719.4.
Step 9137 (42 ms): 2717.4.
Step 9174 (42 ms): 2615.8.
Step 9212 (42 ms): 2728.4.
Step 9250 (42 ms): 2642.7.
Step 9287 (42 ms): 2532.8.
Step 9325 (42 ms): 2697.5.
Step 9362 (42 ms): 2737.7.
Step 9400 (21 ms): -1388.7.

Epoch 25 (16 s):
    Evaluating model.
    Full set (6.29 s): ELBO: 2520.3, ENRE: 2541.7, KL: 21.393.
    Saving model parameters.
    Model parameters saved (131 ms).

Step 9438 (42 ms): 2672.8.
Step 9475 (43 ms): 2608.2.
Step 9513 (43 ms): 2690.1.
Step 9550 (43 ms): 2576.7.
Step 9588 (42 ms): 2685.9.
Step 9626 (43 ms): 2626.1.
Step 9663 (42 ms): 2605.1.
Step 9701 (42 ms): 2757.1.
Step 9738 (43 ms): 2683.2.
Step 9776 (21 ms): 798.71.

Epoch 26 (16.1 s):
    Evaluating model.
    Full set (6.27 s): ELBO: 2632.9, ENRE: 2650.7, KL: 17.734.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 9814 (42 ms): 2662.8.
Step 9851 (43 ms): 2617.7.
Step 9889 (44 ms): 2666.5.
Step 9926 (43 ms): 2710.3.
Step 9964 (44 ms): 2622.9.
Step 10002 (44 ms): 2568.6.
Step 10039 (44 ms): 2596.4.
Step 10077 (43 ms): 2563.3.
Step 10114 (43 ms): 2762.6.
Step 10152 (21 ms): 1149.8.

Epoch 27 (16.2 s):
    Evaluating model.
    Full set (6.28 s): ELBO: 2541.9, ENRE: 2561.8, KL: 19.919.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 10190 (43 ms): 2704.7.
Step 10227 (43 ms): 2682.5.
Step 10265 (43 ms): 2702.4.
Step 10302 (43 ms): 2709.8.
Step 10340 (42 ms): 2700.
Step 10378 (44 ms): 2712.9.
Step 10415 (43 ms): 2719.7.
Step 10453 (43 ms): 2675.2.
Step 10490 (42 ms): 2650.6.
Step 10528 (20 ms): -1220.7.

Epoch 28 (16 s):
    Evaluating model.
    Full set (6.24 s): ELBO: 2607.5, ENRE: 2625.9, KL: 18.357.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 10566 (43 ms): 2726.3.
Step 10603 (44 ms): 2726.8.
Step 10641 (42 ms): 2716.6.
Step 10678 (44 ms): 2631.4.
Step 10716 (43 ms): 2714.
Step 10754 (43 ms): 2653.6.
Step 10791 (42 ms): 2644.
Step 10829 (42 ms): 2647.8.
Step 10866 (43 ms): 2677.2.
Step 10904 (20 ms): -9547.5.

Epoch 29 (16.1 s):
    Evaluating model.
    Full set (6.24 s): ELBO: 2621.3, ENRE: 2639.2, KL: 17.897.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 10942 (42 ms): 2707.3.
Step 10979 (42 ms): 2688.7.
Step 11017 (42 ms): 2595.3.
Step 11054 (42 ms): 2726.1.
Step 11092 (43 ms): 2554.
Step 11130 (42 ms): 2647.2.
Step 11167 (42 ms): 2715.5.
Step 11205 (42 ms): 2725.6.
Step 11242 (41 ms): 2626.1.
Step 11280 (21 ms): -3449.7.

Epoch 30 (15.9 s):
    Evaluating model.
    Full set (6.27 s): ELBO: 2606.7, ENRE: 2624.9, KL: 18.266.
    Saving model parameters.
    Model parameters saved (132 ms).

Step 11318 (44 ms): 2584.7.
Step 11355 (43 ms): 2690.5.
Step 11393 (43 ms): 2692.8.
Step 11430 (43 ms): 2609.6.
Step 11468 (43 ms): 2726.2.
Step 11506 (43 ms): 2712.2.
Step 11543 (43 ms): 2631.9.
Step 11581 (43 ms): 2621.6.
Step 11618 (43 ms): 2647.8.
Step 11656 (20 ms): -98.839.

Epoch 31 (16.1 s):
    Evaluating model.
    Full set (6.26 s): ELBO: 2584.9, ENRE: 2603.9, KL: 18.979.
    Saving model parameters.
    Model parameters saved (132 ms).

Step 11694 (44 ms): 2725.2.
Step 11731 (42 ms): 2697.2.
Step 11769 (43 ms): 2744.2.
Step 11806 (43 ms): 2786.7.
Step 11844 (42 ms): 2605.2.
Step 11882 (42 ms): 2725.8.
Step 11919 (43 ms): 2699.9.
Step 11957 (44 ms): 2719.3.
Step 11994 (43 ms): 2746.1.
Step 12032 (21 ms): -3926.7.

Epoch 32 (16.1 s):
    Evaluating model.
    Full set (6.29 s): ELBO: 2578.6, ENRE: 2598.1, KL: 19.476.
    Saving model parameters.
    Model parameters saved (127 ms).

Step 12070 (43 ms): 2634.3.
Step 12107 (42 ms): 2623.8.
Step 12145 (42 ms): 2737.8.
Step 12182 (43 ms): 2657.3.
Step 12220 (42 ms): 2714.5.
Step 12258 (42 ms): 2562.
Step 12295 (42 ms): 2665.9.
Step 12333 (42 ms): 2713.2.
Step 12370 (42 ms): 2685.6.
Step 12408 (20 ms): -306.28.

Epoch 33 (16 s):
    Evaluating model.
    Full set (6.22 s): ELBO: 2568.4, ENRE: 2587.8, KL: 19.389.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 12446 (42 ms): 2722.5.
Step 12483 (42 ms): 2703.1.
Step 12521 (42 ms): 2766.
Step 12558 (43 ms): 2639.2.
Step 12596 (42 ms): 2749.5.
Step 12634 (42 ms): 2718.8.
Step 12671 (43 ms): 2724.6.
Step 12709 (42 ms): 2729.3.
Step 12746 (42 ms): 2695.7.
Step 12784 (20 ms): -6233.5.

Epoch 34 (16 s):
    Evaluating model.
    Full set (6.26 s): ELBO: 2637.8, ENRE: 2655.2, KL: 17.428.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 12822 (42 ms): 2768.1.
Step 12859 (42 ms): 2751.7.
Step 12897 (42 ms): 2654.3.
Step 12934 (44 ms): 2689.8.
Step 12972 (43 ms): 2717.
Step 13010 (42 ms): 2730.4.
Step 13047 (42 ms): 2686.
Step 13085 (44 ms): 2751.7.
Step 13122 (42 ms): 2695.8.
Step 13160 (20 ms): -1230.6.

Epoch 35 (15.9 s):
    Evaluating model.
    Full set (6.24 s): ELBO: 2596.9, ENRE: 2615.3, KL: 18.455.
    Saving model parameters.
    Model parameters saved (130 ms).

Step 13198 (42 ms): 2699.5.
Step 13235 (42 ms): 2657.6.
Step 13273 (42 ms): 2776.6.
Step 13310 (43 ms): 2698.1.
Step 13348 (43 ms): 2688.2.
Step 13386 (44 ms): 2675.4.
Step 13423 (43 ms): 2718.1.
Step 13461 (43 ms): 2671.
Step 13498 (43 ms): 2687.5.
Step 13536 (20 ms): 992.12.

Epoch 36 (16.1 s):
    Evaluating model.
    Full set (6.29 s): ELBO: 2617.5, ENRE: 2636.1, KL: 18.54.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 13574 (43 ms): 2725.6.
Step 13611 (42 ms): 2609.2.
Step 13649 (43 ms): 2793.4.
Step 13686 (43 ms): 2689.8.
Step 13724 (43 ms): 2703.6.
Step 13762 (43 ms): 2574.5.
Step 13799 (43 ms): 2703.2.
Step 13837 (42 ms): 2644.2.
Step 13874 (44 ms): 2677.
Step 13912 (21 ms): -5.4645.

Epoch 37 (16.1 s):
    Evaluating model.
    Full set (6.26 s): ELBO: 2652.1, ENRE: 2668.8, KL: 16.734.
    Saving model parameters.
    Model parameters saved (135 ms).

Step 13950 (43 ms): 2708.7.
Step 13987 (43 ms): 2705.8.
Step 14025 (43 ms): 2674.1.
Step 14062 (43 ms): 2569.
Step 14100 (43 ms): 2684.4.
Step 14138 (43 ms): 2727.6.
Step 14175 (43 ms): 2690.8.
Step 14213 (42 ms): 2739.4.
Step 14250 (42 ms): 2680.4.
Step 14288 (20 ms): -2907.9.

Epoch 38 (16.1 s):
    Evaluating model.
    Full set (6.24 s): ELBO: 2620.3, ENRE: 2638.7, KL: 18.371.
    Saving model parameters.
    Model parameters saved (127 ms).

Step 14326 (42 ms): 2634.7.
Step 14363 (42 ms): 2666.4.
Step 14401 (43 ms): 2652.9.
Step 14438 (43 ms): 2639.5.
Step 14476 (42 ms): 2764.7.
Step 14514 (43 ms): 2731.5.
Step 14551 (43 ms): 2658.4.
Step 14589 (42 ms): 2708.6.
Step 14626 (43 ms): 2789.2.
Step 14664 (20 ms): -3966.5.

Epoch 39 (15.9 s):
    Evaluating model.
    Full set (6.24 s): ELBO: 2602, ENRE: 2621.2, KL: 19.181.
    Saving model parameters.
    Model parameters saved (129 ms).

Step 14702 (42 ms): 2659.7.
Step 14739 (42 ms): 2738.2.
Step 14777 (42 ms): 2763.2.
Step 14814 (42 ms): 2711.2.
Step 14852 (43 ms): 2694.5.
Step 14890 (42 ms): 2646.
Step 14927 (42 ms): 2678.2.
Step 14965 (42 ms): 2732.
Step 15002 (42 ms): 2708.9.
Step 15040 (20 ms): -2323.2.

Epoch 40 (15.9 s):
    Evaluating model.
    Full set (6.23 s): ELBO: 2654, ENRE: 2671.3, KL: 17.335.
    Saving model parameters.
    Model parameters saved (134 ms).

Step 15078 (42 ms): 2701.5.
Step 15115 (42 ms): 2657.5.
Step 15153 (43 ms): 2722.8.
Step 15190 (43 ms): 2733.
Step 15228 (42 ms): 2744.6.
Step 15266 (42 ms): 2706.7.
Step 15303 (42 ms): 2707.6.
Step 15341 (43 ms): 2699.5.
Step 15378 (43 ms): 2686.2.
Step 15416 (20 ms): -390.17.

Epoch 41 (15.9 s):
    Evaluating model.
    Full set (6.27 s): ELBO: 2664.4, ENRE: 2681.6, KL: 17.206.
    Saving model parameters.
    Model parameters saved (131 ms).

Step 15454 (43 ms): 2751.2.
Step 15491 (43 ms): 2760.9.
Step 15529 (42 ms): 2670.6.
Step 15566 (42 ms): 2704.8.
Step 15604 (42 ms): 2768.4.
Step 15642 (42 ms): 2743.4.
Step 15679 (42 ms): 2652.5.
Step 15717 (42 ms): 2673.6.
Step 15754 (43 ms): 2711.4.
Step 15792 (20 ms): -476.14.

Epoch 42 (16 s):
    Evaluating model.
    Full set (6.26 s): ELBO: 2686.9, ENRE: 2703.1, KL: 16.217.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 15830 (43 ms): 2724.4.
Step 15867 (43 ms): 2746.
Step 15905 (42 ms): 2679.4.
Step 15942 (43 ms): 2577.9.
Step 15980 (43 ms): 2674.1.
Step 16018 (43 ms): 2720.1.
Step 16055 (43 ms): 2695.7.
Step 16093 (43 ms): 2733.2.
Step 16130 (43 ms): 2704.8.
Step 16168 (21 ms): -881.85.

Epoch 43 (16.2 s):
    Evaluating model.
    Full set (6.29 s): ELBO: 2695.5, ENRE: 2711.9, KL: 16.327.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 16206 (43 ms): 2684.4.
Step 16243 (43 ms): 2763.7.
Step 16281 (42 ms): 2778.7.
Step 16318 (43 ms): 2687.
Step 16356 (43 ms): 2783.2.
Step 16394 (43 ms): 2772.7.
Step 16431 (43 ms): 2741.6.
Step 16469 (42 ms): 2632.7.
Step 16506 (43 ms): 2683.3.
Step 16544 (20 ms): -1525.1.

Epoch 44 (16 s):
    Evaluating model.
    Full set (6.25 s): ELBO: 2666.7, ENRE: 2682.7, KL: 15.983.
    Saving model parameters.
    Model parameters saved (127 ms).

Step 16582 (43 ms): 2689.6.
Step 16619 (42 ms): 2686.9.
Step 16657 (43 ms): 2694.5.
Step 16694 (43 ms): 2721.5.
Step 16732 (43 ms): 2753.
Step 16770 (42 ms): 2702.1.
Step 16807 (43 ms): 2616.4.
Step 16845 (44 ms): 2762.3.
Step 16882 (42 ms): 2711.8.
Step 16920 (20 ms): -2763.7.

Epoch 45 (16.1 s):
    Evaluating model.
    Full set (6.22 s): ELBO: 2684.7, ENRE: 2700.6, KL: 15.814.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 16958 (44 ms): 2749.2.
Step 16995 (42 ms): 2746.4.
Step 17033 (42 ms): 2743.1.
Step 17070 (42 ms): 2641.5.
Step 17108 (42 ms): 2791.7.
Step 17146 (42 ms): 2762.3.
Step 17183 (42 ms): 2738.4.
Step 17221 (43 ms): 2705.1.
Step 17258 (42 ms): 2726.3.
Step 17296 (20 ms): -6255.

Epoch 46 (15.9 s):
    Evaluating model.
    Full set (6.24 s): ELBO: 2669.5, ENRE: 2686.5, KL: 16.993.
    Saving model parameters.
    Model parameters saved (131 ms).

Step 17334 (42 ms): 2707.7.
Step 17371 (43 ms): 2642.5.
Step 17409 (43 ms): 2738.
Step 17446 (43 ms): 2725.6.
Step 17484 (42 ms): 2784.6.
Step 17522 (43 ms): 2752.9.
Step 17559 (42 ms): 2698.
Step 17597 (42 ms): 2706.
Step 17634 (43 ms): 2668.8.
Step 17672 (20 ms): -2220.8.

Epoch 47 (16 s):
    Evaluating model.
    Full set (6.24 s): ELBO: 2671.7, ENRE: 2688.7, KL: 17.049.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 17710 (42 ms): 2786.8.
Step 17747 (42 ms): 2793.6.
Step 17785 (43 ms): 2635.2.
Step 17822 (44 ms): 2692.9.
Step 17860 (42 ms): 2697.
Step 17898 (43 ms): 2788.
Step 17935 (43 ms): 2740.9.
Step 17973 (43 ms): 2758.6.
Step 18010 (43 ms): 2727.1.
Step 18048 (20 ms): -524.34.

Epoch 48 (16 s):
    Evaluating model.
    Full set (6.31 s): ELBO: 2671.5, ENRE: 2688.7, KL: 17.235.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 18086 (43 ms): 2778.7.
Step 18123 (43 ms): 2649.4.
Step 18161 (43 ms): 2748.5.
Step 18198 (44 ms): 2795.2.
Step 18236 (43 ms): 2735.4.
Step 18274 (43 ms): 2725.3.
Step 18311 (43 ms): 2777.6.
Step 18349 (43 ms): 2675.3.
Step 18386 (43 ms): 2734.7.
Step 18424 (20 ms): -1473.1.

Epoch 49 (16.2 s):
    Evaluating model.
    Full set (6.26 s): ELBO: 2671.8, ENRE: 2688.2, KL: 16.378.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 18462 (43 ms): 2688.6.
Step 18499 (42 ms): 2755.4.
Step 18537 (43 ms): 2751.1.
Step 18574 (42 ms): 2702.9.
Step 18612 (42 ms): 2691.4.
Step 18650 (42 ms): 2756.2.
Step 18687 (42 ms): 2782.6.
Step 18725 (42 ms): 2742.5.
Step 18762 (43 ms): 2561.8.
Step 18800 (21 ms): 42.722.

Epoch 50 (16 s):
    Evaluating model.
    Full set (6.28 s): ELBO: 2684.4, ENRE: 2700.6, KL: 16.242.
    Saving model parameters.
    Model parameters saved (125 ms).

Model trained for 50 epochs (18m 49s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (855 ms).

Converting data set value array to sparse matrix.
Data set value array converted (275 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2.29 s):  ELBO: -10366, ENRE: -10350, KL: 15.983.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (979 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.0849027752459348
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 51
kl weight: 1.0849027752459348
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (46 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.17 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.89 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 51
    hidden sizes: 189, 240, 73, 255
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.0849027752459348
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 3 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 189)
    ENCODER/1/DENSE/biases:0             (189,)
    ENCODER/1/BATCH_NORM/beta:0          (189,)
    ENCODER/2/DENSE/weights:0            (189, 240)
    ENCODER/2/DENSE/biases:0             (240,)
    ENCODER/2/BATCH_NORM/beta:0          (240,)
    ENCODER/3/DENSE/weights:0            (240, 73)
    ENCODER/3/DENSE/biases:0             (73,)
    ENCODER/3/BATCH_NORM/beta:0          (73,)
    ENCODER/4/DENSE/weights:0            (73, 255)
    ENCODER/4/DENSE/biases:0             (255,)
    ENCODER/4/BATCH_NORM/beta:0          (255,)
    POSTERIOR/MU/DENSE/weights:0         (255, 51)
    POSTERIOR/MU/DENSE/biases:0          (51,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (255, 51)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (51,)
    DECODER/4/DENSE/weights:0            (51, 255)
    DECODER/4/DENSE/biases:0             (255,)
    DECODER/4/BATCH_NORM/beta:0          (255,)
    DECODER/3/DENSE/weights:0            (255, 73)
    DECODER/3/DENSE/biases:0             (73,)
    DECODER/3/BATCH_NORM/beta:0          (73,)
    DECODER/2/DENSE/weights:0            (73, 240)
    DECODER/2/DENSE/biases:0             (240,)
    DECODER/2/BATCH_NORM/beta:0          (240,)
    DECODER/1/DENSE/weights:0            (240, 189)
    DECODER/1/DENSE/biases:0             (189,)
    DECODER/1/BATCH_NORM/beta:0          (189,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (189, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (467 ms).

Training model for 50 epochs on original values.

Step 38 (33 ms): -2123.4.
Step 75 (33 ms): -1759.8.
Step 113 (33 ms): -1493.
Step 150 (32 ms): -1279.9.
Step 188 (32 ms): -1085.4.
Step 226 (32 ms): -970.02.
Step 263 (31 ms): -880.53.
Step 301 (33 ms): -788.65.
Step 338 (31 ms): -734.9.
Step 376 (18 ms): -676.91.

Epoch 1 (14.6 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.47 s): ELBO: -1764, ENRE: -1749.8, KL: 14.182.
    Saving model parameters.
    Model parameters saved (180 ms).

Step 414 (32 ms): -569.23.
Step 451 (32 ms): -494.91.
Step 489 (32 ms): -467.88.
Step 526 (32 ms): -415.65.
Step 564 (33 ms): -391.1.
Step 602 (32 ms): -375.41.
Step 639 (31 ms): -373.32.
Step 677 (32 ms): -351.78.
Step 714 (32 ms): -330.21.
Step 752 (17 ms): -417.03.

Epoch 2 (12.1 s):
    Warm-up weight: 0.33
    Evaluating model.
    Full set (5.86 s): ELBO: -940.16, ENRE: -926.46, KL: 13.706.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 790 (31 ms): -308.71.
Step 827 (32 ms): -289.73.
Step 865 (32 ms): -293.8.
Step 902 (32 ms): -287.2.
Step 940 (32 ms): -276.3.
Step 978 (32 ms): -287.77.
Step 1015 (33 ms): -286.32.
Step 1053 (32 ms): -264.67.
Step 1090 (32 ms): -273.55.
Step 1128 (16 ms): -284.94.

Epoch 3 (12.1 s):
    Warm-up weight: 0.67
    Evaluating model.
    Full set (5.88 s): ELBO: -543.41, ENRE: -534.13, KL: 9.2744.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 1166 (32 ms): -251.5.
Step 1203 (32 ms): -250.88.
Step 1241 (32 ms): -248.22.
Step 1278 (33 ms): -258.11.
Step 1316 (33 ms): -258.19.
Step 1354 (32 ms): -262.12.
Step 1391 (33 ms): -245.03.
Step 1429 (34 ms): -243.56.
Step 1466 (32 ms): -245.34.
Step 1504 (16 ms): -267.82.

Epoch 4 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -368.03, ENRE: -359.71, KL: 8.3115.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 1542 (32 ms): -238.89.
Step 1579 (32 ms): -241.
Step 1617 (33 ms): -232.08.
Step 1654 (32 ms): -238.35.
Step 1692 (32 ms): -240.7.
Step 1730 (32 ms): -228.28.
Step 1767 (32 ms): -219.43.
Step 1805 (32 ms): -226.04.
Step 1842 (32 ms): -245.48.
Step 1880 (16 ms): -265.42.

Epoch 5 (12.1 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -289.57, ENRE: -281.59, KL: 7.9776.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 1918 (32 ms): -233.97.
Step 1955 (32 ms): -242.52.
Step 1993 (32 ms): -218.24.
Step 2030 (32 ms): -222.74.
Step 2068 (32 ms): -223.47.
Step 2106 (33 ms): -222.77.
Step 2143 (32 ms): -229.77.
Step 2181 (32 ms): -241.56.
Step 2218 (32 ms): -246.52.
Step 2256 (16 ms): -739.06.

Epoch 6 (12.1 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -253.92, ENRE: -245.73, KL: 8.1857.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 2294 (31 ms): -226.34.
Step 2331 (32 ms): -223.8.
Step 2369 (32 ms): -238.28.
Step 2406 (32 ms): -228.6.
Step 2444 (32 ms): -227.52.
Step 2482 (32 ms): -227.18.
Step 2519 (32 ms): -212.65.
Step 2557 (32 ms): -220.89.
Step 2594 (32 ms): -225.4.
Step 2632 (15 ms): -254.45.

Epoch 7 (12 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -237.24, ENRE: -229.52, KL: 7.7193.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 2670 (32 ms): -226.11.
Step 2707 (31 ms): -218.96.
Step 2745 (33 ms): -220.71.
Step 2782 (32 ms): -217.23.
Step 2820 (32 ms): -224.4.
Step 2858 (31 ms): -234.15.
Step 2895 (32 ms): -229.9.
Step 2933 (32 ms): -220.28.
Step 2970 (32 ms): -214.61.
Step 3008 (15 ms): -248.92.

Epoch 8 (12 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -226.9, ENRE: -218.95, KL: 7.9451.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 3046 (32 ms): -237.61.
Step 3083 (32 ms): -224.39.
Step 3121 (32 ms): -219.2.
Step 3158 (32 ms): -235.09.
Step 3196 (32 ms): -199.54.
Step 3234 (34 ms): -212.27.
Step 3271 (32 ms): -224.7.
Step 3309 (32 ms): -223.4.
Step 3346 (32 ms): -211.71.
Step 3384 (16 ms): -263.43.

Epoch 9 (12 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -221.96, ENRE: -213.95, KL: 8.0121.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 3422 (32 ms): -227.29.
Step 3459 (32 ms): -222.04.
Step 3497 (34 ms): -211.99.
Step 3534 (33 ms): -220.27.
Step 3572 (32 ms): -207.35.
Step 3610 (32 ms): -230.53.
Step 3647 (32 ms): -216.66.
Step 3685 (33 ms): -225.99.
Step 3722 (33 ms): -217.96.
Step 3760 (16 ms): -219.05.

Epoch 10 (12.1 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -219.24, ENRE: -211.5, KL: 7.739.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 3798 (32 ms): -201.59.
Step 3835 (33 ms): -204.7.
Step 3873 (32 ms): -210.58.
Step 3910 (32 ms): -221.46.
Step 3948 (32 ms): -249.67.
Step 3986 (32 ms): -211.56.
Step 4023 (32 ms): -215.93.
Step 4061 (32 ms): -217.73.
Step 4098 (32 ms): -214.89.
Step 4136 (16 ms): -257.85.

Epoch 11 (12.1 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -218.57, ENRE: -211.04, KL: 7.5231.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 4174 (32 ms): -208.68.
Step 4211 (32 ms): -197.89.
Step 4249 (32 ms): -229.29.
Step 4286 (32 ms): -200.65.
Step 4324 (32 ms): -215.02.
Step 4362 (32 ms): -209.23.
Step 4399 (32 ms): -216.32.
Step 4437 (32 ms): -232.32.
Step 4474 (31 ms): -215.42.
Step 4512 (15 ms): -410.54.

Epoch 12 (12 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -216.1, ENRE: -208.89, KL: 7.2148.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 4550 (33 ms): -231.
Step 4587 (33 ms): -208.92.
Step 4625 (32 ms): -203.56.
Step 4662 (32 ms): -222.73.
Step 4700 (32 ms): -216.36.
Step 4738 (32 ms): -218.62.
Step 4775 (32 ms): -200.24.
Step 4813 (33 ms): -212.87.
Step 4850 (32 ms): -205.36.
Step 4888 (16 ms): -270.01.

Epoch 13 (12.1 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -215.76, ENRE: -208.8, KL: 6.9638.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 4926 (32 ms): -222.15.
Step 4963 (33 ms): -217.06.
Step 5001 (32 ms): -222.25.
Step 5038 (32 ms): -218.95.
Step 5076 (32 ms): -222.86.
Step 5114 (32 ms): -201.7.
Step 5151 (32 ms): -220.77.
Step 5189 (32 ms): -213.66.
Step 5226 (32 ms): -206.42.
Step 5264 (15 ms): -421.16.

Epoch 14 (12 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -213.12, ENRE: -206.08, KL: 7.0488.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 5302 (32 ms): -212.29.
Step 5339 (32 ms): -211.31.
Step 5377 (32 ms): -226.63.
Step 5414 (32 ms): -212.03.
Step 5452 (32 ms): -211.79.
Step 5490 (32 ms): -229.75.
Step 5527 (32 ms): -217.42.
Step 5565 (32 ms): -202.86.
Step 5602 (32 ms): -205.02.
Step 5640 (16 ms): -333.66.

Epoch 15 (12.1 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -212.54, ENRE: -205.65, KL: 6.8858.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 5678 (32 ms): -221.12.
Step 5715 (33 ms): -198.86.
Step 5753 (32 ms): -206.21.
Step 5790 (32 ms): -202.6.
Step 5828 (32 ms): -216.76.
Step 5866 (33 ms): -218.72.
Step 5903 (32 ms): -211.64.
Step 5941 (33 ms): -213.49.
Step 5978 (32 ms): -201.76.
Step 6016 (16 ms): -456.41.

Epoch 16 (12.1 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -211.02, ENRE: -204.22, KL: 6.795.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 6054 (32 ms): -206.73.
Step 6091 (32 ms): -202.43.
Step 6129 (32 ms): -212.51.
Step 6166 (33 ms): -197.
Step 6204 (33 ms): -204.72.
Step 6242 (32 ms): -221.88.
Step 6279 (32 ms): -208.36.
Step 6317 (32 ms): -208.48.
Step 6354 (34 ms): -203.46.
Step 6392 (16 ms): -240.74.

Epoch 17 (12.1 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -209.97, ENRE: -203.11, KL: 6.865.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 6430 (32 ms): -199.33.
Step 6467 (32 ms): -209.41.
Step 6505 (32 ms): -204.54.
Step 6542 (32 ms): -226.22.
Step 6580 (32 ms): -199.75.
Step 6618 (33 ms): -202.81.
Step 6655 (32 ms): -228.3.
Step 6693 (32 ms): -206.51.
Step 6730 (33 ms): -208.34.
Step 6768 (15 ms): -258.84.

Epoch 18 (12.1 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -209.39, ENRE: -202.67, KL: 6.7119.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 6806 (33 ms): -196.78.
Step 6843 (32 ms): -198.47.
Step 6881 (32 ms): -203.92.
Step 6918 (34 ms): -202.74.
Step 6956 (32 ms): -209.37.
Step 6994 (32 ms): -210.04.
Step 7031 (31 ms): -212.9.
Step 7069 (31 ms): -198.43.
Step 7106 (32 ms): -204.83.
Step 7144 (15 ms): -222.98.

Epoch 19 (12 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -208.15, ENRE: -201.39, KL: 6.7573.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 7182 (32 ms): -213.31.
Step 7219 (32 ms): -204.66.
Step 7257 (34 ms): -211.32.
Step 7294 (31 ms): -202.39.
Step 7332 (32 ms): -210.96.
Step 7370 (32 ms): -197.25.
Step 7407 (32 ms): -188.83.
Step 7445 (32 ms): -211.87.
Step 7482 (32 ms): -206.17.
Step 7520 (15 ms): -220.82.

Epoch 20 (12 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -207.63, ENRE: -200.95, KL: 6.6785.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 7558 (32 ms): -213.36.
Step 7595 (32 ms): -202.5.
Step 7633 (31 ms): -213.93.
Step 7670 (32 ms): -209.92.
Step 7708 (32 ms): -198.6.
Step 7746 (32 ms): -214.21.
Step 7783 (32 ms): -200.95.
Step 7821 (32 ms): -208.42.
Step 7858 (31 ms): -194.5.
Step 7896 (16 ms): -207.88.

Epoch 21 (12 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -207.42, ENRE: -200.78, KL: 6.6461.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 7934 (32 ms): -209.33.
Step 7971 (32 ms): -203.91.
Step 8009 (32 ms): -201.59.
Step 8046 (32 ms): -206.61.
Step 8084 (32 ms): -206.34.
Step 8122 (32 ms): -208.83.
Step 8159 (32 ms): -206.39.
Step 8197 (32 ms): -212.39.
Step 8234 (32 ms): -213.65.
Step 8272 (16 ms): -212.94.

Epoch 22 (12.2 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -207.32, ENRE: -200.79, KL: 6.5289.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 8310 (32 ms): -208.28.
Step 8347 (33 ms): -216.6.
Step 8385 (32 ms): -216.18.
Step 8422 (32 ms): -196.92.
Step 8460 (32 ms): -214.83.
Step 8498 (33 ms): -209.99.
Step 8535 (32 ms): -208.14.
Step 8573 (32 ms): -195.28.
Step 8610 (33 ms): -215.
Step 8648 (16 ms): -285.65.

Epoch 23 (12.1 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -205.9, ENRE: -199.3, KL: 6.602.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 8686 (32 ms): -205.99.
Step 8723 (32 ms): -207.3.
Step 8761 (32 ms): -213.49.
Step 8798 (33 ms): -215.74.
Step 8836 (33 ms): -200.36.
Step 8874 (32 ms): -200.44.
Step 8911 (32 ms): -209.98.
Step 8949 (32 ms): -195.31.
Step 8986 (33 ms): -214.79.
Step 9024 (16 ms): -202.78.

Epoch 24 (12.2 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -205.82, ENRE: -199.2, KL: 6.619.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 9062 (32 ms): -198.5.
Step 9099 (32 ms): -196.82.
Step 9137 (33 ms): -203.64.
Step 9174 (32 ms): -209.29.
Step 9212 (32 ms): -210.97.
Step 9250 (32 ms): -200.18.
Step 9287 (32 ms): -209.55.
Step 9325 (32 ms): -205.29.
Step 9362 (33 ms): -203.04.
Step 9400 (15 ms): -235.72.

Epoch 25 (12 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -205.7, ENRE: -198.88, KL: 6.824.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 9438 (33 ms): -203.35.
Step 9475 (31 ms): -203.51.
Step 9513 (32 ms): -192.48.
Step 9550 (32 ms): -209.91.
Step 9588 (32 ms): -203.94.
Step 9626 (32 ms): -199.89.
Step 9663 (32 ms): -206.6.
Step 9701 (32 ms): -205.86.
Step 9738 (32 ms): -198.59.
Step 9776 (15 ms): -267.79.

Epoch 26 (12 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -205.26, ENRE: -198.53, KL: 6.7231.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 9814 (31 ms): -193.62.
Step 9851 (32 ms): -198.7.
Step 9889 (32 ms): -194.59.
Step 9926 (32 ms): -206.93.
Step 9964 (32 ms): -196.94.
Step 10002 (32 ms): -208.73.
Step 10039 (32 ms): -217.73.
Step 10077 (32 ms): -204.46.
Step 10114 (32 ms): -207.79.
Step 10152 (16 ms): -208.57.

Epoch 27 (12.1 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -204.88, ENRE: -198.11, KL: 6.7617.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 10190 (32 ms): -200.84.
Step 10227 (32 ms): -213.49.
Step 10265 (32 ms): -214.23.
Step 10302 (34 ms): -200.89.
Step 10340 (32 ms): -202.89.
Step 10378 (32 ms): -202.06.
Step 10415 (32 ms): -202.03.
Step 10453 (32 ms): -201.32.
Step 10490 (33 ms): -208.55.
Step 10528 (16 ms): -271.29.

Epoch 28 (12.1 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -204.45, ENRE: -197.82, KL: 6.6387.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 10566 (33 ms): -201.37.
Step 10603 (33 ms): -204.04.
Step 10641 (33 ms): -204.
Step 10678 (32 ms): -201.2.
Step 10716 (32 ms): -202.12.
Step 10754 (32 ms): -200.1.
Step 10791 (33 ms): -201.13.
Step 10829 (32 ms): -206.93.
Step 10866 (34 ms): -197.34.
Step 10904 (16 ms): -214.57.

Epoch 29 (12.1 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -204.44, ENRE: -197.72, KL: 6.7233.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 10942 (32 ms): -194.6.
Step 10979 (32 ms): -196.38.
Step 11017 (32 ms): -196.63.
Step 11054 (32 ms): -201.64.
Step 11092 (33 ms): -196.17.
Step 11130 (31 ms): -207.82.
Step 11167 (32 ms): -197.08.
Step 11205 (32 ms): -207.94.
Step 11242 (32 ms): -212.74.
Step 11280 (16 ms): -325.76.

Epoch 30 (12.1 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -203.81, ENRE: -196.95, KL: 6.8584.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 11318 (32 ms): -196.55.
Step 11355 (32 ms): -192.92.
Step 11393 (32 ms): -188.85.
Step 11430 (33 ms): -231.79.
Step 11468 (31 ms): -202.13.
Step 11506 (32 ms): -203.56.
Step 11543 (31 ms): -203.25.
Step 11581 (32 ms): -198.02.
Step 11618 (33 ms): -211.5.
Step 11656 (16 ms): -210.51.

Epoch 31 (12 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -203.48, ENRE: -196.56, KL: 6.9232.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 11694 (32 ms): -203.16.
Step 11731 (32 ms): -203.33.
Step 11769 (32 ms): -208.71.
Step 11806 (31 ms): -218.51.
Step 11844 (32 ms): -197.88.
Step 11882 (32 ms): -193.5.
Step 11919 (32 ms): -204.02.
Step 11957 (44 ms): -199.73.
Step 11994 (32 ms): -208.05.
Step 12032 (15 ms): -235.24.

Epoch 32 (12 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -203.13, ENRE: -196.33, KL: 6.7967.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 12070 (33 ms): -199.83.
Step 12107 (32 ms): -203.73.
Step 12145 (32 ms): -206.7.
Step 12182 (32 ms): -205.57.
Step 12220 (32 ms): -197.78.
Step 12258 (32 ms): -203.03.
Step 12295 (32 ms): -197.94.
Step 12333 (32 ms): -193.3.
Step 12370 (32 ms): -200.87.
Step 12408 (16 ms): -224.11.

Epoch 33 (12 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -202.67, ENRE: -195.74, KL: 6.9319.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 12446 (32 ms): -205.05.
Step 12483 (32 ms): -202.09.
Step 12521 (32 ms): -190.06.
Step 12558 (32 ms): -199.89.
Step 12596 (32 ms): -220.21.
Step 12634 (34 ms): -193.82.
Step 12671 (32 ms): -220.46.
Step 12709 (32 ms): -209.93.
Step 12746 (33 ms): -201.55.
Step 12784 (16 ms): -203.99.

Epoch 34 (12.1 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -202.46, ENRE: -195.61, KL: 6.8475.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 12822 (33 ms): -198.81.
Step 12859 (32 ms): -213.16.
Step 12897 (32 ms): -196.87.
Step 12934 (32 ms): -199.42.
Step 12972 (32 ms): -191.03.
Step 13010 (32 ms): -196.23.
Step 13047 (32 ms): -206.15.
Step 13085 (32 ms): -200.69.
Step 13122 (32 ms): -213.45.
Step 13160 (16 ms): -269.72.

Epoch 35 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -202.1, ENRE: -195.35, KL: 6.7417.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 13198 (33 ms): -201.7.
Step 13235 (32 ms): -208.7.
Step 13273 (32 ms): -201.35.
Step 13310 (32 ms): -208.04.
Step 13348 (32 ms): -200.12.
Step 13386 (32 ms): -189.15.
Step 13423 (32 ms): -199.05.
Step 13461 (33 ms): -203.04.
Step 13498 (32 ms): -196.52.
Step 13536 (16 ms): -232.19.

Epoch 36 (12.1 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -202.05, ENRE: -195.27, KL: 6.7777.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 13574 (31 ms): -197.45.
Step 13611 (32 ms): -228.35.
Step 13649 (32 ms): -190.46.
Step 13686 (32 ms): -205.95.
Step 13724 (32 ms): -193.45.
Step 13762 (32 ms): -207.99.
Step 13799 (32 ms): -207.53.
Step 13837 (33 ms): -205.47.
Step 13874 (32 ms): -199.2.
Step 13912 (16 ms): -201.98.

Epoch 37 (12 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -201.75, ENRE: -195.11, KL: 6.6414.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 13950 (32 ms): -207.01.
Step 13987 (32 ms): -193.82.
Step 14025 (32 ms): -212.52.
Step 14062 (31 ms): -191.19.
Step 14100 (32 ms): -207.29.
Step 14138 (31 ms): -213.18.
Step 14175 (32 ms): -200.16.
Step 14213 (32 ms): -206.07.
Step 14250 (31 ms): -196.8.
Step 14288 (15 ms): -350.24.

Epoch 38 (12 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -201.42, ENRE: -194.66, KL: 6.7621.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 14326 (32 ms): -205.73.
Step 14363 (32 ms): -194.29.
Step 14401 (31 ms): -198.86.
Step 14438 (32 ms): -200.4.
Step 14476 (32 ms): -210.53.
Step 14514 (31 ms): -204.55.
Step 14551 (33 ms): -207.52.
Step 14589 (31 ms): -197.8.
Step 14626 (31 ms): -200.24.
Step 14664 (15 ms): -225.05.

Epoch 39 (11.9 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -201.1, ENRE: -194.45, KL: 6.6451.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 14702 (32 ms): -198.42.
Step 14739 (31 ms): -195.88.
Step 14777 (32 ms): -202.32.
Step 14814 (32 ms): -193.99.
Step 14852 (32 ms): -195.48.
Step 14890 (32 ms): -202.77.
Step 14927 (32 ms): -204.44.
Step 14965 (32 ms): -204.93.
Step 15002 (31 ms): -198.84.
Step 15040 (16 ms): -211.45.

Epoch 40 (12 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -201.14, ENRE: -194.44, KL: 6.7024.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 15078 (32 ms): -197.72.
Step 15115 (32 ms): -198.53.
Step 15153 (32 ms): -191.12.
Step 15190 (32 ms): -215.11.
Step 15228 (32 ms): -205.96.
Step 15266 (33 ms): -211.35.
Step 15303 (32 ms): -204.55.
Step 15341 (33 ms): -218.02.
Step 15378 (33 ms): -206.29.
Step 15416 (16 ms): -221.47.

Epoch 41 (12.1 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -200.8, ENRE: -194.1, KL: 6.6997.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 15454 (33 ms): -190.35.
Step 15491 (33 ms): -192.85.
Step 15529 (33 ms): -201.51.
Step 15566 (33 ms): -208.04.
Step 15604 (32 ms): -194.35.
Step 15642 (32 ms): -213.3.
Step 15679 (33 ms): -190.02.
Step 15717 (32 ms): -203.97.
Step 15754 (32 ms): -217.99.
Step 15792 (16 ms): -265.76.

Epoch 42 (12.2 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -200.9, ENRE: -194.15, KL: 6.7455.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 15830 (32 ms): -207.64.
Step 15867 (32 ms): -203.74.
Step 15905 (32 ms): -197.56.
Step 15942 (32 ms): -204.03.
Step 15980 (32 ms): -202.43.
Step 16018 (32 ms): -189.4.
Step 16055 (32 ms): -203.69.
Step 16093 (32 ms): -191.8.
Step 16130 (32 ms): -194.22.
Step 16168 (16 ms): -259.5.

Epoch 43 (12.1 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -200.82, ENRE: -194.04, KL: 6.7751.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 16206 (32 ms): -216.62.
Step 16243 (32 ms): -196.15.
Step 16281 (32 ms): -214.33.
Step 16318 (32 ms): -200.93.
Step 16356 (32 ms): -206.07.
Step 16394 (32 ms): -207.6.
Step 16431 (32 ms): -213.48.
Step 16469 (32 ms): -209.02.
Step 16506 (32 ms): -218.67.
Step 16544 (16 ms): -292.48.

Epoch 44 (12 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -200.87, ENRE: -194.04, KL: 6.8272.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 16582 (32 ms): -200.93.
Step 16619 (32 ms): -208.81.
Step 16657 (32 ms): -209.29.
Step 16694 (31 ms): -198.95.
Step 16732 (32 ms): -208.01.
Step 16770 (31 ms): -204.64.
Step 16807 (31 ms): -190.56.
Step 16845 (32 ms): -205.12.
Step 16882 (31 ms): -192.93.
Step 16920 (15 ms): -283.76.

Epoch 45 (11.9 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -200.46, ENRE: -193.61, KL: 6.8485.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 16958 (32 ms): -191.01.
Step 16995 (32 ms): -199.37.
Step 17033 (33 ms): -201.29.
Step 17070 (31 ms): -203.23.
Step 17108 (31 ms): -202.15.
Step 17146 (31 ms): -195.21.
Step 17183 (32 ms): -193.8.
Step 17221 (31 ms): -196.7.
Step 17258 (32 ms): -193.82.
Step 17296 (15 ms): -229.3.

Epoch 46 (12 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -200.39, ENRE: -193.63, KL: 6.7532.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 17334 (32 ms): -213.44.
Step 17371 (32 ms): -215.57.
Step 17409 (32 ms): -205.71.
Step 17446 (33 ms): -200.92.
Step 17484 (32 ms): -188.47.
Step 17522 (32 ms): -201.68.
Step 17559 (32 ms): -199.6.
Step 17597 (32 ms): -196.46.
Step 17634 (32 ms): -192.22.
Step 17672 (16 ms): -199.09.

Epoch 47 (12.1 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -200.54, ENRE: -193.82, KL: 6.7211.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 17710 (32 ms): -205.64.
Step 17747 (32 ms): -185.37.
Step 17785 (32 ms): -199.65.
Step 17822 (32 ms): -208.32.
Step 17860 (33 ms): -203.1.
Step 17898 (32 ms): -201.81.
Step 17935 (32 ms): -192.64.
Step 17973 (32 ms): -194.97.
Step 18010 (32 ms): -206.97.
Step 18048 (16 ms): -332.67.

Epoch 48 (12.1 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -200.41, ENRE: -193.59, KL: 6.8168.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 18086 (32 ms): -194.44.
Step 18123 (32 ms): -199.05.
Step 18161 (32 ms): -195.62.
Step 18198 (32 ms): -188.28.
Step 18236 (33 ms): -203.21.
Step 18274 (32 ms): -195.84.
Step 18311 (33 ms): -203.83.
Step 18349 (32 ms): -207.65.
Step 18386 (32 ms): -191.67.
Step 18424 (16 ms): -215.71.

Epoch 49 (12.2 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -200.42, ENRE: -193.6, KL: 6.8229.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 18462 (32 ms): -204.41.
Step 18499 (32 ms): -195.6.
Step 18537 (32 ms): -193.86.
Step 18574 (32 ms): -202.84.
Step 18612 (32 ms): -205.06.
Step 18650 (31 ms): -208.19.
Step 18687 (32 ms): -207.98.
Step 18725 (32 ms): -214.98.
Step 18762 (32 ms): -211.3.
Step 18800 (16 ms): -191.52.

Epoch 50 (12 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -200.18, ENRE: -193.36, KL: 6.8229.
    Saving model parameters.
    Model parameters saved (115 ms).

Model trained for 50 epochs (15m 8s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (12 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (856 ms).

Converting data set value array to sparse matrix.
Data set value array converted (274 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.84 s):  ELBO: -422.16, ENRE: -415.35, KL: 6.8185.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (678 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.3440895974609077
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 42
kl weight: 1.3440895974609077
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (50 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.69 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 42
    hidden sizes: 157, 276, 50, 299
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.3440895974609077
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 2 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 157)
    ENCODER/1/DENSE/biases:0             (157,)
    ENCODER/1/BATCH_NORM/beta:0          (157,)
    ENCODER/2/DENSE/weights:0            (157, 276)
    ENCODER/2/DENSE/biases:0             (276,)
    ENCODER/2/BATCH_NORM/beta:0          (276,)
    ENCODER/3/DENSE/weights:0            (276, 50)
    ENCODER/3/DENSE/biases:0             (50,)
    ENCODER/3/BATCH_NORM/beta:0          (50,)
    ENCODER/4/DENSE/weights:0            (50, 299)
    ENCODER/4/DENSE/biases:0             (299,)
    ENCODER/4/BATCH_NORM/beta:0          (299,)
    POSTERIOR/MU/DENSE/weights:0         (299, 42)
    POSTERIOR/MU/DENSE/biases:0          (42,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (299, 42)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (42,)
    DECODER/4/DENSE/weights:0            (42, 299)
    DECODER/4/DENSE/biases:0             (299,)
    DECODER/4/BATCH_NORM/beta:0          (299,)
    DECODER/3/DENSE/weights:0            (299, 50)
    DECODER/3/DENSE/biases:0             (50,)
    DECODER/3/BATCH_NORM/beta:0          (50,)
    DECODER/2/DENSE/weights:0            (50, 276)
    DECODER/2/DENSE/biases:0             (276,)
    DECODER/2/BATCH_NORM/beta:0          (276,)
    DECODER/1/DENSE/weights:0            (276, 157)
    DECODER/1/DENSE/biases:0             (157,)
    DECODER/1/BATCH_NORM/beta:0          (157,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (157, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (733 ms).

Training model for 50 epochs on original values.

Step 38 (32 ms): -2229.6.
Step 75 (32 ms): -1855.7.
Step 113 (32 ms): -1556.8.
Step 150 (31 ms): -1361.8.
Step 188 (32 ms): -1220.9.
Step 226 (32 ms): -1021.
Step 263 (32 ms): -987.68.
Step 301 (32 ms): -847.62.
Step 338 (32 ms): -759.41.
Step 376 (18 ms): -622.78.

Epoch 1 (14.5 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.43 s): ELBO: -1732.4, ENRE: -1714.8, KL: 17.62.
    Saving model parameters.
    Model parameters saved (182 ms).

Step 414 (33 ms): -599.96.
Step 451 (32 ms): -528.16.
Step 489 (31 ms): -489.11.
Step 526 (31 ms): -442.11.
Step 564 (32 ms): -406.9.
Step 602 (33 ms): -399.84.
Step 639 (32 ms): -404.92.
Step 677 (33 ms): -373.73.
Step 714 (32 ms): -344.65.
Step 752 (19 ms): -330.08.

Epoch 2 (12 s):
    Warm-up weight: 0.5
    Evaluating model.
    Full set (5.92 s): ELBO: -888.22, ENRE: -879.74, KL: 8.4866.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 790 (32 ms): -331.27.
Step 827 (33 ms): -316.5.
Step 865 (32 ms): -313.68.
Step 902 (32 ms): -298.75.
Step 940 (32 ms): -304.46.
Step 978 (31 ms): -288.47.
Step 1015 (32 ms): -303.5.
Step 1053 (32 ms): -266.3.
Step 1090 (32 ms): -279.51.
Step 1128 (15 ms): -234.68.

Epoch 3 (12 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -509.14, ENRE: -503.27, KL: 5.8721.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 1166 (32 ms): -278.8.
Step 1203 (31 ms): -252.18.
Step 1241 (34 ms): -269.1.
Step 1278 (32 ms): -255.15.
Step 1316 (32 ms): -249.36.
Step 1354 (32 ms): -255.97.
Step 1391 (32 ms): -242.86.
Step 1429 (32 ms): -269.05.
Step 1466 (32 ms): -237.42.
Step 1504 (15 ms): -327.02.

Epoch 4 (12 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -357.33, ENRE: -351.84, KL: 5.4912.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 1542 (32 ms): -243.73.
Step 1579 (32 ms): -251.69.
Step 1617 (31 ms): -233.82.
Step 1654 (32 ms): -265.12.
Step 1692 (32 ms): -255.
Step 1730 (31 ms): -257.02.
Step 1767 (32 ms): -237.08.
Step 1805 (32 ms): -250.33.
Step 1842 (33 ms): -244.65.
Step 1880 (15 ms): -293.54.

Epoch 5 (11.9 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -291.29, ENRE: -286.2, KL: 5.0884.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 1918 (33 ms): -224.73.
Step 1955 (31 ms): -257.13.
Step 1993 (32 ms): -234.51.
Step 2030 (32 ms): -233.4.
Step 2068 (31 ms): -221.38.
Step 2106 (31 ms): -245.33.
Step 2143 (32 ms): -225.27.
Step 2181 (31 ms): -253.76.
Step 2218 (31 ms): -240.01.
Step 2256 (15 ms): -365.5.

Epoch 6 (11.9 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -261.75, ENRE: -256.56, KL: 5.1919.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 2294 (32 ms): -217.84.
Step 2331 (32 ms): -218.46.
Step 2369 (32 ms): -225.83.
Step 2406 (32 ms): -233.03.
Step 2444 (32 ms): -232.46.
Step 2482 (32 ms): -225.62.
Step 2519 (32 ms): -226.97.
Step 2557 (31 ms): -215.75.
Step 2594 (33 ms): -236.34.
Step 2632 (15 ms): -243.61.

Epoch 7 (11.9 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -242.23, ENRE: -236.99, KL: 5.2484.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 2670 (32 ms): -236.5.
Step 2707 (31 ms): -214.65.
Step 2745 (32 ms): -223.26.
Step 2782 (31 ms): -226.73.
Step 2820 (32 ms): -208.85.
Step 2858 (31 ms): -231.07.
Step 2895 (31 ms): -230.99.
Step 2933 (31 ms): -235.8.
Step 2970 (32 ms): -228.81.
Step 3008 (16 ms): -219.6.

Epoch 8 (11.9 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -229.77, ENRE: -224.12, KL: 5.6519.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 3046 (34 ms): -212.36.
Step 3083 (32 ms): -241.24.
Step 3121 (32 ms): -228.61.
Step 3158 (32 ms): -224.07.
Step 3196 (33 ms): -221.47.
Step 3234 (33 ms): -214.02.
Step 3271 (33 ms): -215.08.
Step 3309 (32 ms): -224.2.
Step 3346 (32 ms): -220.81.
Step 3384 (15 ms): -305.33.

Epoch 9 (12.1 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -224.41, ENRE: -218.86, KL: 5.55.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 3422 (32 ms): -225.47.
Step 3459 (32 ms): -208.27.
Step 3497 (31 ms): -232.59.
Step 3534 (32 ms): -226.15.
Step 3572 (33 ms): -216.8.
Step 3610 (32 ms): -221.16.
Step 3647 (32 ms): -225.48.
Step 3685 (32 ms): -219.51.
Step 3722 (32 ms): -198.16.
Step 3760 (15 ms): -275.95.

Epoch 10 (12.1 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -219.75, ENRE: -213.99, KL: 5.7684.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 3798 (34 ms): -233.94.
Step 3835 (31 ms): -221.35.
Step 3873 (32 ms): -228.38.
Step 3910 (32 ms): -219.98.
Step 3948 (32 ms): -219.62.
Step 3986 (33 ms): -209.22.
Step 4023 (32 ms): -223.13.
Step 4061 (33 ms): -221.38.
Step 4098 (32 ms): -216.96.
Step 4136 (15 ms): -251.35.

Epoch 11 (12 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -216.37, ENRE: -210.46, KL: 5.9049.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 4174 (32 ms): -207.17.
Step 4211 (32 ms): -262.91.
Step 4249 (32 ms): -221.89.
Step 4286 (32 ms): -205.36.
Step 4324 (32 ms): -229.6.
Step 4362 (32 ms): -220.06.
Step 4399 (31 ms): -203.74.
Step 4437 (32 ms): -208.92.
Step 4474 (33 ms): -210.11.
Step 4512 (15 ms): -300.75.

Epoch 12 (12 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -214.8, ENRE: -209.04, KL: 5.7566.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 4550 (32 ms): -215.14.
Step 4587 (31 ms): -208.58.
Step 4625 (32 ms): -223.11.
Step 4662 (31 ms): -198.86.
Step 4700 (31 ms): -207.48.
Step 4738 (31 ms): -223.67.
Step 4775 (31 ms): -212.27.
Step 4813 (32 ms): -220.3.
Step 4850 (32 ms): -226.16.
Step 4888 (15 ms): -196.93.

Epoch 13 (11.9 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -213.5, ENRE: -207.71, KL: 5.7905.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 4926 (31 ms): -228.8.
Step 4963 (32 ms): -215.02.
Step 5001 (31 ms): -218.42.
Step 5038 (32 ms): -218.38.
Step 5076 (31 ms): -210.42.
Step 5114 (31 ms): -206.73.
Step 5151 (32 ms): -221.69.
Step 5189 (31 ms): -218.93.
Step 5226 (31 ms): -209.68.
Step 5264 (15 ms): -214.4.

Epoch 14 (11.9 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -212.73, ENRE: -207.13, KL: 5.5972.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 5302 (31 ms): -204.08.
Step 5339 (32 ms): -213.44.
Step 5377 (31 ms): -206.57.
Step 5414 (31 ms): -210.74.
Step 5452 (31 ms): -218.24.
Step 5490 (31 ms): -207.78.
Step 5527 (31 ms): -207.59.
Step 5565 (31 ms): -207.4.
Step 5602 (32 ms): -212.82.
Step 5640 (16 ms): -245.38.

Epoch 15 (12 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -212.08, ENRE: -206.69, KL: 5.3842.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 5678 (32 ms): -216.82.
Step 5715 (32 ms): -211.4.
Step 5753 (32 ms): -213.37.
Step 5790 (32 ms): -206.01.
Step 5828 (32 ms): -200.7.
Step 5866 (32 ms): -204.88.
Step 5903 (32 ms): -236.89.
Step 5941 (32 ms): -214.15.
Step 5978 (31 ms): -204.23.
Step 6016 (15 ms): -201.2.

Epoch 16 (12.1 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -211.53, ENRE: -206.26, KL: 5.2709.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 6054 (32 ms): -209.58.
Step 6091 (32 ms): -202.36.
Step 6129 (31 ms): -209.28.
Step 6166 (31 ms): -201.41.
Step 6204 (32 ms): -207.8.
Step 6242 (32 ms): -211.23.
Step 6279 (32 ms): -202.51.
Step 6317 (32 ms): -204.9.
Step 6354 (32 ms): -213.89.
Step 6392 (15 ms): -195.34.

Epoch 17 (12 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -210.29, ENRE: -205.04, KL: 5.2454.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 6430 (32 ms): -189.94.
Step 6467 (33 ms): -206.21.
Step 6505 (32 ms): -206.6.
Step 6542 (32 ms): -206.16.
Step 6580 (32 ms): -197.97.
Step 6618 (32 ms): -214.5.
Step 6655 (32 ms): -206.8.
Step 6693 (33 ms): -209.48.
Step 6730 (32 ms): -209.49.
Step 6768 (15 ms): -230.7.

Epoch 18 (12 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -210.15, ENRE: -204.83, KL: 5.3244.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 6806 (32 ms): -212.79.
Step 6843 (31 ms): -206.72.
Step 6881 (31 ms): -201.97.
Step 6918 (32 ms): -207.58.
Step 6956 (32 ms): -217.01.
Step 6994 (32 ms): -211.43.
Step 7031 (31 ms): -198.41.
Step 7069 (31 ms): -211.77.
Step 7106 (32 ms): -204.21.
Step 7144 (15 ms): -466.43.

Epoch 19 (11.9 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -208.83, ENRE: -203.61, KL: 5.2264.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 7182 (32 ms): -200.63.
Step 7219 (31 ms): -201.13.
Step 7257 (32 ms): -210.98.
Step 7294 (31 ms): -236.15.
Step 7332 (32 ms): -194.61.
Step 7370 (32 ms): -195.77.
Step 7407 (32 ms): -206.44.
Step 7445 (32 ms): -212.28.
Step 7482 (31 ms): -226.97.
Step 7520 (15 ms): -465.1.

Epoch 20 (11.9 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -208.18, ENRE: -202.93, KL: 5.2579.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 7558 (31 ms): -212.61.
Step 7595 (31 ms): -205.29.
Step 7633 (31 ms): -209.41.
Step 7670 (32 ms): -221.76.
Step 7708 (32 ms): -208.68.
Step 7746 (32 ms): -203.97.
Step 7783 (32 ms): -210.31.
Step 7821 (32 ms): -203.92.
Step 7858 (31 ms): -196.65.
Step 7896 (15 ms): -222.6.

Epoch 21 (11.9 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -207.43, ENRE: -202.2, KL: 5.2346.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 7934 (32 ms): -197.93.
Step 7971 (31 ms): -202.41.
Step 8009 (31 ms): -202.48.
Step 8046 (33 ms): -199.95.
Step 8084 (32 ms): -207.64.
Step 8122 (31 ms): -226.17.
Step 8159 (35 ms): -197.46.
Step 8197 (32 ms): -197.32.
Step 8234 (32 ms): -213.46.
Step 8272 (15 ms): -215.33.

Epoch 22 (12 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -206.54, ENRE: -201.27, KL: 5.267.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 8310 (32 ms): -199.58.
Step 8347 (32 ms): -204.95.
Step 8385 (33 ms): -215.58.
Step 8422 (32 ms): -210.79.
Step 8460 (31 ms): -209.5.
Step 8498 (33 ms): -207.39.
Step 8535 (32 ms): -208.96.
Step 8573 (31 ms): -211.19.
Step 8610 (32 ms): -208.16.
Step 8648 (15 ms): -284.78.

Epoch 23 (12 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -207.01, ENRE: -201.62, KL: 5.3876.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 8686 (32 ms): -191.98.
Step 8723 (32 ms): -211.09.
Step 8761 (33 ms): -205.9.
Step 8798 (32 ms): -209.67.
Step 8836 (32 ms): -201.19.
Step 8874 (32 ms): -200.92.
Step 8911 (32 ms): -221.2.
Step 8949 (32 ms): -220.01.
Step 8986 (32 ms): -211.88.
Step 9024 (17 ms): -820.03.

Epoch 24 (12 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -205.92, ENRE: -200.66, KL: 5.2692.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 9062 (32 ms): -207.32.
Step 9099 (33 ms): -203.95.
Step 9137 (32 ms): -197.12.
Step 9174 (32 ms): -217.24.
Step 9212 (32 ms): -195.5.
Step 9250 (33 ms): -218.53.
Step 9287 (32 ms): -207.11.
Step 9325 (32 ms): -215.7.
Step 9362 (31 ms): -210.8.
Step 9400 (15 ms): -270.88.

Epoch 25 (12 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -205.22, ENRE: -199.92, KL: 5.3046.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 9438 (31 ms): -192.97.
Step 9475 (32 ms): -214.67.
Step 9513 (32 ms): -199.22.
Step 9550 (32 ms): -198.75.
Step 9588 (31 ms): -198.61.
Step 9626 (32 ms): -201.31.
Step 9663 (32 ms): -201.8.
Step 9701 (32 ms): -196.44.
Step 9738 (32 ms): -198.13.
Step 9776 (15 ms): -190.38.

Epoch 26 (11.9 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -204.82, ENRE: -199.54, KL: 5.275.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 9814 (31 ms): -202.67.
Step 9851 (32 ms): -194.91.
Step 9889 (32 ms): -193.33.
Step 9926 (32 ms): -199.87.
Step 9964 (32 ms): -197.72.
Step 10002 (32 ms): -216.86.
Step 10039 (32 ms): -207.08.
Step 10077 (32 ms): -201.05.
Step 10114 (33 ms): -201.79.
Step 10152 (15 ms): -251.07.

Epoch 27 (11.9 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -204.4, ENRE: -198.94, KL: 5.4611.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 10190 (32 ms): -209.2.
Step 10227 (31 ms): -212.26.
Step 10265 (32 ms): -200.41.
Step 10302 (31 ms): -213.57.
Step 10340 (32 ms): -210.1.
Step 10378 (31 ms): -208.45.
Step 10415 (32 ms): -212.48.
Step 10453 (32 ms): -208.43.
Step 10490 (31 ms): -200.69.
Step 10528 (15 ms): -234.96.

Epoch 28 (11.9 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -204.01, ENRE: -198.56, KL: 5.4546.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 10566 (32 ms): -209.08.
Step 10603 (31 ms): -211.68.
Step 10641 (32 ms): -190.95.
Step 10678 (32 ms): -199.91.
Step 10716 (32 ms): -195.31.
Step 10754 (32 ms): -202.6.
Step 10791 (32 ms): -195.74.
Step 10829 (32 ms): -204.77.
Step 10866 (33 ms): -194.33.
Step 10904 (15 ms): -229.15.

Epoch 29 (12.1 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -204.46, ENRE: -199, KL: 5.4671.
    Saving model parameters.
    Model parameters saved (103 ms).

Step 10942 (31 ms): -209.71.
Step 10979 (32 ms): -206.23.
Step 11017 (32 ms): -204.11.
Step 11054 (31 ms): -207.24.
Step 11092 (32 ms): -209.33.
Step 11130 (32 ms): -205.01.
Step 11167 (32 ms): -212.14.
Step 11205 (31 ms): -204.83.
Step 11242 (32 ms): -207.47.
Step 11280 (15 ms): -211.87.

Epoch 30 (12 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -203.72, ENRE: -198.3, KL: 5.4152.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 11318 (32 ms): -215.21.
Step 11355 (31 ms): -198.4.
Step 11393 (32 ms): -210.85.
Step 11430 (32 ms): -210.42.
Step 11468 (32 ms): -199.95.
Step 11506 (32 ms): -203.39.
Step 11543 (32 ms): -208.78.
Step 11581 (32 ms): -188.
Step 11618 (32 ms): -193.89.
Step 11656 (15 ms): -199.35.

Epoch 31 (12 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -203.13, ENRE: -197.69, KL: 5.4425.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 11694 (32 ms): -199.07.
Step 11731 (32 ms): -199.98.
Step 11769 (31 ms): -206.42.
Step 11806 (31 ms): -205.73.
Step 11844 (32 ms): -196.29.
Step 11882 (31 ms): -210.46.
Step 11919 (32 ms): -203.09.
Step 11957 (32 ms): -212.8.
Step 11994 (31 ms): -199.6.
Step 12032 (15 ms): -341.02.

Epoch 32 (11.9 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -203.12, ENRE: -197.56, KL: 5.5624.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 12070 (31 ms): -212.31.
Step 12107 (31 ms): -202.25.
Step 12145 (31 ms): -191.97.
Step 12182 (31 ms): -204.47.
Step 12220 (31 ms): -198.53.
Step 12258 (31 ms): -204.01.
Step 12295 (32 ms): -206.56.
Step 12333 (32 ms): -205.75.
Step 12370 (31 ms): -206.53.
Step 12408 (15 ms): -216.86.

Epoch 33 (11.9 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -203.01, ENRE: -197.6, KL: 5.4098.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 12446 (31 ms): -198.52.
Step 12483 (31 ms): -207.57.
Step 12521 (31 ms): -206.82.
Step 12558 (32 ms): -198.94.
Step 12596 (32 ms): -199.57.
Step 12634 (31 ms): -189.98.
Step 12671 (31 ms): -189.54.
Step 12709 (31 ms): -191.81.
Step 12746 (32 ms): -214.2.
Step 12784 (16 ms): -274.06.

Epoch 34 (11.9 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -202.45, ENRE: -197.03, KL: 5.4225.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 12822 (32 ms): -197.9.
Step 12859 (32 ms): -207.11.
Step 12897 (32 ms): -215.25.
Step 12934 (31 ms): -196.93.
Step 12972 (32 ms): -204.89.
Step 13010 (32 ms): -202.82.
Step 13047 (31 ms): -198.57.
Step 13085 (32 ms): -212.28.
Step 13122 (32 ms): -206.
Step 13160 (15 ms): -423.14.

Epoch 35 (12 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -202.76, ENRE: -197.2, KL: 5.5645.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 13198 (31 ms): -195.07.
Step 13235 (32 ms): -199.2.
Step 13273 (32 ms): -205.25.
Step 13310 (32 ms): -195.38.
Step 13348 (32 ms): -200.4.
Step 13386 (32 ms): -206.43.
Step 13423 (33 ms): -210.48.
Step 13461 (32 ms): -203.81.
Step 13498 (33 ms): -196.01.
Step 13536 (15 ms): -215.41.

Epoch 36 (12.1 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -202.16, ENRE: -196.69, KL: 5.4739.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 13574 (32 ms): -204.53.
Step 13611 (32 ms): -192.95.
Step 13649 (31 ms): -214.29.
Step 13686 (32 ms): -194.51.
Step 13724 (31 ms): -213.17.
Step 13762 (32 ms): -201.42.
Step 13799 (32 ms): -219.77.
Step 13837 (32 ms): -190.26.
Step 13874 (32 ms): -191.26.
Step 13912 (15 ms): -197.11.

Epoch 37 (12 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -202.15, ENRE: -196.7, KL: 5.4526.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 13950 (32 ms): -201.06.
Step 13987 (32 ms): -195.4.
Step 14025 (32 ms): -213.23.
Step 14062 (32 ms): -207.49.
Step 14100 (32 ms): -200.48.
Step 14138 (32 ms): -211.76.
Step 14175 (33 ms): -185.92.
Step 14213 (33 ms): -214.13.
Step 14250 (33 ms): -203.5.
Step 14288 (15 ms): -213.94.

Epoch 38 (12 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -202.06, ENRE: -196.63, KL: 5.4269.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 14326 (32 ms): -197.36.
Step 14363 (32 ms): -192.6.
Step 14401 (33 ms): -201.84.
Step 14438 (31 ms): -200.15.
Step 14476 (32 ms): -199.37.
Step 14514 (32 ms): -208.24.
Step 14551 (32 ms): -202.22.
Step 14589 (32 ms): -210.34.
Step 14626 (31 ms): -202.3.
Step 14664 (15 ms): -298.27.

Epoch 39 (11.9 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -201.46, ENRE: -195.94, KL: 5.5174.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 14702 (32 ms): -206.8.
Step 14739 (31 ms): -215.83.
Step 14777 (31 ms): -199.08.
Step 14814 (31 ms): -202.85.
Step 14852 (31 ms): -208.87.
Step 14890 (46 ms): -209.1.
Step 14927 (32 ms): -202.44.
Step 14965 (32 ms): -195.52.
Step 15002 (32 ms): -204.61.
Step 15040 (15 ms): -224.26.

Epoch 40 (11.9 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -201.81, ENRE: -196.18, KL: 5.6315.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 15078 (32 ms): -223.65.
Step 15115 (32 ms): -197.47.
Step 15153 (32 ms): -194.51.
Step 15190 (32 ms): -206.06.
Step 15228 (33 ms): -212.78.
Step 15266 (31 ms): -201.48.
Step 15303 (31 ms): -192.38.
Step 15341 (32 ms): -204.34.
Step 15378 (32 ms): -199.9.
Step 15416 (15 ms): -197.53.

Epoch 41 (12 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -201.49, ENRE: -196.04, KL: 5.4532.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 15454 (32 ms): -196.6.
Step 15491 (31 ms): -192.47.
Step 15529 (33 ms): -201.03.
Step 15566 (31 ms): -204.93.
Step 15604 (31 ms): -206.05.
Step 15642 (32 ms): -188.52.
Step 15679 (32 ms): -187.49.
Step 15717 (32 ms): -217.54.
Step 15754 (31 ms): -208.59.
Step 15792 (16 ms): -168.5.

Epoch 42 (12 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -201.28, ENRE: -195.74, KL: 5.5389.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 15830 (32 ms): -220.12.
Step 15867 (32 ms): -201.45.
Step 15905 (32 ms): -192.53.
Step 15942 (32 ms): -198.64.
Step 15980 (33 ms): -198.19.
Step 16018 (33 ms): -204.04.
Step 16055 (32 ms): -204.26.
Step 16093 (33 ms): -200.07.
Step 16130 (32 ms): -193.24.
Step 16168 (15 ms): -221.93.

Epoch 43 (12.1 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -201.41, ENRE: -195.78, KL: 5.6362.
    Saving model parameters.
    Model parameters saved (102 ms).

Step 16206 (32 ms): -188.12.
Step 16243 (32 ms): -200.19.
Step 16281 (31 ms): -201.64.
Step 16318 (32 ms): -195.82.
Step 16356 (32 ms): -190.81.
Step 16394 (32 ms): -194.99.
Step 16431 (32 ms): -199.7.
Step 16469 (32 ms): -191.72.
Step 16506 (32 ms): -196.55.
Step 16544 (15 ms): -197.5.

Epoch 44 (12 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -201.22, ENRE: -195.69, KL: 5.5369.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 16582 (32 ms): -202.06.
Step 16619 (32 ms): -211.06.
Step 16657 (32 ms): -202.41.
Step 16694 (32 ms): -196.08.
Step 16732 (31 ms): -203.52.
Step 16770 (31 ms): -198.02.
Step 16807 (32 ms): -207.27.
Step 16845 (32 ms): -199.
Step 16882 (32 ms): -201.7.
Step 16920 (15 ms): -191.01.

Epoch 45 (12 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -201.23, ENRE: -195.59, KL: 5.6472.
    Saving model parameters.
    Model parameters saved (104 ms).

Step 16958 (32 ms): -219.99.
Step 16995 (32 ms): -191.58.
Step 17033 (31 ms): -196.84.
Step 17070 (31 ms): -212.41.
Step 17108 (32 ms): -189.08.
Step 17146 (31 ms): -192.78.
Step 17183 (31 ms): -201.04.
Step 17221 (31 ms): -191.6.
Step 17258 (32 ms): -196.77.
Step 17296 (15 ms): -242.15.

Epoch 46 (11.9 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -201.28, ENRE: -195.59, KL: 5.6929.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 17334 (31 ms): -204.03.
Step 17371 (32 ms): -201.24.
Step 17409 (31 ms): -189.23.
Step 17446 (31 ms): -197.45.
Step 17484 (32 ms): -198.49.
Step 17522 (32 ms): -194.73.
Step 17559 (31 ms): -189.95.
Step 17597 (31 ms): -193.9.
Step 17634 (32 ms): -209.33.
Step 17672 (15 ms): -214.94.

Epoch 47 (12 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -200.59, ENRE: -195, KL: 5.5831.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 17710 (31 ms): -199.45.
Step 17747 (31 ms): -191.28.
Step 17785 (32 ms): -203.23.
Step 17822 (32 ms): -195.34.
Step 17860 (32 ms): -198.13.
Step 17898 (32 ms): -210.93.
Step 17935 (31 ms): -205.24.
Step 17973 (31 ms): -203.87.
Step 18010 (32 ms): -190.76.
Step 18048 (15 ms): -185.05.

Epoch 48 (12 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -200.78, ENRE: -195.18, KL: 5.6008.
    Saving model parameters.
    Model parameters saved (105 ms).

Step 18086 (32 ms): -199.84.
Step 18123 (32 ms): -199.52.
Step 18161 (32 ms): -200.67.
Step 18198 (32 ms): -193.25.
Step 18236 (32 ms): -199.38.
Step 18274 (31 ms): -210.96.
Step 18311 (31 ms): -208.55.
Step 18349 (32 ms): -190.49.
Step 18386 (32 ms): -209.65.
Step 18424 (15 ms): -522.17.

Epoch 49 (12 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -200.52, ENRE: -194.87, KL: 5.6517.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 18462 (32 ms): -208.63.
Step 18499 (32 ms): -201.87.
Step 18537 (32 ms): -204.58.
Step 18574 (32 ms): -207.94.
Step 18612 (32 ms): -192.9.
Step 18650 (33 ms): -217.77.
Step 18687 (32 ms): -201.75.
Step 18725 (32 ms): -197.66.
Step 18762 (32 ms): -194.34.
Step 18800 (15 ms): -205.04.

Epoch 50 (12.1 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -200.54, ENRE: -194.91, KL: 5.6252.
    Saving model parameters.
    Model parameters saved (104 ms).

Model trained for 50 epochs (15m 2s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (906 ms).

Converting data set value array to sparse matrix.
Data set value array converted (317 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.84 s):  ELBO: -420.69, ENRE: -415.06, KL: 5.6249.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (673 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.5629991592111583
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 26
kl weight: 1.5629991592111583
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (46 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.29 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.89 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 26
    hidden sizes: 150, 299, 254, 98, 287
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.5629991592111583
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 2 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 150)
    ENCODER/1/DENSE/biases:0             (150,)
    ENCODER/1/BATCH_NORM/beta:0          (150,)
    ENCODER/2/DENSE/weights:0            (150, 299)
    ENCODER/2/DENSE/biases:0             (299,)
    ENCODER/2/BATCH_NORM/beta:0          (299,)
    ENCODER/3/DENSE/weights:0            (299, 254)
    ENCODER/3/DENSE/biases:0             (254,)
    ENCODER/3/BATCH_NORM/beta:0          (254,)
    ENCODER/4/DENSE/weights:0            (254, 98)
    ENCODER/4/DENSE/biases:0             (98,)
    ENCODER/4/BATCH_NORM/beta:0          (98,)
    ENCODER/5/DENSE/weights:0            (98, 287)
    ENCODER/5/DENSE/biases:0             (287,)
    ENCODER/5/BATCH_NORM/beta:0          (287,)
    POSTERIOR/MU/DENSE/weights:0         (287, 26)
    POSTERIOR/MU/DENSE/biases:0          (26,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (287, 26)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (26,)
    DECODER/5/DENSE/weights:0            (26, 287)
    DECODER/5/DENSE/biases:0             (287,)
    DECODER/5/BATCH_NORM/beta:0          (287,)
    DECODER/4/DENSE/weights:0            (287, 98)
    DECODER/4/DENSE/biases:0             (98,)
    DECODER/4/BATCH_NORM/beta:0          (98,)
    DECODER/3/DENSE/weights:0            (98, 254)
    DECODER/3/DENSE/biases:0             (254,)
    DECODER/3/BATCH_NORM/beta:0          (254,)
    DECODER/2/DENSE/weights:0            (254, 299)
    DECODER/2/DENSE/biases:0             (299,)
    DECODER/2/BATCH_NORM/beta:0          (299,)
    DECODER/1/DENSE/weights:0            (299, 150)
    DECODER/1/DENSE/biases:0             (150,)
    DECODER/1/BATCH_NORM/beta:0          (150,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (150, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (540 ms).

Training model for 50 epochs on original values.

Step 38 (38 ms): -2164.7.
Step 75 (37 ms): -1823.5.
Step 113 (36 ms): -1556.
Step 150 (36 ms): -1368.5.
Step 188 (36 ms): -1194.
Step 226 (36 ms): -1037.8.
Step 263 (36 ms): -966.69.
Step 301 (36 ms): -857.56.
Step 338 (36 ms): -771.86.
Step 376 (19 ms): -698.41.

Epoch 1 (16.5 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.95 s): ELBO: -1721.3, ENRE: -1712.4, KL: 8.9162.
    Saving model parameters.
    Model parameters saved (197 ms).

Step 414 (35 ms): -592.95.
Step 451 (35 ms): -522.95.
Step 489 (36 ms): -473.
Step 526 (36 ms): -447.22.
Step 564 (35 ms): -414.17.
Step 602 (36 ms): -399.1.
Step 639 (35 ms): -358.02.
Step 677 (36 ms): -370.34.
Step 714 (35 ms): -353.29.
Step 752 (17 ms): -321.03.

Epoch 2 (13.4 s):
    Warm-up weight: 0.5
    Evaluating model.
    Full set (6.25 s): ELBO: -933.46, ENRE: -926.59, KL: 6.8769.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 790 (35 ms): -321.38.
Step 827 (36 ms): -327.37.
Step 865 (36 ms): -297.66.
Step 902 (37 ms): -290.53.
Step 940 (37 ms): -307.3.
Step 978 (36 ms): -300.49.
Step 1015 (37 ms): -286.42.
Step 1053 (37 ms): -312.16.
Step 1090 (36 ms): -259.26.
Step 1128 (17 ms): -237.29.

Epoch 3 (13.6 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -537.07, ENRE: -531.57, KL: 5.5002.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 1166 (36 ms): -257.33.
Step 1203 (36 ms): -252.95.
Step 1241 (36 ms): -257.89.
Step 1278 (36 ms): -264.34.
Step 1316 (36 ms): -248.44.
Step 1354 (36 ms): -275.45.
Step 1391 (36 ms): -252.61.
Step 1429 (36 ms): -243.79.
Step 1466 (35 ms): -238.65.
Step 1504 (17 ms): -320.2.

Epoch 4 (13.6 s):
    Evaluating model.
    Full set (6.3 s): ELBO: -377.1, ENRE: -372.09, KL: 5.0046.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 1542 (36 ms): -257.07.
Step 1579 (37 ms): -243.63.
Step 1617 (36 ms): -258.34.
Step 1654 (36 ms): -243.75.
Step 1692 (36 ms): -249.32.
Step 1730 (36 ms): -237.48.
Step 1767 (36 ms): -239.28.
Step 1805 (36 ms): -268.27.
Step 1842 (36 ms): -235.75.
Step 1880 (17 ms): -256.31.

Epoch 5 (13.6 s):
    Evaluating model.
    Full set (6.26 s): ELBO: -307.4, ENRE: -302.68, KL: 4.7256.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 1918 (36 ms): -238.67.
Step 1955 (37 ms): -246.18.
Step 1993 (36 ms): -235.8.
Step 2030 (35 ms): -235.79.
Step 2068 (36 ms): -235.59.
Step 2106 (35 ms): -224.95.
Step 2143 (36 ms): -242.08.
Step 2181 (36 ms): -238.52.
Step 2218 (36 ms): -219.93.
Step 2256 (16 ms): -261.02.

Epoch 6 (13.4 s):
    Evaluating model.
    Full set (6.22 s): ELBO: -268.89, ENRE: -263.94, KL: 4.9475.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 2294 (37 ms): -235.81.
Step 2331 (35 ms): -224.77.
Step 2369 (35 ms): -233.29.
Step 2406 (37 ms): -231.18.
Step 2444 (37 ms): -227.7.
Step 2482 (37 ms): -219.21.
Step 2519 (36 ms): -243.13.
Step 2557 (35 ms): -242.55.
Step 2594 (36 ms): -228.44.
Step 2632 (19 ms): -240.89.

Epoch 7 (13.5 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -249.07, ENRE: -243.85, KL: 5.2187.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 2670 (36 ms): -247.32.
Step 2707 (35 ms): -222.77.
Step 2745 (35 ms): -233.45.
Step 2782 (36 ms): -219.65.
Step 2820 (35 ms): -234.49.
Step 2858 (35 ms): -217.26.
Step 2895 (35 ms): -221.95.
Step 2933 (36 ms): -225.18.
Step 2970 (35 ms): -224.1.
Step 3008 (17 ms): -531.52.

Epoch 8 (13.4 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -237.79, ENRE: -232.59, KL: 5.2002.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 3046 (36 ms): -231.13.
Step 3083 (35 ms): -214.37.
Step 3121 (36 ms): -216.19.
Step 3158 (37 ms): -213.79.
Step 3196 (36 ms): -224.82.
Step 3234 (36 ms): -203.45.
Step 3271 (36 ms): -216.35.
Step 3309 (36 ms): -215.92.
Step 3346 (36 ms): -220.59.
Step 3384 (17 ms): -236.16.

Epoch 9 (13.6 s):
    Evaluating model.
    Full set (6.31 s): ELBO: -228.8, ENRE: -223.19, KL: 5.6122.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 3422 (36 ms): -221.35.
Step 3459 (36 ms): -212.7.
Step 3497 (36 ms): -210.98.
Step 3534 (36 ms): -209.06.
Step 3572 (36 ms): -208.86.
Step 3610 (36 ms): -213.92.
Step 3647 (36 ms): -223.67.
Step 3685 (36 ms): -214.59.
Step 3722 (36 ms): -212.01.
Step 3760 (17 ms): -263.47.

Epoch 10 (13.6 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -224.03, ENRE: -218.56, KL: 5.4674.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 3798 (37 ms): -235.38.
Step 3835 (37 ms): -210.47.
Step 3873 (35 ms): -208.26.
Step 3910 (36 ms): -207.1.
Step 3948 (36 ms): -208.15.
Step 3986 (36 ms): -214.
Step 4023 (36 ms): -223.68.
Step 4061 (36 ms): -233.5.
Step 4098 (36 ms): -213.24.
Step 4136 (17 ms): -240.85.

Epoch 11 (13.6 s):
    Evaluating model.
    Full set (6.3 s): ELBO: -220.43, ENRE: -215.15, KL: 5.279.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 4174 (36 ms): -222.48.
Step 4211 (36 ms): -201.89.
Step 4249 (36 ms): -221.19.
Step 4286 (35 ms): -215.27.
Step 4324 (35 ms): -207.74.
Step 4362 (35 ms): -209.75.
Step 4399 (35 ms): -211.1.
Step 4437 (36 ms): -204.2.
Step 4474 (36 ms): -211.73.
Step 4512 (17 ms): -223.51.

Epoch 12 (13.4 s):
    Evaluating model.
    Full set (6.22 s): ELBO: -215.96, ENRE: -211, KL: 4.963.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 4550 (36 ms): -218.63.
Step 4587 (35 ms): -208.11.
Step 4625 (37 ms): -205.15.
Step 4662 (35 ms): -205.66.
Step 4700 (35 ms): -216.87.
Step 4738 (36 ms): -204.07.
Step 4775 (35 ms): -207.64.
Step 4813 (36 ms): -205.49.
Step 4850 (36 ms): -196.89.
Step 4888 (17 ms): -319.28.

Epoch 13 (13.4 s):
    Evaluating model.
    Full set (6.26 s): ELBO: -214.84, ENRE: -209.71, KL: 5.1318.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 4926 (35 ms): -208.18.
Step 4963 (36 ms): -202.83.
Step 5001 (36 ms): -209.44.
Step 5038 (35 ms): -213.37.
Step 5076 (35 ms): -212.94.
Step 5114 (35 ms): -209.51.
Step 5151 (36 ms): -211.77.
Step 5189 (36 ms): -223.14.
Step 5226 (35 ms): -207.69.
Step 5264 (17 ms): -310.39.

Epoch 14 (13.3 s):
    Evaluating model.
    Full set (6.22 s): ELBO: -211.82, ENRE: -206.78, KL: 5.0408.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 5302 (36 ms): -204.29.
Step 5339 (35 ms): -216.73.
Step 5377 (35 ms): -219.1.
Step 5414 (36 ms): -216.12.
Step 5452 (35 ms): -216.25.
Step 5490 (35 ms): -205.92.
Step 5527 (35 ms): -211.77.
Step 5565 (35 ms): -207.85.
Step 5602 (35 ms): -221.33.
Step 5640 (17 ms): -280.76.

Epoch 15 (13.4 s):
    Evaluating model.
    Full set (6.3 s): ELBO: -210.36, ENRE: -205.37, KL: 4.9933.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 5678 (36 ms): -224.7.
Step 5715 (36 ms): -218.62.
Step 5753 (36 ms): -211.33.
Step 5790 (36 ms): -198.69.
Step 5828 (36 ms): -200.79.
Step 5866 (36 ms): -220.58.
Step 5903 (36 ms): -210.22.
Step 5941 (36 ms): -197.5.
Step 5978 (36 ms): -214.41.
Step 6016 (17 ms): -187.5.

Epoch 16 (13.5 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -209.99, ENRE: -204.99, KL: 4.9961.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 6054 (38 ms): -209.48.
Step 6091 (36 ms): -210.16.
Step 6129 (35 ms): -200.87.
Step 6166 (35 ms): -200.2.
Step 6204 (36 ms): -197.49.
Step 6242 (36 ms): -198.34.
Step 6279 (35 ms): -197.62.
Step 6317 (36 ms): -201.75.
Step 6354 (37 ms): -201.59.
Step 6392 (17 ms): -293.73.

Epoch 17 (13.6 s):
    Evaluating model.
    Full set (6.31 s): ELBO: -208.6, ENRE: -203.83, KL: 4.7708.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 6430 (36 ms): -202.4.
Step 6467 (36 ms): -228.35.
Step 6505 (37 ms): -200.68.
Step 6542 (36 ms): -200.
Step 6580 (35 ms): -201.3.
Step 6618 (35 ms): -182.98.
Step 6655 (36 ms): -201.88.
Step 6693 (36 ms): -202.61.
Step 6730 (36 ms): -230.41.
Step 6768 (17 ms): -237.63.

Epoch 18 (13.5 s):
    Evaluating model.
    Full set (6.22 s): ELBO: -208.15, ENRE: -203.17, KL: 4.9826.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 6806 (36 ms): -194.95.
Step 6843 (35 ms): -215.86.
Step 6881 (35 ms): -209.2.
Step 6918 (36 ms): -209.46.
Step 6956 (36 ms): -197.
Step 6994 (36 ms): -200.08.
Step 7031 (36 ms): -207.98.
Step 7069 (35 ms): -197.49.
Step 7106 (35 ms): -202.88.
Step 7144 (17 ms): -191.15.

Epoch 19 (13.4 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -207.15, ENRE: -202.06, KL: 5.0879.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 7182 (35 ms): -191.07.
Step 7219 (35 ms): -204.
Step 7257 (35 ms): -216.31.
Step 7294 (35 ms): -203.58.
Step 7332 (35 ms): -204.03.
Step 7370 (35 ms): -226.81.
Step 7407 (36 ms): -210.46.
Step 7445 (36 ms): -197.13.
Step 7482 (35 ms): -199.99.
Step 7520 (17 ms): -314.87.

Epoch 20 (13.4 s):
    Evaluating model.
    Full set (6.22 s): ELBO: -207.04, ENRE: -201.87, KL: 5.1674.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 7558 (35 ms): -223.76.
Step 7595 (35 ms): -205.54.
Step 7633 (35 ms): -205.45.
Step 7670 (36 ms): -217.87.
Step 7708 (35 ms): -202.76.
Step 7746 (35 ms): -208.78.
Step 7783 (35 ms): -217.7.
Step 7821 (35 ms): -197.67.
Step 7858 (35 ms): -198.49.
Step 7896 (17 ms): -213.1.

Epoch 21 (13.4 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -206.09, ENRE: -201.01, KL: 5.0825.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 7934 (36 ms): -210.42.
Step 7971 (36 ms): -196.35.
Step 8009 (36 ms): -203.71.
Step 8046 (35 ms): -204.63.
Step 8084 (36 ms): -202.88.
Step 8122 (35 ms): -194.59.
Step 8159 (36 ms): -198.41.
Step 8197 (36 ms): -210.87.
Step 8234 (35 ms): -198.8.
Step 8272 (17 ms): -223.82.

Epoch 22 (13.5 s):
    Evaluating model.
    Full set (6.24 s): ELBO: -205.97, ENRE: -200.99, KL: 4.9757.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 8310 (36 ms): -218.17.
Step 8347 (36 ms): -203.08.
Step 8385 (36 ms): -200.95.
Step 8422 (36 ms): -201.13.
Step 8460 (36 ms): -201.64.
Step 8498 (36 ms): -201.35.
Step 8535 (38 ms): -201.95.
Step 8573 (36 ms): -205.12.
Step 8610 (36 ms): -201.54.
Step 8648 (17 ms): -186.53.

Epoch 23 (13.6 s):
    Evaluating model.
    Full set (6.3 s): ELBO: -205.12, ENRE: -200, KL: 5.1159.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 8686 (36 ms): -203.85.
Step 8723 (36 ms): -215.2.
Step 8761 (37 ms): -214.25.
Step 8798 (36 ms): -194.17.
Step 8836 (36 ms): -202.67.
Step 8874 (35 ms): -192.55.
Step 8911 (36 ms): -201.3.
Step 8949 (36 ms): -208.53.
Step 8986 (36 ms): -197.93.
Step 9024 (17 ms): -365.77.

Epoch 24 (13.6 s):
    Evaluating model.
    Full set (6.24 s): ELBO: -204.7, ENRE: -199.49, KL: 5.2147.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 9062 (36 ms): -200.9.
Step 9099 (35 ms): -197.74.
Step 9137 (36 ms): -196.94.
Step 9174 (35 ms): -212.88.
Step 9212 (35 ms): -187.87.
Step 9250 (36 ms): -207.87.
Step 9287 (36 ms): -202.25.
Step 9325 (35 ms): -209.21.
Step 9362 (36 ms): -207.3.
Step 9400 (16 ms): -227.92.

Epoch 25 (13.4 s):
    Evaluating model.
    Full set (6.26 s): ELBO: -204.32, ENRE: -199.08, KL: 5.2446.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 9438 (37 ms): -208.78.
Step 9475 (36 ms): -198.96.
Step 9513 (36 ms): -220.48.
Step 9550 (36 ms): -213.31.
Step 9588 (36 ms): -187.4.
Step 9626 (35 ms): -202.36.
Step 9663 (36 ms): -191.39.
Step 9701 (35 ms): -193.41.
Step 9738 (35 ms): -222.74.
Step 9776 (17 ms): -197.5.

Epoch 26 (13.4 s):
    Evaluating model.
    Full set (6.2 s): ELBO: -203.72, ENRE: -198.62, KL: 5.0994.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 9814 (36 ms): -197.82.
Step 9851 (35 ms): -199.28.
Step 9889 (35 ms): -200.69.
Step 9926 (36 ms): -197.67.
Step 9964 (35 ms): -199.13.
Step 10002 (35 ms): -199.78.
Step 10039 (35 ms): -195.88.
Step 10077 (35 ms): -207.5.
Step 10114 (36 ms): -196.86.
Step 10152 (17 ms): -282.53.

Epoch 27 (13.5 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -203.27, ENRE: -198.13, KL: 5.1353.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 10190 (36 ms): -200.98.
Step 10227 (36 ms): -201.59.
Step 10265 (36 ms): -195.16.
Step 10302 (36 ms): -215.92.
Step 10340 (36 ms): -195.87.
Step 10378 (36 ms): -206.65.
Step 10415 (36 ms): -220.08.
Step 10453 (36 ms): -200.79.
Step 10490 (36 ms): -205.93.
Step 10528 (17 ms): -225.71.

Epoch 28 (13.6 s):
    Evaluating model.
    Full set (6.29 s): ELBO: -203.7, ENRE: -198.35, KL: 5.3522.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 10566 (36 ms): -193.9.
Step 10603 (36 ms): -215.73.
Step 10641 (36 ms): -213.73.
Step 10678 (36 ms): -211.12.
Step 10716 (36 ms): -194.72.
Step 10754 (36 ms): -215.59.
Step 10791 (36 ms): -197.61.
Step 10829 (36 ms): -199.67.
Step 10866 (37 ms): -203.44.
Step 10904 (17 ms): -210.44.

Epoch 29 (13.6 s):
    Evaluating model.
    Full set (6.28 s): ELBO: -203.74, ENRE: -198.45, KL: 5.2967.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 10942 (36 ms): -210.41.
Step 10979 (36 ms): -199.31.
Step 11017 (36 ms): -192.15.
Step 11054 (35 ms): -199.81.
Step 11092 (35 ms): -188.29.
Step 11130 (35 ms): -201.76.
Step 11167 (36 ms): -209.56.
Step 11205 (36 ms): -213.36.
Step 11242 (35 ms): -191.98.
Step 11280 (17 ms): -280.17.

Epoch 30 (13.5 s):
    Evaluating model.
    Full set (6.24 s): ELBO: -203.1, ENRE: -197.78, KL: 5.3277.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 11318 (36 ms): -211.64.
Step 11355 (35 ms): -194.68.
Step 11393 (35 ms): -196.59.
Step 11430 (36 ms): -200.77.
Step 11468 (35 ms): -190.79.
Step 11506 (36 ms): -205.67.
Step 11543 (35 ms): -204.86.
Step 11581 (35 ms): -206.44.
Step 11618 (35 ms): -208.32.
Step 11656 (16 ms): -202.61.

Epoch 31 (13.4 s):
    Evaluating model.
    Full set (6.23 s): ELBO: -202.57, ENRE: -197.33, KL: 5.2409.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 11694 (36 ms): -225.9.
Step 11731 (36 ms): -216.38.
Step 11769 (35 ms): -198.39.
Step 11806 (36 ms): -202.29.
Step 11844 (35 ms): -210.63.
Step 11882 (36 ms): -195.42.
Step 11919 (36 ms): -204.8.
Step 11957 (36 ms): -211.79.
Step 11994 (35 ms): -220.93.
Step 12032 (17 ms): -189.42.

Epoch 32 (13.5 s):
    Evaluating model.
    Full set (6.24 s): ELBO: -203.07, ENRE: -197.83, KL: 5.2365.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 12070 (36 ms): -213.48.
Step 12107 (36 ms): -200.46.
Step 12145 (36 ms): -209.41.
Step 12182 (36 ms): -207.07.
Step 12220 (36 ms): -189.36.
Step 12258 (36 ms): -198.84.
Step 12295 (36 ms): -195.04.
Step 12333 (36 ms): -203.92.
Step 12370 (36 ms): -206.38.
Step 12408 (17 ms): -185.63.

Epoch 33 (13.5 s):
    Evaluating model.
    Full set (6.26 s): ELBO: -202.86, ENRE: -197.64, KL: 5.2148.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 12446 (36 ms): -202.68.
Step 12483 (36 ms): -201.86.
Step 12521 (37 ms): -208.53.
Step 12558 (37 ms): -200.39.
Step 12596 (36 ms): -199.12.
Step 12634 (36 ms): -200.57.
Step 12671 (38 ms): -200.53.
Step 12709 (36 ms): -203.23.
Step 12746 (36 ms): -216.5.
Step 12784 (17 ms): -200.82.

Epoch 34 (13.6 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -202.27, ENRE: -197.07, KL: 5.2086.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 12822 (36 ms): -201.19.
Step 12859 (36 ms): -211.72.
Step 12897 (36 ms): -189.29.
Step 12934 (36 ms): -196.24.
Step 12972 (36 ms): -218.45.
Step 13010 (36 ms): -201.98.
Step 13047 (36 ms): -194.36.
Step 13085 (36 ms): -201.67.
Step 13122 (36 ms): -203.54.
Step 13160 (17 ms): -211.08.

Epoch 35 (13.5 s):
    Evaluating model.
    Full set (6.24 s): ELBO: -202.16, ENRE: -196.97, KL: 5.1858.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 13198 (36 ms): -199.24.
Step 13235 (36 ms): -194.96.
Step 13273 (36 ms): -193.3.
Step 13310 (36 ms): -200.95.
Step 13348 (36 ms): -202.38.
Step 13386 (35 ms): -205.95.
Step 13423 (36 ms): -194.08.
Step 13461 (36 ms): -198.48.
Step 13498 (35 ms): -202.04.
Step 13536 (17 ms): -280.93.

Epoch 36 (13.5 s):
    Evaluating model.
    Full set (6.21 s): ELBO: -201.73, ENRE: -196.54, KL: 5.1936.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 13574 (36 ms): -201.82.
Step 13611 (35 ms): -205.09.
Step 13649 (36 ms): -196.02.
Step 13686 (36 ms): -207.63.
Step 13724 (36 ms): -206.95.
Step 13762 (36 ms): -196.74.
Step 13799 (35 ms): -214.21.
Step 13837 (35 ms): -202.
Step 13874 (36 ms): -200.76.
Step 13912 (16 ms): -196.81.

Epoch 37 (13.4 s):
    Evaluating model.
    Full set (6.21 s): ELBO: -201.79, ENRE: -196.52, KL: 5.2607.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 13950 (35 ms): -208.41.
Step 13987 (36 ms): -195.13.
Step 14025 (36 ms): -202.31.
Step 14062 (36 ms): -195.54.
Step 14100 (36 ms): -197.59.
Step 14138 (35 ms): -196.73.
Step 14175 (36 ms): -199.21.
Step 14213 (36 ms): -202.91.
Step 14250 (35 ms): -209.34.
Step 14288 (17 ms): -202.61.

Epoch 38 (13.4 s):
    Evaluating model.
    Full set (6.24 s): ELBO: -201.83, ENRE: -196.7, KL: 5.1388.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 14326 (36 ms): -204.64.
Step 14363 (36 ms): -201.6.
Step 14401 (35 ms): -207.09.
Step 14438 (36 ms): -193.11.
Step 14476 (35 ms): -191.43.
Step 14514 (36 ms): -202.43.
Step 14551 (36 ms): -200.9.
Step 14589 (36 ms): -207.75.
Step 14626 (36 ms): -212.85.
Step 14664 (17 ms): -286.63.

Epoch 39 (13.5 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -202.3, ENRE: -197.05, KL: 5.245.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 14702 (36 ms): -192.61.
Step 14739 (36 ms): -208.87.
Step 14777 (37 ms): -193.99.
Step 14814 (36 ms): -193.19.
Step 14852 (36 ms): -200.68.
Step 14890 (36 ms): -193.42.
Step 14927 (36 ms): -201.93.
Step 14965 (36 ms): -204.78.
Step 15002 (37 ms): -198.54.
Step 15040 (17 ms): -208.93.

Epoch 40 (13.7 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -201.68, ENRE: -196.39, KL: 5.2937.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 15078 (36 ms): -195.36.
Step 15115 (36 ms): -203.23.
Step 15153 (37 ms): -203.63.
Step 15190 (37 ms): -189.37.
Step 15228 (36 ms): -212.95.
Step 15266 (36 ms): -214.96.
Step 15303 (36 ms): -204.16.
Step 15341 (36 ms): -210.97.
Step 15378 (36 ms): -199.01.
Step 15416 (17 ms): -204.12.

Epoch 41 (13.5 s):
    Evaluating model.
    Full set (6.21 s): ELBO: -201.39, ENRE: -196.13, KL: 5.2543.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 15454 (35 ms): -203.9.
Step 15491 (36 ms): -193.13.
Step 15529 (36 ms): -198.61.
Step 15566 (35 ms): -198.06.
Step 15604 (36 ms): -221.58.
Step 15642 (36 ms): -197.15.
Step 15679 (36 ms): -193.9.
Step 15717 (36 ms): -191.79.
Step 15754 (35 ms): -212.01.
Step 15792 (17 ms): -263.09.

Epoch 42 (13.5 s):
    Evaluating model.
    Full set (6.23 s): ELBO: -201.67, ENRE: -196.41, KL: 5.2564.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 15830 (35 ms): -201.22.
Step 15867 (36 ms): -203.26.
Step 15905 (35 ms): -203.09.
Step 15942 (36 ms): -201.16.
Step 15980 (37 ms): -193.08.
Step 16018 (36 ms): -204.67.
Step 16055 (35 ms): -198.15.
Step 16093 (35 ms): -202.5.
Step 16130 (36 ms): -201.96.
Step 16168 (17 ms): -208.27.

Epoch 43 (13.4 s):
    Evaluating model.
    Full set (6.23 s): ELBO: -200.84, ENRE: -195.66, KL: 5.1847.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 16206 (36 ms): -205.23.
Step 16243 (36 ms): -203.6.
Step 16281 (35 ms): -201.31.
Step 16318 (36 ms): -203.18.
Step 16356 (36 ms): -202.93.
Step 16394 (36 ms): -197.33.
Step 16431 (36 ms): -197.62.
Step 16469 (36 ms): -218.36.
Step 16506 (36 ms): -200.9.
Step 16544 (17 ms): -193.54.

Epoch 44 (13.5 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -201.01, ENRE: -195.8, KL: 5.2147.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 16582 (36 ms): -201.59.
Step 16619 (36 ms): -199.61.
Step 16657 (35 ms): -197.68.
Step 16694 (36 ms): -198.64.
Step 16732 (36 ms): -198.95.
Step 16770 (36 ms): -201.08.
Step 16807 (36 ms): -206.09.
Step 16845 (36 ms): -203.37.
Step 16882 (36 ms): -203.53.
Step 16920 (17 ms): -289.78.

Epoch 45 (13.5 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -201.05, ENRE: -195.92, KL: 5.1273.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 16958 (36 ms): -202.8.
Step 16995 (36 ms): -195.93.
Step 17033 (37 ms): -193.72.
Step 17070 (36 ms): -200.27.
Step 17108 (37 ms): -203.05.
Step 17146 (36 ms): -183.39.
Step 17183 (36 ms): -207.07.
Step 17221 (36 ms): -200.29.
Step 17258 (36 ms): -210.1.
Step 17296 (17 ms): -198.6.

Epoch 46 (13.6 s):
    Evaluating model.
    Full set (6.26 s): ELBO: -200.99, ENRE: -195.7, KL: 5.2966.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 17334 (36 ms): -204.08.
Step 17371 (36 ms): -186.32.
Step 17409 (35 ms): -191.71.
Step 17446 (36 ms): -187.76.
Step 17484 (36 ms): -194.27.
Step 17522 (37 ms): -207.48.
Step 17559 (36 ms): -202.01.
Step 17597 (36 ms): -206.38.
Step 17634 (36 ms): -200.78.
Step 17672 (17 ms): -190.48.

Epoch 47 (13.5 s):
    Evaluating model.
    Full set (6.22 s): ELBO: -200.76, ENRE: -195.56, KL: 5.1975.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 17710 (36 ms): -194.18.
Step 17747 (35 ms): -204.93.
Step 17785 (36 ms): -206.24.
Step 17822 (37 ms): -207.4.
Step 17860 (36 ms): -208.02.
Step 17898 (35 ms): -205.4.
Step 17935 (36 ms): -197.35.
Step 17973 (36 ms): -206.85.
Step 18010 (36 ms): -197.85.
Step 18048 (16 ms): -230.36.

Epoch 48 (13.5 s):
    Evaluating model.
    Full set (6.22 s): ELBO: -200.72, ENRE: -195.57, KL: 5.1437.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 18086 (35 ms): -197.32.
Step 18123 (36 ms): -200.64.
Step 18161 (35 ms): -191.71.
Step 18198 (36 ms): -201.71.
Step 18236 (36 ms): -191.63.
Step 18274 (36 ms): -204.31.
Step 18311 (35 ms): -204.69.
Step 18349 (37 ms): -208.22.
Step 18386 (35 ms): -206.32.
Step 18424 (16 ms): -207.65.

Epoch 49 (13.4 s):
    Evaluating model.
    Full set (6.21 s): ELBO: -200.56, ENRE: -195.29, KL: 5.2665.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 18462 (35 ms): -195.25.
Step 18499 (35 ms): -192.4.
Step 18537 (35 ms): -194.
Step 18574 (35 ms): -197.51.
Step 18612 (35 ms): -191.64.
Step 18650 (36 ms): -201.1.
Step 18687 (36 ms): -199.39.
Step 18725 (35 ms): -196.13.
Step 18762 (35 ms): -206.86.
Step 18800 (17 ms): -220.93.

Epoch 50 (13.4 s):
    Evaluating model.
    Full set (6.24 s): ELBO: -200.22, ENRE: -194.92, KL: 5.3058.
    Saving model parameters.
    Model parameters saved (119 ms).

Model trained for 50 epochs (16m 39s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (895 ms).

Converting data set value array to sparse matrix.
Data set value array converted (311 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2.22 s):  ELBO: -419.34, ENRE: -414.04, KL: 5.2992.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (778 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.3311389120122017
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 42
kl weight: 1.3311389120122017
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (47 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.2 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.88 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 42
    hidden sizes: 157, 276, 54, 296
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.3311389120122017
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 1 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 157)
    ENCODER/1/DENSE/biases:0             (157,)
    ENCODER/1/BATCH_NORM/beta:0          (157,)
    ENCODER/2/DENSE/weights:0            (157, 276)
    ENCODER/2/DENSE/biases:0             (276,)
    ENCODER/2/BATCH_NORM/beta:0          (276,)
    ENCODER/3/DENSE/weights:0            (276, 54)
    ENCODER/3/DENSE/biases:0             (54,)
    ENCODER/3/BATCH_NORM/beta:0          (54,)
    ENCODER/4/DENSE/weights:0            (54, 296)
    ENCODER/4/DENSE/biases:0             (296,)
    ENCODER/4/BATCH_NORM/beta:0          (296,)
    POSTERIOR/MU/DENSE/weights:0         (296, 42)
    POSTERIOR/MU/DENSE/biases:0          (42,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (296, 42)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (42,)
    DECODER/4/DENSE/weights:0            (42, 296)
    DECODER/4/DENSE/biases:0             (296,)
    DECODER/4/BATCH_NORM/beta:0          (296,)
    DECODER/3/DENSE/weights:0            (296, 54)
    DECODER/3/DENSE/biases:0             (54,)
    DECODER/3/BATCH_NORM/beta:0          (54,)
    DECODER/2/DENSE/weights:0            (54, 276)
    DECODER/2/DENSE/biases:0             (276,)
    DECODER/2/BATCH_NORM/beta:0          (276,)
    DECODER/1/DENSE/weights:0            (276, 157)
    DECODER/1/DENSE/biases:0             (157,)
    DECODER/1/BATCH_NORM/beta:0          (157,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (157, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (462 ms).

Training model for 50 epochs on original values.

Step 38 (35 ms): -2203.1.
Step 75 (32 ms): -1840.7.
Step 113 (33 ms): -1598.8.
Step 150 (31 ms): -1388.8.
Step 188 (33 ms): -1223.2.
Step 226 (32 ms): -1050.2.
Step 263 (32 ms): -919.58.
Step 301 (32 ms): -855.59.
Step 338 (32 ms): -763.09.
Step 376 (19 ms): -719.71.

Epoch 1 (14.7 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.48 s): ELBO: -1764.8, ENRE: -1750, KL: 14.847.
    Saving model parameters.
    Model parameters saved (182 ms).

Step 414 (32 ms): -558.48.
Step 451 (32 ms): -514.68.
Step 489 (32 ms): -474.98.
Step 526 (32 ms): -434.59.
Step 564 (32 ms): -422.42.
Step 602 (32 ms): -419.29.
Step 639 (33 ms): -371.36.
Step 677 (32 ms): -373.27.
Step 714 (33 ms): -345.18.
Step 752 (17 ms): -316.15.

Epoch 2 (12.1 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -885.24, ENRE: -877.03, KL: 8.2035.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 790 (32 ms): -314.6.
Step 827 (32 ms): -308.93.
Step 865 (31 ms): -289.43.
Step 902 (31 ms): -280.8.
Step 940 (32 ms): -287.25.
Step 978 (33 ms): -302.59.
Step 1015 (32 ms): -274.51.
Step 1053 (32 ms): -276.09.
Step 1090 (32 ms): -273.92.
Step 1128 (15 ms): -490.3.

Epoch 3 (12 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -505.37, ENRE: -498.98, KL: 6.3897.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 1166 (33 ms): -262.13.
Step 1203 (32 ms): -279.24.
Step 1241 (32 ms): -262.19.
Step 1278 (32 ms): -270.26.
Step 1316 (32 ms): -257.28.
Step 1354 (31 ms): -240.68.
Step 1391 (32 ms): -242.79.
Step 1429 (32 ms): -261.45.
Step 1466 (31 ms): -250.1.
Step 1504 (15 ms): -280.09.

Epoch 4 (12 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -354.5, ENRE: -349.21, KL: 5.2842.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 1542 (32 ms): -239.19.
Step 1579 (31 ms): -245.25.
Step 1617 (31 ms): -240.67.
Step 1654 (31 ms): -241.18.
Step 1692 (32 ms): -245.97.
Step 1730 (31 ms): -235.88.
Step 1767 (31 ms): -246.78.
Step 1805 (32 ms): -243.96.
Step 1842 (31 ms): -226.14.
Step 1880 (15 ms): -279.62.

Epoch 5 (11.9 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -289.57, ENRE: -284.3, KL: 5.2692.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 1918 (33 ms): -235.49.
Step 1955 (32 ms): -251.78.
Step 1993 (33 ms): -229.93.
Step 2030 (32 ms): -226.25.
Step 2068 (32 ms): -222.99.
Step 2106 (34 ms): -248.51.
Step 2143 (32 ms): -237.37.
Step 2181 (32 ms): -242.84.
Step 2218 (32 ms): -224.97.
Step 2256 (16 ms): -238.96.

Epoch 6 (12.1 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -259.45, ENRE: -254.25, KL: 5.1988.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 2294 (32 ms): -225.93.
Step 2331 (31 ms): -246.49.
Step 2369 (32 ms): -236.8.
Step 2406 (32 ms): -219.57.
Step 2444 (32 ms): -242.64.
Step 2482 (32 ms): -230.95.
Step 2519 (32 ms): -231.5.
Step 2557 (32 ms): -220.63.
Step 2594 (31 ms): -218.46.
Step 2632 (16 ms): -258.83.

Epoch 7 (12 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -242.98, ENRE: -237.5, KL: 5.4738.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 2670 (32 ms): -219.65.
Step 2707 (32 ms): -223.31.
Step 2745 (32 ms): -217.61.
Step 2782 (32 ms): -258.88.
Step 2820 (32 ms): -208.65.
Step 2858 (32 ms): -227.04.
Step 2895 (32 ms): -230.54.
Step 2933 (32 ms): -237.09.
Step 2970 (32 ms): -248.63.
Step 3008 (15 ms): -208.64.

Epoch 8 (12 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -233.2, ENRE: -227.73, KL: 5.4678.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 3046 (32 ms): -220.97.
Step 3083 (32 ms): -220.2.
Step 3121 (33 ms): -224.52.
Step 3158 (32 ms): -215.89.
Step 3196 (32 ms): -208.84.
Step 3234 (31 ms): -256.14.
Step 3271 (31 ms): -204.29.
Step 3309 (32 ms): -214.05.
Step 3346 (32 ms): -219.36.
Step 3384 (15 ms): -315.39.

Epoch 9 (12 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -225.84, ENRE: -220.25, KL: 5.5912.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 3422 (31 ms): -225.12.
Step 3459 (32 ms): -227.44.
Step 3497 (31 ms): -218.23.
Step 3534 (32 ms): -210.27.
Step 3572 (31 ms): -213.33.
Step 3610 (32 ms): -232.41.
Step 3647 (31 ms): -227.31.
Step 3685 (31 ms): -211.48.
Step 3722 (31 ms): -214.29.
Step 3760 (15 ms): -267.11.

Epoch 10 (11.9 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -221.77, ENRE: -216.09, KL: 5.6863.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 3798 (32 ms): -238.08.
Step 3835 (32 ms): -215.16.
Step 3873 (33 ms): -203.96.
Step 3910 (31 ms): -206.24.
Step 3948 (31 ms): -204.7.
Step 3986 (31 ms): -203.19.
Step 4023 (32 ms): -224.06.
Step 4061 (31 ms): -214.06.
Step 4098 (32 ms): -205.35.
Step 4136 (15 ms): -259.07.

Epoch 11 (11.9 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -217.96, ENRE: -212.29, KL: 5.6661.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 4174 (31 ms): -236.33.
Step 4211 (32 ms): -224.41.
Step 4249 (32 ms): -209.58.
Step 4286 (31 ms): -212.17.
Step 4324 (32 ms): -202.4.
Step 4362 (32 ms): -224.54.
Step 4399 (32 ms): -206.94.
Step 4437 (31 ms): -211.84.
Step 4474 (31 ms): -205.97.
Step 4512 (15 ms): -235.14.

Epoch 12 (11.9 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -216.13, ENRE: -210.42, KL: 5.7042.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 4550 (32 ms): -227.25.
Step 4587 (33 ms): -213.44.
Step 4625 (32 ms): -223.89.
Step 4662 (32 ms): -209.41.
Step 4700 (32 ms): -207.79.
Step 4738 (32 ms): -207.32.
Step 4775 (32 ms): -230.85.
Step 4813 (32 ms): -202.62.
Step 4850 (32 ms): -213.76.
Step 4888 (15 ms): -206.92.

Epoch 13 (12.1 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -214.33, ENRE: -208.7, KL: 5.634.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 4926 (32 ms): -214.59.
Step 4963 (32 ms): -203.19.
Step 5001 (32 ms): -202.92.
Step 5038 (32 ms): -208.27.
Step 5076 (32 ms): -204.7.
Step 5114 (32 ms): -201.24.
Step 5151 (32 ms): -234.63.
Step 5189 (33 ms): -207.7.
Step 5226 (32 ms): -200.93.
Step 5264 (15 ms): -218.62.

Epoch 14 (12.1 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -212.81, ENRE: -207, KL: 5.8099.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 5302 (32 ms): -216.11.
Step 5339 (32 ms): -221.18.
Step 5377 (32 ms): -217.51.
Step 5414 (32 ms): -216.14.
Step 5452 (32 ms): -216.7.
Step 5490 (32 ms): -221.48.
Step 5527 (32 ms): -209.37.
Step 5565 (33 ms): -203.42.
Step 5602 (33 ms): -215.33.
Step 5640 (15 ms): -300.98.

Epoch 15 (12.1 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -211.67, ENRE: -206, KL: 5.6704.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 5678 (32 ms): -198.08.
Step 5715 (31 ms): -208.06.
Step 5753 (32 ms): -211.77.
Step 5790 (31 ms): -207.27.
Step 5828 (32 ms): -212.04.
Step 5866 (32 ms): -206.68.
Step 5903 (32 ms): -204.96.
Step 5941 (31 ms): -219.09.
Step 5978 (32 ms): -211.37.
Step 6016 (15 ms): -214.15.

Epoch 16 (11.9 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -211.07, ENRE: -205.39, KL: 5.6714.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 6054 (31 ms): -210.1.
Step 6091 (32 ms): -225.93.
Step 6129 (32 ms): -213.37.
Step 6166 (31 ms): -219.45.
Step 6204 (31 ms): -214.25.
Step 6242 (32 ms): -201.
Step 6279 (32 ms): -196.52.
Step 6317 (31 ms): -220.42.
Step 6354 (32 ms): -219.28.
Step 6392 (15 ms): -215.82.

Epoch 17 (11.9 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -209.55, ENRE: -203.91, KL: 5.6436.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 6430 (32 ms): -206.6.
Step 6467 (31 ms): -192.13.
Step 6505 (32 ms): -207.2.
Step 6542 (32 ms): -199.58.
Step 6580 (32 ms): -219.17.
Step 6618 (32 ms): -198.44.
Step 6655 (31 ms): -195.36.
Step 6693 (32 ms): -201.86.
Step 6730 (31 ms): -209.39.
Step 6768 (15 ms): -302.58.

Epoch 18 (11.9 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -209.6, ENRE: -204.05, KL: 5.5494.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 6806 (31 ms): -201.44.
Step 6843 (32 ms): -195.97.
Step 6881 (32 ms): -203.83.
Step 6918 (32 ms): -206.56.
Step 6956 (32 ms): -209.5.
Step 6994 (32 ms): -206.6.
Step 7031 (31 ms): -194.01.
Step 7069 (32 ms): -204.93.
Step 7106 (32 ms): -208.35.
Step 7144 (15 ms): -245.98.

Epoch 19 (12.1 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -208.57, ENRE: -203.01, KL: 5.5508.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 7182 (32 ms): -202.29.
Step 7219 (32 ms): -208.34.
Step 7257 (33 ms): -209.42.
Step 7294 (32 ms): -203.5.
Step 7332 (32 ms): -205.59.
Step 7370 (32 ms): -194.39.
Step 7407 (33 ms): -200.57.
Step 7445 (32 ms): -212.14.
Step 7482 (32 ms): -208.67.
Step 7520 (15 ms): -216.82.

Epoch 20 (12.1 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -207.63, ENRE: -202.13, KL: 5.4989.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 7558 (32 ms): -201.29.
Step 7595 (32 ms): -221.47.
Step 7633 (32 ms): -208.49.
Step 7670 (32 ms): -206.02.
Step 7708 (32 ms): -206.91.
Step 7746 (33 ms): -200.28.
Step 7783 (32 ms): -196.52.
Step 7821 (31 ms): -197.63.
Step 7858 (32 ms): -216.8.
Step 7896 (15 ms): -207.97.

Epoch 21 (12 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -207.15, ENRE: -201.6, KL: 5.544.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 7934 (32 ms): -227.16.
Step 7971 (32 ms): -192.99.
Step 8009 (32 ms): -197.94.
Step 8046 (32 ms): -217.09.
Step 8084 (32 ms): -196.58.
Step 8122 (32 ms): -203.04.
Step 8159 (32 ms): -222.17.
Step 8197 (33 ms): -195.57.
Step 8234 (32 ms): -200.5.
Step 8272 (15 ms): -213.37.

Epoch 22 (12 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -206.71, ENRE: -201.29, KL: 5.4161.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 8310 (32 ms): -207.66.
Step 8347 (32 ms): -195.8.
Step 8385 (31 ms): -195.54.
Step 8422 (31 ms): -199.61.
Step 8460 (31 ms): -207.52.
Step 8498 (31 ms): -212.83.
Step 8535 (32 ms): -221.73.
Step 8573 (31 ms): -215.54.
Step 8610 (31 ms): -195.36.
Step 8648 (15 ms): -256.35.

Epoch 23 (11.8 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -206.33, ENRE: -200.75, KL: 5.5791.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 8686 (32 ms): -195.27.
Step 8723 (32 ms): -193.12.
Step 8761 (32 ms): -202.31.
Step 8798 (31 ms): -199.85.
Step 8836 (32 ms): -203.22.
Step 8874 (33 ms): -198.2.
Step 8911 (32 ms): -203.84.
Step 8949 (32 ms): -196.6.
Step 8986 (32 ms): -192.4.
Step 9024 (15 ms): -207.23.

Epoch 24 (12 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -205.68, ENRE: -200.19, KL: 5.4837.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 9062 (32 ms): -201.29.
Step 9099 (32 ms): -200.07.
Step 9137 (32 ms): -205.12.
Step 9174 (32 ms): -207.65.
Step 9212 (32 ms): -212.94.
Step 9250 (32 ms): -214.74.
Step 9287 (31 ms): -209.68.
Step 9325 (32 ms): -203.3.
Step 9362 (33 ms): -216.03.
Step 9400 (15 ms): -213.94.

Epoch 25 (12 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -204.87, ENRE: -199.35, KL: 5.5223.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 9438 (32 ms): -200.5.
Step 9475 (32 ms): -201.77.
Step 9513 (32 ms): -194.87.
Step 9550 (32 ms): -205.09.
Step 9588 (32 ms): -199.99.
Step 9626 (32 ms): -202.86.
Step 9663 (32 ms): -199.34.
Step 9701 (32 ms): -220.37.
Step 9738 (34 ms): -194.86.
Step 9776 (15 ms): -261.45.

Epoch 26 (12.1 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -204.52, ENRE: -198.9, KL: 5.6216.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 9814 (32 ms): -212.56.
Step 9851 (34 ms): -198.28.
Step 9889 (32 ms): -205.73.
Step 9926 (32 ms): -202.97.
Step 9964 (32 ms): -214.84.
Step 10002 (32 ms): -209.02.
Step 10039 (33 ms): -201.75.
Step 10077 (31 ms): -201.25.
Step 10114 (31 ms): -204.97.
Step 10152 (15 ms): -305.85.

Epoch 27 (12.1 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -204.37, ENRE: -198.78, KL: 5.5859.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 10190 (32 ms): -198.64.
Step 10227 (32 ms): -214.09.
Step 10265 (32 ms): -198.15.
Step 10302 (32 ms): -212.12.
Step 10340 (32 ms): -208.69.
Step 10378 (32 ms): -204.77.
Step 10415 (31 ms): -196.07.
Step 10453 (31 ms): -200.35.
Step 10490 (32 ms): -206.52.
Step 10528 (15 ms): -277.31.

Epoch 28 (12 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -204.4, ENRE: -198.69, KL: 5.7123.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 10566 (32 ms): -215.68.
Step 10603 (33 ms): -201.14.
Step 10641 (34 ms): -199.71.
Step 10678 (32 ms): -190.88.
Step 10716 (32 ms): -204.48.
Step 10754 (32 ms): -202.82.
Step 10791 (31 ms): -201.42.
Step 10829 (31 ms): -220.86.
Step 10866 (32 ms): -199.65.
Step 10904 (15 ms): -266.49.

Epoch 29 (12 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -203.74, ENRE: -198.21, KL: 5.5308.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 10942 (32 ms): -194.91.
Step 10979 (31 ms): -197.25.
Step 11017 (31 ms): -193.65.
Step 11054 (31 ms): -207.43.
Step 11092 (31 ms): -198.29.
Step 11130 (32 ms): -208.79.
Step 11167 (32 ms): -195.81.
Step 11205 (32 ms): -207.24.
Step 11242 (31 ms): -192.95.
Step 11280 (15 ms): -255.91.

Epoch 30 (11.9 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -203.44, ENRE: -197.71, KL: 5.73.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 11318 (32 ms): -193.53.
Step 11355 (34 ms): -201.24.
Step 11393 (32 ms): -200.98.
Step 11430 (32 ms): -202.71.
Step 11468 (32 ms): -190.89.
Step 11506 (32 ms): -200.95.
Step 11543 (32 ms): -219.76.
Step 11581 (32 ms): -207.76.
Step 11618 (32 ms): -208.54.
Step 11656 (15 ms): -275.59.

Epoch 31 (12 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -203.02, ENRE: -197.33, KL: 5.6881.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 11694 (32 ms): -205.3.
Step 11731 (32 ms): -197.53.
Step 11769 (31 ms): -209.58.
Step 11806 (32 ms): -189.52.
Step 11844 (32 ms): -194.24.
Step 11882 (32 ms): -204.03.
Step 11919 (32 ms): -210.79.
Step 11957 (32 ms): -187.65.
Step 11994 (32 ms): -203.55.
Step 12032 (15 ms): -210.96.

Epoch 32 (12.1 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -202.83, ENRE: -197.16, KL: 5.6752.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 12070 (32 ms): -205.76.
Step 12107 (32 ms): -205.28.
Step 12145 (32 ms): -189.36.
Step 12182 (31 ms): -208.74.
Step 12220 (33 ms): -192.75.
Step 12258 (32 ms): -196.36.
Step 12295 (32 ms): -198.81.
Step 12333 (32 ms): -194.55.
Step 12370 (32 ms): -203.22.
Step 12408 (15 ms): -225.82.

Epoch 33 (12.1 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -202.73, ENRE: -197.14, KL: 5.5911.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 12446 (31 ms): -193.79.
Step 12483 (31 ms): -204.82.
Step 12521 (31 ms): -208.89.
Step 12558 (31 ms): -199.87.
Step 12596 (31 ms): -205.04.
Step 12634 (32 ms): -211.92.
Step 12671 (31 ms): -201.66.
Step 12709 (32 ms): -224.58.
Step 12746 (32 ms): -209.43.
Step 12784 (15 ms): -214.83.

Epoch 34 (11.9 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -202.47, ENRE: -196.8, KL: 5.6688.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 12822 (31 ms): -216.85.
Step 12859 (32 ms): -198.21.
Step 12897 (32 ms): -206.16.
Step 12934 (31 ms): -206.41.
Step 12972 (33 ms): -199.71.
Step 13010 (32 ms): -186.54.
Step 13047 (32 ms): -207.48.
Step 13085 (32 ms): -205.37.
Step 13122 (31 ms): -192.66.
Step 13160 (16 ms): -222.87.

Epoch 35 (11.9 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -202.18, ENRE: -196.46, KL: 5.7229.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 13198 (32 ms): -206.86.
Step 13235 (32 ms): -206.56.
Step 13273 (32 ms): -200.54.
Step 13310 (31 ms): -197.29.
Step 13348 (32 ms): -206.8.
Step 13386 (32 ms): -199.26.
Step 13423 (31 ms): -205.74.
Step 13461 (32 ms): -208.05.
Step 13498 (32 ms): -214.88.
Step 13536 (15 ms): -252.83.

Epoch 36 (11.9 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -202.14, ENRE: -196.39, KL: 5.7521.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 13574 (31 ms): -214.04.
Step 13611 (31 ms): -205.74.
Step 13649 (32 ms): -206.65.
Step 13686 (34 ms): -204.15.
Step 13724 (32 ms): -200.69.
Step 13762 (32 ms): -209.71.
Step 13799 (32 ms): -205.26.
Step 13837 (32 ms): -206.43.
Step 13874 (31 ms): -199.85.
Step 13912 (15 ms): -208.99.

Epoch 37 (12 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -201.86, ENRE: -196.1, KL: 5.7586.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 13950 (32 ms): -204.75.
Step 13987 (32 ms): -193.88.
Step 14025 (32 ms): -205.63.
Step 14062 (31 ms): -196.26.
Step 14100 (32 ms): -188.38.
Step 14138 (32 ms): -210.61.
Step 14175 (33 ms): -201.72.
Step 14213 (32 ms): -191.83.
Step 14250 (32 ms): -189.7.
Step 14288 (15 ms): -224.7.

Epoch 38 (12.1 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -201.69, ENRE: -196.04, KL: 5.6494.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 14326 (32 ms): -205.95.
Step 14363 (32 ms): -205.1.
Step 14401 (33 ms): -194.37.
Step 14438 (32 ms): -195.75.
Step 14476 (32 ms): -194.51.
Step 14514 (31 ms): -203.04.
Step 14551 (32 ms): -216.77.
Step 14589 (32 ms): -191.76.
Step 14626 (32 ms): -206.49.
Step 14664 (15 ms): -206.77.

Epoch 39 (12.1 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -201.66, ENRE: -195.84, KL: 5.8197.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 14702 (33 ms): -195.67.
Step 14739 (33 ms): -197.55.
Step 14777 (32 ms): -200.24.
Step 14814 (32 ms): -202.47.
Step 14852 (33 ms): -212.06.
Step 14890 (33 ms): -196.9.
Step 14927 (32 ms): -200.14.
Step 14965 (32 ms): -207.8.
Step 15002 (32 ms): -206.1.
Step 15040 (15 ms): -211.76.

Epoch 40 (12.1 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -201.45, ENRE: -195.55, KL: 5.9.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 15078 (31 ms): -188.18.
Step 15115 (33 ms): -203.78.
Step 15153 (32 ms): -201.31.
Step 15190 (32 ms): -207.17.
Step 15228 (32 ms): -186.78.
Step 15266 (32 ms): -199.44.
Step 15303 (32 ms): -207.94.
Step 15341 (32 ms): -207.34.
Step 15378 (32 ms): -199.54.
Step 15416 (15 ms): -298.25.

Epoch 41 (11.9 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -201.38, ENRE: -195.72, KL: 5.6538.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 15454 (31 ms): -191.06.
Step 15491 (31 ms): -197.9.
Step 15529 (32 ms): -194.05.
Step 15566 (31 ms): -202.01.
Step 15604 (31 ms): -203.81.
Step 15642 (32 ms): -203.75.
Step 15679 (32 ms): -206.37.
Step 15717 (32 ms): -196.42.
Step 15754 (32 ms): -212.51.
Step 15792 (15 ms): -217.6.

Epoch 42 (11.9 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -201.09, ENRE: -195.37, KL: 5.7153.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 15830 (31 ms): -201.3.
Step 15867 (32 ms): -199.58.
Step 15905 (32 ms): -208.64.
Step 15942 (32 ms): -197.29.
Step 15980 (31 ms): -198.3.
Step 16018 (31 ms): -198.78.
Step 16055 (33 ms): -190.31.
Step 16093 (32 ms): -201.03.
Step 16130 (32 ms): -214.12.
Step 16168 (15 ms): -548.

Epoch 43 (11.9 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -201.38, ENRE: -195.68, KL: 5.6943.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 16206 (32 ms): -192.75.
Step 16243 (33 ms): -210.92.
Step 16281 (32 ms): -195.12.
Step 16318 (31 ms): -186.13.
Step 16356 (32 ms): -208.52.
Step 16394 (32 ms): -193.23.
Step 16431 (32 ms): -208.74.
Step 16469 (32 ms): -195.46.
Step 16506 (33 ms): -195.59.
Step 16544 (15 ms): -310.68.

Epoch 44 (12.1 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -201.03, ENRE: -195.25, KL: 5.7808.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 16582 (32 ms): -210.41.
Step 16619 (33 ms): -191.84.
Step 16657 (32 ms): -203.39.
Step 16694 (32 ms): -202.05.
Step 16732 (33 ms): -195.08.
Step 16770 (32 ms): -203.1.
Step 16807 (32 ms): -207.37.
Step 16845 (32 ms): -216.58.
Step 16882 (32 ms): -194.15.
Step 16920 (16 ms): -234.81.

Epoch 45 (12.1 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -200.9, ENRE: -195.02, KL: 5.8774.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 16958 (33 ms): -196.07.
Step 16995 (31 ms): -193.16.
Step 17033 (33 ms): -213.05.
Step 17070 (32 ms): -203.7.
Step 17108 (32 ms): -202.62.
Step 17146 (32 ms): -191.25.
Step 17183 (32 ms): -190.37.
Step 17221 (32 ms): -199.79.
Step 17258 (31 ms): -191.7.
Step 17296 (15 ms): -217.47.

Epoch 46 (12 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -200.91, ENRE: -194.97, KL: 5.937.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 17334 (32 ms): -215.06.
Step 17371 (33 ms): -201.52.
Step 17409 (32 ms): -202.93.
Step 17446 (32 ms): -201.53.
Step 17484 (32 ms): -196.57.
Step 17522 (32 ms): -194.47.
Step 17559 (31 ms): -204.32.
Step 17597 (32 ms): -207.58.
Step 17634 (31 ms): -200.84.
Step 17672 (15 ms): -221.39.

Epoch 47 (12 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -200.82, ENRE: -195.07, KL: 5.7474.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 17710 (31 ms): -197.55.
Step 17747 (33 ms): -208.26.
Step 17785 (31 ms): -217.78.
Step 17822 (31 ms): -200.91.
Step 17860 (32 ms): -197.65.
Step 17898 (32 ms): -203.49.
Step 17935 (32 ms): -202.57.
Step 17973 (31 ms): -204.55.
Step 18010 (32 ms): -191.94.
Step 18048 (15 ms): -214.59.

Epoch 48 (11.9 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -200.76, ENRE: -194.98, KL: 5.7822.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 18086 (31 ms): -190.97.
Step 18123 (32 ms): -185.15.
Step 18161 (34 ms): -188.8.
Step 18198 (32 ms): -187.91.
Step 18236 (31 ms): -200.39.
Step 18274 (31 ms): -199.44.
Step 18311 (32 ms): -201.81.
Step 18349 (33 ms): -201.16.
Step 18386 (32 ms): -194.43.
Step 18424 (15 ms): -267.69.

Epoch 49 (11.9 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -200.61, ENRE: -194.79, KL: 5.8228.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 18462 (32 ms): -189.73.
Step 18499 (32 ms): -196.75.
Step 18537 (32 ms): -190.62.
Step 18574 (32 ms): -210.55.
Step 18612 (31 ms): -194.17.
Step 18650 (32 ms): -200.42.
Step 18687 (32 ms): -219.17.
Step 18725 (32 ms): -202.81.
Step 18762 (31 ms): -202.97.
Step 18800 (16 ms): -190.86.

Epoch 50 (12 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -200.7, ENRE: -194.97, KL: 5.7351.
    Saving model parameters.
    Model parameters saved (108 ms).

Model trained for 50 epochs (15m 2s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (899 ms).

Converting data set value array to sparse matrix.
Data set value array converted (311 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.83 s):  ELBO: -420.66, ENRE: -414.92, KL: 5.7363.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (674 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.3458652321824185
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 40
kl weight: 1.3458652321824185
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (44 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.69 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 40
    hidden sizes: 151, 277, 56, 297
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.3458652321824185
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 1 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 151)
    ENCODER/1/DENSE/biases:0             (151,)
    ENCODER/1/BATCH_NORM/beta:0          (151,)
    ENCODER/2/DENSE/weights:0            (151, 277)
    ENCODER/2/DENSE/biases:0             (277,)
    ENCODER/2/BATCH_NORM/beta:0          (277,)
    ENCODER/3/DENSE/weights:0            (277, 56)
    ENCODER/3/DENSE/biases:0             (56,)
    ENCODER/3/BATCH_NORM/beta:0          (56,)
    ENCODER/4/DENSE/weights:0            (56, 297)
    ENCODER/4/DENSE/biases:0             (297,)
    ENCODER/4/BATCH_NORM/beta:0          (297,)
    POSTERIOR/MU/DENSE/weights:0         (297, 40)
    POSTERIOR/MU/DENSE/biases:0          (40,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (297, 40)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (40,)
    DECODER/4/DENSE/weights:0            (40, 297)
    DECODER/4/DENSE/biases:0             (297,)
    DECODER/4/BATCH_NORM/beta:0          (297,)
    DECODER/3/DENSE/weights:0            (297, 56)
    DECODER/3/DENSE/biases:0             (56,)
    DECODER/3/BATCH_NORM/beta:0          (56,)
    DECODER/2/DENSE/weights:0            (56, 277)
    DECODER/2/DENSE/biases:0             (277,)
    DECODER/2/BATCH_NORM/beta:0          (277,)
    DECODER/1/DENSE/weights:0            (277, 151)
    DECODER/1/DENSE/biases:0             (151,)
    DECODER/1/BATCH_NORM/beta:0          (151,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (151, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (462 ms).

Training model for 50 epochs on original values.

Step 38 (33 ms): -2183.9.
Step 75 (34 ms): -1901.3.
Step 113 (33 ms): -1577.5.
Step 150 (33 ms): -1359.1.
Step 188 (33 ms): -1221.9.
Step 226 (35 ms): -1056.1.
Step 263 (33 ms): -914.82.
Step 301 (33 ms): -819.7.
Step 338 (33 ms): -740.7.
Step 376 (18 ms): -675.97.

Epoch 1 (14.9 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.36 s): ELBO: -1693.4, ENRE: -1671.3, KL: 22.105.
    Saving model parameters.
    Model parameters saved (180 ms).

Step 414 (32 ms): -541.73.
Step 451 (32 ms): -500.7.
Step 489 (32 ms): -486.04.
Step 526 (33 ms): -443.87.
Step 564 (31 ms): -393.95.
Step 602 (31 ms): -371.61.
Step 639 (32 ms): -356.92.
Step 677 (32 ms): -383.1.
Step 714 (34 ms): -340.69.
Step 752 (18 ms): -378.99.

Epoch 2 (12 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -871.43, ENRE: -864.79, KL: 6.6315.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 790 (32 ms): -332.09.
Step 827 (33 ms): -318.98.
Step 865 (33 ms): -309.02.
Step 902 (32 ms): -331.89.
Step 940 (32 ms): -305.18.
Step 978 (32 ms): -320.65.
Step 1015 (32 ms): -310.27.
Step 1053 (32 ms): -288.98.
Step 1090 (31 ms): -268.7.
Step 1128 (15 ms): -292.74.

Epoch 3 (12.1 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -519.11, ENRE: -514.2, KL: 4.9093.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 1166 (31 ms): -279.29.
Step 1203 (32 ms): -293.84.
Step 1241 (31 ms): -276.02.
Step 1278 (32 ms): -270.65.
Step 1316 (32 ms): -263.77.
Step 1354 (32 ms): -255.55.
Step 1391 (31 ms): -256.13.
Step 1429 (31 ms): -252.96.
Step 1466 (33 ms): -255.83.
Step 1504 (15 ms): -269.53.

Epoch 4 (11.8 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -383.25, ENRE: -378.72, KL: 4.5319.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 1542 (32 ms): -255.22.
Step 1579 (32 ms): -245.97.
Step 1617 (32 ms): -258.24.
Step 1654 (32 ms): -257.76.
Step 1692 (32 ms): -271.
Step 1730 (32 ms): -258.25.
Step 1767 (33 ms): -236.83.
Step 1805 (33 ms): -241.82.
Step 1842 (31 ms): -241.86.
Step 1880 (15 ms): -603.61.

Epoch 5 (12.1 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -316.3, ENRE: -311.72, KL: 4.5761.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 1918 (32 ms): -225.25.
Step 1955 (32 ms): -240.44.
Step 1993 (31 ms): -234.91.
Step 2030 (32 ms): -239.04.
Step 2068 (32 ms): -229.29.
Step 2106 (32 ms): -232.16.
Step 2143 (32 ms): -232.45.
Step 2181 (32 ms): -233.14.
Step 2218 (32 ms): -221.66.
Step 2256 (15 ms): -245.51.

Epoch 6 (12 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -281.85, ENRE: -277.13, KL: 4.7257.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 2294 (32 ms): -257.4.
Step 2331 (32 ms): -232.47.
Step 2369 (33 ms): -234.91.
Step 2406 (32 ms): -216.48.
Step 2444 (31 ms): -231.6.
Step 2482 (32 ms): -234.86.
Step 2519 (32 ms): -244.19.
Step 2557 (31 ms): -224.49.
Step 2594 (31 ms): -221.79.
Step 2632 (15 ms): -299.53.

Epoch 7 (12 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -257.98, ENRE: -253.03, KL: 4.9583.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 2670 (33 ms): -211.58.
Step 2707 (32 ms): -229.46.
Step 2745 (32 ms): -230.24.
Step 2782 (32 ms): -235.27.
Step 2820 (33 ms): -229.77.
Step 2858 (32 ms): -232.
Step 2895 (32 ms): -227.43.
Step 2933 (32 ms): -234.42.
Step 2970 (32 ms): -222.08.
Step 3008 (15 ms): -251.52.

Epoch 8 (11.9 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -242.97, ENRE: -237.77, KL: 5.2084.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 3046 (32 ms): -213.42.
Step 3083 (32 ms): -222.81.
Step 3121 (32 ms): -226.78.
Step 3158 (31 ms): -219.98.
Step 3196 (32 ms): -221.73.
Step 3234 (31 ms): -215.83.
Step 3271 (31 ms): -209.74.
Step 3309 (31 ms): -233.07.
Step 3346 (32 ms): -222.23.
Step 3384 (15 ms): -203.97.

Epoch 9 (11.9 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -238.88, ENRE: -233.64, KL: 5.2325.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 3422 (33 ms): -216.7.
Step 3459 (31 ms): -221.33.
Step 3497 (31 ms): -205.29.
Step 3534 (31 ms): -219.91.
Step 3572 (31 ms): -225.9.
Step 3610 (31 ms): -222.13.
Step 3647 (31 ms): -211.41.
Step 3685 (31 ms): -224.07.
Step 3722 (31 ms): -208.63.
Step 3760 (15 ms): -202.89.

Epoch 10 (11.8 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -230.62, ENRE: -225.08, KL: 5.541.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 3798 (31 ms): -215.35.
Step 3835 (31 ms): -243.5.
Step 3873 (32 ms): -242.87.
Step 3910 (31 ms): -211.87.
Step 3948 (31 ms): -218.39.
Step 3986 (32 ms): -226.25.
Step 4023 (32 ms): -214.99.
Step 4061 (33 ms): -212.55.
Step 4098 (32 ms): -230.09.
Step 4136 (15 ms): -215.45.

Epoch 11 (11.9 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -225.26, ENRE: -219.82, KL: 5.4422.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 4174 (32 ms): -215.87.
Step 4211 (33 ms): -215.82.
Step 4249 (32 ms): -211.7.
Step 4286 (32 ms): -215.81.
Step 4324 (32 ms): -248.
Step 4362 (32 ms): -215.98.
Step 4399 (32 ms): -210.85.
Step 4437 (32 ms): -217.
Step 4474 (32 ms): -213.74.
Step 4512 (15 ms): -246.78.

Epoch 12 (12.1 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -221.23, ENRE: -215.72, KL: 5.5125.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 4550 (32 ms): -207.92.
Step 4587 (32 ms): -211.66.
Step 4625 (32 ms): -219.77.
Step 4662 (32 ms): -213.99.
Step 4700 (32 ms): -219.06.
Step 4738 (32 ms): -242.36.
Step 4775 (32 ms): -207.34.
Step 4813 (34 ms): -213.89.
Step 4850 (31 ms): -218.73.
Step 4888 (15 ms): -203.89.

Epoch 13 (12 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -218.66, ENRE: -213.31, KL: 5.3567.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 4926 (31 ms): -199.05.
Step 4963 (32 ms): -222.17.
Step 5001 (32 ms): -204.98.
Step 5038 (33 ms): -215.65.
Step 5076 (31 ms): -212.48.
Step 5114 (32 ms): -219.06.
Step 5151 (32 ms): -201.
Step 5189 (32 ms): -225.23.
Step 5226 (33 ms): -208.83.
Step 5264 (15 ms): -207.38.

Epoch 14 (11.9 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -215.82, ENRE: -210.37, KL: 5.4493.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 5302 (32 ms): -205.51.
Step 5339 (31 ms): -202.37.
Step 5377 (32 ms): -215.03.
Step 5414 (32 ms): -219.1.
Step 5452 (31 ms): -196.54.
Step 5490 (31 ms): -210.55.
Step 5527 (33 ms): -201.04.
Step 5565 (31 ms): -202.31.
Step 5602 (31 ms): -205.06.
Step 5640 (15 ms): -640.14.

Epoch 15 (11.9 s):
    Evaluating model.
    Full set (5.76 s): ELBO: -213.75, ENRE: -208.17, KL: 5.5804.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 5678 (31 ms): -222.03.
Step 5715 (31 ms): -200.22.
Step 5753 (32 ms): -234.36.
Step 5790 (32 ms): -194.41.
Step 5828 (31 ms): -213.62.
Step 5866 (31 ms): -208.64.
Step 5903 (31 ms): -212.96.
Step 5941 (31 ms): -201.21.
Step 5978 (31 ms): -203.23.
Step 6016 (14 ms): -226.69.

Epoch 16 (11.8 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -214.64, ENRE: -209.21, KL: 5.4363.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 6054 (32 ms): -248.16.
Step 6091 (32 ms): -213.45.
Step 6129 (31 ms): -199.46.
Step 6166 (32 ms): -208.5.
Step 6204 (31 ms): -205.7.
Step 6242 (31 ms): -213.65.
Step 6279 (32 ms): -208.15.
Step 6317 (32 ms): -211.42.
Step 6354 (32 ms): -222.93.
Step 6392 (15 ms): -262.49.

Epoch 17 (11.9 s):
    Evaluating model.
    Full set (5.76 s): ELBO: -211.4, ENRE: -206.01, KL: 5.3942.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 6430 (32 ms): -216.93.
Step 6467 (31 ms): -208.56.
Step 6505 (31 ms): -219.77.
Step 6542 (32 ms): -194.08.
Step 6580 (32 ms): -233.35.
Step 6618 (31 ms): -203.11.
Step 6655 (32 ms): -208.9.
Step 6693 (31 ms): -212.14.
Step 6730 (32 ms): -210.33.
Step 6768 (15 ms): -338.28.

Epoch 18 (12 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -210.99, ENRE: -205.5, KL: 5.4912.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 6806 (31 ms): -210.98.
Step 6843 (32 ms): -222.48.
Step 6881 (33 ms): -212.75.
Step 6918 (32 ms): -208.82.
Step 6956 (33 ms): -208.22.
Step 6994 (32 ms): -199.2.
Step 7031 (33 ms): -217.9.
Step 7069 (32 ms): -206.19.
Step 7106 (32 ms): -201.88.
Step 7144 (15 ms): -286.99.

Epoch 19 (12.1 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -209.46, ENRE: -203.97, KL: 5.4836.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 7182 (32 ms): -206.26.
Step 7219 (32 ms): -227.87.
Step 7257 (31 ms): -210.15.
Step 7294 (32 ms): -209.96.
Step 7332 (32 ms): -217.41.
Step 7370 (32 ms): -193.04.
Step 7407 (31 ms): -204.73.
Step 7445 (32 ms): -205.78.
Step 7482 (32 ms): -215.32.
Step 7520 (15 ms): -285.52.

Epoch 20 (12 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -209.1, ENRE: -203.59, KL: 5.5025.
    Saving model parameters.
    Model parameters saved (345 ms).

Step 7558 (31 ms): -196.16.
Step 7595 (31 ms): -204.55.
Step 7633 (32 ms): -220.02.
Step 7670 (31 ms): -214.82.
Step 7708 (32 ms): -215.72.
Step 7746 (32 ms): -211.42.
Step 7783 (32 ms): -208.53.
Step 7821 (32 ms): -203.7.
Step 7858 (31 ms): -205.16.
Step 7896 (15 ms): -234.35.

Epoch 21 (12 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -207.58, ENRE: -202.08, KL: 5.5008.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 7934 (32 ms): -202.93.
Step 7971 (31 ms): -215.87.
Step 8009 (31 ms): -210.8.
Step 8046 (31 ms): -203.62.
Step 8084 (31 ms): -210.4.
Step 8122 (31 ms): -210.96.
Step 8159 (33 ms): -196.5.
Step 8197 (31 ms): -209.88.
Step 8234 (31 ms): -203.53.
Step 8272 (14 ms): -208.49.

Epoch 22 (11.8 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -207.25, ENRE: -201.88, KL: 5.3718.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 8310 (32 ms): -196.73.
Step 8347 (32 ms): -195.62.
Step 8385 (32 ms): -207.46.
Step 8422 (33 ms): -214.2.
Step 8460 (31 ms): -198.01.
Step 8498 (31 ms): -207.42.
Step 8535 (32 ms): -226.4.
Step 8573 (32 ms): -210.31.
Step 8610 (31 ms): -198.29.
Step 8648 (15 ms): -345.06.

Epoch 23 (11.9 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -206.58, ENRE: -201.19, KL: 5.3924.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 8686 (32 ms): -197.02.
Step 8723 (32 ms): -207.34.
Step 8761 (32 ms): -217.15.
Step 8798 (32 ms): -204.03.
Step 8836 (33 ms): -220.17.
Step 8874 (33 ms): -207.91.
Step 8911 (32 ms): -224.05.
Step 8949 (32 ms): -196.31.
Step 8986 (32 ms): -199.14.
Step 9024 (15 ms): -211.88.

Epoch 24 (12 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -206.36, ENRE: -201.01, KL: 5.3536.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 9062 (32 ms): -197.81.
Step 9099 (32 ms): -210.83.
Step 9137 (32 ms): -218.45.
Step 9174 (32 ms): -204.16.
Step 9212 (32 ms): -200.23.
Step 9250 (32 ms): -213.29.
Step 9287 (32 ms): -209.82.
Step 9325 (33 ms): -202.2.
Step 9362 (32 ms): -205.05.
Step 9400 (15 ms): -236.95.

Epoch 25 (12.1 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -206.04, ENRE: -200.64, KL: 5.4047.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 9438 (32 ms): -203.22.
Step 9475 (32 ms): -196.98.
Step 9513 (32 ms): -198.4.
Step 9550 (32 ms): -196.07.
Step 9588 (32 ms): -200.16.
Step 9626 (32 ms): -217.29.
Step 9663 (32 ms): -196.07.
Step 9701 (32 ms): -199.95.
Step 9738 (32 ms): -200.35.
Step 9776 (15 ms): -230.15.

Epoch 26 (12 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -205.78, ENRE: -200.35, KL: 5.4265.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 9814 (32 ms): -213.69.
Step 9851 (33 ms): -194.6.
Step 9889 (31 ms): -217.18.
Step 9926 (32 ms): -205.72.
Step 9964 (32 ms): -206.12.
Step 10002 (31 ms): -216.45.
Step 10039 (32 ms): -202.03.
Step 10077 (31 ms): -196.84.
Step 10114 (31 ms): -198.28.
Step 10152 (15 ms): -219.6.

Epoch 27 (11.9 s):
    Evaluating model.
    Full set (5.74 s): ELBO: -205.44, ENRE: -200.04, KL: 5.403.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 10190 (31 ms): -228.33.
Step 10227 (32 ms): -200.93.
Step 10265 (31 ms): -200.61.
Step 10302 (32 ms): -206.63.
Step 10340 (32 ms): -211.24.
Step 10378 (31 ms): -200.89.
Step 10415 (31 ms): -203.53.
Step 10453 (32 ms): -194.74.
Step 10490 (32 ms): -218.97.
Step 10528 (15 ms): -175.28.

Epoch 28 (11.9 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -204.75, ENRE: -199.47, KL: 5.2825.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 10566 (31 ms): -201.89.
Step 10603 (32 ms): -208.08.
Step 10641 (32 ms): -187.06.
Step 10678 (33 ms): -212.68.
Step 10716 (31 ms): -200.43.
Step 10754 (32 ms): -201.38.
Step 10791 (32 ms): -214.14.
Step 10829 (32 ms): -202.3.
Step 10866 (32 ms): -207.75.
Step 10904 (15 ms): -238.7.

Epoch 29 (11.9 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -205.51, ENRE: -200.17, KL: 5.3334.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 10942 (32 ms): -205.48.
Step 10979 (32 ms): -218.35.
Step 11017 (33 ms): -199.59.
Step 11054 (32 ms): -199.21.
Step 11092 (32 ms): -200.4.
Step 11130 (32 ms): -209.96.
Step 11167 (32 ms): -207.19.
Step 11205 (33 ms): -201.02.
Step 11242 (31 ms): -204.36.
Step 11280 (15 ms): -232.37.

Epoch 30 (12 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -205.04, ENRE: -199.77, KL: 5.2683.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 11318 (32 ms): -206.37.
Step 11355 (32 ms): -196.24.
Step 11393 (32 ms): -199.49.
Step 11430 (31 ms): -197.3.
Step 11468 (31 ms): -205.77.
Step 11506 (32 ms): -193.97.
Step 11543 (31 ms): -210.41.
Step 11581 (32 ms): -202.26.
Step 11618 (32 ms): -206.15.
Step 11656 (15 ms): -207.3.

Epoch 31 (12 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -204.88, ENRE: -199.55, KL: 5.3336.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 11694 (32 ms): -198.75.
Step 11731 (33 ms): -197.42.
Step 11769 (32 ms): -193.96.
Step 11806 (31 ms): -197.81.
Step 11844 (31 ms): -202.92.
Step 11882 (32 ms): -193.64.
Step 11919 (32 ms): -215.6.
Step 11957 (32 ms): -200.71.
Step 11994 (31 ms): -198.59.
Step 12032 (15 ms): -177.23.

Epoch 32 (11.9 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -204.12, ENRE: -198.75, KL: 5.3695.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 12070 (31 ms): -202.2.
Step 12107 (32 ms): -208.06.
Step 12145 (32 ms): -203.93.
Step 12182 (32 ms): -208.84.
Step 12220 (32 ms): -197.73.
Step 12258 (32 ms): -212.63.
Step 12295 (31 ms): -207.51.
Step 12333 (32 ms): -202.23.
Step 12370 (31 ms): -205.58.
Step 12408 (15 ms): -197.49.

Epoch 33 (12 s):
    Evaluating model.
    Full set (5.74 s): ELBO: -203.54, ENRE: -198.13, KL: 5.4084.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 12446 (31 ms): -201.38.
Step 12483 (31 ms): -199.82.
Step 12521 (31 ms): -209.14.
Step 12558 (31 ms): -203.15.
Step 12596 (31 ms): -206.73.
Step 12634 (32 ms): -195.42.
Step 12671 (31 ms): -204.17.
Step 12709 (31 ms): -208.89.
Step 12746 (31 ms): -193.83.
Step 12784 (14 ms): -234.75.

Epoch 34 (11.8 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -203.33, ENRE: -198.08, KL: 5.2525.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 12822 (32 ms): -196.64.
Step 12859 (32 ms): -205.9.
Step 12897 (31 ms): -211.59.
Step 12934 (31 ms): -204.29.
Step 12972 (31 ms): -204.65.
Step 13010 (32 ms): -203.86.
Step 13047 (32 ms): -197.86.
Step 13085 (32 ms): -206.42.
Step 13122 (31 ms): -206.04.
Step 13160 (15 ms): -264.41.

Epoch 35 (11.9 s):
    Evaluating model.
    Full set (5.74 s): ELBO: -202.93, ENRE: -197.57, KL: 5.3598.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 13198 (32 ms): -211.57.
Step 13235 (31 ms): -200.47.
Step 13273 (31 ms): -212.08.
Step 13310 (32 ms): -199.26.
Step 13348 (31 ms): -195.96.
Step 13386 (31 ms): -204.81.
Step 13423 (32 ms): -205.45.
Step 13461 (32 ms): -210.52.
Step 13498 (31 ms): -203.23.
Step 13536 (15 ms): -286.9.

Epoch 36 (11.9 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -202.64, ENRE: -197.38, KL: 5.2643.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 13574 (32 ms): -210.74.
Step 13611 (32 ms): -205.53.
Step 13649 (32 ms): -205.56.
Step 13686 (32 ms): -202.84.
Step 13724 (32 ms): -191.46.
Step 13762 (32 ms): -202.25.
Step 13799 (32 ms): -203.29.
Step 13837 (32 ms): -206.43.
Step 13874 (32 ms): -221.02.
Step 13912 (15 ms): -250.52.

Epoch 37 (12 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -202.82, ENRE: -197.56, KL: 5.2568.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 13950 (32 ms): -208.16.
Step 13987 (32 ms): -193.77.
Step 14025 (32 ms): -209.54.
Step 14062 (32 ms): -190.59.
Step 14100 (32 ms): -195.97.
Step 14138 (32 ms): -198.66.
Step 14175 (31 ms): -201.51.
Step 14213 (32 ms): -205.5.
Step 14250 (32 ms): -200.
Step 14288 (15 ms): -208.77.

Epoch 38 (12 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -202.58, ENRE: -197.23, KL: 5.3552.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 14326 (32 ms): -203.54.
Step 14363 (32 ms): -197.25.
Step 14401 (33 ms): -197.33.
Step 14438 (32 ms): -218.42.
Step 14476 (32 ms): -196.5.
Step 14514 (32 ms): -204.75.
Step 14551 (31 ms): -192.45.
Step 14589 (32 ms): -201.48.
Step 14626 (32 ms): -200.3.
Step 14664 (15 ms): -233.13.

Epoch 39 (12 s):
    Evaluating model.
    Full set (5.76 s): ELBO: -202.62, ENRE: -197.31, KL: 5.3081.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 14702 (32 ms): -194.78.
Step 14739 (32 ms): -202.44.
Step 14777 (32 ms): -205.63.
Step 14814 (32 ms): -210.95.
Step 14852 (31 ms): -215.13.
Step 14890 (32 ms): -191.81.
Step 14927 (32 ms): -203.93.
Step 14965 (31 ms): -200.53.
Step 15002 (31 ms): -209.62.
Step 15040 (15 ms): -268.99.

Epoch 40 (11.9 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -202.25, ENRE: -196.89, KL: 5.3627.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 15078 (32 ms): -187.3.
Step 15115 (32 ms): -200.3.
Step 15153 (32 ms): -202.91.
Step 15190 (32 ms): -194.12.
Step 15228 (31 ms): -197.29.
Step 15266 (31 ms): -201.06.
Step 15303 (32 ms): -190.28.
Step 15341 (31 ms): -212.2.
Step 15378 (32 ms): -196.89.
Step 15416 (15 ms): -187.76.

Epoch 41 (11.9 s):
    Evaluating model.
    Full set (5.74 s): ELBO: -202.22, ENRE: -196.96, KL: 5.264.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 15454 (31 ms): -203.67.
Step 15491 (32 ms): -207.
Step 15529 (32 ms): -207.31.
Step 15566 (32 ms): -203.6.
Step 15604 (32 ms): -198.17.
Step 15642 (31 ms): -197.3.
Step 15679 (32 ms): -214.95.
Step 15717 (31 ms): -195.36.
Step 15754 (31 ms): -210.49.
Step 15792 (16 ms): -177.74.

Epoch 42 (11.9 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -201.94, ENRE: -196.66, KL: 5.2856.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 15830 (32 ms): -202.12.
Step 15867 (32 ms): -201.69.
Step 15905 (32 ms): -217.61.
Step 15942 (31 ms): -197.77.
Step 15980 (32 ms): -217.02.
Step 16018 (32 ms): -211.06.
Step 16055 (32 ms): -200.89.
Step 16093 (32 ms): -218.51.
Step 16130 (32 ms): -205.77.
Step 16168 (15 ms): -223.63.

Epoch 43 (11.9 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -201.61, ENRE: -196.23, KL: 5.3751.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 16206 (32 ms): -195.32.
Step 16243 (31 ms): -189.24.
Step 16281 (32 ms): -203.79.
Step 16318 (32 ms): -204.38.
Step 16356 (32 ms): -193.74.
Step 16394 (32 ms): -204.48.
Step 16431 (31 ms): -198.59.
Step 16469 (33 ms): -197.38.
Step 16506 (32 ms): -198.3.
Step 16544 (15 ms): -206.76.

Epoch 44 (12 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -201.87, ENRE: -196.58, KL: 5.2823.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 16582 (31 ms): -211.19.
Step 16619 (33 ms): -213.56.
Step 16657 (33 ms): -208.22.
Step 16694 (32 ms): -198.51.
Step 16732 (32 ms): -205.19.
Step 16770 (31 ms): -202.64.
Step 16807 (32 ms): -194.23.
Step 16845 (32 ms): -210.48.
Step 16882 (32 ms): -204.75.
Step 16920 (15 ms): -197.79.

Epoch 45 (12 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -201.36, ENRE: -196.06, KL: 5.3016.
    Saving model parameters.
    Model parameters saved (106 ms).

Step 16958 (32 ms): -203.67.
Step 16995 (31 ms): -202.17.
Step 17033 (32 ms): -198.03.
Step 17070 (31 ms): -200.66.
Step 17108 (31 ms): -196.47.
Step 17146 (32 ms): -206.83.
Step 17183 (32 ms): -204.87.
Step 17221 (32 ms): -199.67.
Step 17258 (32 ms): -200.1.
Step 17296 (15 ms): -176.69.

Epoch 46 (11.9 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -201.28, ENRE: -195.94, KL: 5.3403.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 17334 (32 ms): -204.52.
Step 17371 (32 ms): -206.15.
Step 17409 (31 ms): -195.45.
Step 17446 (32 ms): -190.62.
Step 17484 (31 ms): -218.22.
Step 17522 (32 ms): -194.97.
Step 17559 (32 ms): -193.32.
Step 17597 (32 ms): -216.65.
Step 17634 (31 ms): -201.54.
Step 17672 (15 ms): -206.54.

Epoch 47 (11.9 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -201.13, ENRE: -195.77, KL: 5.3672.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 17710 (32 ms): -210.75.
Step 17747 (31 ms): -198.51.
Step 17785 (31 ms): -198.33.
Step 17822 (31 ms): -200.66.
Step 17860 (31 ms): -202.51.
Step 17898 (31 ms): -210.67.
Step 17935 (31 ms): -194.53.
Step 17973 (32 ms): -199.69.
Step 18010 (31 ms): -200.36.
Step 18048 (15 ms): -189.81.

Epoch 48 (11.8 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -201.12, ENRE: -195.76, KL: 5.362.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 18086 (32 ms): -208.4.
Step 18123 (32 ms): -206.26.
Step 18161 (32 ms): -205.02.
Step 18198 (32 ms): -210.09.
Step 18236 (31 ms): -196.22.
Step 18274 (31 ms): -194.43.
Step 18311 (31 ms): -217.31.
Step 18349 (32 ms): -211.01.
Step 18386 (32 ms): -215.55.
Step 18424 (15 ms): -297.98.

Epoch 49 (11.9 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -200.91, ENRE: -195.56, KL: 5.3542.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 18462 (32 ms): -207.17.
Step 18499 (31 ms): -197.6.
Step 18537 (32 ms): -190.21.
Step 18574 (31 ms): -199.19.
Step 18612 (32 ms): -191.81.
Step 18650 (32 ms): -210.4.
Step 18687 (31 ms): -189.21.
Step 18725 (32 ms): -214.42.
Step 18762 (32 ms): -198.94.
Step 18800 (15 ms): -185.09.

Epoch 50 (11.9 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -200.67, ENRE: -195.23, KL: 5.4378.
    Saving model parameters.
    Model parameters saved (107 ms).

Model trained for 50 epochs (14m 58s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (866 ms).

Converting data set value array to sparse matrix.
Data set value array converted (276 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2.1 s):  ELBO: -418.23, ENRE: -412.79, KL: 5.4367.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (672 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.520331264696729
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 34
kl weight: 1.520331264696729
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (46 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.68 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 34
    hidden sizes: 149, 278, 53, 298
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.520331264696729
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 1 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 149)
    ENCODER/1/DENSE/biases:0             (149,)
    ENCODER/1/BATCH_NORM/beta:0          (149,)
    ENCODER/2/DENSE/weights:0            (149, 278)
    ENCODER/2/DENSE/biases:0             (278,)
    ENCODER/2/BATCH_NORM/beta:0          (278,)
    ENCODER/3/DENSE/weights:0            (278, 53)
    ENCODER/3/DENSE/biases:0             (53,)
    ENCODER/3/BATCH_NORM/beta:0          (53,)
    ENCODER/4/DENSE/weights:0            (53, 298)
    ENCODER/4/DENSE/biases:0             (298,)
    ENCODER/4/BATCH_NORM/beta:0          (298,)
    POSTERIOR/MU/DENSE/weights:0         (298, 34)
    POSTERIOR/MU/DENSE/biases:0          (34,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (298, 34)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (34,)
    DECODER/4/DENSE/weights:0            (34, 298)
    DECODER/4/DENSE/biases:0             (298,)
    DECODER/4/BATCH_NORM/beta:0          (298,)
    DECODER/3/DENSE/weights:0            (298, 53)
    DECODER/3/DENSE/biases:0             (53,)
    DECODER/3/BATCH_NORM/beta:0          (53,)
    DECODER/2/DENSE/weights:0            (53, 278)
    DECODER/2/DENSE/biases:0             (278,)
    DECODER/2/BATCH_NORM/beta:0          (278,)
    DECODER/1/DENSE/weights:0            (278, 149)
    DECODER/1/DENSE/biases:0             (149,)
    DECODER/1/BATCH_NORM/beta:0          (149,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (149, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (470 ms).

Training model for 50 epochs on original values.

Step 38 (33 ms): -2281.9.
Step 75 (34 ms): -1979.5.
Step 113 (33 ms): -1734.
Step 150 (33 ms): -1535.3.
Step 188 (32 ms): -1406.5.
Step 226 (32 ms): -1248.1.
Step 263 (34 ms): -1146.4.
Step 301 (32 ms): -1066.
Step 338 (32 ms): -997.29.
Step 376 (18 ms): -893.82.

Epoch 1 (14.7 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.37 s): ELBO: -1770.2, ENRE: -1746.9, KL: 23.355.
    Saving model parameters.
    Model parameters saved (191 ms).

Step 414 (33 ms): -652.55.
Step 451 (32 ms): -566.34.
Step 489 (33 ms): -500.59.
Step 526 (32 ms): -458.42.
Step 564 (33 ms): -421.39.
Step 602 (32 ms): -427.96.
Step 639 (32 ms): -370.32.
Step 677 (32 ms): -371.59.
Step 714 (32 ms): -362.02.
Step 752 (18 ms): -480.57.

Epoch 2 (12.2 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -991.81, ENRE: -985.35, KL: 6.463.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 790 (33 ms): -313.94.
Step 827 (32 ms): -310.25.
Step 865 (32 ms): -310.56.
Step 902 (32 ms): -309.56.
Step 940 (32 ms): -296.89.
Step 978 (32 ms): -277.08.
Step 1015 (32 ms): -283.37.
Step 1053 (32 ms): -296.48.
Step 1090 (32 ms): -313.2.
Step 1128 (14 ms): -360.71.

Epoch 3 (12.1 s):
    Evaluating model.
    Full set (5.76 s): ELBO: -548.94, ENRE: -544, KL: 4.9343.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 1166 (32 ms): -291.83.
Step 1203 (33 ms): -269.84.
Step 1241 (32 ms): -257.29.
Step 1278 (31 ms): -248.47.
Step 1316 (32 ms): -273.8.
Step 1354 (32 ms): -264.47.
Step 1391 (32 ms): -275.88.
Step 1429 (31 ms): -255.94.
Step 1466 (32 ms): -253.59.
Step 1504 (15 ms): -337.84.

Epoch 4 (12 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -374.15, ENRE: -369.55, KL: 4.5955.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 1542 (32 ms): -252.6.
Step 1579 (33 ms): -236.48.
Step 1617 (32 ms): -240.06.
Step 1654 (33 ms): -250.18.
Step 1692 (32 ms): -244.14.
Step 1730 (33 ms): -240.99.
Step 1767 (32 ms): -249.41.
Step 1805 (32 ms): -242.81.
Step 1842 (32 ms): -240.19.
Step 1880 (15 ms): -248.61.

Epoch 5 (12.2 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -297.25, ENRE: -292.77, KL: 4.4793.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 1918 (32 ms): -246.45.
Step 1955 (32 ms): -225.44.
Step 1993 (32 ms): -218.44.
Step 2030 (32 ms): -220.72.
Step 2068 (33 ms): -260.13.
Step 2106 (32 ms): -267.37.
Step 2143 (32 ms): -230.64.
Step 2181 (32 ms): -231.8.
Step 2218 (32 ms): -230.31.
Step 2256 (15 ms): -340.88.

Epoch 6 (12.2 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -265.63, ENRE: -260.9, KL: 4.7352.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 2294 (32 ms): -220.93.
Step 2331 (32 ms): -221.07.
Step 2369 (32 ms): -222.29.
Step 2406 (32 ms): -247.52.
Step 2444 (33 ms): -221.57.
Step 2482 (32 ms): -233.27.
Step 2519 (33 ms): -233.37.
Step 2557 (33 ms): -221.35.
Step 2594 (33 ms): -224.76.
Step 2632 (15 ms): -237.68.

Epoch 7 (12.2 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -244.66, ENRE: -239.79, KL: 4.8706.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 2670 (32 ms): -219.71.
Step 2707 (32 ms): -227.89.
Step 2745 (33 ms): -233.06.
Step 2782 (32 ms): -228.45.
Step 2820 (32 ms): -217.21.
Step 2858 (32 ms): -230.45.
Step 2895 (32 ms): -223.44.
Step 2933 (31 ms): -210.83.
Step 2970 (32 ms): -234.96.
Step 3008 (15 ms): -357.5.

Epoch 8 (12.1 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -231.24, ENRE: -226.01, KL: 5.2328.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 3046 (32 ms): -224.03.
Step 3083 (32 ms): -229.39.
Step 3121 (31 ms): -228.8.
Step 3158 (32 ms): -220.05.
Step 3196 (32 ms): -216.29.
Step 3234 (32 ms): -255.94.
Step 3271 (31 ms): -216.65.
Step 3309 (32 ms): -207.81.
Step 3346 (32 ms): -220.83.
Step 3384 (15 ms): -206.8.

Epoch 9 (12 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -223.44, ENRE: -217.82, KL: 5.6198.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 3422 (32 ms): -220.61.
Step 3459 (32 ms): -230.48.
Step 3497 (32 ms): -223.61.
Step 3534 (32 ms): -217.71.
Step 3572 (31 ms): -229.37.
Step 3610 (32 ms): -214.52.
Step 3647 (32 ms): -212.81.
Step 3685 (32 ms): -211.03.
Step 3722 (32 ms): -220.82.
Step 3760 (15 ms): -465.48.

Epoch 10 (12 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -219.23, ENRE: -213.51, KL: 5.7269.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 3798 (33 ms): -210.57.
Step 3835 (32 ms): -224.85.
Step 3873 (32 ms): -228.18.
Step 3910 (32 ms): -224.92.
Step 3948 (33 ms): -216.47.
Step 3986 (32 ms): -205.62.
Step 4023 (33 ms): -225.14.
Step 4061 (32 ms): -212.52.
Step 4098 (32 ms): -213.56.
Step 4136 (15 ms): -225.6.

Epoch 11 (12.1 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -216.71, ENRE: -211.06, KL: 5.6565.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 4174 (36 ms): -210.86.
Step 4211 (32 ms): -209.63.
Step 4249 (33 ms): -206.09.
Step 4286 (32 ms): -236.96.
Step 4324 (33 ms): -208.32.
Step 4362 (33 ms): -226.49.
Step 4399 (32 ms): -204.76.
Step 4437 (32 ms): -232.26.
Step 4474 (33 ms): -212.29.
Step 4512 (15 ms): -259.13.

Epoch 12 (12.3 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -214.66, ENRE: -209.09, KL: 5.5773.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 4550 (32 ms): -223.66.
Step 4587 (32 ms): -216.69.
Step 4625 (32 ms): -219.73.
Step 4662 (33 ms): -210.81.
Step 4700 (33 ms): -218.31.
Step 4738 (32 ms): -216.5.
Step 4775 (32 ms): -210.87.
Step 4813 (32 ms): -210.25.
Step 4850 (32 ms): -214.05.
Step 4888 (15 ms): -230.45.

Epoch 13 (12.2 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -213.23, ENRE: -207.61, KL: 5.6248.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 4926 (32 ms): -197.48.
Step 4963 (32 ms): -214.61.
Step 5001 (33 ms): -208.89.
Step 5038 (32 ms): -207.69.
Step 5076 (33 ms): -207.14.
Step 5114 (33 ms): -199.57.
Step 5151 (33 ms): -213.26.
Step 5189 (32 ms): -198.46.
Step 5226 (33 ms): -210.49.
Step 5264 (15 ms): -207.54.

Epoch 14 (12.2 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -212.17, ENRE: -206.45, KL: 5.7212.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 5302 (33 ms): -208.97.
Step 5339 (32 ms): -214.52.
Step 5377 (32 ms): -205.63.
Step 5414 (31 ms): -210.75.
Step 5452 (32 ms): -217.5.
Step 5490 (32 ms): -211.38.
Step 5527 (32 ms): -205.27.
Step 5565 (32 ms): -202.04.
Step 5602 (32 ms): -211.42.
Step 5640 (15 ms): -183.07.

Epoch 15 (12 s):
    Evaluating model.
    Full set (5.76 s): ELBO: -211.87, ENRE: -206.05, KL: 5.8166.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 5678 (31 ms): -207.
Step 5715 (32 ms): -206.77.
Step 5753 (31 ms): -212.78.
Step 5790 (31 ms): -203.55.
Step 5828 (32 ms): -207.64.
Step 5866 (31 ms): -198.
Step 5903 (32 ms): -225.42.
Step 5941 (31 ms): -215.88.
Step 5978 (32 ms): -208.45.
Step 6016 (15 ms): -219.94.

Epoch 16 (12 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -210.66, ENRE: -204.95, KL: 5.7067.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 6054 (32 ms): -206.32.
Step 6091 (32 ms): -203.23.
Step 6129 (32 ms): -214.89.
Step 6166 (31 ms): -214.15.
Step 6204 (34 ms): -203.97.
Step 6242 (33 ms): -221.46.
Step 6279 (32 ms): -213.87.
Step 6317 (32 ms): -208.53.
Step 6354 (33 ms): -210.3.
Step 6392 (15 ms): -206.86.

Epoch 17 (12.1 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -209.93, ENRE: -204.36, KL: 5.5671.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 6430 (33 ms): -200.45.
Step 6467 (32 ms): -222.59.
Step 6505 (32 ms): -204.99.
Step 6542 (32 ms): -206.45.
Step 6580 (32 ms): -211.65.
Step 6618 (32 ms): -205.34.
Step 6655 (32 ms): -188.06.
Step 6693 (32 ms): -210.96.
Step 6730 (32 ms): -207.64.
Step 6768 (15 ms): -228.54.

Epoch 18 (12.1 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -209.69, ENRE: -204.14, KL: 5.5451.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 6806 (35 ms): -209.61.
Step 6843 (33 ms): -193.08.
Step 6881 (33 ms): -210.89.
Step 6918 (33 ms): -214.77.
Step 6956 (32 ms): -206.69.
Step 6994 (32 ms): -203.95.
Step 7031 (32 ms): -193.88.
Step 7069 (32 ms): -210.13.
Step 7106 (33 ms): -211.83.
Step 7144 (15 ms): -218.68.

Epoch 19 (12.2 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -208.61, ENRE: -203.03, KL: 5.5855.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 7182 (32 ms): -200.48.
Step 7219 (32 ms): -202.96.
Step 7257 (33 ms): -224.45.
Step 7294 (33 ms): -205.44.
Step 7332 (32 ms): -215.64.
Step 7370 (33 ms): -210.52.
Step 7407 (32 ms): -208.77.
Step 7445 (32 ms): -213.64.
Step 7482 (33 ms): -215.22.
Step 7520 (14 ms): -206.02.

Epoch 20 (12.1 s):
    Evaluating model.
    Full set (5.76 s): ELBO: -209.52, ENRE: -203.89, KL: 5.6226.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 7558 (31 ms): -196.93.
Step 7595 (32 ms): -195.7.
Step 7633 (32 ms): -223.02.
Step 7670 (32 ms): -200.49.
Step 7708 (33 ms): -218.92.
Step 7746 (32 ms): -214.73.
Step 7783 (32 ms): -222.88.
Step 7821 (32 ms): -210.54.
Step 7858 (31 ms): -206.37.
Step 7896 (15 ms): -255.7.

Epoch 21 (12.1 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -208.78, ENRE: -203.07, KL: 5.714.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 7934 (32 ms): -212.85.
Step 7971 (33 ms): -202.34.
Step 8009 (31 ms): -216.84.
Step 8046 (32 ms): -211.44.
Step 8084 (31 ms): -201.71.
Step 8122 (32 ms): -215.68.
Step 8159 (31 ms): -206.51.
Step 8197 (32 ms): -192.12.
Step 8234 (32 ms): -205.13.
Step 8272 (14 ms): -232.46.

Epoch 22 (12 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -208.22, ENRE: -202.65, KL: 5.5667.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 8310 (31 ms): -195.98.
Step 8347 (32 ms): -208.16.
Step 8385 (32 ms): -210.96.
Step 8422 (32 ms): -202.25.
Step 8460 (32 ms): -200.99.
Step 8498 (31 ms): -204.55.
Step 8535 (32 ms): -192.65.
Step 8573 (32 ms): -206.54.
Step 8610 (33 ms): -214.31.
Step 8648 (15 ms): -366.37.

Epoch 23 (12 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -207.41, ENRE: -201.83, KL: 5.5837.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 8686 (32 ms): -206.58.
Step 8723 (32 ms): -204.84.
Step 8761 (32 ms): -195.22.
Step 8798 (32 ms): -205.16.
Step 8836 (32 ms): -202.35.
Step 8874 (32 ms): -200.58.
Step 8911 (32 ms): -204.94.
Step 8949 (32 ms): -204.81.
Step 8986 (31 ms): -196.98.
Step 9024 (15 ms): -256.94.

Epoch 24 (12 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -207.32, ENRE: -201.76, KL: 5.5624.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 9062 (32 ms): -200.91.
Step 9099 (32 ms): -205.54.
Step 9137 (33 ms): -198.06.
Step 9174 (33 ms): -191.65.
Step 9212 (31 ms): -206.11.
Step 9250 (33 ms): -200.16.
Step 9287 (33 ms): -209.57.
Step 9325 (32 ms): -205.86.
Step 9362 (32 ms): -202.2.
Step 9400 (15 ms): -230.8.

Epoch 25 (12.1 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -205.85, ENRE: -200.39, KL: 5.4648.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 9438 (33 ms): -215.34.
Step 9475 (33 ms): -198.74.
Step 9513 (32 ms): -203.77.
Step 9550 (32 ms): -206.58.
Step 9588 (32 ms): -208.37.
Step 9626 (33 ms): -207.15.
Step 9663 (32 ms): -195.96.
Step 9701 (32 ms): -215.63.
Step 9738 (32 ms): -217.31.
Step 9776 (15 ms): -238.88.

Epoch 26 (12.2 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -205.75, ENRE: -200.15, KL: 5.6012.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 9814 (33 ms): -201.15.
Step 9851 (32 ms): -190.64.
Step 9889 (33 ms): -213.67.
Step 9926 (32 ms): -198.09.
Step 9964 (32 ms): -204.22.
Step 10002 (32 ms): -210.45.
Step 10039 (32 ms): -203.14.
Step 10077 (32 ms): -198.66.
Step 10114 (32 ms): -202.12.
Step 10152 (15 ms): -215.47.

Epoch 27 (12.2 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -205.02, ENRE: -199.55, KL: 5.4681.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 10190 (32 ms): -211.24.
Step 10227 (32 ms): -210.03.
Step 10265 (32 ms): -204.48.
Step 10302 (32 ms): -216.45.
Step 10340 (33 ms): -219.55.
Step 10378 (33 ms): -223.34.
Step 10415 (32 ms): -198.84.
Step 10453 (33 ms): -198.13.
Step 10490 (32 ms): -200.22.
Step 10528 (14 ms): -279.77.

Epoch 28 (12.1 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -204.98, ENRE: -199.41, KL: 5.5719.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 10566 (31 ms): -196.01.
Step 10603 (32 ms): -198.54.
Step 10641 (32 ms): -201.42.
Step 10678 (32 ms): -206.49.
Step 10716 (32 ms): -192.37.
Step 10754 (32 ms): -201.44.
Step 10791 (32 ms): -213.69.
Step 10829 (33 ms): -206.71.
Step 10866 (32 ms): -208.35.
Step 10904 (14 ms): -259.74.

Epoch 29 (12 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -205.39, ENRE: -199.85, KL: 5.542.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 10942 (32 ms): -195.6.
Step 10979 (32 ms): -194.28.
Step 11017 (32 ms): -221.31.
Step 11054 (33 ms): -198.86.
Step 11092 (32 ms): -200.26.
Step 11130 (32 ms): -197.69.
Step 11167 (32 ms): -209.04.
Step 11205 (32 ms): -198.8.
Step 11242 (32 ms): -193.66.
Step 11280 (15 ms): -214.49.

Epoch 30 (12 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -204.73, ENRE: -199.16, KL: 5.5679.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 11318 (32 ms): -213.37.
Step 11355 (32 ms): -197.76.
Step 11393 (32 ms): -209.72.
Step 11430 (32 ms): -196.21.
Step 11468 (33 ms): -198.82.
Step 11506 (32 ms): -198.15.
Step 11543 (32 ms): -206.8.
Step 11581 (32 ms): -205.13.
Step 11618 (33 ms): -201.97.
Step 11656 (15 ms): -234.48.

Epoch 31 (12.1 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -204.05, ENRE: -198.54, KL: 5.5085.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 11694 (33 ms): -201.7.
Step 11731 (32 ms): -205.56.
Step 11769 (32 ms): -205.34.
Step 11806 (32 ms): -192.8.
Step 11844 (32 ms): -208.18.
Step 11882 (32 ms): -195.48.
Step 11919 (33 ms): -191.22.
Step 11957 (32 ms): -198.03.
Step 11994 (33 ms): -207.13.
Step 12032 (15 ms): -223.74.

Epoch 32 (12.2 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -204.61, ENRE: -198.98, KL: 5.6223.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 12070 (32 ms): -203.28.
Step 12107 (31 ms): -200.77.
Step 12145 (33 ms): -221.4.
Step 12182 (33 ms): -202.9.
Step 12220 (32 ms): -208.21.
Step 12258 (33 ms): -198.68.
Step 12295 (32 ms): -198.59.
Step 12333 (32 ms): -200.05.
Step 12370 (32 ms): -210.21.
Step 12408 (15 ms): -286.78.

Epoch 33 (12.2 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -203.86, ENRE: -198.13, KL: 5.7222.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 12446 (32 ms): -208.53.
Step 12483 (32 ms): -204.76.
Step 12521 (32 ms): -211.2.
Step 12558 (33 ms): -202.56.
Step 12596 (32 ms): -202.69.
Step 12634 (32 ms): -206.56.
Step 12671 (32 ms): -194.16.
Step 12709 (32 ms): -210.17.
Step 12746 (33 ms): -217.39.
Step 12784 (14 ms): -257.44.

Epoch 34 (12.1 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -202.86, ENRE: -197.23, KL: 5.6354.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 12822 (32 ms): -195.97.
Step 12859 (32 ms): -222.98.
Step 12897 (32 ms): -205.62.
Step 12934 (31 ms): -201.62.
Step 12972 (33 ms): -199.16.
Step 13010 (32 ms): -198.64.
Step 13047 (32 ms): -228.38.
Step 13085 (31 ms): -216.69.
Step 13122 (31 ms): -209.61.
Step 13160 (14 ms): -261.99.

Epoch 35 (12 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -202.4, ENRE: -196.82, KL: 5.5811.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 13198 (31 ms): -201.11.
Step 13235 (31 ms): -210.62.
Step 13273 (32 ms): -203.01.
Step 13310 (32 ms): -218.13.
Step 13348 (32 ms): -198.7.
Step 13386 (32 ms): -192.68.
Step 13423 (32 ms): -201.87.
Step 13461 (32 ms): -212.44.
Step 13498 (34 ms): -212.65.
Step 13536 (15 ms): -214.96.

Epoch 36 (12 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -203.28, ENRE: -197.73, KL: 5.5439.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 13574 (32 ms): -196.91.
Step 13611 (32 ms): -204.25.
Step 13649 (32 ms): -191.95.
Step 13686 (33 ms): -200.59.
Step 13724 (32 ms): -192.23.
Step 13762 (32 ms): -187.97.
Step 13799 (33 ms): -205.86.
Step 13837 (33 ms): -206.64.
Step 13874 (33 ms): -214.14.
Step 13912 (15 ms): -258.67.

Epoch 37 (12.2 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -202.46, ENRE: -196.89, KL: 5.5714.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 13950 (32 ms): -195.36.
Step 13987 (32 ms): -208.93.
Step 14025 (32 ms): -192.47.
Step 14062 (32 ms): -196.56.
Step 14100 (32 ms): -205.88.
Step 14138 (32 ms): -207.54.
Step 14175 (32 ms): -211.04.
Step 14213 (32 ms): -219.56.
Step 14250 (33 ms): -190.73.
Step 14288 (15 ms): -181.64.

Epoch 38 (12.2 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -202.21, ENRE: -196.66, KL: 5.5463.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 14326 (33 ms): -204.74.
Step 14363 (32 ms): -214.6.
Step 14401 (32 ms): -195.63.
Step 14438 (32 ms): -203.76.
Step 14476 (33 ms): -209.95.
Step 14514 (33 ms): -202.75.
Step 14551 (32 ms): -196.84.
Step 14589 (33 ms): -211.14.
Step 14626 (34 ms): -204.34.
Step 14664 (15 ms): -234.99.

Epoch 39 (12.2 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -202.02, ENRE: -196.38, KL: 5.6417.
    Saving model parameters.
    Model parameters saved (154 ms).

Step 14702 (32 ms): -206.84.
Step 14739 (32 ms): -197.03.
Step 14777 (32 ms): -203.5.
Step 14814 (31 ms): -213.92.
Step 14852 (33 ms): -221.71.
Step 14890 (31 ms): -214.29.
Step 14927 (32 ms): -215.17.
Step 14965 (32 ms): -211.99.
Step 15002 (32 ms): -198.57.
Step 15040 (15 ms): -245.27.

Epoch 40 (12 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -202.01, ENRE: -196.42, KL: 5.5909.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 15078 (32 ms): -200.13.
Step 15115 (32 ms): -214.19.
Step 15153 (32 ms): -204.79.
Step 15190 (33 ms): -198.11.
Step 15228 (32 ms): -197.91.
Step 15266 (31 ms): -204.63.
Step 15303 (32 ms): -205.07.
Step 15341 (32 ms): -194.07.
Step 15378 (31 ms): -192.82.
Step 15416 (15 ms): -232.35.

Epoch 41 (12 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -201.62, ENRE: -195.94, KL: 5.6843.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 15454 (31 ms): -195.55.
Step 15491 (33 ms): -212.18.
Step 15529 (32 ms): -207.38.
Step 15566 (32 ms): -206.95.
Step 15604 (32 ms): -195.69.
Step 15642 (32 ms): -198.21.
Step 15679 (32 ms): -207.46.
Step 15717 (31 ms): -201.78.
Step 15754 (32 ms): -212.83.
Step 15792 (15 ms): -212.18.

Epoch 42 (12 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -201.58, ENRE: -195.89, KL: 5.6837.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 15830 (33 ms): -190.05.
Step 15867 (31 ms): -211.5.
Step 15905 (33 ms): -202.92.
Step 15942 (32 ms): -199.27.
Step 15980 (31 ms): -206.95.
Step 16018 (32 ms): -197.89.
Step 16055 (32 ms): -192.47.
Step 16093 (32 ms): -198.06.
Step 16130 (32 ms): -215.72.
Step 16168 (15 ms): -329.95.

Epoch 43 (12.1 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -201.6, ENRE: -196.06, KL: 5.5334.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 16206 (33 ms): -196.79.
Step 16243 (32 ms): -212.95.
Step 16281 (32 ms): -202.75.
Step 16318 (33 ms): -208.89.
Step 16356 (35 ms): -208.74.
Step 16394 (32 ms): -210.53.
Step 16431 (32 ms): -206.23.
Step 16469 (33 ms): -200.5.
Step 16506 (33 ms): -198.06.
Step 16544 (15 ms): -207.64.

Epoch 44 (12.3 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -201.39, ENRE: -195.72, KL: 5.6691.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 16582 (32 ms): -193.67.
Step 16619 (32 ms): -214.73.
Step 16657 (33 ms): -202.26.
Step 16694 (32 ms): -193.07.
Step 16732 (32 ms): -198.18.
Step 16770 (32 ms): -206.7.
Step 16807 (32 ms): -206.91.
Step 16845 (31 ms): -211.12.
Step 16882 (32 ms): -203.64.
Step 16920 (15 ms): -339.83.

Epoch 45 (12.2 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -201.59, ENRE: -195.88, KL: 5.7143.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 16958 (33 ms): -200.49.
Step 16995 (32 ms): -196.16.
Step 17033 (32 ms): -200.41.
Step 17070 (32 ms): -202.36.
Step 17108 (33 ms): -198.57.
Step 17146 (33 ms): -210.55.
Step 17183 (32 ms): -198.87.
Step 17221 (32 ms): -199.39.
Step 17258 (32 ms): -206.57.
Step 17296 (15 ms): -206.55.

Epoch 46 (12.2 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -201.34, ENRE: -195.67, KL: 5.6736.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 17334 (32 ms): -201.64.
Step 17371 (32 ms): -211.41.
Step 17409 (32 ms): -201.9.
Step 17446 (32 ms): -192.48.
Step 17484 (32 ms): -195.03.
Step 17522 (32 ms): -205.54.
Step 17559 (32 ms): -204.03.
Step 17597 (32 ms): -210.33.
Step 17634 (32 ms): -196.3.
Step 17672 (14 ms): -206.77.

Epoch 47 (12 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -201.22, ENRE: -195.51, KL: 5.7124.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 17710 (32 ms): -194.85.
Step 17747 (32 ms): -205.45.
Step 17785 (32 ms): -203.81.
Step 17822 (32 ms): -200.04.
Step 17860 (33 ms): -202.01.
Step 17898 (32 ms): -191.44.
Step 17935 (32 ms): -194.6.
Step 17973 (32 ms): -208.88.
Step 18010 (32 ms): -197.81.
Step 18048 (14 ms): -247.09.

Epoch 48 (12 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -201.54, ENRE: -195.82, KL: 5.7222.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 18086 (32 ms): -196.27.
Step 18123 (33 ms): -214.8.
Step 18161 (32 ms): -209.57.
Step 18198 (34 ms): -209.75.
Step 18236 (32 ms): -211.82.
Step 18274 (32 ms): -199.13.
Step 18311 (32 ms): -196.05.
Step 18349 (32 ms): -202.81.
Step 18386 (33 ms): -200.63.
Step 18424 (15 ms): -224.72.

Epoch 49 (12 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -201.31, ENRE: -195.55, KL: 5.7545.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 18462 (33 ms): -218.48.
Step 18499 (34 ms): -221.32.
Step 18537 (33 ms): -213.48.
Step 18574 (32 ms): -206.04.
Step 18612 (32 ms): -195.46.
Step 18650 (32 ms): -201.21.
Step 18687 (34 ms): -197.97.
Step 18725 (32 ms): -200.42.
Step 18762 (32 ms): -200.88.
Step 18800 (15 ms): -509.89.

Epoch 50 (12.1 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -200.95, ENRE: -195.11, KL: 5.8394.
    Saving model parameters.
    Model parameters saved (113 ms).

Model trained for 50 epochs (15m 5s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (863 ms).

Converting data set value array to sparse matrix.
Data set value array converted (275 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.84 s):  ELBO: -422.58, ENRE: -416.74, KL: 5.8407.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (663 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.3564939374609823
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 40
kl weight: 1.3564939374609823
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (49 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.2 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.91 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 40
    hidden sizes: 163, 281, 54, 297, 120
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.3564939374609823
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 1 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 163)
    ENCODER/1/DENSE/biases:0             (163,)
    ENCODER/1/BATCH_NORM/beta:0          (163,)
    ENCODER/2/DENSE/weights:0            (163, 281)
    ENCODER/2/DENSE/biases:0             (281,)
    ENCODER/2/BATCH_NORM/beta:0          (281,)
    ENCODER/3/DENSE/weights:0            (281, 54)
    ENCODER/3/DENSE/biases:0             (54,)
    ENCODER/3/BATCH_NORM/beta:0          (54,)
    ENCODER/4/DENSE/weights:0            (54, 297)
    ENCODER/4/DENSE/biases:0             (297,)
    ENCODER/4/BATCH_NORM/beta:0          (297,)
    ENCODER/5/DENSE/weights:0            (297, 120)
    ENCODER/5/DENSE/biases:0             (120,)
    ENCODER/5/BATCH_NORM/beta:0          (120,)
    POSTERIOR/MU/DENSE/weights:0         (120, 40)
    POSTERIOR/MU/DENSE/biases:0          (40,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (120, 40)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (40,)
    DECODER/5/DENSE/weights:0            (40, 120)
    DECODER/5/DENSE/biases:0             (120,)
    DECODER/5/BATCH_NORM/beta:0          (120,)
    DECODER/4/DENSE/weights:0            (120, 297)
    DECODER/4/DENSE/biases:0             (297,)
    DECODER/4/BATCH_NORM/beta:0          (297,)
    DECODER/3/DENSE/weights:0            (297, 54)
    DECODER/3/DENSE/biases:0             (54,)
    DECODER/3/BATCH_NORM/beta:0          (54,)
    DECODER/2/DENSE/weights:0            (54, 281)
    DECODER/2/DENSE/biases:0             (281,)
    DECODER/2/BATCH_NORM/beta:0          (281,)
    DECODER/1/DENSE/weights:0            (281, 163)
    DECODER/1/DENSE/biases:0             (163,)
    DECODER/1/BATCH_NORM/beta:0          (163,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (163, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (556 ms).

Training model for 50 epochs on original values.

Step 38 (36 ms): -2249.8.
Step 75 (36 ms): -1847.2.
Step 113 (35 ms): -1588.4.
Step 150 (35 ms): -1327.
Step 188 (34 ms): -1157.6.
Step 226 (34 ms): -1035.8.
Step 263 (34 ms): -904.09.
Step 301 (34 ms): -824.87.
Step 338 (34 ms): -753.88.
Step 376 (19 ms): -709.9.

Epoch 1 (16 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.83 s): ELBO: -1684.6, ENRE: -1674.9, KL: 9.6925.
    Saving model parameters.
    Model parameters saved (197 ms).

Step 414 (35 ms): -557.24.
Step 451 (34 ms): -501.99.
Step 489 (34 ms): -462.15.
Step 526 (34 ms): -413.82.
Step 564 (34 ms): -403.11.
Step 602 (35 ms): -373.52.
Step 639 (35 ms): -370.68.
Step 677 (34 ms): -345.03.
Step 714 (35 ms): -350.59.
Step 752 (18 ms): -382.45.

Epoch 2 (13 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -882.81, ENRE: -876.65, KL: 6.1571.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 790 (34 ms): -302.59.
Step 827 (34 ms): -303.43.
Step 865 (34 ms): -308.33.
Step 902 (34 ms): -295.98.
Step 940 (34 ms): -273.9.
Step 978 (34 ms): -291.7.
Step 1015 (34 ms): -270.96.
Step 1053 (34 ms): -276.8.
Step 1090 (34 ms): -268.29.
Step 1128 (16 ms): -289.52.

Epoch 3 (12.8 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -501.94, ENRE: -496.53, KL: 5.4017.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 1166 (34 ms): -265.25.
Step 1203 (34 ms): -259.84.
Step 1241 (34 ms): -258.24.
Step 1278 (34 ms): -268.3.
Step 1316 (35 ms): -262.13.
Step 1354 (34 ms): -249.97.
Step 1391 (34 ms): -252.04.
Step 1429 (34 ms): -234.3.
Step 1466 (35 ms): -242.93.
Step 1504 (17 ms): -238.81.

Epoch 4 (12.9 s):
    Evaluating model.
    Full set (6.11 s): ELBO: -356.19, ENRE: -351.13, KL: 5.059.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 1542 (34 ms): -269.33.
Step 1579 (34 ms): -243.79.
Step 1617 (34 ms): -241.09.
Step 1654 (34 ms): -231.92.
Step 1692 (35 ms): -234.86.
Step 1730 (34 ms): -229.49.
Step 1767 (35 ms): -220.8.
Step 1805 (34 ms): -252.52.
Step 1842 (34 ms): -237.04.
Step 1880 (17 ms): -247.16.

Epoch 5 (13 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -293.2, ENRE: -288.09, KL: 5.1106.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 1918 (34 ms): -232.33.
Step 1955 (34 ms): -236.42.
Step 1993 (34 ms): -232.26.
Step 2030 (34 ms): -227.58.
Step 2068 (34 ms): -231.51.
Step 2106 (34 ms): -226.18.
Step 2143 (34 ms): -218.37.
Step 2181 (34 ms): -219.11.
Step 2218 (34 ms): -235.95.
Step 2256 (17 ms): -222.15.

Epoch 6 (13 s):
    Evaluating model.
    Full set (6.11 s): ELBO: -262.08, ENRE: -256.86, KL: 5.2269.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 2294 (34 ms): -214.56.
Step 2331 (34 ms): -226.37.
Step 2369 (34 ms): -235.38.
Step 2406 (34 ms): -228.65.
Step 2444 (35 ms): -232.34.
Step 2482 (34 ms): -223.56.
Step 2519 (34 ms): -216.81.
Step 2557 (34 ms): -215.64.
Step 2594 (34 ms): -245.84.
Step 2632 (16 ms): -267.31.

Epoch 7 (12.9 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -242.19, ENRE: -236.59, KL: 5.6043.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 2670 (34 ms): -220.38.
Step 2707 (34 ms): -223.11.
Step 2745 (34 ms): -223.86.
Step 2782 (34 ms): -233.48.
Step 2820 (35 ms): -217.8.
Step 2858 (34 ms): -207.21.
Step 2895 (34 ms): -214.66.
Step 2933 (33 ms): -238.17.
Step 2970 (34 ms): -217.33.
Step 3008 (16 ms): -225.08.

Epoch 8 (12.8 s):
    Evaluating model.
    Full set (6.1 s): ELBO: -232.07, ENRE: -226.45, KL: 5.6167.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 3046 (35 ms): -220.1.
Step 3083 (34 ms): -223.85.
Step 3121 (33 ms): -226.41.
Step 3158 (34 ms): -215.28.
Step 3196 (34 ms): -221.29.
Step 3234 (33 ms): -207.97.
Step 3271 (34 ms): -225.82.
Step 3309 (34 ms): -216.22.
Step 3346 (34 ms): -219.73.
Step 3384 (16 ms): -265.63.

Epoch 9 (12.8 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -224.98, ENRE: -219.15, KL: 5.8318.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 3422 (36 ms): -223.34.
Step 3459 (34 ms): -207.23.
Step 3497 (34 ms): -210.57.
Step 3534 (34 ms): -219.16.
Step 3572 (34 ms): -218.67.
Step 3610 (35 ms): -218.78.
Step 3647 (34 ms): -210.54.
Step 3685 (34 ms): -224.37.
Step 3722 (34 ms): -230.48.
Step 3760 (16 ms): -857.15.

Epoch 10 (12.9 s):
    Evaluating model.
    Full set (6.1 s): ELBO: -221.61, ENRE: -215.44, KL: 6.1694.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 3798 (34 ms): -205.84.
Step 3835 (34 ms): -205.62.
Step 3873 (35 ms): -214.63.
Step 3910 (34 ms): -212.76.
Step 3948 (35 ms): -231.3.
Step 3986 (34 ms): -201.07.
Step 4023 (34 ms): -218.61.
Step 4061 (35 ms): -203.18.
Step 4098 (34 ms): -219.65.
Step 4136 (16 ms): -337.25.

Epoch 11 (13 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -218.9, ENRE: -212.76, KL: 6.1336.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 4174 (34 ms): -231.83.
Step 4211 (34 ms): -214.1.
Step 4249 (34 ms): -208.64.
Step 4286 (34 ms): -209.28.
Step 4324 (34 ms): -212.63.
Step 4362 (34 ms): -210.38.
Step 4399 (35 ms): -212.31.
Step 4437 (34 ms): -210.34.
Step 4474 (34 ms): -211.72.
Step 4512 (17 ms): -477.67.

Epoch 12 (13 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -216.32, ENRE: -210.35, KL: 5.9701.
    Saving model parameters.
    Model parameters saved (129 ms).

Step 4550 (35 ms): -213.75.
Step 4587 (34 ms): -207.15.
Step 4625 (34 ms): -224.99.
Step 4662 (35 ms): -218.93.
Step 4700 (35 ms): -229.42.
Step 4738 (34 ms): -221.19.
Step 4775 (34 ms): -224.88.
Step 4813 (35 ms): -213.83.
Step 4850 (33 ms): -213.01.
Step 4888 (16 ms): -224.85.

Epoch 13 (12.9 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -214.67, ENRE: -208.62, KL: 6.0526.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 4926 (34 ms): -228.82.
Step 4963 (34 ms): -200.88.
Step 5001 (34 ms): -212.7.
Step 5038 (34 ms): -203.81.
Step 5076 (33 ms): -221.04.
Step 5114 (34 ms): -195.93.
Step 5151 (36 ms): -201.19.
Step 5189 (34 ms): -228.53.
Step 5226 (34 ms): -206.84.
Step 5264 (16 ms): -236.38.

Epoch 14 (12.8 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -213.62, ENRE: -207.63, KL: 5.9907.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 5302 (34 ms): -206.28.
Step 5339 (35 ms): -233.48.
Step 5377 (35 ms): -202.06.
Step 5414 (34 ms): -203.25.
Step 5452 (34 ms): -222.56.
Step 5490 (34 ms): -209.81.
Step 5527 (34 ms): -223.95.
Step 5565 (34 ms): -208.96.
Step 5602 (33 ms): -206.15.
Step 5640 (16 ms): -231.52.

Epoch 15 (12.8 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -213.01, ENRE: -207.04, KL: 5.9666.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 5678 (34 ms): -216.25.
Step 5715 (34 ms): -213.31.
Step 5753 (34 ms): -214.6.
Step 5790 (33 ms): -212.41.
Step 5828 (34 ms): -208.05.
Step 5866 (34 ms): -200.11.
Step 5903 (34 ms): -206.51.
Step 5941 (35 ms): -222.79.
Step 5978 (34 ms): -210.3.
Step 6016 (17 ms): -235.93.

Epoch 16 (12.8 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -212.62, ENRE: -206.74, KL: 5.8876.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 6054 (34 ms): -203.94.
Step 6091 (35 ms): -212.45.
Step 6129 (34 ms): -200.46.
Step 6166 (35 ms): -218.92.
Step 6204 (34 ms): -213.41.
Step 6242 (34 ms): -204.98.
Step 6279 (35 ms): -198.99.
Step 6317 (35 ms): -206.55.
Step 6354 (35 ms): -227.28.
Step 6392 (17 ms): -184.29.

Epoch 17 (13 s):
    Evaluating model.
    Full set (6.1 s): ELBO: -211.14, ENRE: -205.27, KL: 5.8656.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 6430 (35 ms): -210.41.
Step 6467 (35 ms): -218.4.
Step 6505 (34 ms): -208.25.
Step 6542 (34 ms): -212.9.
Step 6580 (34 ms): -219.34.
Step 6618 (34 ms): -201.51.
Step 6655 (35 ms): -210.6.
Step 6693 (35 ms): -218.77.
Step 6730 (34 ms): -219.61.
Step 6768 (17 ms): -233.3.

Epoch 18 (13 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -210.51, ENRE: -204.8, KL: 5.7105.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 6806 (34 ms): -206.77.
Step 6843 (34 ms): -210.55.
Step 6881 (34 ms): -206.35.
Step 6918 (35 ms): -199.35.
Step 6956 (34 ms): -206.34.
Step 6994 (34 ms): -202.87.
Step 7031 (35 ms): -209.19.
Step 7069 (35 ms): -226.26.
Step 7106 (34 ms): -201.22.
Step 7144 (17 ms): -206.32.

Epoch 19 (13 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -210.56, ENRE: -204.78, KL: 5.7778.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 7182 (34 ms): -221.39.
Step 7219 (34 ms): -208.95.
Step 7257 (34 ms): -198.09.
Step 7294 (35 ms): -220.07.
Step 7332 (34 ms): -199.04.
Step 7370 (34 ms): -224.65.
Step 7407 (35 ms): -204.27.
Step 7445 (34 ms): -201.64.
Step 7482 (34 ms): -199.76.
Step 7520 (16 ms): -312.02.

Epoch 20 (12.8 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -208.75, ENRE: -203.21, KL: 5.5409.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 7558 (34 ms): -216.24.
Step 7595 (34 ms): -203.95.
Step 7633 (33 ms): -227.55.
Step 7670 (34 ms): -216.17.
Step 7708 (33 ms): -193.38.
Step 7746 (34 ms): -208.47.
Step 7783 (33 ms): -193.32.
Step 7821 (34 ms): -204.07.
Step 7858 (34 ms): -198.66.
Step 7896 (16 ms): -196.67.

Epoch 21 (12.8 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -208.3, ENRE: -202.78, KL: 5.5225.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 7934 (34 ms): -202.16.
Step 7971 (34 ms): -217.94.
Step 8009 (34 ms): -204.54.
Step 8046 (34 ms): -218.35.
Step 8084 (34 ms): -201.9.
Step 8122 (34 ms): -199.69.
Step 8159 (33 ms): -209.63.
Step 8197 (34 ms): -209.08.
Step 8234 (34 ms): -198.93.
Step 8272 (16 ms): -223.83.

Epoch 22 (12.8 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -207.77, ENRE: -202.31, KL: 5.4562.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 8310 (34 ms): -205.17.
Step 8347 (35 ms): -206.66.
Step 8385 (34 ms): -224.89.
Step 8422 (34 ms): -221.57.
Step 8460 (34 ms): -208.06.
Step 8498 (34 ms): -213.02.
Step 8535 (34 ms): -215.42.
Step 8573 (35 ms): -215.04.
Step 8610 (36 ms): -197.09.
Step 8648 (17 ms): -241.35.

Epoch 23 (12.9 s):
    Evaluating model.
    Full set (6.13 s): ELBO: -207.34, ENRE: -201.96, KL: 5.38.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 8686 (35 ms): -215.54.
Step 8723 (36 ms): -193.55.
Step 8761 (35 ms): -206.51.
Step 8798 (35 ms): -212.89.
Step 8836 (34 ms): -198.07.
Step 8874 (35 ms): -209.33.
Step 8911 (34 ms): -196.26.
Step 8949 (34 ms): -211.67.
Step 8986 (34 ms): -198.4.
Step 9024 (17 ms): -328.2.

Epoch 24 (13 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -207.24, ENRE: -201.95, KL: 5.2921.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 9062 (34 ms): -197.97.
Step 9099 (35 ms): -198.5.
Step 9137 (34 ms): -196.25.
Step 9174 (34 ms): -202.1.
Step 9212 (35 ms): -200.11.
Step 9250 (35 ms): -207.01.
Step 9287 (34 ms): -207.26.
Step 9325 (34 ms): -211.74.
Step 9362 (34 ms): -194.99.
Step 9400 (17 ms): -282.16.

Epoch 25 (13 s):
    Evaluating model.
    Full set (6.1 s): ELBO: -206.97, ENRE: -201.7, KL: 5.2724.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 9438 (34 ms): -208.36.
Step 9475 (35 ms): -201.55.
Step 9513 (35 ms): -201.79.
Step 9550 (35 ms): -201.5.
Step 9588 (34 ms): -199.26.
Step 9626 (34 ms): -212.46.
Step 9663 (34 ms): -211.46.
Step 9701 (34 ms): -199.62.
Step 9738 (34 ms): -190.81.
Step 9776 (16 ms): -230.51.

Epoch 26 (12.9 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -205.89, ENRE: -200.75, KL: 5.1432.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 9814 (34 ms): -198.02.
Step 9851 (35 ms): -201.26.
Step 9889 (34 ms): -184.72.
Step 9926 (34 ms): -196.78.
Step 9964 (34 ms): -225.56.
Step 10002 (34 ms): -188.67.
Step 10039 (34 ms): -200.1.
Step 10077 (33 ms): -200.54.
Step 10114 (33 ms): -214.68.
Step 10152 (16 ms): -210.05.

Epoch 27 (12.8 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -205.77, ENRE: -200.55, KL: 5.2248.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 10190 (34 ms): -224.37.
Step 10227 (35 ms): -215.77.
Step 10265 (34 ms): -202.45.
Step 10302 (34 ms): -214.81.
Step 10340 (34 ms): -207.65.
Step 10378 (34 ms): -207.27.
Step 10415 (34 ms): -213.08.
Step 10453 (34 ms): -195.4.
Step 10490 (34 ms): -202.85.
Step 10528 (17 ms): -205.47.

Epoch 28 (12.9 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -205.04, ENRE: -199.7, KL: 5.341.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 10566 (35 ms): -202.05.
Step 10603 (35 ms): -201.26.
Step 10641 (34 ms): -196.83.
Step 10678 (35 ms): -210.04.
Step 10716 (34 ms): -218.47.
Step 10754 (35 ms): -189.64.
Step 10791 (34 ms): -207.19.
Step 10829 (34 ms): -198.78.
Step 10866 (34 ms): -204.43.
Step 10904 (16 ms): -289.83.

Epoch 29 (13 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -204.48, ENRE: -199.21, KL: 5.2714.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 10942 (35 ms): -195.34.
Step 10979 (34 ms): -213.22.
Step 11017 (34 ms): -215.78.
Step 11054 (35 ms): -196.69.
Step 11092 (34 ms): -201.54.
Step 11130 (35 ms): -211.36.
Step 11167 (35 ms): -207.02.
Step 11205 (35 ms): -215.9.
Step 11242 (37 ms): -199.87.
Step 11280 (16 ms): -207.38.

Epoch 30 (13.1 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -204.9, ENRE: -199.44, KL: 5.4573.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 11318 (34 ms): -196.21.
Step 11355 (34 ms): -201.91.
Step 11393 (34 ms): -202.83.
Step 11430 (34 ms): -208.92.
Step 11468 (34 ms): -208.27.
Step 11506 (34 ms): -214.57.
Step 11543 (34 ms): -193.39.
Step 11581 (34 ms): -207.59.
Step 11618 (34 ms): -213.19.
Step 11656 (16 ms): -387.25.

Epoch 31 (12.9 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -203.94, ENRE: -198.55, KL: 5.3858.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 11694 (35 ms): -195.94.
Step 11731 (34 ms): -202.94.
Step 11769 (34 ms): -202.17.
Step 11806 (34 ms): -199.78.
Step 11844 (35 ms): -196.34.
Step 11882 (34 ms): -214.03.
Step 11919 (36 ms): -203.71.
Step 11957 (35 ms): -202.67.
Step 11994 (35 ms): -198.86.
Step 12032 (16 ms): -248.51.

Epoch 32 (12.9 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -203.93, ENRE: -198.34, KL: 5.5901.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 12070 (34 ms): -201.35.
Step 12107 (34 ms): -197.88.
Step 12145 (34 ms): -193.4.
Step 12182 (34 ms): -206.07.
Step 12220 (34 ms): -193.3.
Step 12258 (34 ms): -211.08.
Step 12295 (33 ms): -219.16.
Step 12333 (33 ms): -202.7.
Step 12370 (34 ms): -207.33.
Step 12408 (16 ms): -366.6.

Epoch 33 (12.8 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -203.33, ENRE: -197.89, KL: 5.4488.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 12446 (34 ms): -187.05.
Step 12483 (36 ms): -200.26.
Step 12521 (34 ms): -199.07.
Step 12558 (34 ms): -192.81.
Step 12596 (34 ms): -208.44.
Step 12634 (35 ms): -204.18.
Step 12671 (35 ms): -208.44.
Step 12709 (35 ms): -233.11.
Step 12746 (35 ms): -206.98.
Step 12784 (17 ms): -218.34.

Epoch 34 (13 s):
    Evaluating model.
    Full set (6.1 s): ELBO: -203.45, ENRE: -197.96, KL: 5.4893.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 12822 (34 ms): -206.47.
Step 12859 (35 ms): -189.82.
Step 12897 (34 ms): -201.08.
Step 12934 (34 ms): -196.3.
Step 12972 (35 ms): -195.47.
Step 13010 (35 ms): -197.92.
Step 13047 (35 ms): -206.09.
Step 13085 (34 ms): -200.64.
Step 13122 (34 ms): -217.74.
Step 13160 (16 ms): -223.53.

Epoch 35 (13 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -202.7, ENRE: -197.18, KL: 5.5226.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 13198 (35 ms): -196.34.
Step 13235 (34 ms): -187.19.
Step 13273 (34 ms): -200.61.
Step 13310 (35 ms): -216.29.
Step 13348 (34 ms): -200.8.
Step 13386 (34 ms): -217.16.
Step 13423 (34 ms): -213.05.
Step 13461 (34 ms): -197.57.
Step 13498 (34 ms): -195.85.
Step 13536 (17 ms): -360.43.

Epoch 36 (12.9 s):
    Evaluating model.
    Full set (6.11 s): ELBO: -203.13, ENRE: -197.56, KL: 5.5696.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 13574 (34 ms): -189.37.
Step 13611 (34 ms): -198.38.
Step 13649 (34 ms): -197.17.
Step 13686 (34 ms): -197.28.
Step 13724 (34 ms): -218.27.
Step 13762 (34 ms): -193.7.
Step 13799 (34 ms): -198.42.
Step 13837 (34 ms): -209.75.
Step 13874 (34 ms): -190.24.
Step 13912 (16 ms): -218.22.

Epoch 37 (12.8 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -202.29, ENRE: -196.83, KL: 5.4622.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 13950 (34 ms): -226.04.
Step 13987 (34 ms): -209.8.
Step 14025 (34 ms): -198.45.
Step 14062 (34 ms): -211.
Step 14100 (34 ms): -205.48.
Step 14138 (36 ms): -200.39.
Step 14175 (34 ms): -189.92.
Step 14213 (34 ms): -208.24.
Step 14250 (34 ms): -205.26.
Step 14288 (16 ms): -179.3.

Epoch 38 (12.8 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -202.87, ENRE: -197.47, KL: 5.407.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 14326 (34 ms): -201.26.
Step 14363 (34 ms): -198.98.
Step 14401 (35 ms): -191.78.
Step 14438 (33 ms): -194.05.
Step 14476 (34 ms): -196.98.
Step 14514 (34 ms): -218.72.
Step 14551 (34 ms): -202.23.
Step 14589 (34 ms): -200.33.
Step 14626 (34 ms): -201.13.
Step 14664 (16 ms): -370.14.

Epoch 39 (12.8 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -202.05, ENRE: -196.59, KL: 5.4524.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 14702 (34 ms): -191.71.
Step 14739 (34 ms): -201.02.
Step 14777 (34 ms): -201.16.
Step 14814 (34 ms): -206.75.
Step 14852 (34 ms): -212.82.
Step 14890 (34 ms): -209.91.
Step 14927 (34 ms): -200.55.
Step 14965 (34 ms): -204.67.
Step 15002 (34 ms): -203.72.
Step 15040 (17 ms): -204.21.

Epoch 40 (12.9 s):
    Evaluating model.
    Full set (6.12 s): ELBO: -202.11, ENRE: -196.71, KL: 5.3928.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 15078 (35 ms): -193.57.
Step 15115 (34 ms): -205.6.
Step 15153 (34 ms): -203.67.
Step 15190 (35 ms): -201.18.
Step 15228 (34 ms): -197.65.
Step 15266 (34 ms): -205.31.
Step 15303 (35 ms): -198.44.
Step 15341 (35 ms): -196.43.
Step 15378 (34 ms): -191.34.
Step 15416 (17 ms): -245.73.

Epoch 41 (13.1 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -201.7, ENRE: -196.28, KL: 5.4135.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 15454 (34 ms): -202.72.
Step 15491 (34 ms): -207.84.
Step 15529 (34 ms): -206.81.
Step 15566 (34 ms): -191.52.
Step 15604 (34 ms): -197.63.
Step 15642 (34 ms): -195.86.
Step 15679 (35 ms): -189.2.
Step 15717 (34 ms): -195.97.
Step 15754 (34 ms): -194.75.
Step 15792 (16 ms): -233.11.

Epoch 42 (12.9 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -201.38, ENRE: -195.82, KL: 5.5615.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 15830 (34 ms): -208.1.
Step 15867 (34 ms): -201.02.
Step 15905 (34 ms): -194.33.
Step 15942 (35 ms): -187.02.
Step 15980 (35 ms): -202.27.
Step 16018 (34 ms): -194.42.
Step 16055 (34 ms): -187.54.
Step 16093 (34 ms): -205.58.
Step 16130 (34 ms): -213.36.
Step 16168 (17 ms): -249.77.

Epoch 43 (12.9 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -201.22, ENRE: -195.76, KL: 5.4675.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 16206 (34 ms): -204.09.
Step 16243 (34 ms): -195.2.
Step 16281 (34 ms): -205.8.
Step 16318 (34 ms): -200.81.
Step 16356 (36 ms): -203.31.
Step 16394 (34 ms): -200.65.
Step 16431 (34 ms): -201.59.
Step 16469 (33 ms): -196.51.
Step 16506 (34 ms): -191.87.
Step 16544 (16 ms): -314.92.

Epoch 44 (12.8 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -201.2, ENRE: -195.61, KL: 5.5934.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 16582 (34 ms): -196.67.
Step 16619 (34 ms): -202.57.
Step 16657 (34 ms): -204.46.
Step 16694 (34 ms): -200.76.
Step 16732 (34 ms): -192.55.
Step 16770 (34 ms): -204.07.
Step 16807 (35 ms): -203.71.
Step 16845 (34 ms): -197.12.
Step 16882 (35 ms): -217.06.
Step 16920 (16 ms): -202.27.

Epoch 45 (12.9 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -201.09, ENRE: -195.62, KL: 5.4711.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 16958 (35 ms): -196.16.
Step 16995 (34 ms): -198.41.
Step 17033 (34 ms): -185.52.
Step 17070 (35 ms): -200.54.
Step 17108 (34 ms): -205.48.
Step 17146 (34 ms): -204.1.
Step 17183 (35 ms): -207.98.
Step 17221 (34 ms): -213.46.
Step 17258 (35 ms): -215.98.
Step 17296 (17 ms): -219.63.

Epoch 46 (12.9 s):
    Evaluating model.
    Full set (6.1 s): ELBO: -200.93, ENRE: -195.43, KL: 5.5032.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 17334 (35 ms): -189.83.
Step 17371 (34 ms): -200.8.
Step 17409 (34 ms): -189.98.
Step 17446 (34 ms): -195.07.
Step 17484 (34 ms): -201.02.
Step 17522 (34 ms): -189.06.
Step 17559 (35 ms): -198.5.
Step 17597 (34 ms): -188.54.
Step 17634 (35 ms): -198.33.
Step 17672 (16 ms): -185.98.

Epoch 47 (13 s):
    Evaluating model.
    Full set (6.12 s): ELBO: -200.71, ENRE: -195.2, KL: 5.5135.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 17710 (34 ms): -203.21.
Step 17747 (34 ms): -190.95.
Step 17785 (35 ms): -190.14.
Step 17822 (34 ms): -194.29.
Step 17860 (34 ms): -188.19.
Step 17898 (35 ms): -192.82.
Step 17935 (36 ms): -202.35.
Step 17973 (36 ms): -205.86.
Step 18010 (34 ms): -197.85.
Step 18048 (16 ms): -248.75.

Epoch 48 (12.9 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -200.9, ENRE: -195.52, KL: 5.38.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 18086 (34 ms): -203.32.
Step 18123 (34 ms): -199.18.
Step 18161 (33 ms): -195.77.
Step 18198 (33 ms): -206.12.
Step 18236 (34 ms): -206.3.
Step 18274 (34 ms): -205.11.
Step 18311 (34 ms): -199.39.
Step 18349 (34 ms): -214.38.
Step 18386 (35 ms): -202.4.
Step 18424 (16 ms): -247.86.

Epoch 49 (12.8 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -200.87, ENRE: -195.27, KL: 5.5993.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 18462 (34 ms): -210.15.
Step 18499 (34 ms): -195.25.
Step 18537 (34 ms): -209.74.
Step 18574 (34 ms): -196.94.
Step 18612 (34 ms): -200.48.
Step 18650 (34 ms): -195.74.
Step 18687 (34 ms): -200.66.
Step 18725 (34 ms): -197.14.
Step 18762 (34 ms): -210.39.
Step 18800 (16 ms): -194.61.

Epoch 50 (12.8 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -200.45, ENRE: -194.95, KL: 5.4952.
    Saving model parameters.
    Model parameters saved (117 ms).

Model trained for 50 epochs (16m 1s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (909 ms).

Converting data set value array to sparse matrix.
Data set value array converted (315 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.96 s):  ELBO: -419.88, ENRE: -414.37, KL: 5.5055.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (774 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.0903994412216775
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 38
kl weight: 1.0903994412216775
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (48 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (3.99 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.68 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 38
    hidden sizes: 164, 280, 92, 273, 117
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.0903994412216775
    using analytical KL term
    using batch normalisation for minibatches
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 164)
    ENCODER/1/DENSE/biases:0             (164,)
    ENCODER/1/BATCH_NORM/beta:0          (164,)
    ENCODER/2/DENSE/weights:0            (164, 280)
    ENCODER/2/DENSE/biases:0             (280,)
    ENCODER/2/BATCH_NORM/beta:0          (280,)
    ENCODER/3/DENSE/weights:0            (280, 92)
    ENCODER/3/DENSE/biases:0             (92,)
    ENCODER/3/BATCH_NORM/beta:0          (92,)
    ENCODER/4/DENSE/weights:0            (92, 273)
    ENCODER/4/DENSE/biases:0             (273,)
    ENCODER/4/BATCH_NORM/beta:0          (273,)
    ENCODER/5/DENSE/weights:0            (273, 117)
    ENCODER/5/DENSE/biases:0             (117,)
    ENCODER/5/BATCH_NORM/beta:0          (117,)
    POSTERIOR/MU/DENSE/weights:0         (117, 38)
    POSTERIOR/MU/DENSE/biases:0          (38,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (117, 38)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (38,)
    DECODER/5/DENSE/weights:0            (38, 117)
    DECODER/5/DENSE/biases:0             (117,)
    DECODER/5/BATCH_NORM/beta:0          (117,)
    DECODER/4/DENSE/weights:0            (117, 273)
    DECODER/4/DENSE/biases:0             (273,)
    DECODER/4/BATCH_NORM/beta:0          (273,)
    DECODER/3/DENSE/weights:0            (273, 92)
    DECODER/3/DENSE/biases:0             (92,)
    DECODER/3/BATCH_NORM/beta:0          (92,)
    DECODER/2/DENSE/weights:0            (92, 280)
    DECODER/2/DENSE/biases:0             (280,)
    DECODER/2/BATCH_NORM/beta:0          (280,)
    DECODER/1/DENSE/weights:0            (280, 164)
    DECODER/1/DENSE/biases:0             (164,)
    DECODER/1/BATCH_NORM/beta:0          (164,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (164, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (544 ms).

Training model for 50 epochs on original values.

Step 38 (37 ms): -2123.1.
Step 75 (36 ms): -1772.7.
Step 113 (36 ms): -1482.2.
Step 150 (35 ms): -1267.8.
Step 188 (35 ms): -1082.3.
Step 226 (36 ms): -939.32.
Step 263 (35 ms): -803.39.
Step 301 (35 ms): -724.73.
Step 338 (35 ms): -645.13.
Step 376 (24 ms): -704.61.

Epoch 1 (16.2 s):
    Evaluating model.
    Full set (6.77 s): ELBO: -1739.9, ENRE: -1735.3, KL: 4.5372.
    Saving model parameters.
    Model parameters saved (196 ms).

Step 414 (35 ms): -526.42.
Step 451 (35 ms): -482.74.
Step 489 (36 ms): -456.26.
Step 526 (36 ms): -413.23.
Step 564 (35 ms): -381.
Step 602 (35 ms): -395.23.
Step 639 (35 ms): -354.24.
Step 677 (34 ms): -343.4.
Step 714 (35 ms): -321.23.
Step 752 (17 ms): -344.44.

Epoch 2 (13.2 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -871.23, ENRE: -865.99, KL: 5.2456.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 790 (36 ms): -309.21.
Step 827 (35 ms): -317.92.
Step 865 (36 ms): -303.88.
Step 902 (35 ms): -291.63.
Step 940 (35 ms): -288.57.
Step 978 (35 ms): -277.61.
Step 1015 (35 ms): -275.2.
Step 1053 (37 ms): -254.22.
Step 1090 (35 ms): -262.
Step 1128 (18 ms): -269.41.

Epoch 3 (13.3 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -492.58, ENRE: -487.13, KL: 5.4536.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 1166 (35 ms): -267.6.
Step 1203 (35 ms): -259.45.
Step 1241 (35 ms): -286.52.
Step 1278 (35 ms): -267.98.
Step 1316 (35 ms): -249.84.
Step 1354 (35 ms): -243.13.
Step 1391 (34 ms): -263.28.
Step 1429 (35 ms): -257.
Step 1466 (35 ms): -251.25.
Step 1504 (16 ms): -233.7.

Epoch 4 (13.1 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -348.8, ENRE: -343.19, KL: 5.6085.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 1542 (35 ms): -252.03.
Step 1579 (35 ms): -271.02.
Step 1617 (35 ms): -256.33.
Step 1654 (36 ms): -228.67.
Step 1692 (35 ms): -230.97.
Step 1730 (35 ms): -266.11.
Step 1767 (35 ms): -252.19.
Step 1805 (35 ms): -243.51.
Step 1842 (34 ms): -229.59.
Step 1880 (17 ms): -264.33.

Epoch 5 (13.1 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -288.9, ENRE: -283.04, KL: 5.8577.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 1918 (34 ms): -223.1.
Step 1955 (35 ms): -266.92.
Step 1993 (35 ms): -244.9.
Step 2030 (35 ms): -227.14.
Step 2068 (35 ms): -224.72.
Step 2106 (35 ms): -232.72.
Step 2143 (35 ms): -234.72.
Step 2181 (35 ms): -233.16.
Step 2218 (35 ms): -228.1.
Step 2256 (16 ms): -227.6.

Epoch 6 (13.1 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -257.84, ENRE: -251.5, KL: 6.3431.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 2294 (36 ms): -257.25.
Step 2331 (36 ms): -226.06.
Step 2369 (35 ms): -236.24.
Step 2406 (36 ms): -227.3.
Step 2444 (36 ms): -218.62.
Step 2482 (36 ms): -249.88.
Step 2519 (36 ms): -254.63.
Step 2557 (36 ms): -232.93.
Step 2594 (35 ms): -225.01.
Step 2632 (17 ms): -233.17.

Epoch 7 (13.3 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -239.32, ENRE: -232.96, KL: 6.3557.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 2670 (35 ms): -228.04.
Step 2707 (36 ms): -221.43.
Step 2745 (35 ms): -235.13.
Step 2782 (35 ms): -217.42.
Step 2820 (35 ms): -209.2.
Step 2858 (36 ms): -227.74.
Step 2895 (35 ms): -213.83.
Step 2933 (35 ms): -213.98.
Step 2970 (35 ms): -225.04.
Step 3008 (17 ms): -420.16.

Epoch 8 (13.2 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -230.27, ENRE: -223.58, KL: 6.6905.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 3046 (35 ms): -223.07.
Step 3083 (35 ms): -216.87.
Step 3121 (35 ms): -238.42.
Step 3158 (35 ms): -216.87.
Step 3196 (36 ms): -225.57.
Step 3234 (36 ms): -227.1.
Step 3271 (35 ms): -223.32.
Step 3309 (35 ms): -224.44.
Step 3346 (36 ms): -206.33.
Step 3384 (17 ms): -228.34.

Epoch 9 (13.2 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -225.83, ENRE: -219.46, KL: 6.3751.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 3422 (35 ms): -234.05.
Step 3459 (34 ms): -229.54.
Step 3497 (34 ms): -224.6.
Step 3534 (34 ms): -211.8.
Step 3572 (35 ms): -227.64.
Step 3610 (35 ms): -205.89.
Step 3647 (35 ms): -216.5.
Step 3685 (34 ms): -231.47.
Step 3722 (34 ms): -210.13.
Step 3760 (16 ms): -253.84.

Epoch 10 (13.1 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -221.23, ENRE: -214.55, KL: 6.6834.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 3798 (34 ms): -210.86.
Step 3835 (34 ms): -215.01.
Step 3873 (34 ms): -215.53.
Step 3910 (34 ms): -215.43.
Step 3948 (34 ms): -221.34.
Step 3986 (34 ms): -210.34.
Step 4023 (34 ms): -232.49.
Step 4061 (35 ms): -202.26.
Step 4098 (35 ms): -212.09.
Step 4136 (16 ms): -245.49.

Epoch 11 (13.1 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -218.18, ENRE: -211.53, KL: 6.6492.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 4174 (34 ms): -207.54.
Step 4211 (35 ms): -226.4.
Step 4249 (35 ms): -234.7.
Step 4286 (34 ms): -224.22.
Step 4324 (35 ms): -214.87.
Step 4362 (34 ms): -203.38.
Step 4399 (35 ms): -220.06.
Step 4437 (35 ms): -215.39.
Step 4474 (34 ms): -209.22.
Step 4512 (17 ms): -331.29.

Epoch 12 (13.1 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -216.49, ENRE: -210.04, KL: 6.4522.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 4550 (35 ms): -238.28.
Step 4587 (34 ms): -197.59.
Step 4625 (36 ms): -215.65.
Step 4662 (35 ms): -223.39.
Step 4700 (36 ms): -205.55.
Step 4738 (34 ms): -207.26.
Step 4775 (35 ms): -202.33.
Step 4813 (35 ms): -217.3.
Step 4850 (35 ms): -215.85.
Step 4888 (17 ms): -190.34.

Epoch 13 (13.3 s):
    Evaluating model.
    Full set (6.1 s): ELBO: -214.5, ENRE: -208.28, KL: 6.224.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 4926 (37 ms): -201.78.
Step 4963 (35 ms): -212.8.
Step 5001 (35 ms): -213.08.
Step 5038 (35 ms): -222.36.
Step 5076 (36 ms): -208.01.
Step 5114 (35 ms): -211.96.
Step 5151 (35 ms): -204.17.
Step 5189 (35 ms): -209.85.
Step 5226 (35 ms): -208.85.
Step 5264 (17 ms): -287.62.

Epoch 14 (13.2 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -213.83, ENRE: -207.65, KL: 6.1728.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 5302 (35 ms): -216.9.
Step 5339 (35 ms): -213.05.
Step 5377 (35 ms): -218.76.
Step 5414 (35 ms): -224.64.
Step 5452 (35 ms): -211.03.
Step 5490 (35 ms): -219.79.
Step 5527 (35 ms): -200.34.
Step 5565 (35 ms): -206.63.
Step 5602 (35 ms): -216.17.
Step 5640 (16 ms): -254.45.

Epoch 15 (13.2 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -213.34, ENRE: -207.16, KL: 6.1769.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 5678 (36 ms): -204.27.
Step 5715 (35 ms): -215.54.
Step 5753 (35 ms): -217.13.
Step 5790 (35 ms): -211.12.
Step 5828 (34 ms): -220.95.
Step 5866 (34 ms): -201.12.
Step 5903 (35 ms): -222.74.
Step 5941 (34 ms): -198.98.
Step 5978 (35 ms): -200.78.
Step 6016 (16 ms): -226.9.

Epoch 16 (13.1 s):
    Evaluating model.
    Full set (6 s): ELBO: -212.29, ENRE: -206.27, KL: 6.0246.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 6054 (35 ms): -199.54.
Step 6091 (35 ms): -214.97.
Step 6129 (34 ms): -204.84.
Step 6166 (35 ms): -205.64.
Step 6204 (34 ms): -195.76.
Step 6242 (34 ms): -200.49.
Step 6279 (35 ms): -201.31.
Step 6317 (35 ms): -207.57.
Step 6354 (34 ms): -197.4.
Step 6392 (17 ms): -227.59.

Epoch 17 (13 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -211.43, ENRE: -205.34, KL: 6.0892.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 6430 (35 ms): -231.88.
Step 6467 (35 ms): -222.15.
Step 6505 (36 ms): -205.65.
Step 6542 (35 ms): -199.56.
Step 6580 (36 ms): -211.51.
Step 6618 (35 ms): -204.8.
Step 6655 (35 ms): -197.09.
Step 6693 (35 ms): -222.
Step 6730 (35 ms): -213.3.
Step 6768 (17 ms): -269.18.

Epoch 18 (13.2 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -209.61, ENRE: -203.55, KL: 6.0642.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 6806 (35 ms): -204.08.
Step 6843 (35 ms): -213.6.
Step 6881 (35 ms): -194.46.
Step 6918 (35 ms): -192.98.
Step 6956 (35 ms): -212.19.
Step 6994 (35 ms): -211.49.
Step 7031 (36 ms): -211.74.
Step 7069 (35 ms): -209.13.
Step 7106 (35 ms): -219.12.
Step 7144 (17 ms): -458.6.

Epoch 19 (13.2 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -209.52, ENRE: -203.46, KL: 6.0572.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 7182 (34 ms): -200.56.
Step 7219 (35 ms): -192.92.
Step 7257 (36 ms): -210.28.
Step 7294 (35 ms): -205.08.
Step 7332 (35 ms): -206.46.
Step 7370 (35 ms): -202.04.
Step 7407 (35 ms): -202.68.
Step 7445 (35 ms): -204.04.
Step 7482 (35 ms): -213.33.
Step 7520 (16 ms): -423.23.

Epoch 20 (13.3 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -208.39, ENRE: -202.43, KL: 5.9542.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 7558 (35 ms): -223.13.
Step 7595 (35 ms): -209.2.
Step 7633 (35 ms): -205.08.
Step 7670 (34 ms): -212.27.
Step 7708 (35 ms): -216.24.
Step 7746 (35 ms): -199.71.
Step 7783 (35 ms): -199.5.
Step 7821 (35 ms): -204.88.
Step 7858 (35 ms): -206.99.
Step 7896 (16 ms): -461.4.

Epoch 21 (13.1 s):
    Evaluating model.
    Full set (6 s): ELBO: -207.21, ENRE: -201.31, KL: 5.8979.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 7934 (35 ms): -218.36.
Step 7971 (34 ms): -192.01.
Step 8009 (35 ms): -216.05.
Step 8046 (35 ms): -200.6.
Step 8084 (35 ms): -199.51.
Step 8122 (36 ms): -216.22.
Step 8159 (35 ms): -196.6.
Step 8197 (35 ms): -207.72.
Step 8234 (35 ms): -202.37.
Step 8272 (16 ms): -197.75.

Epoch 22 (13.1 s):
    Evaluating model.
    Full set (6 s): ELBO: -206.82, ENRE: -201.08, KL: 5.7428.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 8310 (36 ms): -200.5.
Step 8347 (35 ms): -204.93.
Step 8385 (34 ms): -203.26.
Step 8422 (35 ms): -198.11.
Step 8460 (34 ms): -206.03.
Step 8498 (35 ms): -213.61.
Step 8535 (35 ms): -204.64.
Step 8573 (35 ms): -197.38.
Step 8610 (35 ms): -191.89.
Step 8648 (16 ms): -248.97.

Epoch 23 (13 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -206.33, ENRE: -200.53, KL: 5.8054.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 8686 (34 ms): -197.23.
Step 8723 (34 ms): -198.25.
Step 8761 (35 ms): -220.71.
Step 8798 (36 ms): -196.04.
Step 8836 (35 ms): -200.92.
Step 8874 (35 ms): -207.67.
Step 8911 (35 ms): -198.46.
Step 8949 (35 ms): -204.41.
Step 8986 (35 ms): -212.73.
Step 9024 (19 ms): -238.92.

Epoch 24 (13.2 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -206.67, ENRE: -200.77, KL: 5.899.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 9062 (36 ms): -200.64.
Step 9099 (35 ms): -195.83.
Step 9137 (35 ms): -215.26.
Step 9174 (35 ms): -201.51.
Step 9212 (35 ms): -199.67.
Step 9250 (35 ms): -221.3.
Step 9287 (35 ms): -202.58.
Step 9325 (35 ms): -201.61.
Step 9362 (35 ms): -198.92.
Step 9400 (17 ms): -261.2.

Epoch 25 (13.2 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -205.51, ENRE: -199.73, KL: 5.7885.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 9438 (35 ms): -200.
Step 9475 (35 ms): -206.8.
Step 9513 (37 ms): -218.27.
Step 9550 (37 ms): -199.68.
Step 9588 (36 ms): -200.58.
Step 9626 (35 ms): -207.27.
Step 9663 (35 ms): -205.14.
Step 9701 (35 ms): -212.72.
Step 9738 (35 ms): -208.37.
Step 9776 (17 ms): -231.28.

Epoch 26 (13.3 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -206.04, ENRE: -200.3, KL: 5.7381.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 9814 (35 ms): -193.54.
Step 9851 (35 ms): -206.06.
Step 9889 (34 ms): -209.61.
Step 9926 (35 ms): -192.59.
Step 9964 (35 ms): -194.9.
Step 10002 (35 ms): -202.66.
Step 10039 (35 ms): -220.42.
Step 10077 (35 ms): -196.15.
Step 10114 (36 ms): -197.55.
Step 10152 (16 ms): -215.14.

Epoch 27 (13.1 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -204.73, ENRE: -198.87, KL: 5.8578.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 10190 (35 ms): -207.9.
Step 10227 (36 ms): -196.61.
Step 10265 (35 ms): -194.31.
Step 10302 (37 ms): -215.91.
Step 10340 (35 ms): -195.86.
Step 10378 (35 ms): -196.56.
Step 10415 (35 ms): -195.03.
Step 10453 (35 ms): -212.11.
Step 10490 (35 ms): -197.44.
Step 10528 (16 ms): -191.37.

Epoch 28 (13.1 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -204.52, ENRE: -198.81, KL: 5.7051.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 10566 (35 ms): -192.42.
Step 10603 (35 ms): -205.97.
Step 10641 (34 ms): -190.96.
Step 10678 (34 ms): -191.94.
Step 10716 (34 ms): -200.54.
Step 10754 (35 ms): -233.25.
Step 10791 (35 ms): -203.44.
Step 10829 (35 ms): -210.67.
Step 10866 (35 ms): -216.13.
Step 10904 (16 ms): -210.05.

Epoch 29 (13.1 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -204.11, ENRE: -198.39, KL: 5.7201.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 10942 (35 ms): -202.82.
Step 10979 (35 ms): -197.75.
Step 11017 (35 ms): -202.5.
Step 11054 (35 ms): -212.74.
Step 11092 (35 ms): -219.96.
Step 11130 (35 ms): -200.54.
Step 11167 (34 ms): -205.36.
Step 11205 (35 ms): -193.09.
Step 11242 (35 ms): -204.57.
Step 11280 (17 ms): -197.84.

Epoch 30 (13.2 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -203.82, ENRE: -198.03, KL: 5.7922.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 11318 (36 ms): -208.03.
Step 11355 (35 ms): -205.23.
Step 11393 (36 ms): -195.9.
Step 11430 (35 ms): -201.31.
Step 11468 (35 ms): -190.69.
Step 11506 (36 ms): -201.93.
Step 11543 (35 ms): -203.6.
Step 11581 (35 ms): -211.1.
Step 11618 (34 ms): -201.06.
Step 11656 (17 ms): -257.63.

Epoch 31 (13.3 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -203.46, ENRE: -197.74, KL: 5.7203.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 11694 (35 ms): -210.31.
Step 11731 (35 ms): -207.17.
Step 11769 (35 ms): -193.28.
Step 11806 (35 ms): -195.78.
Step 11844 (35 ms): -209.54.
Step 11882 (35 ms): -203.95.
Step 11919 (35 ms): -198.28.
Step 11957 (36 ms): -205.47.
Step 11994 (35 ms): -208.52.
Step 12032 (16 ms): -247.3.

Epoch 32 (13.2 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -203.04, ENRE: -197.35, KL: 5.6853.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 12070 (35 ms): -198.42.
Step 12107 (36 ms): -225.17.
Step 12145 (35 ms): -195.88.
Step 12182 (36 ms): -198.15.
Step 12220 (35 ms): -205.62.
Step 12258 (35 ms): -211.72.
Step 12295 (39 ms): -209.72.
Step 12333 (35 ms): -216.95.
Step 12370 (34 ms): -189.09.
Step 12408 (16 ms): -285.51.

Epoch 33 (13.2 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -203.03, ENRE: -197.32, KL: 5.7104.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 12446 (34 ms): -199.03.
Step 12483 (34 ms): -207.11.
Step 12521 (35 ms): -203.07.
Step 12558 (35 ms): -202.08.
Step 12596 (35 ms): -191.13.
Step 12634 (34 ms): -195.12.
Step 12671 (35 ms): -202.83.
Step 12709 (34 ms): -199.69.
Step 12746 (34 ms): -208.65.
Step 12784 (16 ms): -234.32.

Epoch 34 (13 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -202.67, ENRE: -196.93, KL: 5.7353.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 12822 (34 ms): -213.31.
Step 12859 (34 ms): -213.37.
Step 12897 (35 ms): -203.68.
Step 12934 (35 ms): -198.05.
Step 12972 (35 ms): -206.71.
Step 13010 (36 ms): -213.94.
Step 13047 (35 ms): -192.76.
Step 13085 (35 ms): -206.02.
Step 13122 (35 ms): -201.69.
Step 13160 (17 ms): -192.53.

Epoch 35 (13.1 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -202.95, ENRE: -197.22, KL: 5.7294.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 13198 (35 ms): -191.44.
Step 13235 (35 ms): -200.7.
Step 13273 (35 ms): -200.49.
Step 13310 (35 ms): -198.5.
Step 13348 (35 ms): -211.12.
Step 13386 (35 ms): -204.51.
Step 13423 (35 ms): -211.73.
Step 13461 (35 ms): -203.52.
Step 13498 (35 ms): -200.09.
Step 13536 (17 ms): -379.75.

Epoch 36 (13.2 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -202.45, ENRE: -196.7, KL: 5.7525.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 13574 (35 ms): -203.61.
Step 13611 (35 ms): -215.73.
Step 13649 (35 ms): -195.05.
Step 13686 (35 ms): -202.79.
Step 13724 (36 ms): -188.89.
Step 13762 (35 ms): -223.2.
Step 13799 (35 ms): -219.59.
Step 13837 (35 ms): -206.69.
Step 13874 (35 ms): -202.26.
Step 13912 (17 ms): -335.09.

Epoch 37 (13.3 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -202.13, ENRE: -196.2, KL: 5.9284.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 13950 (35 ms): -195.48.
Step 13987 (35 ms): -208.31.
Step 14025 (35 ms): -200.68.
Step 14062 (35 ms): -192.14.
Step 14100 (35 ms): -208.51.
Step 14138 (35 ms): -218.31.
Step 14175 (35 ms): -204.9.
Step 14213 (35 ms): -203.35.
Step 14250 (35 ms): -219.4.
Step 14288 (17 ms): -272.08.

Epoch 38 (13.2 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -202.18, ENRE: -196.36, KL: 5.8202.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 14326 (35 ms): -213.86.
Step 14363 (35 ms): -197.98.
Step 14401 (34 ms): -215.67.
Step 14438 (35 ms): -204.17.
Step 14476 (36 ms): -210.06.
Step 14514 (36 ms): -204.68.
Step 14551 (37 ms): -202.66.
Step 14589 (37 ms): -203.65.
Step 14626 (35 ms): -202.66.
Step 14664 (18 ms): -188.63.

Epoch 39 (13.1 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -202.17, ENRE: -196.21, KL: 5.9645.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 14702 (35 ms): -205.54.
Step 14739 (34 ms): -188.55.
Step 14777 (35 ms): -197.06.
Step 14814 (34 ms): -199.28.
Step 14852 (35 ms): -207.75.
Step 14890 (35 ms): -219.76.
Step 14927 (34 ms): -196.79.
Step 14965 (35 ms): -213.44.
Step 15002 (35 ms): -207.64.
Step 15040 (17 ms): -286.84.

Epoch 40 (13 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -201.29, ENRE: -195.41, KL: 5.8796.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 15078 (36 ms): -199.22.
Step 15115 (37 ms): -205.51.
Step 15153 (35 ms): -197.75.
Step 15190 (35 ms): -194.66.
Step 15228 (35 ms): -189.99.
Step 15266 (35 ms): -216.69.
Step 15303 (35 ms): -201.88.
Step 15341 (36 ms): -215.18.
Step 15378 (35 ms): -197.11.
Step 15416 (17 ms): -187.76.

Epoch 41 (13.2 s):
    Evaluating model.
    Full set (6.13 s): ELBO: -201.08, ENRE: -195.2, KL: 5.8783.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 15454 (35 ms): -193.15.
Step 15491 (35 ms): -199.2.
Step 15529 (35 ms): -202.24.
Step 15566 (35 ms): -190.58.
Step 15604 (34 ms): -208.38.
Step 15642 (35 ms): -196.75.
Step 15679 (35 ms): -193.71.
Step 15717 (35 ms): -199.8.
Step 15754 (35 ms): -202.67.
Step 15792 (17 ms): -209.6.

Epoch 42 (13.2 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -201.15, ENRE: -195.32, KL: 5.83.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 15830 (35 ms): -197.37.
Step 15867 (36 ms): -203.87.
Step 15905 (35 ms): -195.92.
Step 15942 (35 ms): -208.58.
Step 15980 (35 ms): -200.19.
Step 16018 (35 ms): -205.52.
Step 16055 (35 ms): -196.78.
Step 16093 (35 ms): -194.63.
Step 16130 (35 ms): -206.18.
Step 16168 (17 ms): -249.94.

Epoch 43 (13.2 s):
    Evaluating model.
    Full set (6.1 s): ELBO: -200.87, ENRE: -195.03, KL: 5.8395.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 16206 (35 ms): -205.81.
Step 16243 (35 ms): -192.41.
Step 16281 (35 ms): -197.66.
Step 16318 (35 ms): -200.99.
Step 16356 (35 ms): -213.88.
Step 16394 (35 ms): -208.14.
Step 16431 (35 ms): -199.35.
Step 16469 (34 ms): -207.08.
Step 16506 (35 ms): -204.13.
Step 16544 (17 ms): -350.49.

Epoch 44 (13.2 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -201.38, ENRE: -195.49, KL: 5.8901.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 16582 (35 ms): -208.82.
Step 16619 (34 ms): -207.66.
Step 16657 (35 ms): -189.01.
Step 16694 (34 ms): -198.79.
Step 16732 (34 ms): -211.27.
Step 16770 (34 ms): -199.66.
Step 16807 (35 ms): -204.68.
Step 16845 (34 ms): -196.45.
Step 16882 (34 ms): -202.74.
Step 16920 (16 ms): -191.5.

Epoch 45 (13 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -200.83, ENRE: -194.92, KL: 5.918.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 16958 (35 ms): -190.75.
Step 16995 (35 ms): -205.97.
Step 17033 (35 ms): -197.75.
Step 17070 (36 ms): -188.77.
Step 17108 (35 ms): -215.85.
Step 17146 (35 ms): -197.59.
Step 17183 (35 ms): -209.05.
Step 17221 (35 ms): -197.71.
Step 17258 (35 ms): -206.68.
Step 17296 (17 ms): -401.49.

Epoch 46 (13.2 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -200.86, ENRE: -195.02, KL: 5.8417.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 17334 (35 ms): -203.35.
Step 17371 (36 ms): -202.55.
Step 17409 (35 ms): -201.64.
Step 17446 (35 ms): -202.9.
Step 17484 (36 ms): -212.75.
Step 17522 (35 ms): -198.77.
Step 17559 (35 ms): -199.73.
Step 17597 (36 ms): -205.96.
Step 17634 (35 ms): -186.22.
Step 17672 (17 ms): -251.17.

Epoch 47 (13.2 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -200.53, ENRE: -194.69, KL: 5.843.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 17710 (35 ms): -198.06.
Step 17747 (36 ms): -203.75.
Step 17785 (35 ms): -200.6.
Step 17822 (36 ms): -204.08.
Step 17860 (35 ms): -218.26.
Step 17898 (36 ms): -201.56.
Step 17935 (36 ms): -204.56.
Step 17973 (35 ms): -209.62.
Step 18010 (35 ms): -196.85.
Step 18048 (17 ms): -236.08.

Epoch 48 (13.3 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -200.39, ENRE: -194.58, KL: 5.8067.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 18086 (35 ms): -195.96.
Step 18123 (35 ms): -199.03.
Step 18161 (35 ms): -197.9.
Step 18198 (35 ms): -197.79.
Step 18236 (35 ms): -206.5.
Step 18274 (36 ms): -202.21.
Step 18311 (35 ms): -200.32.
Step 18349 (35 ms): -214.9.
Step 18386 (35 ms): -213.43.
Step 18424 (16 ms): -203.88.

Epoch 49 (13.2 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -200.71, ENRE: -194.81, KL: 5.9029.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 18462 (36 ms): -199.76.
Step 18499 (35 ms): -200.64.
Step 18537 (34 ms): -194.5.
Step 18574 (35 ms): -204.78.
Step 18612 (35 ms): -194.36.
Step 18650 (35 ms): -205.45.
Step 18687 (35 ms): -192.6.
Step 18725 (35 ms): -199.14.
Step 18762 (35 ms): -201.3.
Step 18800 (16 ms): -240.93.

Epoch 50 (13.1 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -200.38, ENRE: -194.45, KL: 5.9371.
    Saving model parameters.
    Model parameters saved (116 ms).

Model trained for 50 epochs (16m 13s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (913 ms).

Converting data set value array to sparse matrix.
Data set value array converted (311 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2.21 s):  ELBO: -420.36, ENRE: -414.43, KL: 5.9389.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (765 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.4140079376027026
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 40
kl weight: 1.4140079376027026
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (45 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.18 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.89 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 40
    hidden sizes: 136, 217, 66, 300, 118
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.4140079376027026
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 1 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 136)
    ENCODER/1/DENSE/biases:0             (136,)
    ENCODER/1/BATCH_NORM/beta:0          (136,)
    ENCODER/2/DENSE/weights:0            (136, 217)
    ENCODER/2/DENSE/biases:0             (217,)
    ENCODER/2/BATCH_NORM/beta:0          (217,)
    ENCODER/3/DENSE/weights:0            (217, 66)
    ENCODER/3/DENSE/biases:0             (66,)
    ENCODER/3/BATCH_NORM/beta:0          (66,)
    ENCODER/4/DENSE/weights:0            (66, 300)
    ENCODER/4/DENSE/biases:0             (300,)
    ENCODER/4/BATCH_NORM/beta:0          (300,)
    ENCODER/5/DENSE/weights:0            (300, 118)
    ENCODER/5/DENSE/biases:0             (118,)
    ENCODER/5/BATCH_NORM/beta:0          (118,)
    POSTERIOR/MU/DENSE/weights:0         (118, 40)
    POSTERIOR/MU/DENSE/biases:0          (40,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (118, 40)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (40,)
    DECODER/5/DENSE/weights:0            (40, 118)
    DECODER/5/DENSE/biases:0             (118,)
    DECODER/5/BATCH_NORM/beta:0          (118,)
    DECODER/4/DENSE/weights:0            (118, 300)
    DECODER/4/DENSE/biases:0             (300,)
    DECODER/4/BATCH_NORM/beta:0          (300,)
    DECODER/3/DENSE/weights:0            (300, 66)
    DECODER/3/DENSE/biases:0             (66,)
    DECODER/3/BATCH_NORM/beta:0          (66,)
    DECODER/2/DENSE/weights:0            (66, 217)
    DECODER/2/DENSE/biases:0             (217,)
    DECODER/2/BATCH_NORM/beta:0          (217,)
    DECODER/1/DENSE/weights:0            (217, 136)
    DECODER/1/DENSE/biases:0             (136,)
    DECODER/1/BATCH_NORM/beta:0          (136,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (136, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (541 ms).

Training model for 50 epochs on original values.

Step 38 (33 ms): -2209.7.
Step 75 (33 ms): -1856.
Step 113 (33 ms): -1631.5.
Step 150 (33 ms): -1396.6.
Step 188 (34 ms): -1268.9.
Step 226 (33 ms): -1135.4.
Step 263 (33 ms): -1003.9.
Step 301 (33 ms): -886.45.
Step 338 (34 ms): -803.27.
Step 376 (20 ms): -952.53.

Epoch 1 (15.3 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.53 s): ELBO: -1759.2, ENRE: -1752.4, KL: 6.8383.
    Saving model parameters.
    Model parameters saved (196 ms).

Step 414 (35 ms): -636.28.
Step 451 (33 ms): -587.19.
Step 489 (34 ms): -528.24.
Step 526 (33 ms): -493.87.
Step 564 (33 ms): -454.7.
Step 602 (34 ms): -421.61.
Step 639 (34 ms): -414.12.
Step 677 (34 ms): -386.53.
Step 714 (33 ms): -377.6.
Step 752 (16 ms): -344.17.

Epoch 2 (12.5 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -976.08, ENRE: -970.37, KL: 5.7007.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 790 (33 ms): -359.19.
Step 827 (34 ms): -362.08.
Step 865 (33 ms): -329.56.
Step 902 (33 ms): -334.44.
Step 940 (33 ms): -313.31.
Step 978 (33 ms): -315.45.
Step 1015 (34 ms): -297.59.
Step 1053 (34 ms): -297.79.
Step 1090 (33 ms): -287.32.
Step 1128 (20 ms): -293.8.

Epoch 3 (12.6 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -544.09, ENRE: -538.68, KL: 5.4116.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 1166 (33 ms): -262.4.
Step 1203 (34 ms): -276.47.
Step 1241 (33 ms): -271.7.
Step 1278 (33 ms): -263.41.
Step 1316 (33 ms): -265.04.
Step 1354 (33 ms): -268.93.
Step 1391 (32 ms): -267.94.
Step 1429 (33 ms): -273.44.
Step 1466 (33 ms): -271.79.
Step 1504 (15 ms): -460.7.

Epoch 4 (12.4 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -380.28, ENRE: -375.18, KL: 5.1076.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 1542 (33 ms): -253.74.
Step 1579 (32 ms): -260.3.
Step 1617 (33 ms): -244.42.
Step 1654 (33 ms): -246.38.
Step 1692 (33 ms): -256.55.
Step 1730 (33 ms): -273.94.
Step 1767 (32 ms): -254.85.
Step 1805 (33 ms): -246.95.
Step 1842 (33 ms): -250.74.
Step 1880 (15 ms): -252.36.

Epoch 5 (12.3 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -306.25, ENRE: -301.02, KL: 5.2281.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 1918 (32 ms): -237.01.
Step 1955 (32 ms): -241.47.
Step 1993 (33 ms): -258.55.
Step 2030 (33 ms): -246.24.
Step 2068 (33 ms): -237.99.
Step 2106 (33 ms): -248.1.
Step 2143 (32 ms): -232.11.
Step 2181 (33 ms): -245.92.
Step 2218 (33 ms): -228.2.
Step 2256 (15 ms): -206.14.

Epoch 6 (12.3 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -268.92, ENRE: -263.74, KL: 5.1818.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 2294 (33 ms): -248.45.
Step 2331 (33 ms): -221.97.
Step 2369 (33 ms): -232.35.
Step 2406 (33 ms): -240.34.
Step 2444 (33 ms): -220.91.
Step 2482 (32 ms): -227.08.
Step 2519 (33 ms): -223.41.
Step 2557 (33 ms): -229.69.
Step 2594 (33 ms): -226.77.
Step 2632 (16 ms): -220.89.

Epoch 7 (12.4 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -249.09, ENRE: -243.69, KL: 5.3985.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 2670 (33 ms): -250.87.
Step 2707 (33 ms): -232.14.
Step 2745 (32 ms): -250.53.
Step 2782 (33 ms): -225.56.
Step 2820 (34 ms): -225.91.
Step 2858 (33 ms): -226.06.
Step 2895 (33 ms): -234.34.
Step 2933 (33 ms): -229.36.
Step 2970 (33 ms): -216.11.
Step 3008 (16 ms): -281.22.

Epoch 8 (12.6 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -237.78, ENRE: -232.26, KL: 5.523.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 3046 (34 ms): -224.75.
Step 3083 (33 ms): -246.36.
Step 3121 (33 ms): -214.01.
Step 3158 (34 ms): -219.13.
Step 3196 (33 ms): -223.22.
Step 3234 (33 ms): -224.38.
Step 3271 (33 ms): -222.59.
Step 3309 (33 ms): -206.83.
Step 3346 (34 ms): -243.52.
Step 3384 (16 ms): -1056.

Epoch 9 (12.5 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -229.24, ENRE: -223.78, KL: 5.4599.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 3422 (33 ms): -247.99.
Step 3459 (33 ms): -210.44.
Step 3497 (33 ms): -211.05.
Step 3534 (33 ms): -228.6.
Step 3572 (33 ms): -206.16.
Step 3610 (34 ms): -234.69.
Step 3647 (33 ms): -220.78.
Step 3685 (33 ms): -216.88.
Step 3722 (32 ms): -214.17.
Step 3760 (16 ms): -206.34.

Epoch 10 (12.4 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -224.34, ENRE: -218.71, KL: 5.6243.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 3798 (34 ms): -229.44.
Step 3835 (33 ms): -225.47.
Step 3873 (32 ms): -225.37.
Step 3910 (33 ms): -214.78.
Step 3948 (33 ms): -215.28.
Step 3986 (33 ms): -213.67.
Step 4023 (33 ms): -209.78.
Step 4061 (32 ms): -232.54.
Step 4098 (34 ms): -243.41.
Step 4136 (15 ms): -498.46.

Epoch 11 (12.3 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -221.22, ENRE: -215.56, KL: 5.664.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 4174 (33 ms): -200.1.
Step 4211 (33 ms): -217.8.
Step 4249 (33 ms): -233.38.
Step 4286 (32 ms): -221.6.
Step 4324 (33 ms): -231.32.
Step 4362 (32 ms): -230.41.
Step 4399 (33 ms): -216.41.
Step 4437 (33 ms): -221.75.
Step 4474 (33 ms): -201.19.
Step 4512 (15 ms): -216.88.

Epoch 12 (12.3 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -218.8, ENRE: -213.18, KL: 5.623.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 4550 (33 ms): -205.26.
Step 4587 (33 ms): -210.91.
Step 4625 (33 ms): -218.
Step 4662 (33 ms): -206.92.
Step 4700 (33 ms): -235.15.
Step 4738 (33 ms): -204.38.
Step 4775 (32 ms): -206.07.
Step 4813 (33 ms): -207.03.
Step 4850 (33 ms): -215.31.
Step 4888 (16 ms): -262.45.

Epoch 13 (12.4 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -217.55, ENRE: -211.94, KL: 5.61.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 4926 (33 ms): -207.13.
Step 4963 (33 ms): -225.1.
Step 5001 (33 ms): -207.27.
Step 5038 (34 ms): -210.98.
Step 5076 (33 ms): -221.36.
Step 5114 (32 ms): -211.75.
Step 5151 (32 ms): -211.68.
Step 5189 (33 ms): -207.84.
Step 5226 (33 ms): -213.93.
Step 5264 (16 ms): -253.01.

Epoch 14 (12.5 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -215.42, ENRE: -209.74, KL: 5.6802.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 5302 (33 ms): -221.21.
Step 5339 (33 ms): -216.36.
Step 5377 (34 ms): -220.64.
Step 5414 (34 ms): -210.51.
Step 5452 (34 ms): -198.73.
Step 5490 (33 ms): -215.27.
Step 5527 (33 ms): -213.65.
Step 5565 (33 ms): -212.43.
Step 5602 (33 ms): -206.83.
Step 5640 (16 ms): -288.15.

Epoch 15 (12.6 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -214.29, ENRE: -208.76, KL: 5.5292.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 5678 (33 ms): -204.08.
Step 5715 (34 ms): -206.79.
Step 5753 (33 ms): -218.01.
Step 5790 (32 ms): -223.3.
Step 5828 (34 ms): -220.24.
Step 5866 (33 ms): -212.02.
Step 5903 (33 ms): -201.43.
Step 5941 (33 ms): -228.52.
Step 5978 (33 ms): -222.16.
Step 6016 (16 ms): -228.11.

Epoch 16 (12.4 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -213.65, ENRE: -208.21, KL: 5.445.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 6054 (32 ms): -204.2.
Step 6091 (33 ms): -209.96.
Step 6129 (32 ms): -207.37.
Step 6166 (32 ms): -201.01.
Step 6204 (32 ms): -216.3.
Step 6242 (33 ms): -221.89.
Step 6279 (33 ms): -203.26.
Step 6317 (34 ms): -201.6.
Step 6354 (33 ms): -216.38.
Step 6392 (15 ms): -193.67.

Epoch 17 (12.4 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -212.93, ENRE: -207.51, KL: 5.4193.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 6430 (33 ms): -216.4.
Step 6467 (32 ms): -207.31.
Step 6505 (33 ms): -215.27.
Step 6542 (33 ms): -203.06.
Step 6580 (32 ms): -199.69.
Step 6618 (33 ms): -203.07.
Step 6655 (32 ms): -207.37.
Step 6693 (32 ms): -213.19.
Step 6730 (34 ms): -214.7.
Step 6768 (16 ms): -235.24.

Epoch 18 (12.3 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -211.64, ENRE: -206.2, KL: 5.4361.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 6806 (33 ms): -205.92.
Step 6843 (33 ms): -201.03.
Step 6881 (33 ms): -201.29.
Step 6918 (32 ms): -211.02.
Step 6956 (33 ms): -200.54.
Step 6994 (33 ms): -197.36.
Step 7031 (33 ms): -212.5.
Step 7069 (34 ms): -203.19.
Step 7106 (33 ms): -199.98.
Step 7144 (16 ms): -226.45.

Epoch 19 (12.4 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -211.52, ENRE: -206.1, KL: 5.4277.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 7182 (33 ms): -211.54.
Step 7219 (34 ms): -208.89.
Step 7257 (33 ms): -210.73.
Step 7294 (33 ms): -204.36.
Step 7332 (33 ms): -203.04.
Step 7370 (33 ms): -204.63.
Step 7407 (33 ms): -218.06.
Step 7445 (33 ms): -209.3.
Step 7482 (34 ms): -207.18.
Step 7520 (16 ms): -418.1.

Epoch 20 (12.4 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -210.85, ENRE: -205.43, KL: 5.424.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 7558 (33 ms): -211.
Step 7595 (33 ms): -228.23.
Step 7633 (33 ms): -217.91.
Step 7670 (33 ms): -203.55.
Step 7708 (34 ms): -216.75.
Step 7746 (32 ms): -193.86.
Step 7783 (33 ms): -210.42.
Step 7821 (33 ms): -198.77.
Step 7858 (34 ms): -223.3.
Step 7896 (16 ms): -202.79.

Epoch 21 (12.5 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -210.03, ENRE: -204.81, KL: 5.2264.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 7934 (33 ms): -203.79.
Step 7971 (34 ms): -209.7.
Step 8009 (34 ms): -210.57.
Step 8046 (34 ms): -202.85.
Step 8084 (33 ms): -205.17.
Step 8122 (33 ms): -202.43.
Step 8159 (33 ms): -211.91.
Step 8197 (33 ms): -202.92.
Step 8234 (33 ms): -203.4.
Step 8272 (16 ms): -252.85.

Epoch 22 (12.5 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -209.28, ENRE: -204.07, KL: 5.2141.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 8310 (33 ms): -209.27.
Step 8347 (33 ms): -201.91.
Step 8385 (33 ms): -204.6.
Step 8422 (33 ms): -216.34.
Step 8460 (32 ms): -211.64.
Step 8498 (33 ms): -219.77.
Step 8535 (33 ms): -211.27.
Step 8573 (33 ms): -215.02.
Step 8610 (33 ms): -207.02.
Step 8648 (15 ms): -210.57.

Epoch 23 (12.4 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -209.1, ENRE: -203.98, KL: 5.1167.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 8686 (33 ms): -207.16.
Step 8723 (34 ms): -210.91.
Step 8761 (33 ms): -212.68.
Step 8798 (33 ms): -215.96.
Step 8836 (33 ms): -208.11.
Step 8874 (33 ms): -205.44.
Step 8911 (34 ms): -221.62.
Step 8949 (33 ms): -196.03.
Step 8986 (32 ms): -203.96.
Step 9024 (15 ms): -233.53.

Epoch 24 (12.4 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -207.52, ENRE: -202.31, KL: 5.2098.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 9062 (33 ms): -196.1.
Step 9099 (32 ms): -210.19.
Step 9137 (32 ms): -207.25.
Step 9174 (33 ms): -192.73.
Step 9212 (32 ms): -200.5.
Step 9250 (33 ms): -215.56.
Step 9287 (33 ms): -212.22.
Step 9325 (33 ms): -202.74.
Step 9362 (34 ms): -217.88.
Step 9400 (16 ms): -199.95.

Epoch 25 (12.3 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -207.88, ENRE: -202.68, KL: 5.2003.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 9438 (33 ms): -207.03.
Step 9475 (33 ms): -219.95.
Step 9513 (33 ms): -196.38.
Step 9550 (34 ms): -205.7.
Step 9588 (33 ms): -219.36.
Step 9626 (33 ms): -202.65.
Step 9663 (33 ms): -202.44.
Step 9701 (33 ms): -201.77.
Step 9738 (33 ms): -208.23.
Step 9776 (16 ms): -230.59.

Epoch 26 (12.5 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -207.76, ENRE: -202.68, KL: 5.0779.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 9814 (33 ms): -201.86.
Step 9851 (33 ms): -223.71.
Step 9889 (34 ms): -216.16.
Step 9926 (33 ms): -204.78.
Step 9964 (33 ms): -189.46.
Step 10002 (33 ms): -193.76.
Step 10039 (33 ms): -206.96.
Step 10077 (33 ms): -195.06.
Step 10114 (33 ms): -212.17.
Step 10152 (16 ms): -582.87.

Epoch 27 (12.5 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -207.34, ENRE: -202.24, KL: 5.0997.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 10190 (33 ms): -229.74.
Step 10227 (34 ms): -216.75.
Step 10265 (33 ms): -216.54.
Step 10302 (34 ms): -218.13.
Step 10340 (33 ms): -200.08.
Step 10378 (33 ms): -197.67.
Step 10415 (33 ms): -207.26.
Step 10453 (33 ms): -194.69.
Step 10490 (33 ms): -190.3.
Step 10528 (16 ms): -346.36.

Epoch 28 (12.5 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -207.2, ENRE: -202.15, KL: 5.0517.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 10566 (34 ms): -219.06.
Step 10603 (33 ms): -213.42.
Step 10641 (33 ms): -204.05.
Step 10678 (33 ms): -213.75.
Step 10716 (33 ms): -221.76.
Step 10754 (34 ms): -199.
Step 10791 (33 ms): -205.16.
Step 10829 (32 ms): -205.12.
Step 10866 (33 ms): -201.88.
Step 10904 (15 ms): -202.57.

Epoch 29 (12.4 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -206.26, ENRE: -201.16, KL: 5.1015.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 10942 (32 ms): -196.07.
Step 10979 (33 ms): -193.66.
Step 11017 (32 ms): -203.93.
Step 11054 (33 ms): -224.52.
Step 11092 (33 ms): -199.51.
Step 11130 (33 ms): -200.25.
Step 11167 (32 ms): -213.05.
Step 11205 (32 ms): -209.07.
Step 11242 (33 ms): -214.15.
Step 11280 (15 ms): -191.93.

Epoch 30 (12.3 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -206.56, ENRE: -201.44, KL: 5.1258.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 11318 (33 ms): -206.51.
Step 11355 (33 ms): -203.68.
Step 11393 (33 ms): -204.1.
Step 11430 (33 ms): -221.28.
Step 11468 (33 ms): -202.31.
Step 11506 (33 ms): -209.07.
Step 11543 (32 ms): -204.57.
Step 11581 (32 ms): -203.38.
Step 11618 (32 ms): -200.93.
Step 11656 (16 ms): -194.29.

Epoch 31 (12.4 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -205.2, ENRE: -200.08, KL: 5.1171.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 11694 (33 ms): -221.93.
Step 11731 (33 ms): -195.48.
Step 11769 (32 ms): -188.13.
Step 11806 (32 ms): -218.08.
Step 11844 (33 ms): -205.45.
Step 11882 (32 ms): -209.14.
Step 11919 (34 ms): -201.43.
Step 11957 (33 ms): -203.09.
Step 11994 (33 ms): -209.31.
Step 12032 (16 ms): -188.86.

Epoch 32 (12.4 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -205.17, ENRE: -200.04, KL: 5.1284.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 12070 (34 ms): -203.59.
Step 12107 (33 ms): -199.96.
Step 12145 (34 ms): -213.29.
Step 12182 (34 ms): -204.82.
Step 12220 (33 ms): -207.37.
Step 12258 (34 ms): -208.71.
Step 12295 (33 ms): -191.46.
Step 12333 (34 ms): -206.98.
Step 12370 (33 ms): -210.16.
Step 12408 (16 ms): -185.49.

Epoch 33 (12.6 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -204.04, ENRE: -198.92, KL: 5.1209.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 12446 (33 ms): -202.
Step 12483 (33 ms): -207.52.
Step 12521 (33 ms): -202.12.
Step 12558 (33 ms): -202.35.
Step 12596 (33 ms): -205.25.
Step 12634 (34 ms): -207.35.
Step 12671 (33 ms): -204.69.
Step 12709 (33 ms): -206.09.
Step 12746 (33 ms): -198.65.
Step 12784 (16 ms): -235.58.

Epoch 34 (12.5 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -204.31, ENRE: -199.16, KL: 5.1528.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 12822 (33 ms): -196.08.
Step 12859 (33 ms): -203.14.
Step 12897 (33 ms): -192.44.
Step 12934 (33 ms): -205.33.
Step 12972 (33 ms): -203.73.
Step 13010 (33 ms): -211.64.
Step 13047 (33 ms): -201.76.
Step 13085 (34 ms): -211.01.
Step 13122 (33 ms): -203.16.
Step 13160 (16 ms): -321.96.

Epoch 35 (12.5 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -203.99, ENRE: -198.93, KL: 5.0554.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 13198 (33 ms): -205.62.
Step 13235 (33 ms): -215.38.
Step 13273 (32 ms): -199.96.
Step 13310 (33 ms): -199.85.
Step 13348 (33 ms): -201.3.
Step 13386 (33 ms): -196.35.
Step 13423 (33 ms): -198.9.
Step 13461 (34 ms): -200.68.
Step 13498 (33 ms): -210.05.
Step 13536 (15 ms): -175.9.

Epoch 36 (12.3 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -204.01, ENRE: -198.84, KL: 5.1715.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 13574 (33 ms): -193.52.
Step 13611 (32 ms): -195.
Step 13649 (32 ms): -207.14.
Step 13686 (32 ms): -187.17.
Step 13724 (32 ms): -194.87.
Step 13762 (34 ms): -199.39.
Step 13799 (33 ms): -210.19.
Step 13837 (33 ms): -196.76.
Step 13874 (33 ms): -204.18.
Step 13912 (15 ms): -224.58.

Epoch 37 (12.3 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -203.07, ENRE: -197.93, KL: 5.1374.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 13950 (34 ms): -200.7.
Step 13987 (33 ms): -196.5.
Step 14025 (32 ms): -207.61.
Step 14062 (32 ms): -188.83.
Step 14100 (33 ms): -201.83.
Step 14138 (33 ms): -193.19.
Step 14175 (33 ms): -192.88.
Step 14213 (33 ms): -206.51.
Step 14250 (33 ms): -202.02.
Step 14288 (16 ms): -288.05.

Epoch 38 (12.4 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -203.67, ENRE: -198.58, KL: 5.0914.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 14326 (33 ms): -198.57.
Step 14363 (35 ms): -199.39.
Step 14401 (33 ms): -208.24.
Step 14438 (34 ms): -204.54.
Step 14476 (33 ms): -195.02.
Step 14514 (33 ms): -202.98.
Step 14551 (33 ms): -200.63.
Step 14589 (33 ms): -194.94.
Step 14626 (33 ms): -204.17.
Step 14664 (16 ms): -208.93.

Epoch 39 (12.5 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -203, ENRE: -197.75, KL: 5.2456.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 14702 (33 ms): -208.44.
Step 14739 (33 ms): -192.11.
Step 14777 (33 ms): -188.32.
Step 14814 (33 ms): -211.03.
Step 14852 (33 ms): -196.76.
Step 14890 (33 ms): -193.13.
Step 14927 (33 ms): -194.58.
Step 14965 (33 ms): -193.85.
Step 15002 (33 ms): -204.78.
Step 15040 (16 ms): -197.74.

Epoch 40 (12.5 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -202.93, ENRE: -197.83, KL: 5.1008.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 15078 (34 ms): -199.88.
Step 15115 (33 ms): -202.66.
Step 15153 (33 ms): -203.83.
Step 15190 (33 ms): -213.55.
Step 15228 (32 ms): -191.68.
Step 15266 (33 ms): -201.39.
Step 15303 (33 ms): -198.1.
Step 15341 (33 ms): -202.81.
Step 15378 (33 ms): -195.9.
Step 15416 (16 ms): -430.16.

Epoch 41 (12.4 s):
    Evaluating model.
    Full set (5.73 s): ELBO: -202.95, ENRE: -197.77, KL: 5.1823.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 15454 (32 ms): -209.88.
Step 15491 (32 ms): -201.5.
Step 15529 (33 ms): -198.1.
Step 15566 (33 ms): -199.1.
Step 15604 (33 ms): -213.08.
Step 15642 (34 ms): -196.31.
Step 15679 (33 ms): -195.69.
Step 15717 (33 ms): -212.39.
Step 15754 (32 ms): -211.11.
Step 15792 (15 ms): -210.

Epoch 42 (12.3 s):
    Evaluating model.
    Full set (5.76 s): ELBO: -202.69, ENRE: -197.48, KL: 5.212.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 15830 (32 ms): -203.2.
Step 15867 (33 ms): -197.36.
Step 15905 (32 ms): -200.29.
Step 15942 (34 ms): -198.51.
Step 15980 (32 ms): -191.84.
Step 16018 (32 ms): -200.64.
Step 16055 (33 ms): -196.29.
Step 16093 (33 ms): -205.74.
Step 16130 (32 ms): -206.
Step 16168 (15 ms): -293.67.

Epoch 43 (12.3 s):
    Evaluating model.
    Full set (5.73 s): ELBO: -202.52, ENRE: -197.28, KL: 5.2464.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 16206 (32 ms): -198.17.
Step 16243 (33 ms): -200.86.
Step 16281 (32 ms): -203.46.
Step 16318 (34 ms): -194.84.
Step 16356 (32 ms): -194.21.
Step 16394 (33 ms): -200.09.
Step 16431 (33 ms): -201.64.
Step 16469 (33 ms): -199.35.
Step 16506 (33 ms): -224.71.
Step 16544 (16 ms): -211.13.

Epoch 44 (12.4 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -202.72, ENRE: -197.44, KL: 5.2751.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 16582 (33 ms): -201.63.
Step 16619 (33 ms): -215.49.
Step 16657 (33 ms): -213.73.
Step 16694 (33 ms): -197.31.
Step 16732 (33 ms): -209.49.
Step 16770 (33 ms): -216.05.
Step 16807 (33 ms): -195.17.
Step 16845 (33 ms): -202.84.
Step 16882 (34 ms): -205.46.
Step 16920 (16 ms): -640.06.

Epoch 45 (12.4 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -202, ENRE: -196.76, KL: 5.2405.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 16958 (33 ms): -198.07.
Step 16995 (33 ms): -190.74.
Step 17033 (33 ms): -196.58.
Step 17070 (33 ms): -208.8.
Step 17108 (33 ms): -205.37.
Step 17146 (33 ms): -213.73.
Step 17183 (33 ms): -196.8.
Step 17221 (34 ms): -220.67.
Step 17258 (33 ms): -204.58.
Step 17296 (15 ms): -206.24.

Epoch 46 (12.4 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -201.73, ENRE: -196.43, KL: 5.2972.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 17334 (33 ms): -197.83.
Step 17371 (33 ms): -200.31.
Step 17409 (33 ms): -201.24.
Step 17446 (32 ms): -199.55.
Step 17484 (32 ms): -192.67.
Step 17522 (32 ms): -204.4.
Step 17559 (33 ms): -193.1.
Step 17597 (33 ms): -210.1.
Step 17634 (33 ms): -225.3.
Step 17672 (15 ms): -202.74.

Epoch 47 (12.4 s):
    Evaluating model.
    Full set (5.74 s): ELBO: -201.98, ENRE: -196.68, KL: 5.2992.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 17710 (33 ms): -195.65.
Step 17747 (33 ms): -204.5.
Step 17785 (33 ms): -204.52.
Step 17822 (33 ms): -205.43.
Step 17860 (32 ms): -193.36.
Step 17898 (33 ms): -212.71.
Step 17935 (32 ms): -203.27.
Step 17973 (33 ms): -211.29.
Step 18010 (32 ms): -194.51.
Step 18048 (15 ms): -251.24.

Epoch 48 (12.2 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -201.9, ENRE: -196.67, KL: 5.227.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 18086 (33 ms): -211.79.
Step 18123 (33 ms): -188.73.
Step 18161 (33 ms): -197.61.
Step 18198 (33 ms): -208.66.
Step 18236 (33 ms): -203.32.
Step 18274 (32 ms): -208.69.
Step 18311 (32 ms): -196.13.
Step 18349 (34 ms): -207.39.
Step 18386 (32 ms): -191.47.
Step 18424 (15 ms): -225.14.

Epoch 49 (12.3 s):
    Evaluating model.
    Full set (5.72 s): ELBO: -201.77, ENRE: -196.6, KL: 5.1713.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 18462 (32 ms): -196.37.
Step 18499 (32 ms): -212.84.
Step 18537 (32 ms): -200.22.
Step 18574 (33 ms): -209.95.
Step 18612 (35 ms): -207.85.
Step 18650 (33 ms): -204.6.
Step 18687 (33 ms): -215.48.
Step 18725 (33 ms): -193.97.
Step 18762 (33 ms): -182.75.
Step 18800 (16 ms): -195.13.

Epoch 50 (12.3 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -201.23, ENRE: -195.9, KL: 5.3334.
    Saving model parameters.
    Model parameters saved (119 ms).

Model trained for 50 epochs (15m 22s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (857 ms).

Converting data set value array to sparse matrix.
Data set value array converted (272 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.9 s):  ELBO: -418.68, ENRE: -413.34, KL: 5.3382.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (734 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.7559879794281947
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 30
kl weight: 1.7559879794281947
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (46 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.18 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.87 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 30
    hidden sizes: 113, 153, 91, 276, 140
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.7559879794281947
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 1 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 113)
    ENCODER/1/DENSE/biases:0             (113,)
    ENCODER/1/BATCH_NORM/beta:0          (113,)
    ENCODER/2/DENSE/weights:0            (113, 153)
    ENCODER/2/DENSE/biases:0             (153,)
    ENCODER/2/BATCH_NORM/beta:0          (153,)
    ENCODER/3/DENSE/weights:0            (153, 91)
    ENCODER/3/DENSE/biases:0             (91,)
    ENCODER/3/BATCH_NORM/beta:0          (91,)
    ENCODER/4/DENSE/weights:0            (91, 276)
    ENCODER/4/DENSE/biases:0             (276,)
    ENCODER/4/BATCH_NORM/beta:0          (276,)
    ENCODER/5/DENSE/weights:0            (276, 140)
    ENCODER/5/DENSE/biases:0             (140,)
    ENCODER/5/BATCH_NORM/beta:0          (140,)
    POSTERIOR/MU/DENSE/weights:0         (140, 30)
    POSTERIOR/MU/DENSE/biases:0          (30,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (140, 30)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (30,)
    DECODER/5/DENSE/weights:0            (30, 140)
    DECODER/5/DENSE/biases:0             (140,)
    DECODER/5/BATCH_NORM/beta:0          (140,)
    DECODER/4/DENSE/weights:0            (140, 276)
    DECODER/4/DENSE/biases:0             (276,)
    DECODER/4/BATCH_NORM/beta:0          (276,)
    DECODER/3/DENSE/weights:0            (276, 91)
    DECODER/3/DENSE/biases:0             (91,)
    DECODER/3/BATCH_NORM/beta:0          (91,)
    DECODER/2/DENSE/weights:0            (91, 153)
    DECODER/2/DENSE/biases:0             (153,)
    DECODER/2/BATCH_NORM/beta:0          (153,)
    DECODER/1/DENSE/weights:0            (153, 113)
    DECODER/1/DENSE/biases:0             (113,)
    DECODER/1/BATCH_NORM/beta:0          (113,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (113, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (547 ms).

Training model for 50 epochs on original values.

Step 38 (33 ms): -2273.6.
Step 75 (33 ms): -1950.9.
Step 113 (32 ms): -1755.
Step 150 (32 ms): -1576.
Step 188 (32 ms): -1339.4.
Step 226 (32 ms): -1212.4.
Step 263 (32 ms): -1097.6.
Step 301 (31 ms): -1004.7.
Step 338 (32 ms): -919.59.
Step 376 (18 ms): -849.56.

Epoch 1 (14.9 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.43 s): ELBO: -1909.6, ENRE: -1900.4, KL: 9.2834.
    Saving model parameters.
    Model parameters saved (198 ms).

Step 414 (31 ms): -731.12.
Step 451 (31 ms): -662.69.
Step 489 (31 ms): -605.17.
Step 526 (32 ms): -589.29.
Step 564 (32 ms): -535.71.
Step 602 (32 ms): -500.31.
Step 639 (31 ms): -470.6.
Step 677 (32 ms): -447.21.
Step 714 (32 ms): -416.36.
Step 752 (18 ms): -413.89.

Epoch 2 (11.9 s):
    Evaluating model.
    Full set (5.73 s): ELBO: -1168.9, ENRE: -1163.7, KL: 5.1739.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 790 (31 ms): -362.46.
Step 827 (31 ms): -375.82.
Step 865 (32 ms): -370.98.
Step 902 (31 ms): -364.84.
Step 940 (31 ms): -323.19.
Step 978 (32 ms): -347.18.
Step 1015 (31 ms): -324.08.
Step 1053 (31 ms): -320.26.
Step 1090 (31 ms): -308.75.
Step 1128 (15 ms): -267.85.

Epoch 3 (11.8 s):
    Evaluating model.
    Full set (5.62 s): ELBO: -607.89, ENRE: -603.3, KL: 4.5935.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 1166 (30 ms): -288.93.
Step 1203 (31 ms): -297.26.
Step 1241 (31 ms): -293.51.
Step 1278 (31 ms): -279.92.
Step 1316 (31 ms): -303.83.
Step 1354 (31 ms): -270.74.
Step 1391 (31 ms): -278.33.
Step 1429 (31 ms): -263.94.
Step 1466 (31 ms): -276.78.
Step 1504 (15 ms): -390.17.

Epoch 4 (11.7 s):
    Evaluating model.
    Full set (5.67 s): ELBO: -398.24, ENRE: -393.24, KL: 5.0037.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 1542 (31 ms): -254.89.
Step 1579 (31 ms): -271.03.
Step 1617 (31 ms): -277.58.
Step 1654 (32 ms): -262.26.
Step 1692 (32 ms): -259.38.
Step 1730 (32 ms): -256.03.
Step 1767 (31 ms): -245.73.
Step 1805 (32 ms): -236.73.
Step 1842 (32 ms): -248.33.
Step 1880 (16 ms): -228.14.

Epoch 5 (11.9 s):
    Evaluating model.
    Full set (5.66 s): ELBO: -315.23, ENRE: -310.41, KL: 4.8205.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 1918 (32 ms): -261.24.
Step 1955 (32 ms): -258.87.
Step 1993 (32 ms): -269.62.
Step 2030 (32 ms): -233.14.
Step 2068 (31 ms): -249.21.
Step 2106 (31 ms): -255.91.
Step 2143 (32 ms): -247.88.
Step 2181 (32 ms): -252.28.
Step 2218 (32 ms): -220.58.
Step 2256 (16 ms): -247.77.

Epoch 6 (11.9 s):
    Evaluating model.
    Full set (5.66 s): ELBO: -271.65, ENRE: -266.76, KL: 4.8874.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 2294 (31 ms): -233.95.
Step 2331 (32 ms): -244.5.
Step 2369 (32 ms): -239.37.
Step 2406 (32 ms): -230.79.
Step 2444 (32 ms): -239.64.
Step 2482 (32 ms): -265.61.
Step 2519 (32 ms): -241.68.
Step 2557 (31 ms): -264.1.
Step 2594 (32 ms): -219.84.
Step 2632 (15 ms): -247.63.

Epoch 7 (12 s):
    Evaluating model.
    Full set (5.64 s): ELBO: -251.55, ENRE: -246.45, KL: 5.0934.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 2670 (31 ms): -223.4.
Step 2707 (32 ms): -226.47.
Step 2745 (31 ms): -255.57.
Step 2782 (31 ms): -241.4.
Step 2820 (31 ms): -228.44.
Step 2858 (31 ms): -221.13.
Step 2895 (31 ms): -227.6.
Step 2933 (31 ms): -229.46.
Step 2970 (31 ms): -241.1.
Step 3008 (15 ms): -429.3.

Epoch 8 (11.7 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -239.8, ENRE: -234.71, KL: 5.094.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 3046 (30 ms): -222.21.
Step 3083 (31 ms): -235.4.
Step 3121 (31 ms): -229.66.
Step 3158 (31 ms): -246.16.
Step 3196 (31 ms): -226.36.
Step 3234 (30 ms): -228.91.
Step 3271 (31 ms): -229.84.
Step 3309 (31 ms): -226.92.
Step 3346 (32 ms): -223.22.
Step 3384 (15 ms): -361.7.

Epoch 9 (11.7 s):
    Evaluating model.
    Full set (5.67 s): ELBO: -231.32, ENRE: -226.29, KL: 5.0273.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 3422 (31 ms): -226.77.
Step 3459 (30 ms): -254.57.
Step 3497 (31 ms): -221.97.
Step 3534 (31 ms): -221.99.
Step 3572 (31 ms): -256.43.
Step 3610 (31 ms): -219.74.
Step 3647 (31 ms): -236.98.
Step 3685 (31 ms): -216.15.
Step 3722 (31 ms): -227.17.
Step 3760 (15 ms): -363.12.

Epoch 10 (11.7 s):
    Evaluating model.
    Full set (5.65 s): ELBO: -227.33, ENRE: -222.32, KL: 5.0127.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 3798 (31 ms): -237.44.
Step 3835 (31 ms): -217.87.
Step 3873 (32 ms): -225.69.
Step 3910 (31 ms): -208.19.
Step 3948 (32 ms): -208.48.
Step 3986 (31 ms): -213.33.
Step 4023 (31 ms): -215.16.
Step 4061 (32 ms): -228.48.
Step 4098 (32 ms): -211.25.
Step 4136 (15 ms): -227.76.

Epoch 11 (11.8 s):
    Evaluating model.
    Full set (5.65 s): ELBO: -223.42, ENRE: -218.35, KL: 5.0774.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 4174 (32 ms): -219.66.
Step 4211 (34 ms): -221.43.
Step 4249 (31 ms): -217.7.
Step 4286 (31 ms): -226.88.
Step 4324 (32 ms): -234.81.
Step 4362 (32 ms): -220.88.
Step 4399 (32 ms): -217.36.
Step 4437 (31 ms): -218.95.
Step 4474 (33 ms): -220.66.
Step 4512 (15 ms): -185.8.

Epoch 12 (11.9 s):
    Evaluating model.
    Full set (5.65 s): ELBO: -220.33, ENRE: -215.17, KL: 5.1634.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 4550 (32 ms): -212.29.
Step 4587 (32 ms): -218.95.
Step 4625 (32 ms): -234.43.
Step 4662 (31 ms): -218.76.
Step 4700 (32 ms): -230.78.
Step 4738 (31 ms): -209.87.
Step 4775 (31 ms): -211.12.
Step 4813 (32 ms): -213.67.
Step 4850 (31 ms): -214.82.
Step 4888 (16 ms): -199.13.

Epoch 13 (11.9 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -218.17, ENRE: -213.13, KL: 5.0361.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 4926 (31 ms): -207.78.
Step 4963 (31 ms): -223.81.
Step 5001 (31 ms): -225.54.
Step 5038 (32 ms): -201.86.
Step 5076 (31 ms): -213.84.
Step 5114 (31 ms): -220.8.
Step 5151 (31 ms): -222.64.
Step 5189 (31 ms): -230.88.
Step 5226 (31 ms): -223.52.
Step 5264 (15 ms): -193.9.

Epoch 14 (11.8 s):
    Evaluating model.
    Full set (5.63 s): ELBO: -216.31, ENRE: -211.11, KL: 5.2.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 5302 (31 ms): -231.29.
Step 5339 (31 ms): -212.66.
Step 5377 (31 ms): -216.03.
Step 5414 (31 ms): -205.35.
Step 5452 (30 ms): -215.18.
Step 5490 (31 ms): -214.72.
Step 5527 (31 ms): -197.18.
Step 5565 (31 ms): -212.15.
Step 5602 (31 ms): -208.85.
Step 5640 (15 ms): -238.46.

Epoch 15 (11.7 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -215.71, ENRE: -210.84, KL: 4.8648.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 5678 (31 ms): -205.57.
Step 5715 (31 ms): -214.04.
Step 5753 (31 ms): -210.12.
Step 5790 (31 ms): -236.93.
Step 5828 (31 ms): -203.37.
Step 5866 (31 ms): -213.41.
Step 5903 (31 ms): -199.92.
Step 5941 (31 ms): -209.07.
Step 5978 (31 ms): -205.55.
Step 6016 (15 ms): -189.48.

Epoch 16 (11.7 s):
    Evaluating model.
    Full set (5.7 s): ELBO: -214.22, ENRE: -209.5, KL: 4.7255.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 6054 (32 ms): -219.13.
Step 6091 (31 ms): -191.63.
Step 6129 (32 ms): -214.11.
Step 6166 (31 ms): -198.83.
Step 6204 (32 ms): -207.65.
Step 6242 (31 ms): -213.04.
Step 6279 (31 ms): -214.75.
Step 6317 (31 ms): -206.37.
Step 6354 (31 ms): -206.06.
Step 6392 (16 ms): -250.63.

Epoch 17 (11.8 s):
    Evaluating model.
    Full set (5.64 s): ELBO: -212.13, ENRE: -207.28, KL: 4.8527.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 6430 (31 ms): -211.78.
Step 6467 (31 ms): -205.22.
Step 6505 (31 ms): -213.52.
Step 6542 (31 ms): -207.64.
Step 6580 (32 ms): -205.14.
Step 6618 (31 ms): -196.57.
Step 6655 (31 ms): -219.34.
Step 6693 (31 ms): -215.95.
Step 6730 (31 ms): -210.69.
Step 6768 (15 ms): -184.3.

Epoch 18 (11.9 s):
    Evaluating model.
    Full set (5.7 s): ELBO: -211.66, ENRE: -206.91, KL: 4.7504.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 6806 (32 ms): -223.59.
Step 6843 (32 ms): -205.73.
Step 6881 (33 ms): -237.65.
Step 6918 (31 ms): -199.98.
Step 6956 (32 ms): -224.77.
Step 6994 (32 ms): -210.7.
Step 7031 (31 ms): -192.44.
Step 7069 (30 ms): -218.79.
Step 7106 (31 ms): -200.97.
Step 7144 (15 ms): -219.63.

Epoch 19 (11.9 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -210.84, ENRE: -206.05, KL: 4.7835.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 7182 (31 ms): -210.67.
Step 7219 (32 ms): -220.31.
Step 7257 (31 ms): -225.66.
Step 7294 (31 ms): -208.82.
Step 7332 (31 ms): -196.23.
Step 7370 (32 ms): -196.33.
Step 7407 (31 ms): -203.75.
Step 7445 (31 ms): -215.08.
Step 7482 (31 ms): -201.87.
Step 7520 (15 ms): -252.99.

Epoch 20 (11.8 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -209.78, ENRE: -204.99, KL: 4.7969.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 7558 (31 ms): -205.38.
Step 7595 (31 ms): -209.5.
Step 7633 (31 ms): -223.09.
Step 7670 (31 ms): -208.72.
Step 7708 (32 ms): -203.61.
Step 7746 (31 ms): -203.62.
Step 7783 (31 ms): -209.51.
Step 7821 (31 ms): -213.41.
Step 7858 (31 ms): -200.08.
Step 7896 (15 ms): -387.54.

Epoch 21 (11.8 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -209.29, ENRE: -204.52, KL: 4.7708.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 7934 (31 ms): -196.62.
Step 7971 (31 ms): -199.47.
Step 8009 (31 ms): -203.66.
Step 8046 (31 ms): -221.72.
Step 8084 (31 ms): -210.8.
Step 8122 (31 ms): -204.63.
Step 8159 (31 ms): -210.67.
Step 8197 (31 ms): -211.11.
Step 8234 (31 ms): -209.74.
Step 8272 (15 ms): -569.91.

Epoch 22 (11.7 s):
    Evaluating model.
    Full set (5.63 s): ELBO: -208.59, ENRE: -203.78, KL: 4.8104.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 8310 (31 ms): -203.51.
Step 8347 (31 ms): -213.6.
Step 8385 (31 ms): -199.29.
Step 8422 (31 ms): -196.89.
Step 8460 (32 ms): -205.1.
Step 8498 (31 ms): -193.35.
Step 8535 (31 ms): -203.35.
Step 8573 (30 ms): -216.1.
Step 8610 (31 ms): -204.68.
Step 8648 (15 ms): -217.5.

Epoch 23 (11.6 s):
    Evaluating model.
    Full set (5.68 s): ELBO: -208.13, ENRE: -203.38, KL: 4.7485.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 8686 (32 ms): -214.17.
Step 8723 (31 ms): -208.29.
Step 8761 (31 ms): -212.9.
Step 8798 (31 ms): -198.34.
Step 8836 (31 ms): -211.68.
Step 8874 (31 ms): -207.45.
Step 8911 (31 ms): -199.52.
Step 8949 (31 ms): -204.87.
Step 8986 (31 ms): -201.38.
Step 9024 (15 ms): -206.69.

Epoch 24 (11.8 s):
    Evaluating model.
    Full set (5.68 s): ELBO: -207.5, ENRE: -202.76, KL: 4.7444.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 9062 (31 ms): -201.64.
Step 9099 (32 ms): -205.24.
Step 9137 (31 ms): -200.04.
Step 9174 (32 ms): -220.4.
Step 9212 (32 ms): -199.97.
Step 9250 (31 ms): -204.59.
Step 9287 (31 ms): -193.06.
Step 9325 (31 ms): -192.49.
Step 9362 (32 ms): -204.69.
Step 9400 (16 ms): -224.

Epoch 25 (11.9 s):
    Evaluating model.
    Full set (5.66 s): ELBO: -207.14, ENRE: -202.35, KL: 4.7908.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 9438 (32 ms): -220.48.
Step 9475 (31 ms): -191.44.
Step 9513 (31 ms): -206.06.
Step 9550 (32 ms): -189.57.
Step 9588 (31 ms): -203.59.
Step 9626 (32 ms): -200.69.
Step 9663 (31 ms): -202.58.
Step 9701 (31 ms): -208.35.
Step 9738 (31 ms): -222.29.
Step 9776 (15 ms): -327.56.

Epoch 26 (11.9 s):
    Evaluating model.
    Full set (5.67 s): ELBO: -207.07, ENRE: -202.41, KL: 4.6557.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 9814 (32 ms): -203.04.
Step 9851 (32 ms): -214.47.
Step 9889 (32 ms): -198.15.
Step 9926 (31 ms): -228.18.
Step 9964 (32 ms): -195.54.
Step 10002 (31 ms): -199.91.
Step 10039 (32 ms): -201.71.
Step 10077 (31 ms): -196.15.
Step 10114 (31 ms): -214.83.
Step 10152 (15 ms): -234.01.

Epoch 27 (11.8 s):
    Evaluating model.
    Full set (5.57 s): ELBO: -206.68, ENRE: -202.01, KL: 4.669.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 10190 (31 ms): -207.52.
Step 10227 (30 ms): -212.51.
Step 10265 (32 ms): -206.95.
Step 10302 (32 ms): -207.15.
Step 10340 (31 ms): -207.25.
Step 10378 (31 ms): -214.53.
Step 10415 (31 ms): -200.22.
Step 10453 (31 ms): -202.92.
Step 10490 (31 ms): -210.4.
Step 10528 (15 ms): -268.19.

Epoch 28 (11.8 s):
    Evaluating model.
    Full set (5.64 s): ELBO: -205.95, ENRE: -201.2, KL: 4.7471.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 10566 (30 ms): -217.93.
Step 10603 (31 ms): -201.45.
Step 10641 (30 ms): -198.78.
Step 10678 (31 ms): -202.84.
Step 10716 (31 ms): -196.65.
Step 10754 (30 ms): -198.11.
Step 10791 (31 ms): -194.1.
Step 10829 (31 ms): -200.46.
Step 10866 (31 ms): -196.91.
Step 10904 (15 ms): -195.25.

Epoch 29 (11.6 s):
    Evaluating model.
    Full set (5.59 s): ELBO: -205.64, ENRE: -200.96, KL: 4.6851.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 10942 (31 ms): -195.9.
Step 10979 (31 ms): -202.59.
Step 11017 (31 ms): -206.88.
Step 11054 (32 ms): -207.42.
Step 11092 (31 ms): -201.13.
Step 11130 (31 ms): -206.08.
Step 11167 (31 ms): -212.72.
Step 11205 (32 ms): -222.27.
Step 11242 (31 ms): -202.44.
Step 11280 (16 ms): -180.05.

Epoch 30 (11.8 s):
    Evaluating model.
    Full set (5.73 s): ELBO: -205.35, ENRE: -200.6, KL: 4.7495.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 11318 (32 ms): -203.71.
Step 11355 (31 ms): -222.17.
Step 11393 (31 ms): -199.39.
Step 11430 (32 ms): -200.51.
Step 11468 (32 ms): -215.98.
Step 11506 (31 ms): -192.84.
Step 11543 (32 ms): -209.9.
Step 11581 (32 ms): -219.98.
Step 11618 (31 ms): -192.71.
Step 11656 (15 ms): -198.3.

Epoch 31 (11.9 s):
    Evaluating model.
    Full set (5.63 s): ELBO: -205.26, ENRE: -200.46, KL: 4.8077.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 11694 (32 ms): -198.41.
Step 11731 (31 ms): -208.12.
Step 11769 (32 ms): -198.45.
Step 11806 (31 ms): -196.83.
Step 11844 (31 ms): -199.64.
Step 11882 (31 ms): -206.45.
Step 11919 (31 ms): -206.08.
Step 11957 (33 ms): -201.82.
Step 11994 (32 ms): -199.33.
Step 12032 (15 ms): -220.48.

Epoch 32 (11.9 s):
    Evaluating model.
    Full set (5.73 s): ELBO: -204.74, ENRE: -199.98, KL: 4.7529.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 12070 (32 ms): -199.25.
Step 12107 (32 ms): -206.67.
Step 12145 (31 ms): -200.79.
Step 12182 (32 ms): -201.21.
Step 12220 (32 ms): -197.18.
Step 12258 (31 ms): -222.2.
Step 12295 (31 ms): -207.05.
Step 12333 (31 ms): -219.12.
Step 12370 (32 ms): -194.03.
Step 12408 (15 ms): -235.64.

Epoch 33 (11.8 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -204.62, ENRE: -199.92, KL: 4.7025.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 12446 (31 ms): -191.35.
Step 12483 (31 ms): -210.46.
Step 12521 (31 ms): -186.65.
Step 12558 (31 ms): -218.54.
Step 12596 (30 ms): -209.67.
Step 12634 (31 ms): -199.27.
Step 12671 (31 ms): -210.64.
Step 12709 (31 ms): -216.26.
Step 12746 (31 ms): -206.62.
Step 12784 (15 ms): -239.53.

Epoch 34 (11.7 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -204.39, ENRE: -199.55, KL: 4.8344.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 12822 (31 ms): -206.53.
Step 12859 (32 ms): -206.45.
Step 12897 (31 ms): -206.66.
Step 12934 (32 ms): -205.36.
Step 12972 (31 ms): -193.39.
Step 13010 (32 ms): -197.58.
Step 13047 (32 ms): -207.71.
Step 13085 (31 ms): -195.1.
Step 13122 (31 ms): -199.9.
Step 13160 (15 ms): -232.86.

Epoch 35 (11.8 s):
    Evaluating model.
    Full set (5.59 s): ELBO: -204.18, ENRE: -199.39, KL: 4.7875.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 13198 (30 ms): -199.11.
Step 13235 (30 ms): -205.06.
Step 13273 (31 ms): -206.77.
Step 13310 (31 ms): -200.38.
Step 13348 (31 ms): -192.61.
Step 13386 (31 ms): -198.67.
Step 13423 (31 ms): -210.68.
Step 13461 (31 ms): -197.18.
Step 13498 (33 ms): -203.16.
Step 13536 (15 ms): -199.69.

Epoch 36 (11.7 s):
    Evaluating model.
    Full set (5.67 s): ELBO: -203.69, ENRE: -198.9, KL: 4.7908.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 13574 (31 ms): -195.34.
Step 13611 (31 ms): -202.35.
Step 13649 (32 ms): -209.31.
Step 13686 (32 ms): -206.5.
Step 13724 (31 ms): -194.43.
Step 13762 (31 ms): -198.88.
Step 13799 (32 ms): -198.26.
Step 13837 (32 ms): -200.46.
Step 13874 (32 ms): -206.3.
Step 13912 (15 ms): -466.77.

Epoch 37 (11.9 s):
    Evaluating model.
    Full set (5.71 s): ELBO: -203.41, ENRE: -198.66, KL: 4.7422.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 13950 (33 ms): -184.92.
Step 13987 (32 ms): -200.99.
Step 14025 (32 ms): -222.41.
Step 14062 (31 ms): -192.33.
Step 14100 (31 ms): -207.5.
Step 14138 (31 ms): -197.63.
Step 14175 (31 ms): -205.43.
Step 14213 (32 ms): -211.6.
Step 14250 (32 ms): -208.37.
Step 14288 (15 ms): -252.24.

Epoch 38 (11.8 s):
    Evaluating model.
    Full set (5.67 s): ELBO: -203.06, ENRE: -198.2, KL: 4.8658.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 14326 (31 ms): -198.27.
Step 14363 (32 ms): -204.67.
Step 14401 (32 ms): -199.4.
Step 14438 (32 ms): -201.85.
Step 14476 (31 ms): -185.9.
Step 14514 (33 ms): -194.49.
Step 14551 (32 ms): -204.76.
Step 14589 (34 ms): -215.23.
Step 14626 (31 ms): -199.46.
Step 14664 (15 ms): -208.18.

Epoch 39 (11.9 s):
    Evaluating model.
    Full set (5.69 s): ELBO: -202.6, ENRE: -197.7, KL: 4.9001.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 14702 (31 ms): -205.43.
Step 14739 (31 ms): -188.73.
Step 14777 (31 ms): -216.45.
Step 14814 (32 ms): -201.55.
Step 14852 (31 ms): -209.75.
Step 14890 (31 ms): -202.28.
Step 14927 (31 ms): -191.33.
Step 14965 (31 ms): -208.29.
Step 15002 (31 ms): -202.76.
Step 15040 (15 ms): -308.75.

Epoch 40 (11.8 s):
    Evaluating model.
    Full set (5.65 s): ELBO: -202.9, ENRE: -198.07, KL: 4.8276.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 15078 (31 ms): -200.
Step 15115 (31 ms): -206.33.
Step 15153 (31 ms): -208.14.
Step 15190 (32 ms): -205.83.
Step 15228 (31 ms): -198.05.
Step 15266 (31 ms): -217.27.
Step 15303 (31 ms): -193.68.
Step 15341 (31 ms): -203.44.
Step 15378 (31 ms): -199.92.
Step 15416 (14 ms): -212.03.

Epoch 41 (11.7 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -202.84, ENRE: -197.93, KL: 4.9145.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 15454 (31 ms): -201.26.
Step 15491 (31 ms): -200.88.
Step 15529 (31 ms): -217.73.
Step 15566 (30 ms): -197.75.
Step 15604 (32 ms): -198.43.
Step 15642 (32 ms): -212.69.
Step 15679 (31 ms): -206.59.
Step 15717 (31 ms): -207.99.
Step 15754 (31 ms): -207.09.
Step 15792 (15 ms): -199.33.

Epoch 42 (11.7 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -202.73, ENRE: -197.85, KL: 4.8809.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 15830 (30 ms): -197.52.
Step 15867 (31 ms): -193.04.
Step 15905 (30 ms): -198.37.
Step 15942 (31 ms): -193.75.
Step 15980 (31 ms): -208.93.
Step 16018 (31 ms): -203.34.
Step 16055 (32 ms): -213.63.
Step 16093 (31 ms): -202.9.
Step 16130 (31 ms): -199.97.
Step 16168 (15 ms): -258.

Epoch 43 (11.7 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -202.55, ENRE: -197.72, KL: 4.8362.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 16206 (32 ms): -194.79.
Step 16243 (31 ms): -197.57.
Step 16281 (31 ms): -193.86.
Step 16318 (31 ms): -205.33.
Step 16356 (32 ms): -236.31.
Step 16394 (31 ms): -195.98.
Step 16431 (31 ms): -198.14.
Step 16469 (32 ms): -203.5.
Step 16506 (32 ms): -205.62.
Step 16544 (16 ms): -194.86.

Epoch 44 (11.9 s):
    Evaluating model.
    Full set (5.72 s): ELBO: -202.54, ENRE: -197.61, KL: 4.9207.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 16582 (31 ms): -204.01.
Step 16619 (32 ms): -194.53.
Step 16657 (32 ms): -204.49.
Step 16694 (31 ms): -192.43.
Step 16732 (31 ms): -212.1.
Step 16770 (31 ms): -201.37.
Step 16807 (31 ms): -212.04.
Step 16845 (32 ms): -208.03.
Step 16882 (32 ms): -197.19.
Step 16920 (15 ms): -200.22.

Epoch 45 (11.9 s):
    Evaluating model.
    Full set (5.64 s): ELBO: -201.98, ENRE: -197.11, KL: 4.8705.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 16958 (33 ms): -192.24.
Step 16995 (31 ms): -228.12.
Step 17033 (31 ms): -200.49.
Step 17070 (31 ms): -206.58.
Step 17108 (32 ms): -216.3.
Step 17146 (31 ms): -200.98.
Step 17183 (32 ms): -207.49.
Step 17221 (31 ms): -202.72.
Step 17258 (32 ms): -204.59.
Step 17296 (15 ms): -180.3.

Epoch 46 (11.9 s):
    Evaluating model.
    Full set (5.73 s): ELBO: -202.01, ENRE: -197.08, KL: 4.9255.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 17334 (32 ms): -200.2.
Step 17371 (31 ms): -200.9.
Step 17409 (31 ms): -203.33.
Step 17446 (31 ms): -213.68.
Step 17484 (31 ms): -202.27.
Step 17522 (32 ms): -198.2.
Step 17559 (31 ms): -198.38.
Step 17597 (31 ms): -191.46.
Step 17634 (31 ms): -182.78.
Step 17672 (15 ms): -215.31.

Epoch 47 (11.8 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -202.14, ENRE: -197.28, KL: 4.8586.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 17710 (31 ms): -204.57.
Step 17747 (31 ms): -191.62.
Step 17785 (31 ms): -204.22.
Step 17822 (31 ms): -202.44.
Step 17860 (31 ms): -215.44.
Step 17898 (31 ms): -206.2.
Step 17935 (31 ms): -199.44.
Step 17973 (31 ms): -206.58.
Step 18010 (31 ms): -199.78.
Step 18048 (15 ms): -273.66.

Epoch 48 (11.7 s):
    Evaluating model.
    Full set (5.63 s): ELBO: -202.21, ENRE: -197.37, KL: 4.8445.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 18086 (31 ms): -187.56.
Step 18123 (32 ms): -193.57.
Step 18161 (31 ms): -204.87.
Step 18198 (32 ms): -210.58.
Step 18236 (31 ms): -202.87.
Step 18274 (31 ms): -208.
Step 18311 (31 ms): -209.79.
Step 18349 (31 ms): -200.35.
Step 18386 (31 ms): -213.78.
Step 18424 (15 ms): -177.93.

Epoch 49 (11.8 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -202.08, ENRE: -197.15, KL: 4.9277.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 18462 (31 ms): -194.72.
Step 18499 (31 ms): -198.61.
Step 18537 (31 ms): -204.51.
Step 18574 (31 ms): -201.23.
Step 18612 (31 ms): -200.22.
Step 18650 (31 ms): -195.62.
Step 18687 (31 ms): -203.35.
Step 18725 (31 ms): -196.03.
Step 18762 (31 ms): -196.62.
Step 18800 (15 ms): -308.38.

Epoch 50 (11.8 s):
    Evaluating model.
    Full set (5.64 s): ELBO: -201.72, ENRE: -196.85, KL: 4.8697.
    Saving model parameters.
    Model parameters saved (116 ms).

Model trained for 50 epochs (14m 43s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (10 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (865 ms).

Converting data set value array to sparse matrix.
Data set value array converted (277 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.88 s):  ELBO: -416.16, ENRE: -411.29, KL: 4.8671.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (707 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 0.9706533655189339
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 42
kl weight: 0.9706533655189339
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (45 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (3.93 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.66 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 42
    hidden sizes: 188, 299, 63, 240, 217
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 0.9706533655189339
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 2 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 188)
    ENCODER/1/DENSE/biases:0             (188,)
    ENCODER/1/BATCH_NORM/beta:0          (188,)
    ENCODER/2/DENSE/weights:0            (188, 299)
    ENCODER/2/DENSE/biases:0             (299,)
    ENCODER/2/BATCH_NORM/beta:0          (299,)
    ENCODER/3/DENSE/weights:0            (299, 63)
    ENCODER/3/DENSE/biases:0             (63,)
    ENCODER/3/BATCH_NORM/beta:0          (63,)
    ENCODER/4/DENSE/weights:0            (63, 240)
    ENCODER/4/DENSE/biases:0             (240,)
    ENCODER/4/BATCH_NORM/beta:0          (240,)
    ENCODER/5/DENSE/weights:0            (240, 217)
    ENCODER/5/DENSE/biases:0             (217,)
    ENCODER/5/BATCH_NORM/beta:0          (217,)
    POSTERIOR/MU/DENSE/weights:0         (217, 42)
    POSTERIOR/MU/DENSE/biases:0          (42,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (217, 42)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (42,)
    DECODER/5/DENSE/weights:0            (42, 217)
    DECODER/5/DENSE/biases:0             (217,)
    DECODER/5/BATCH_NORM/beta:0          (217,)
    DECODER/4/DENSE/weights:0            (217, 240)
    DECODER/4/DENSE/biases:0             (240,)
    DECODER/4/BATCH_NORM/beta:0          (240,)
    DECODER/3/DENSE/weights:0            (240, 63)
    DECODER/3/DENSE/biases:0             (63,)
    DECODER/3/BATCH_NORM/beta:0          (63,)
    DECODER/2/DENSE/weights:0            (63, 299)
    DECODER/2/DENSE/biases:0             (299,)
    DECODER/2/BATCH_NORM/beta:0          (299,)
    DECODER/1/DENSE/weights:0            (299, 188)
    DECODER/1/DENSE/biases:0             (188,)
    DECODER/1/BATCH_NORM/beta:0          (188,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (188, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (549 ms).

Training model for 50 epochs on original values.

Step 38 (36 ms): -2158.3.
Step 75 (37 ms): -1783.2.
Step 113 (35 ms): -1431.7.
Step 150 (36 ms): -1276.4.
Step 188 (36 ms): -1081.4.
Step 226 (36 ms): -955.8.
Step 263 (35 ms): -850.03.
Step 301 (36 ms): -810.34.
Step 338 (36 ms): -741.59.
Step 376 (19 ms): -636.83.

Epoch 1 (16.2 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.68 s): ELBO: -1650, ENRE: -1632.6, KL: 17.49.
    Saving model parameters.
    Model parameters saved (194 ms).

Step 414 (35 ms): -566.02.
Step 451 (35 ms): -551.68.
Step 489 (36 ms): -435.4.
Step 526 (36 ms): -436.86.
Step 564 (35 ms): -414.95.
Step 602 (36 ms): -381.98.
Step 639 (35 ms): -355.53.
Step 677 (36 ms): -339.05.
Step 714 (36 ms): -338.1.
Step 752 (19 ms): -343.31.

Epoch 2 (13.4 s):
    Warm-up weight: 0.5
    Evaluating model.
    Full set (6.04 s): ELBO: -805.66, ENRE: -797.3, KL: 8.364.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 790 (35 ms): -312.93.
Step 827 (35 ms): -294.79.
Step 865 (35 ms): -294.21.
Step 902 (35 ms): -295.72.
Step 940 (35 ms): -272.19.
Step 978 (35 ms): -281.75.
Step 1015 (35 ms): -272.85.
Step 1053 (35 ms): -260.22.
Step 1090 (35 ms): -242.74.
Step 1128 (17 ms): -284.27.

Epoch 3 (13.3 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -464.29, ENRE: -457.5, KL: 6.7982.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 1166 (35 ms): -241.88.
Step 1203 (35 ms): -246.43.
Step 1241 (35 ms): -250.97.
Step 1278 (35 ms): -253.13.
Step 1316 (36 ms): -242.09.
Step 1354 (35 ms): -264.64.
Step 1391 (35 ms): -245.95.
Step 1429 (35 ms): -243.79.
Step 1466 (35 ms): -251.18.
Step 1504 (17 ms): -310.96.

Epoch 4 (13.3 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -339.33, ENRE: -332.7, KL: 6.633.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 1542 (35 ms): -227.06.
Step 1579 (35 ms): -244.78.
Step 1617 (35 ms): -233.08.
Step 1654 (35 ms): -226.44.
Step 1692 (35 ms): -230.44.
Step 1730 (35 ms): -232.78.
Step 1767 (35 ms): -230.49.
Step 1805 (35 ms): -242.21.
Step 1842 (36 ms): -221.3.
Step 1880 (17 ms): -292.66.

Epoch 5 (13.3 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -282.7, ENRE: -275.8, KL: 6.8937.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 1918 (36 ms): -226.67.
Step 1955 (35 ms): -226.23.
Step 1993 (35 ms): -247.69.
Step 2030 (35 ms): -236.89.
Step 2068 (35 ms): -208.76.
Step 2106 (35 ms): -235.91.
Step 2143 (35 ms): -226.56.
Step 2181 (35 ms): -225.77.
Step 2218 (36 ms): -224.53.
Step 2256 (17 ms): -454.71.

Epoch 6 (13.4 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -254.75, ENRE: -248.07, KL: 6.6751.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 2294 (35 ms): -242.37.
Step 2331 (36 ms): -222.14.
Step 2369 (35 ms): -236.72.
Step 2406 (35 ms): -211.75.
Step 2444 (35 ms): -220.98.
Step 2482 (35 ms): -240.53.
Step 2519 (35 ms): -225.11.
Step 2557 (36 ms): -234.72.
Step 2594 (35 ms): -217.7.
Step 2632 (17 ms): -271.26.

Epoch 7 (13.3 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -236.01, ENRE: -228.55, KL: 7.4594.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 2670 (35 ms): -215.01.
Step 2707 (35 ms): -227.79.
Step 2745 (35 ms): -211.77.
Step 2782 (34 ms): -232.37.
Step 2820 (35 ms): -210.45.
Step 2858 (35 ms): -217.2.
Step 2895 (35 ms): -230.67.
Step 2933 (35 ms): -223.33.
Step 2970 (35 ms): -215.46.
Step 3008 (18 ms): -214.86.

Epoch 8 (13.2 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -226.37, ENRE: -218.97, KL: 7.4075.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 3046 (37 ms): -209.09.
Step 3083 (36 ms): -217.65.
Step 3121 (35 ms): -228.19.
Step 3158 (35 ms): -232.42.
Step 3196 (35 ms): -216.05.
Step 3234 (34 ms): -234.65.
Step 3271 (35 ms): -208.88.
Step 3309 (35 ms): -245.8.
Step 3346 (35 ms): -209.
Step 3384 (16 ms): -207.47.

Epoch 9 (13.2 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -221.09, ENRE: -213.6, KL: 7.4965.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 3422 (35 ms): -219.65.
Step 3459 (35 ms): -229.63.
Step 3497 (35 ms): -228.55.
Step 3534 (35 ms): -213.02.
Step 3572 (35 ms): -215.59.
Step 3610 (35 ms): -219.88.
Step 3647 (35 ms): -216.91.
Step 3685 (35 ms): -205.46.
Step 3722 (35 ms): -231.09.
Step 3760 (17 ms): -221.17.

Epoch 10 (13.3 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -217.46, ENRE: -209.77, KL: 7.6901.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 3798 (36 ms): -224.02.
Step 3835 (36 ms): -221.27.
Step 3873 (35 ms): -211.76.
Step 3910 (35 ms): -211.67.
Step 3948 (36 ms): -218.7.
Step 3986 (35 ms): -207.75.
Step 4023 (36 ms): -222.73.
Step 4061 (36 ms): -229.26.
Step 4098 (35 ms): -197.32.
Step 4136 (17 ms): -235.29.

Epoch 11 (13.4 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -215.35, ENRE: -207.99, KL: 7.3616.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 4174 (36 ms): -213.45.
Step 4211 (36 ms): -209.31.
Step 4249 (35 ms): -200.42.
Step 4286 (35 ms): -211.93.
Step 4324 (35 ms): -204.57.
Step 4362 (36 ms): -219.78.
Step 4399 (35 ms): -217.81.
Step 4437 (36 ms): -209.57.
Step 4474 (36 ms): -219.69.
Step 4512 (17 ms): -214.5.

Epoch 12 (13.3 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -213.56, ENRE: -206.29, KL: 7.2652.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 4550 (36 ms): -210.34.
Step 4587 (35 ms): -196.61.
Step 4625 (35 ms): -212.22.
Step 4662 (36 ms): -205.12.
Step 4700 (35 ms): -202.39.
Step 4738 (35 ms): -209.07.
Step 4775 (35 ms): -215.11.
Step 4813 (35 ms): -208.01.
Step 4850 (35 ms): -203.95.
Step 4888 (16 ms): -259.46.

Epoch 13 (13.3 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -213.02, ENRE: -205.96, KL: 7.0604.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 4926 (35 ms): -208.03.
Step 4963 (35 ms): -212.3.
Step 5001 (34 ms): -210.98.
Step 5038 (35 ms): -232.7.
Step 5076 (34 ms): -196.12.
Step 5114 (35 ms): -205.92.
Step 5151 (35 ms): -205.11.
Step 5189 (35 ms): -206.59.
Step 5226 (35 ms): -220.86.
Step 5264 (17 ms): -812.8.

Epoch 14 (13.2 s):
    Evaluating model.
    Full set (5.98 s): ELBO: -212.17, ENRE: -205.11, KL: 7.055.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 5302 (35 ms): -209.71.
Step 5339 (35 ms): -210.68.
Step 5377 (35 ms): -209.48.
Step 5414 (35 ms): -209.58.
Step 5452 (35 ms): -210.34.
Step 5490 (35 ms): -211.85.
Step 5527 (35 ms): -210.62.
Step 5565 (35 ms): -213.95.
Step 5602 (35 ms): -218.28.
Step 5640 (17 ms): -217.48.

Epoch 15 (13.2 s):
    Evaluating model.
    Full set (6 s): ELBO: -211.23, ENRE: -204.29, KL: 6.9428.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 5678 (35 ms): -212.87.
Step 5715 (35 ms): -217.96.
Step 5753 (35 ms): -217.55.
Step 5790 (35 ms): -207.76.
Step 5828 (35 ms): -201.49.
Step 5866 (35 ms): -219.35.
Step 5903 (36 ms): -217.87.
Step 5941 (35 ms): -204.08.
Step 5978 (35 ms): -200.56.
Step 6016 (17 ms): -243.18.

Epoch 16 (13.3 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -211.18, ENRE: -204.41, KL: 6.7672.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 6054 (36 ms): -201.76.
Step 6091 (36 ms): -204.12.
Step 6129 (36 ms): -196.65.
Step 6166 (36 ms): -205.18.
Step 6204 (35 ms): -209.72.
Step 6242 (36 ms): -213.68.
Step 6279 (36 ms): -193.56.
Step 6317 (35 ms): -213.
Step 6354 (36 ms): -200.45.
Step 6392 (17 ms): -220.78.

Epoch 17 (13.4 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -210.25, ENRE: -203.54, KL: 6.7076.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 6430 (35 ms): -199.79.
Step 6467 (35 ms): -199.79.
Step 6505 (35 ms): -203.21.
Step 6542 (36 ms): -209.91.
Step 6580 (35 ms): -213.19.
Step 6618 (35 ms): -198.76.
Step 6655 (36 ms): -196.62.
Step 6693 (35 ms): -202.19.
Step 6730 (35 ms): -211.25.
Step 6768 (17 ms): -240.65.

Epoch 18 (13.3 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -209.84, ENRE: -203.25, KL: 6.5849.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 6806 (36 ms): -217.43.
Step 6843 (36 ms): -209.59.
Step 6881 (35 ms): -198.37.
Step 6918 (37 ms): -211.29.
Step 6956 (36 ms): -196.69.
Step 6994 (36 ms): -206.79.
Step 7031 (35 ms): -210.96.
Step 7069 (36 ms): -214.04.
Step 7106 (36 ms): -206.95.
Step 7144 (16 ms): -213.72.

Epoch 19 (13.3 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -209.5, ENRE: -202.92, KL: 6.5782.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 7182 (35 ms): -202.35.
Step 7219 (35 ms): -205.48.
Step 7257 (35 ms): -200.92.
Step 7294 (36 ms): -204.36.
Step 7332 (35 ms): -209.29.
Step 7370 (36 ms): -195.15.
Step 7407 (35 ms): -202.25.
Step 7445 (35 ms): -203.61.
Step 7482 (35 ms): -213.96.
Step 7520 (16 ms): -324.85.

Epoch 20 (13.2 s):
    Evaluating model.
    Full set (5.97 s): ELBO: -209.37, ENRE: -202.69, KL: 6.6889.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 7558 (35 ms): -216.22.
Step 7595 (36 ms): -208.66.
Step 7633 (35 ms): -207.73.
Step 7670 (36 ms): -207.35.
Step 7708 (36 ms): -205.45.
Step 7746 (35 ms): -204.77.
Step 7783 (36 ms): -208.59.
Step 7821 (36 ms): -204.31.
Step 7858 (36 ms): -205.5.
Step 7896 (17 ms): -188.88.

Epoch 21 (13.2 s):
    Evaluating model.
    Full set (6 s): ELBO: -208.84, ENRE: -202.41, KL: 6.4272.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 7934 (35 ms): -214.41.
Step 7971 (35 ms): -218.96.
Step 8009 (35 ms): -187.77.
Step 8046 (35 ms): -198.35.
Step 8084 (35 ms): -212.09.
Step 8122 (36 ms): -194.82.
Step 8159 (35 ms): -200.47.
Step 8197 (35 ms): -200.47.
Step 8234 (35 ms): -194.18.
Step 8272 (17 ms): -240.38.

Epoch 22 (13.3 s):
    Evaluating model.
    Full set (6 s): ELBO: -206.83, ENRE: -200.49, KL: 6.3441.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 8310 (35 ms): -196.16.
Step 8347 (35 ms): -206.86.
Step 8385 (36 ms): -206.36.
Step 8422 (38 ms): -200.24.
Step 8460 (35 ms): -206.02.
Step 8498 (36 ms): -208.09.
Step 8535 (36 ms): -219.96.
Step 8573 (35 ms): -204.3.
Step 8610 (35 ms): -203.46.
Step 8648 (19 ms): -233.47.

Epoch 23 (13.4 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -207.33, ENRE: -201.02, KL: 6.3192.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 8686 (35 ms): -196.67.
Step 8723 (35 ms): -184.06.
Step 8761 (35 ms): -213.45.
Step 8798 (37 ms): -201.29.
Step 8836 (35 ms): -217.31.
Step 8874 (35 ms): -204.31.
Step 8911 (35 ms): -194.99.
Step 8949 (35 ms): -219.28.
Step 8986 (35 ms): -219.25.
Step 9024 (19 ms): -195.62.

Epoch 24 (13.3 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -205.95, ENRE: -199.77, KL: 6.1773.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 9062 (35 ms): -208.07.
Step 9099 (36 ms): -201.38.
Step 9137 (35 ms): -203.42.
Step 9174 (35 ms): -199.84.
Step 9212 (35 ms): -214.45.
Step 9250 (35 ms): -209.46.
Step 9287 (35 ms): -191.08.
Step 9325 (36 ms): -203.28.
Step 9362 (35 ms): -204.68.
Step 9400 (17 ms): -354.16.

Epoch 25 (13.3 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -206.64, ENRE: -200.32, KL: 6.3197.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 9438 (36 ms): -198.71.
Step 9475 (35 ms): -207.16.
Step 9513 (35 ms): -196.89.
Step 9550 (35 ms): -204.36.
Step 9588 (35 ms): -205.77.
Step 9626 (35 ms): -199.57.
Step 9663 (35 ms): -201.49.
Step 9701 (36 ms): -206.63.
Step 9738 (35 ms): -199.51.
Step 9776 (16 ms): -264.13.

Epoch 26 (13.2 s):
    Evaluating model.
    Full set (5.98 s): ELBO: -204.58, ENRE: -198.45, KL: 6.1312.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 9814 (35 ms): -202.31.
Step 9851 (36 ms): -196.21.
Step 9889 (35 ms): -208.39.
Step 9926 (35 ms): -199.84.
Step 9964 (34 ms): -203.26.
Step 10002 (35 ms): -202.93.
Step 10039 (35 ms): -198.08.
Step 10077 (35 ms): -204.54.
Step 10114 (35 ms): -211.2.
Step 10152 (17 ms): -214.94.

Epoch 27 (13.1 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -203.83, ENRE: -197.72, KL: 6.1176.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 10190 (35 ms): -195.37.
Step 10227 (35 ms): -206.59.
Step 10265 (37 ms): -219.19.
Step 10302 (35 ms): -188.6.
Step 10340 (35 ms): -195.18.
Step 10378 (35 ms): -193.49.
Step 10415 (37 ms): -198.54.
Step 10453 (35 ms): -209.94.
Step 10490 (36 ms): -198.6.
Step 10528 (17 ms): -291.09.

Epoch 28 (13.3 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -203.93, ENRE: -197.71, KL: 6.2173.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 10566 (35 ms): -193.75.
Step 10603 (36 ms): -208.22.
Step 10641 (35 ms): -194.13.
Step 10678 (36 ms): -197.56.
Step 10716 (35 ms): -210.58.
Step 10754 (35 ms): -201.87.
Step 10791 (36 ms): -209.93.
Step 10829 (36 ms): -213.48.
Step 10866 (35 ms): -205.59.
Step 10904 (17 ms): -170.95.

Epoch 29 (13.4 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -203.57, ENRE: -197.25, KL: 6.32.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 10942 (36 ms): -203.34.
Step 10979 (36 ms): -213.18.
Step 11017 (36 ms): -208.31.
Step 11054 (35 ms): -195.87.
Step 11092 (35 ms): -204.2.
Step 11130 (36 ms): -193.98.
Step 11167 (36 ms): -208.9.
Step 11205 (35 ms): -191.28.
Step 11242 (35 ms): -200.31.
Step 11280 (17 ms): -190.42.

Epoch 30 (13.4 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -203.52, ENRE: -197.14, KL: 6.385.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 11318 (35 ms): -197.99.
Step 11355 (35 ms): -197.16.
Step 11393 (35 ms): -211.99.
Step 11430 (35 ms): -194.65.
Step 11468 (36 ms): -212.19.
Step 11506 (35 ms): -193.53.
Step 11543 (36 ms): -214.51.
Step 11581 (35 ms): -199.34.
Step 11618 (35 ms): -198.93.
Step 11656 (16 ms): -209.58.

Epoch 31 (13.3 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -202.85, ENRE: -196.6, KL: 6.2515.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 11694 (35 ms): -200.12.
Step 11731 (35 ms): -208.09.
Step 11769 (36 ms): -197.54.
Step 11806 (35 ms): -199.98.
Step 11844 (36 ms): -198.94.
Step 11882 (35 ms): -200.92.
Step 11919 (35 ms): -197.03.
Step 11957 (35 ms): -214.68.
Step 11994 (35 ms): -201.09.
Step 12032 (16 ms): -228.26.

Epoch 32 (13.2 s):
    Evaluating model.
    Full set (5.98 s): ELBO: -202.44, ENRE: -196.08, KL: 6.3596.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 12070 (35 ms): -194.61.
Step 12107 (35 ms): -194.91.
Step 12145 (35 ms): -203.91.
Step 12182 (35 ms): -210.74.
Step 12220 (34 ms): -197.82.
Step 12258 (35 ms): -206.35.
Step 12295 (34 ms): -210.9.
Step 12333 (34 ms): -192.53.
Step 12370 (35 ms): -185.16.
Step 12408 (16 ms): -201.24.

Epoch 33 (13.1 s):
    Evaluating model.
    Full set (6 s): ELBO: -202.59, ENRE: -196.3, KL: 6.2939.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 12446 (35 ms): -198.34.
Step 12483 (36 ms): -205.44.
Step 12521 (36 ms): -214.69.
Step 12558 (35 ms): -201.06.
Step 12596 (35 ms): -213.06.
Step 12634 (35 ms): -196.93.
Step 12671 (35 ms): -211.49.
Step 12709 (35 ms): -202.65.
Step 12746 (35 ms): -194.94.
Step 12784 (17 ms): -216.22.

Epoch 34 (13.3 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -202.38, ENRE: -196.04, KL: 6.3417.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 12822 (36 ms): -217.65.
Step 12859 (35 ms): -200.2.
Step 12897 (35 ms): -189.51.
Step 12934 (36 ms): -203.85.
Step 12972 (36 ms): -202.73.
Step 13010 (35 ms): -199.64.
Step 13047 (35 ms): -190.22.
Step 13085 (35 ms): -207.05.
Step 13122 (36 ms): -199.48.
Step 13160 (17 ms): -239.26.

Epoch 35 (13.3 s):
    Evaluating model.
    Full set (6 s): ELBO: -202.06, ENRE: -195.57, KL: 6.4978.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 13198 (36 ms): -207.16.
Step 13235 (35 ms): -205.88.
Step 13273 (36 ms): -195.21.
Step 13310 (35 ms): -196.74.
Step 13348 (35 ms): -201.67.
Step 13386 (35 ms): -209.98.
Step 13423 (35 ms): -197.71.
Step 13461 (35 ms): -196.42.
Step 13498 (35 ms): -210.87.
Step 13536 (17 ms): -249.71.

Epoch 36 (13.4 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -202.35, ENRE: -195.96, KL: 6.3889.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 13574 (36 ms): -198.02.
Step 13611 (35 ms): -216.52.
Step 13649 (36 ms): -197.36.
Step 13686 (35 ms): -198.29.
Step 13724 (36 ms): -196.13.
Step 13762 (35 ms): -201.41.
Step 13799 (36 ms): -204.95.
Step 13837 (35 ms): -203.98.
Step 13874 (35 ms): -198.35.
Step 13912 (17 ms): -182.75.

Epoch 37 (13.3 s):
    Evaluating model.
    Full set (5.99 s): ELBO: -202.21, ENRE: -195.85, KL: 6.3581.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 13950 (35 ms): -200.53.
Step 13987 (35 ms): -196.48.
Step 14025 (35 ms): -205.35.
Step 14062 (36 ms): -220.63.
Step 14100 (35 ms): -197.42.
Step 14138 (35 ms): -212.81.
Step 14175 (35 ms): -204.1.
Step 14213 (35 ms): -199.26.
Step 14250 (35 ms): -200.75.
Step 14288 (17 ms): -214.49.

Epoch 38 (13.3 s):
    Evaluating model.
    Full set (6 s): ELBO: -201.48, ENRE: -195.05, KL: 6.4227.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 14326 (35 ms): -199.06.
Step 14363 (35 ms): -212.75.
Step 14401 (35 ms): -204.54.
Step 14438 (35 ms): -198.57.
Step 14476 (35 ms): -213.55.
Step 14514 (35 ms): -202.03.
Step 14551 (35 ms): -221.37.
Step 14589 (35 ms): -208.28.
Step 14626 (35 ms): -192.12.
Step 14664 (17 ms): -233.48.

Epoch 39 (13.2 s):
    Evaluating model.
    Full set (5.95 s): ELBO: -201.71, ENRE: -195.28, KL: 6.4272.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 14702 (35 ms): -208.12.
Step 14739 (35 ms): -218.53.
Step 14777 (35 ms): -198.62.
Step 14814 (36 ms): -192.92.
Step 14852 (36 ms): -206.18.
Step 14890 (35 ms): -212.21.
Step 14927 (36 ms): -192.43.
Step 14965 (37 ms): -199.85.
Step 15002 (36 ms): -201.63.
Step 15040 (18 ms): -208.19.

Epoch 40 (13.4 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -200.83, ENRE: -194.5, KL: 6.3307.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 15078 (36 ms): -195.47.
Step 15115 (35 ms): -199.45.
Step 15153 (36 ms): -188.78.
Step 15190 (35 ms): -199.49.
Step 15228 (36 ms): -195.09.
Step 15266 (35 ms): -215.69.
Step 15303 (35 ms): -207.42.
Step 15341 (37 ms): -201.99.
Step 15378 (35 ms): -192.21.
Step 15416 (17 ms): -219.88.

Epoch 41 (13.4 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -200.93, ENRE: -194.57, KL: 6.3609.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 15454 (36 ms): -189.68.
Step 15491 (36 ms): -189.92.
Step 15529 (38 ms): -199.25.
Step 15566 (36 ms): -202.52.
Step 15604 (35 ms): -200.14.
Step 15642 (36 ms): -185.32.
Step 15679 (36 ms): -194.55.
Step 15717 (38 ms): -213.72.
Step 15754 (37 ms): -195.56.
Step 15792 (19 ms): -244.98.

Epoch 42 (13.5 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -200.54, ENRE: -194.29, KL: 6.2523.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 15830 (35 ms): -207.46.
Step 15867 (36 ms): -204.47.
Step 15905 (35 ms): -206.47.
Step 15942 (35 ms): -195.23.
Step 15980 (35 ms): -201.19.
Step 16018 (35 ms): -191.86.
Step 16055 (35 ms): -192.81.
Step 16093 (35 ms): -206.03.
Step 16130 (35 ms): -203.63.
Step 16168 (17 ms): -247.93.

Epoch 43 (13.3 s):
    Evaluating model.
    Full set (5.97 s): ELBO: -200.9, ENRE: -194.48, KL: 6.4208.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 16206 (35 ms): -193.61.
Step 16243 (36 ms): -197.57.
Step 16281 (35 ms): -200.33.
Step 16318 (35 ms): -193.47.
Step 16356 (35 ms): -194.78.
Step 16394 (35 ms): -204.73.
Step 16431 (35 ms): -204.8.
Step 16469 (35 ms): -191.85.
Step 16506 (35 ms): -194.83.
Step 16544 (16 ms): -363.2.

Epoch 44 (13.2 s):
    Evaluating model.
    Full set (6 s): ELBO: -200.42, ENRE: -194.07, KL: 6.3555.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 16582 (35 ms): -195.89.
Step 16619 (35 ms): -203.9.
Step 16657 (35 ms): -198.57.
Step 16694 (35 ms): -198.
Step 16732 (35 ms): -198.59.
Step 16770 (35 ms): -195.65.
Step 16807 (35 ms): -198.23.
Step 16845 (34 ms): -206.03.
Step 16882 (35 ms): -199.57.
Step 16920 (17 ms): -187.21.

Epoch 45 (13.2 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -200.73, ENRE: -194.29, KL: 6.4391.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 16958 (35 ms): -192.95.
Step 16995 (35 ms): -202.65.
Step 17033 (36 ms): -200.72.
Step 17070 (36 ms): -213.69.
Step 17108 (36 ms): -202.
Step 17146 (36 ms): -207.84.
Step 17183 (36 ms): -190.27.
Step 17221 (35 ms): -193.69.
Step 17258 (36 ms): -198.46.
Step 17296 (17 ms): -212.19.

Epoch 46 (13.4 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -200.52, ENRE: -194.07, KL: 6.4508.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 17334 (35 ms): -192.84.
Step 17371 (36 ms): -214.31.
Step 17409 (35 ms): -197.32.
Step 17446 (36 ms): -208.69.
Step 17484 (36 ms): -209.02.
Step 17522 (35 ms): -204.19.
Step 17559 (36 ms): -208.72.
Step 17597 (36 ms): -202.15.
Step 17634 (35 ms): -204.79.
Step 17672 (17 ms): -205.09.

Epoch 47 (13.4 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -200.21, ENRE: -193.89, KL: 6.3135.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 17710 (35 ms): -190.69.
Step 17747 (36 ms): -199.84.
Step 17785 (35 ms): -205.66.
Step 17822 (35 ms): -204.97.
Step 17860 (35 ms): -199.89.
Step 17898 (36 ms): -199.91.
Step 17935 (36 ms): -207.43.
Step 17973 (37 ms): -192.95.
Step 18010 (35 ms): -193.2.
Step 18048 (17 ms): -188.59.

Epoch 48 (13.4 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -199.89, ENRE: -193.61, KL: 6.2792.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 18086 (36 ms): -194.29.
Step 18123 (36 ms): -191.97.
Step 18161 (36 ms): -186.59.
Step 18198 (35 ms): -208.65.
Step 18236 (35 ms): -200.12.
Step 18274 (36 ms): -201.45.
Step 18311 (36 ms): -216.06.
Step 18349 (35 ms): -200.64.
Step 18386 (35 ms): -206.48.
Step 18424 (17 ms): -217.59.

Epoch 49 (13.3 s):
    Evaluating model.
    Full set (6 s): ELBO: -200.36, ENRE: -194.13, KL: 6.231.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 18462 (35 ms): -198.92.
Step 18499 (35 ms): -188.13.
Step 18537 (35 ms): -203.66.
Step 18574 (34 ms): -196.83.
Step 18612 (35 ms): -190.92.
Step 18650 (35 ms): -194.99.
Step 18687 (35 ms): -195.78.
Step 18725 (35 ms): -201.25.
Step 18762 (35 ms): -190.29.
Step 18800 (17 ms): -284.9.

Epoch 50 (13.2 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -200.22, ENRE: -193.87, KL: 6.3444.
    Saving model parameters.
    Model parameters saved (123 ms).

Model trained for 50 epochs (16m 18s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (11 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (923 ms).

Converting data set value array to sparse matrix.
Data set value array converted (313 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2.2 s):  ELBO: -425.46, ENRE: -419.11, KL: 6.3481.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (752 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.220460987372196
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 18
kl weight: 1.220460987372196
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (45 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.14 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.87 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 18
    hidden sizes: 208, 127, 86, 161
    latent distribution: gaussian
    reconstruction distribution: gaussian
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.220460987372196
    using analytical KL term
    using batch normalisation for minibatches
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 208)
    ENCODER/1/DENSE/biases:0             (208,)
    ENCODER/1/BATCH_NORM/beta:0          (208,)
    ENCODER/2/DENSE/weights:0            (208, 127)
    ENCODER/2/DENSE/biases:0             (127,)
    ENCODER/2/BATCH_NORM/beta:0          (127,)
    ENCODER/3/DENSE/weights:0            (127, 86)
    ENCODER/3/DENSE/biases:0             (86,)
    ENCODER/3/BATCH_NORM/beta:0          (86,)
    ENCODER/4/DENSE/weights:0            (86, 161)
    ENCODER/4/DENSE/biases:0             (161,)
    ENCODER/4/BATCH_NORM/beta:0          (161,)
    POSTERIOR/MU/DENSE/weights:0         (161, 18)
    POSTERIOR/MU/DENSE/biases:0          (18,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (161, 18)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (18,)
    DECODER/4/DENSE/weights:0            (18, 161)
    DECODER/4/DENSE/biases:0             (161,)
    DECODER/4/BATCH_NORM/beta:0          (161,)
    DECODER/3/DENSE/weights:0            (161, 86)
    DECODER/3/DENSE/biases:0             (86,)
    DECODER/3/BATCH_NORM/beta:0          (86,)
    DECODER/2/DENSE/weights:0            (86, 127)
    DECODER/2/DENSE/biases:0             (127,)
    DECODER/2/BATCH_NORM/beta:0          (127,)
    DECODER/1/DENSE/weights:0            (127, 208)
    DECODER/1/DENSE/biases:0             (208,)
    DECODER/1/BATCH_NORM/beta:0          (208,)
    X_TILDE/MU/DENSE/weights:0           (208, 2000)
    X_TILDE/MU/DENSE/biases:0            (2000,)
    X_TILDE/LOG_SIGMA/DENSE/weights:0    (208, 2000)
    X_TILDE/LOG_SIGMA/DENSE/biases:0     (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (495 ms).

Training model for 50 epochs on original values.

Step 38 (35 ms): -2991.2.
Step 75 (36 ms): -2163.2.
Step 113 (34 ms): -1225.7.
Step 150 (35 ms): -720.63.
Step 188 (36 ms): -225.86.
Step 226 (36 ms): 163.
Step 263 (35 ms): 443.64.
Step 301 (35 ms): 704.62.
Step 338 (35 ms): 1215.9.
Step 376 (23 ms): 1244.4.

Epoch 1 (15.8 s):
    Evaluating model.
    Full set (5.97 s): ELBO: -2098.3, ENRE: -2079.2, KL: 19.09.
    Saving model parameters.
    Model parameters saved (195 ms).

Step 414 (36 ms): 1663.
Step 451 (36 ms): 1878.
Step 489 (36 ms): 1848.2.
Step 526 (38 ms): 2091.2.
Step 564 (36 ms): 2150.
Step 602 (36 ms): 2197.4.
Step 639 (35 ms): 2008.8.
Step 677 (35 ms): 2217.6.
Step 714 (36 ms): 2263.1.
Step 752 (17 ms): 1535.6.

Epoch 2 (13.5 s):
    Evaluating model.
    Full set (5.26 s): ELBO: 893.24, ENRE: 925.84, KL: 32.605.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 790 (35 ms): 2269.3.
Step 827 (35 ms): 2454.5.
Step 865 (36 ms): 2353.4.
Step 902 (35 ms): 2537.7.
Step 940 (35 ms): 2347.9.
Step 978 (35 ms): 2486.6.
Step 1015 (35 ms): 2446.1.
Step 1053 (35 ms): 2403.2.
Step 1090 (35 ms): 2339.6.
Step 1128 (17 ms): 2054.9.

Epoch 3 (13.3 s):
    Evaluating model.
    Full set (5.35 s): ELBO: 1770.6, ENRE: 1784.8, KL: 14.273.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 1166 (36 ms): 2561.1.
Step 1203 (36 ms): 2334.1.
Step 1241 (36 ms): 2385.7.
Step 1278 (35 ms): 2452.5.
Step 1316 (36 ms): 2541.2.
Step 1354 (36 ms): 2557.4.
Step 1391 (36 ms): 2485.6.
Step 1429 (36 ms): 2561.7.
Step 1466 (35 ms): 2544.9.
Step 1504 (18 ms): 1303.8.

Epoch 4 (13.4 s):
    Evaluating model.
    Full set (5.27 s): ELBO: 2368.9, ENRE: 2383.9, KL: 15.084.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 1542 (35 ms): 2480.
Step 1579 (35 ms): 2583.4.
Step 1617 (35 ms): 2549.2.
Step 1654 (35 ms): 2541.8.
Step 1692 (35 ms): 2479.9.
Step 1730 (35 ms): 2589.8.
Step 1767 (35 ms): 2471.2.
Step 1805 (35 ms): 2549.9.
Step 1842 (34 ms): 2652.2.
Step 1880 (17 ms): 1167.2.

Epoch 5 (13.1 s):
    Evaluating model.
    Full set (5.31 s): ELBO: 2427.2, ENRE: 2443.8, KL: 16.561.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 1918 (35 ms): 2575.9.
Step 1955 (35 ms): 2385.2.
Step 1993 (35 ms): 2595.3.
Step 2030 (35 ms): 2421.4.
Step 2068 (35 ms): 2530.7.
Step 2106 (35 ms): 2667.5.
Step 2143 (36 ms): 2572.7.
Step 2181 (35 ms): 2544.3.
Step 2218 (36 ms): 2583.8.
Step 2256 (17 ms): 1742.6.

Epoch 6 (13.3 s):
    Evaluating model.
    Full set (5.26 s): ELBO: 2420.1, ENRE: 2438, KL: 17.912.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 2294 (35 ms): 2674.1.
Step 2331 (36 ms): 2465.1.
Step 2369 (35 ms): 2579.7.
Step 2406 (35 ms): 2576.8.
Step 2444 (35 ms): 2603.3.
Step 2482 (35 ms): 2610.3.
Step 2519 (35 ms): 2533.4.
Step 2557 (36 ms): 2591.5.
Step 2594 (35 ms): 2540.
Step 2632 (17 ms): 1879.9.

Epoch 7 (13.3 s):
    Evaluating model.
    Full set (5.49 s): ELBO: 2413.1, ENRE: 2431.5, KL: 18.405.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 2670 (36 ms): 2570.6.
Step 2707 (37 ms): 2639.7.
Step 2745 (37 ms): 2518.9.
Step 2782 (37 ms): 2554.3.
Step 2820 (36 ms): 2581.5.
Step 2858 (38 ms): 2496.5.
Step 2895 (36 ms): 2594.1.
Step 2933 (38 ms): 2643.7.
Step 2970 (37 ms): 2645.2.
Step 3008 (17 ms): -10112.

Epoch 8 (14 s):
    Evaluating model.
    Full set (5.51 s): ELBO: 2363.3, ENRE: 2381.6, KL: 18.291.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 3046 (37 ms): 2667.3.
Step 3083 (36 ms): 2591.6.
Step 3121 (37 ms): 2718.2.
Step 3158 (37 ms): 2581.1.
Step 3196 (37 ms): 2633.2.
Step 3234 (37 ms): 2502.6.
Step 3271 (37 ms): 2614.2.
Step 3309 (37 ms): 2608.2.
Step 3346 (37 ms): 2540.6.
Step 3384 (18 ms): 319.32.

Epoch 9 (13.9 s):
    Evaluating model.
    Full set (5.59 s): ELBO: 2390.8, ENRE: 2409.2, KL: 18.345.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 3422 (37 ms): 2616.5.
Step 3459 (38 ms): 2312.
Step 3497 (37 ms): 2684.1.
Step 3534 (36 ms): 2531.7.
Step 3572 (37 ms): 2622.8.
Step 3610 (38 ms): 2370.9.
Step 3647 (37 ms): 2591.6.
Step 3685 (37 ms): 2600.7.
Step 3722 (37 ms): 2680.8.
Step 3760 (17 ms): 368.97.

Epoch 10 (14 s):
    Evaluating model.
    Full set (5.5 s): ELBO: 2307.9, ENRE: 2327.1, KL: 19.244.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 3798 (35 ms): 2548.1.
Step 3835 (37 ms): 2658.
Step 3873 (37 ms): 2603.9.
Step 3910 (37 ms): 2577.9.
Step 3948 (36 ms): 2372.3.
Step 3986 (37 ms): 2640.3.
Step 4023 (37 ms): 2626.7.
Step 4061 (36 ms): 2668.7.
Step 4098 (38 ms): 2645.
Step 4136 (17 ms): 26.557.

Epoch 11 (13.8 s):
    Evaluating model.
    Full set (5.58 s): ELBO: 2334.9, ENRE: 2353.9, KL: 18.983.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 4174 (37 ms): 2555.6.
Step 4211 (37 ms): 2627.5.
Step 4249 (37 ms): 2578.7.
Step 4286 (37 ms): 2695.3.
Step 4324 (37 ms): 2696.
Step 4362 (36 ms): 2593.2.
Step 4399 (36 ms): 2581.8.
Step 4437 (37 ms): 2571.
Step 4474 (37 ms): 2667.4.
Step 4512 (18 ms): 505.82.

Epoch 12 (13.8 s):
    Evaluating model.
    Full set (5.51 s): ELBO: 2298.7, ENRE: 2319.2, KL: 20.524.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 4550 (37 ms): 2638.5.
Step 4587 (37 ms): 2599.9.
Step 4625 (37 ms): 2667.8.
Step 4662 (36 ms): 2564.5.
Step 4700 (37 ms): 2655.4.
Step 4738 (38 ms): 2601.2.
Step 4775 (37 ms): 2643.5.
Step 4813 (38 ms): 2522.2.
Step 4850 (37 ms): 2641.4.
Step 4888 (18 ms): 1697.7.

Epoch 13 (13.9 s):
    Evaluating model.
    Full set (5.58 s): ELBO: 2333.4, ENRE: 2353, KL: 19.676.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 4926 (37 ms): 2702.3.
Step 4963 (38 ms): 2634.8.
Step 5001 (37 ms): 2569.6.
Step 5038 (39 ms): 2627.7.
Step 5076 (37 ms): 2636.1.
Step 5114 (37 ms): 2639.3.
Step 5151 (36 ms): 2563.8.
Step 5189 (37 ms): 2617.3.
Step 5226 (37 ms): 2622.1.
Step 5264 (19 ms): 359.75.

Epoch 14 (14 s):
    Evaluating model.
    Full set (5.49 s): ELBO: 2368.9, ENRE: 2388.9, KL: 20.059.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 5302 (37 ms): 2608.
Step 5339 (37 ms): 2616.1.
Step 5377 (37 ms): 2693.1.
Step 5414 (37 ms): 2601.
Step 5452 (38 ms): 2632.7.
Step 5490 (37 ms): 2660.8.
Step 5527 (37 ms): 2697.2.
Step 5565 (37 ms): 2617.3.
Step 5602 (37 ms): 2670.
Step 5640 (18 ms): -3006.

Epoch 15 (13.9 s):
    Evaluating model.
    Full set (5.57 s): ELBO: 2409.3, ENRE: 2429.2, KL: 19.942.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 5678 (36 ms): 2638.2.
Step 5715 (37 ms): 2606.4.
Step 5753 (38 ms): 2619.7.
Step 5790 (37 ms): 2532.2.
Step 5828 (37 ms): 2669.2.
Step 5866 (37 ms): 2690.4.
Step 5903 (36 ms): 2682.2.
Step 5941 (37 ms): 2715.8.
Step 5978 (36 ms): 2718.7.
Step 6016 (18 ms): -3440.3.

Epoch 16 (13.9 s):
    Evaluating model.
    Full set (5.48 s): ELBO: 2448, ENRE: 2467.1, KL: 19.065.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 6054 (37 ms): 2590.3.
Step 6091 (36 ms): 2725.1.
Step 6129 (37 ms): 2668.3.
Step 6166 (37 ms): 2558.7.
Step 6204 (37 ms): 2579.3.
Step 6242 (37 ms): 2738.3.
Step 6279 (37 ms): 2707.6.
Step 6317 (36 ms): 2694.3.
Step 6354 (37 ms): 2604.8.
Step 6392 (18 ms): 1825.6.

Epoch 17 (13.8 s):
    Evaluating model.
    Full set (5.56 s): ELBO: 2455.7, ENRE: 2474.7, KL: 18.951.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 6430 (37 ms): 2685.4.
Step 6467 (38 ms): 2645.8.
Step 6505 (37 ms): 2704.5.
Step 6542 (36 ms): 2692.1.
Step 6580 (37 ms): 2694.7.
Step 6618 (36 ms): 2691.7.
Step 6655 (36 ms): 2661.
Step 6693 (37 ms): 2685.9.
Step 6730 (37 ms): 2588.4.
Step 6768 (18 ms): 1204.6.

Epoch 18 (13.9 s):
    Evaluating model.
    Full set (5.45 s): ELBO: 2486.8, ENRE: 2505.3, KL: 18.502.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 6806 (36 ms): 2741.6.
Step 6843 (37 ms): 2687.7.
Step 6881 (39 ms): 2677.7.
Step 6918 (38 ms): 2566.6.
Step 6956 (36 ms): 2582.8.
Step 6994 (38 ms): 2587.8.
Step 7031 (37 ms): 2563.4.
Step 7069 (37 ms): 2588.9.
Step 7106 (37 ms): 2569.1.
Step 7144 (17 ms): 1337.6.

Epoch 19 (13.9 s):
    Evaluating model.
    Full set (5.61 s): ELBO: 2492.5, ENRE: 2510.8, KL: 18.304.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 7182 (38 ms): 2586.5.
Step 7219 (37 ms): 2664.5.
Step 7257 (37 ms): 2665.2.
Step 7294 (37 ms): 2602.3.
Step 7332 (37 ms): 2658.9.
Step 7370 (38 ms): 2545.5.
Step 7407 (36 ms): 2671.3.
Step 7445 (40 ms): 2700.
Step 7482 (37 ms): 2664.6.
Step 7520 (18 ms): -2015.8.

Epoch 20 (14 s):
    Evaluating model.
    Full set (5.47 s): ELBO: 2474.9, ENRE: 2493.8, KL: 18.94.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 7558 (37 ms): 2619.6.
Step 7595 (37 ms): 2676.9.
Step 7633 (37 ms): 2674.2.
Step 7670 (37 ms): 2664.8.
Step 7708 (36 ms): 2664.3.
Step 7746 (37 ms): 2665.6.
Step 7783 (38 ms): 2582.8.
Step 7821 (38 ms): 2650.9.
Step 7858 (37 ms): 2721.5.
Step 7896 (18 ms): 818.46.

Epoch 21 (13.9 s):
    Evaluating model.
    Full set (5.61 s): ELBO: 2546.1, ENRE: 2563.6, KL: 17.429.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 7934 (37 ms): 2720.3.
Step 7971 (37 ms): 2771.3.
Step 8009 (37 ms): 2704.6.
Step 8046 (37 ms): 2773.
Step 8084 (37 ms): 2778.3.
Step 8122 (37 ms): 2758.6.
Step 8159 (37 ms): 2716.1.
Step 8197 (37 ms): 2719.5.
Step 8234 (37 ms): 2697.2.
Step 8272 (18 ms): -2699.6.

Epoch 22 (14 s):
    Evaluating model.
    Full set (5.48 s): ELBO: 2560.4, ENRE: 2578, KL: 17.608.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 8310 (36 ms): 2705.4.
Step 8347 (37 ms): 2693.7.
Step 8385 (36 ms): 2693.
Step 8422 (37 ms): 2498.1.
Step 8460 (37 ms): 2690.3.
Step 8498 (37 ms): 2704.1.
Step 8535 (37 ms): 2645.
Step 8573 (37 ms): 2666.6.
Step 8610 (36 ms): 2684.5.
Step 8648 (18 ms): 968.65.

Epoch 23 (13.8 s):
    Evaluating model.
    Full set (5.62 s): ELBO: 2586.1, ENRE: 2603, KL: 16.983.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 8686 (37 ms): 2705.9.
Step 8723 (37 ms): 2589.3.
Step 8761 (37 ms): 2594.
Step 8798 (37 ms): 2742.5.
Step 8836 (38 ms): 2676.8.
Step 8874 (37 ms): 2757.7.
Step 8911 (38 ms): 2738.5.
Step 8949 (38 ms): 2678.2.
Step 8986 (38 ms): 2743.9.
Step 9024 (18 ms): 1496.

Epoch 24 (14 s):
    Evaluating model.
    Full set (5.5 s): ELBO: 2583.6, ENRE: 2600.7, KL: 17.039.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 9062 (38 ms): 2773.5.
Step 9099 (37 ms): 2666.5.
Step 9137 (36 ms): 2706.3.
Step 9174 (37 ms): 2674.3.
Step 9212 (37 ms): 2695.2.
Step 9250 (37 ms): 2730.3.
Step 9287 (39 ms): 2742.2.
Step 9325 (37 ms): 2766.6.
Step 9362 (36 ms): 2729.1.
Step 9400 (17 ms): 1020.1.

Epoch 25 (13.9 s):
    Evaluating model.
    Full set (5.6 s): ELBO: 2603.5, ENRE: 2620.4, KL: 16.855.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 9438 (38 ms): 2696.7.
Step 9475 (37 ms): 2720.
Step 9513 (38 ms): 2753.9.
Step 9550 (38 ms): 2749.8.
Step 9588 (38 ms): 2741.9.
Step 9626 (37 ms): 2636.5.
Step 9663 (37 ms): 2765.1.
Step 9701 (37 ms): 2633.1.
Step 9738 (37 ms): 2686.1.
Step 9776 (18 ms): 612.13.

Epoch 26 (14 s):
    Evaluating model.
    Full set (5.48 s): ELBO: 2563.7, ENRE: 2581.2, KL: 17.551.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 9814 (37 ms): 2725.5.
Step 9851 (37 ms): 2679.8.
Step 9889 (38 ms): 2733.5.
Step 9926 (37 ms): 2662.4.
Step 9964 (37 ms): 2674.8.
Step 10002 (36 ms): 2694.5.
Step 10039 (37 ms): 2730.2.
Step 10077 (36 ms): 2729.4.
Step 10114 (37 ms): 2656.6.
Step 10152 (18 ms): 291.75.

Epoch 27 (13.8 s):
    Evaluating model.
    Full set (5.57 s): ELBO: 2593.6, ENRE: 2610.5, KL: 16.857.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 10190 (37 ms): 2738.9.
Step 10227 (36 ms): 2747.9.
Step 10265 (36 ms): 2732.2.
Step 10302 (37 ms): 2721.1.
Step 10340 (38 ms): 2727.6.
Step 10378 (37 ms): 2693.5.
Step 10415 (38 ms): 2659.6.
Step 10453 (37 ms): 2709.1.
Step 10490 (36 ms): 2694.
Step 10528 (17 ms): -1805.5.

Epoch 28 (13.9 s):
    Evaluating model.
    Full set (5.45 s): ELBO: 2643.8, ENRE: 2660.7, KL: 16.925.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 10566 (36 ms): 2737.
Step 10603 (37 ms): 2703.4.
Step 10641 (36 ms): 2714.6.
Step 10678 (35 ms): 2776.7.
Step 10716 (36 ms): 2825.5.
Step 10754 (37 ms): 2733.5.
Step 10791 (36 ms): 2785.7.
Step 10829 (37 ms): 2739.6.
Step 10866 (37 ms): 2736.1.
Step 10904 (18 ms): -3877.

Epoch 29 (13.8 s):
    Evaluating model.
    Full set (5.58 s): ELBO: 2652.3, ENRE: 2668.5, KL: 16.208.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 10942 (38 ms): 2691.5.
Step 10979 (38 ms): 2730.3.
Step 11017 (37 ms): 2694.7.
Step 11054 (37 ms): 2744.2.
Step 11092 (38 ms): 2652.1.
Step 11130 (37 ms): 2740.
Step 11167 (37 ms): 2746.2.
Step 11205 (37 ms): 2700.6.
Step 11242 (39 ms): 2714.7.
Step 11280 (18 ms): -1200.1.

Epoch 30 (14 s):
    Evaluating model.
    Full set (5.49 s): ELBO: 2606, ENRE: 2623.1, KL: 17.108.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 11318 (37 ms): 2726.8.
Step 11355 (37 ms): 2568.
Step 11393 (37 ms): 2752.5.
Step 11430 (39 ms): 2762.7.
Step 11468 (36 ms): 2702.2.
Step 11506 (38 ms): 2723.9.
Step 11543 (37 ms): 2740.
Step 11581 (36 ms): 2706.7.
Step 11618 (36 ms): 2749.7.
Step 11656 (18 ms): -41.038.

Epoch 31 (13.9 s):
    Evaluating model.
    Full set (5.59 s): ELBO: 2621.5, ENRE: 2638.2, KL: 16.709.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 11694 (37 ms): 2702.
Step 11731 (37 ms): 2674.8.
Step 11769 (38 ms): 2840.7.
Step 11806 (37 ms): 2719.3.
Step 11844 (39 ms): 2755.1.
Step 11882 (37 ms): 2741.4.
Step 11919 (37 ms): 2739.7.
Step 11957 (36 ms): 2692.9.
Step 11994 (38 ms): 2629.1.
Step 12032 (18 ms): 309.79.

Epoch 32 (14 s):
    Evaluating model.
    Full set (5.51 s): ELBO: 2628.7, ENRE: 2645.2, KL: 16.47.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 12070 (36 ms): 2690.6.
Step 12107 (37 ms): 2792.3.
Step 12145 (36 ms): 2655.7.
Step 12182 (37 ms): 2693.
Step 12220 (37 ms): 2813.5.
Step 12258 (38 ms): 2782.5.
Step 12295 (37 ms): 2809.4.
Step 12333 (37 ms): 2779.5.
Step 12370 (36 ms): 2640.4.
Step 12408 (18 ms): 1291.4.

Epoch 33 (13.8 s):
    Evaluating model.
    Full set (5.57 s): ELBO: 2690.5, ENRE: 2706.2, KL: 15.7.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 12446 (37 ms): 2738.9.
Step 12483 (36 ms): 2647.5.
Step 12521 (36 ms): 2701.7.
Step 12558 (36 ms): 2761.
Step 12596 (37 ms): 2663.6.
Step 12634 (37 ms): 2719.4.
Step 12671 (37 ms): 2763.2.
Step 12709 (40 ms): 2807.7.
Step 12746 (38 ms): 2757.9.
Step 12784 (17 ms): -1602.8.

Epoch 34 (13.9 s):
    Evaluating model.
    Full set (5.51 s): ELBO: 2675.9, ENRE: 2691.5, KL: 15.577.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 12822 (36 ms): 2772.8.
Step 12859 (37 ms): 2783.4.
Step 12897 (39 ms): 2788.8.
Step 12934 (36 ms): 2734.1.
Step 12972 (36 ms): 2751.5.
Step 13010 (37 ms): 2708.5.
Step 13047 (37 ms): 2703.8.
Step 13085 (36 ms): 2787.2.
Step 13122 (36 ms): 2733.6.
Step 13160 (18 ms): -9511.7.

Epoch 35 (13.8 s):
    Evaluating model.
    Full set (5.59 s): ELBO: 2674.4, ENRE: 2690.1, KL: 15.679.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 13198 (37 ms): 2742.5.
Step 13235 (37 ms): 2832.6.
Step 13273 (36 ms): 2728.1.
Step 13310 (38 ms): 2753.7.
Step 13348 (37 ms): 2760.1.
Step 13386 (38 ms): 2744.7.
Step 13423 (37 ms): 2659.1.
Step 13461 (37 ms): 2762.
Step 13498 (37 ms): 2753.5.
Step 13536 (18 ms): 548.26.

Epoch 36 (14 s):
    Evaluating model.
    Full set (5.52 s): ELBO: 2666.9, ENRE: 2683.1, KL: 16.178.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 13574 (37 ms): 2710.6.
Step 13611 (36 ms): 2712.3.
Step 13649 (37 ms): 2667.4.
Step 13686 (37 ms): 2744.4.
Step 13724 (37 ms): 2710.5.
Step 13762 (37 ms): 2788.4.
Step 13799 (39 ms): 2768.3.
Step 13837 (37 ms): 2728.8.
Step 13874 (37 ms): 2796.8.
Step 13912 (18 ms): 315.24.

Epoch 37 (13.9 s):
    Evaluating model.
    Full set (5.58 s): ELBO: 2676, ENRE: 2692.2, KL: 16.242.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 13950 (37 ms): 2702.2.
Step 13987 (37 ms): 2726.6.
Step 14025 (36 ms): 2677.
Step 14062 (37 ms): 2758.7.
Step 14100 (35 ms): 2789.9.
Step 14138 (36 ms): 2777.4.
Step 14175 (37 ms): 2728.4.
Step 14213 (37 ms): 2793.3.
Step 14250 (37 ms): 2773.7.
Step 14288 (18 ms): -1697.1.

Epoch 38 (13.9 s):
    Evaluating model.
    Full set (5.47 s): ELBO: 2699.3, ENRE: 2715.6, KL: 16.294.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 14326 (36 ms): 2683.9.
Step 14363 (36 ms): 2682.2.
Step 14401 (37 ms): 2767.7.
Step 14438 (38 ms): 2663.
Step 14476 (37 ms): 2767.9.
Step 14514 (37 ms): 2773.9.
Step 14551 (37 ms): 2754.3.
Step 14589 (37 ms): 2632.5.
Step 14626 (36 ms): 2740.5.
Step 14664 (17 ms): -2523.4.

Epoch 39 (13.8 s):
    Evaluating model.
    Full set (5.57 s): ELBO: 2685.3, ENRE: 2701.8, KL: 16.433.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 14702 (37 ms): 2736.5.
Step 14739 (37 ms): 2687.3.
Step 14777 (37 ms): 2821.5.
Step 14814 (36 ms): 2823.6.
Step 14852 (36 ms): 2695.8.
Step 14890 (36 ms): 2800.6.
Step 14927 (37 ms): 2756.6.
Step 14965 (37 ms): 2772.1.
Step 15002 (38 ms): 2705.4.
Step 15040 (17 ms): 1168.4.

Epoch 40 (13.8 s):
    Evaluating model.
    Full set (5.44 s): ELBO: 2658.7, ENRE: 2675.3, KL: 16.668.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 15078 (37 ms): 2670.5.
Step 15115 (37 ms): 2797.9.
Step 15153 (37 ms): 2790.8.
Step 15190 (37 ms): 2788.1.
Step 15228 (37 ms): 2630.6.
Step 15266 (37 ms): 2752.5.
Step 15303 (36 ms): 2682.2.
Step 15341 (37 ms): 2808.6.
Step 15378 (37 ms): 2632.3.
Step 15416 (18 ms): -4476.8.

Epoch 41 (13.8 s):
    Evaluating model.
    Full set (5.6 s): ELBO: 2665.6, ENRE: 2682.1, KL: 16.555.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 15454 (37 ms): 2768.3.
Step 15491 (37 ms): 2738.8.
Step 15529 (37 ms): 2854.2.
Step 15566 (37 ms): 2833.5.
Step 15604 (37 ms): 2750.3.
Step 15642 (37 ms): 2769.5.
Step 15679 (38 ms): 2689.
Step 15717 (37 ms): 2653.5.
Step 15754 (37 ms): 2743.2.
Step 15792 (18 ms): -224.33.

Epoch 42 (14 s):
    Evaluating model.
    Full set (5.51 s): ELBO: 2699.8, ENRE: 2716.2, KL: 16.417.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 15830 (37 ms): 2793.8.
Step 15867 (37 ms): 2759.6.
Step 15905 (39 ms): 2745.6.
Step 15942 (38 ms): 2773.4.
Step 15980 (38 ms): 2768.2.
Step 16018 (36 ms): 2728.5.
Step 16055 (37 ms): 2768.1.
Step 16093 (37 ms): 2727.6.
Step 16130 (36 ms): 2783.5.
Step 16168 (19 ms): 545.24.

Epoch 43 (13.9 s):
    Evaluating model.
    Full set (5.63 s): ELBO: 2662.2, ENRE: 2679.1, KL: 16.933.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 16206 (37 ms): 2709.5.
Step 16243 (39 ms): 2694.5.
Step 16281 (37 ms): 2743.7.
Step 16318 (37 ms): 2679.4.
Step 16356 (37 ms): 2735.3.
Step 16394 (37 ms): 2750.
Step 16431 (38 ms): 2714.1.
Step 16469 (38 ms): 2814.8.
Step 16506 (38 ms): 2750.4.
Step 16544 (18 ms): 372.12.

Epoch 44 (14 s):
    Evaluating model.
    Full set (5.48 s): ELBO: 2693.1, ENRE: 2709.8, KL: 16.695.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 16582 (37 ms): 2704.9.
Step 16619 (36 ms): 2761.4.
Step 16657 (36 ms): 2777.6.
Step 16694 (37 ms): 2824.5.
Step 16732 (37 ms): 2710.2.
Step 16770 (36 ms): 2660.3.
Step 16807 (36 ms): 2829.
Step 16845 (36 ms): 2720.6.
Step 16882 (37 ms): 2735.3.
Step 16920 (18 ms): 769.34.

Epoch 45 (13.9 s):
    Evaluating model.
    Full set (5.6 s): ELBO: 2721.4, ENRE: 2738, KL: 16.616.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 16958 (37 ms): 2662.9.
Step 16995 (38 ms): 2711.4.
Step 17033 (37 ms): 2780.7.
Step 17070 (37 ms): 2729.7.
Step 17108 (36 ms): 2676.
Step 17146 (38 ms): 2740.1.
Step 17183 (36 ms): 2784.6.
Step 17221 (38 ms): 2650.2.
Step 17258 (37 ms): 2789.6.
Step 17296 (18 ms): 121.3.

Epoch 46 (13.9 s):
    Evaluating model.
    Full set (5.48 s): ELBO: 2727.9, ENRE: 2744.7, KL: 16.788.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 17334 (37 ms): 2791.1.
Step 17371 (36 ms): 2783.
Step 17409 (36 ms): 2818.7.
Step 17446 (36 ms): 2741.1.
Step 17484 (37 ms): 2822.
Step 17522 (37 ms): 2792.7.
Step 17559 (37 ms): 2800.3.
Step 17597 (37 ms): 2778.1.
Step 17634 (37 ms): 2704.6.
Step 17672 (18 ms): 1925.

Epoch 47 (13.9 s):
    Evaluating model.
    Full set (5.6 s): ELBO: 2665.5, ENRE: 2683.2, KL: 17.73.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 17710 (38 ms): 2857.9.
Step 17747 (37 ms): 2688.3.
Step 17785 (37 ms): 2789.8.
Step 17822 (37 ms): 2742.3.
Step 17860 (38 ms): 2674.9.
Step 17898 (37 ms): 2804.9.
Step 17935 (37 ms): 2779.1.
Step 17973 (39 ms): 2764.4.
Step 18010 (36 ms): 2795.2.
Step 18048 (18 ms): 322.01.

Epoch 48 (14 s):
    Evaluating model.
    Full set (5.49 s): ELBO: 2683.8, ENRE: 2701.7, KL: 17.958.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 18086 (36 ms): 2691.1.
Step 18123 (38 ms): 2725.
Step 18161 (37 ms): 2712.3.
Step 18198 (36 ms): 2782.5.
Step 18236 (37 ms): 2834.1.
Step 18274 (37 ms): 2771.1.
Step 18311 (37 ms): 2781.8.
Step 18349 (37 ms): 2829.7.
Step 18386 (38 ms): 2659.6.
Step 18424 (18 ms): 1024.1.

Epoch 49 (13.9 s):
    Evaluating model.
    Full set (5.59 s): ELBO: 2740.1, ENRE: 2757, KL: 16.839.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 18462 (37 ms): 2776.7.
Step 18499 (37 ms): 2828.8.
Step 18537 (37 ms): 2800.5.
Step 18574 (37 ms): 2812.6.
Step 18612 (36 ms): 2770.3.
Step 18650 (37 ms): 2802.
Step 18687 (37 ms): 2765.9.
Step 18725 (37 ms): 2830.1.
Step 18762 (37 ms): 2779.2.
Step 18800 (18 ms): 758.45.

Epoch 50 (14 s):
    Evaluating model.
    Full set (5.48 s): ELBO: 2759.5, ENRE: 2776.3, KL: 16.772.
    Saving model parameters.
    Model parameters saved (113 ms).

Model trained for 50 epochs (16m 19s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (15 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (913 ms).

Converting data set value array to sparse matrix.
Data set value array converted (317 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.82 s):  ELBO: -11913, ENRE: -11896, KL: 16.64.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (835 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 0.8271115297414589
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 27
kl weight: 0.8271115297414589
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (56 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.3 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.94 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 27
    hidden sizes: 164, 173, 51, 187, 171
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 0.8271115297414589
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 1 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 164)
    ENCODER/1/DENSE/biases:0             (164,)
    ENCODER/1/BATCH_NORM/beta:0          (164,)
    ENCODER/2/DENSE/weights:0            (164, 173)
    ENCODER/2/DENSE/biases:0             (173,)
    ENCODER/2/BATCH_NORM/beta:0          (173,)
    ENCODER/3/DENSE/weights:0            (173, 51)
    ENCODER/3/DENSE/biases:0             (51,)
    ENCODER/3/BATCH_NORM/beta:0          (51,)
    ENCODER/4/DENSE/weights:0            (51, 187)
    ENCODER/4/DENSE/biases:0             (187,)
    ENCODER/4/BATCH_NORM/beta:0          (187,)
    ENCODER/5/DENSE/weights:0            (187, 171)
    ENCODER/5/DENSE/biases:0             (171,)
    ENCODER/5/BATCH_NORM/beta:0          (171,)
    POSTERIOR/MU/DENSE/weights:0         (171, 27)
    POSTERIOR/MU/DENSE/biases:0          (27,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (171, 27)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (27,)
    DECODER/5/DENSE/weights:0            (27, 171)
    DECODER/5/DENSE/biases:0             (171,)
    DECODER/5/BATCH_NORM/beta:0          (171,)
    DECODER/4/DENSE/weights:0            (171, 187)
    DECODER/4/DENSE/biases:0             (187,)
    DECODER/4/BATCH_NORM/beta:0          (187,)
    DECODER/3/DENSE/weights:0            (187, 51)
    DECODER/3/DENSE/biases:0             (51,)
    DECODER/3/BATCH_NORM/beta:0          (51,)
    DECODER/2/DENSE/weights:0            (51, 173)
    DECODER/2/DENSE/biases:0             (173,)
    DECODER/2/BATCH_NORM/beta:0          (173,)
    DECODER/1/DENSE/weights:0            (173, 164)
    DECODER/1/DENSE/biases:0             (164,)
    DECODER/1/BATCH_NORM/beta:0          (164,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (164, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (576 ms).

Training model for 50 epochs on original values.

Step 38 (35 ms): -2187.4.
Step 75 (34 ms): -1881.2.
Step 113 (35 ms): -1615.6.
Step 150 (34 ms): -1348.2.
Step 188 (35 ms): -1204.1.
Step 226 (35 ms): -1088.
Step 263 (36 ms): -1001.7.
Step 301 (35 ms): -931.99.
Step 338 (34 ms): -867.7.
Step 376 (22 ms): -818.61.

Epoch 1 (16 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.74 s): ELBO: -1792.4, ENRE: -1786, KL: 6.4195.
    Saving model parameters.
    Model parameters saved (210 ms).

Step 414 (34 ms): -641.83.
Step 451 (34 ms): -521.45.
Step 489 (34 ms): -469.01.
Step 526 (34 ms): -430.31.
Step 564 (33 ms): -443.71.
Step 602 (34 ms): -399.57.
Step 639 (34 ms): -386.31.
Step 677 (34 ms): -372.63.
Step 714 (33 ms): -348.21.
Step 752 (19 ms): -372.4.

Epoch 2 (12.8 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -1019.9, ENRE: -1006.5, KL: 13.36.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 790 (33 ms): -333.92.
Step 827 (33 ms): -317.71.
Step 865 (33 ms): -342.93.
Step 902 (33 ms): -290.88.
Step 940 (33 ms): -289.07.
Step 978 (33 ms): -286.07.
Step 1015 (35 ms): -288.5.
Step 1053 (34 ms): -295.75.
Step 1090 (34 ms): -283.48.
Step 1128 (18 ms): -387.81.

Epoch 3 (12.8 s):
    Evaluating model.
    Full set (6.11 s): ELBO: -572.18, ENRE: -564.49, KL: 7.6855.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 1166 (34 ms): -267.13.
Step 1203 (33 ms): -253.68.
Step 1241 (33 ms): -260.55.
Step 1278 (33 ms): -264.19.
Step 1316 (34 ms): -250.6.
Step 1354 (34 ms): -256.85.
Step 1391 (34 ms): -262.22.
Step 1429 (34 ms): -250.18.
Step 1466 (34 ms): -250.04.
Step 1504 (17 ms): -262.07.

Epoch 4 (12.7 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -378.4, ENRE: -371.77, KL: 6.6316.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 1542 (33 ms): -253.64.
Step 1579 (33 ms): -229.6.
Step 1617 (34 ms): -244.08.
Step 1654 (34 ms): -246.15.
Step 1692 (33 ms): -260.93.
Step 1730 (34 ms): -240.27.
Step 1767 (33 ms): -236.76.
Step 1805 (33 ms): -233.32.
Step 1842 (33 ms): -244.72.
Step 1880 (16 ms): -241.64.

Epoch 5 (12.6 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -299.84, ENRE: -293.21, KL: 6.6322.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 1918 (35 ms): -229.26.
Step 1955 (33 ms): -221.29.
Step 1993 (33 ms): -220.49.
Step 2030 (33 ms): -259.25.
Step 2068 (33 ms): -232.33.
Step 2106 (33 ms): -230.16.
Step 2143 (33 ms): -233.13.
Step 2181 (33 ms): -230.25.
Step 2218 (34 ms): -243.53.
Step 2256 (16 ms): -276.03.

Epoch 6 (12.6 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -258.98, ENRE: -251.8, KL: 7.1801.
    Saving model parameters.
    Model parameters saved (127 ms).

Step 2294 (34 ms): -243.74.
Step 2331 (33 ms): -238.27.
Step 2369 (33 ms): -234.97.
Step 2406 (34 ms): -222.82.
Step 2444 (34 ms): -246.86.
Step 2482 (33 ms): -236.17.
Step 2519 (36 ms): -223.1.
Step 2557 (33 ms): -218.76.
Step 2594 (35 ms): -214.47.
Step 2632 (17 ms): -282.77.

Epoch 7 (12.7 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -239.15, ENRE: -231.95, KL: 7.2014.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 2670 (36 ms): -202.47.
Step 2707 (33 ms): -218.29.
Step 2745 (33 ms): -253.6.
Step 2782 (35 ms): -205.94.
Step 2820 (34 ms): -223.53.
Step 2858 (34 ms): -221.56.
Step 2895 (34 ms): -225.38.
Step 2933 (34 ms): -233.75.
Step 2970 (36 ms): -228.
Step 3008 (17 ms): -273.42.

Epoch 8 (12.8 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -228.11, ENRE: -220.45, KL: 7.664.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 3046 (34 ms): -222.5.
Step 3083 (34 ms): -208.45.
Step 3121 (34 ms): -231.42.
Step 3158 (34 ms): -230.76.
Step 3196 (34 ms): -217.95.
Step 3234 (33 ms): -217.93.
Step 3271 (34 ms): -225.46.
Step 3309 (33 ms): -225.09.
Step 3346 (34 ms): -219.46.
Step 3384 (17 ms): -273.27.

Epoch 9 (12.8 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -221.37, ENRE: -213.66, KL: 7.7124.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 3422 (34 ms): -218.61.
Step 3459 (33 ms): -198.79.
Step 3497 (33 ms): -224.52.
Step 3534 (33 ms): -220.4.
Step 3572 (33 ms): -199.
Step 3610 (33 ms): -206.68.
Step 3647 (34 ms): -218.79.
Step 3685 (33 ms): -207.23.
Step 3722 (34 ms): -204.51.
Step 3760 (16 ms): -214.46.

Epoch 10 (12.7 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -217.4, ENRE: -209.47, KL: 7.9291.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 3798 (34 ms): -214.72.
Step 3835 (33 ms): -200.54.
Step 3873 (33 ms): -218.79.
Step 3910 (33 ms): -215.04.
Step 3948 (33 ms): -208.13.
Step 3986 (33 ms): -208.01.
Step 4023 (33 ms): -219.21.
Step 4061 (33 ms): -216.01.
Step 4098 (33 ms): -213.19.
Step 4136 (16 ms): -328.51.

Epoch 11 (12.6 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -214.8, ENRE: -206.97, KL: 7.8254.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 4174 (34 ms): -202.24.
Step 4211 (33 ms): -211.32.
Step 4249 (33 ms): -213.46.
Step 4286 (33 ms): -209.26.
Step 4324 (32 ms): -231.2.
Step 4362 (34 ms): -229.16.
Step 4399 (33 ms): -214.74.
Step 4437 (33 ms): -221.42.
Step 4474 (34 ms): -204.7.
Step 4512 (16 ms): -288.92.

Epoch 12 (12.5 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -214.21, ENRE: -206.25, KL: 7.9649.
    Saving model parameters.
    Model parameters saved (129 ms).

Step 4550 (33 ms): -204.82.
Step 4587 (33 ms): -209.61.
Step 4625 (33 ms): -219.46.
Step 4662 (34 ms): -209.6.
Step 4700 (34 ms): -223.63.
Step 4738 (34 ms): -215.74.
Step 4775 (34 ms): -216.75.
Step 4813 (33 ms): -223.89.
Step 4850 (34 ms): -218.21.
Step 4888 (17 ms): -248.33.

Epoch 13 (12.7 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -213.24, ENRE: -205.63, KL: 7.6139.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 4926 (34 ms): -216.33.
Step 4963 (34 ms): -194.24.
Step 5001 (34 ms): -218.14.
Step 5038 (35 ms): -211.97.
Step 5076 (34 ms): -227.33.
Step 5114 (34 ms): -207.11.
Step 5151 (34 ms): -204.56.
Step 5189 (34 ms): -214.51.
Step 5226 (34 ms): -215.52.
Step 5264 (17 ms): -201.51.

Epoch 14 (12.8 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -211.32, ENRE: -203.7, KL: 7.6202.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 5302 (34 ms): -220.57.
Step 5339 (34 ms): -204.9.
Step 5377 (34 ms): -205.23.
Step 5414 (34 ms): -216.92.
Step 5452 (34 ms): -205.66.
Step 5490 (34 ms): -235.32.
Step 5527 (34 ms): -202.28.
Step 5565 (33 ms): -198.
Step 5602 (34 ms): -201.04.
Step 5640 (17 ms): -202.39.

Epoch 15 (12.8 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -210.45, ENRE: -202.71, KL: 7.7423.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 5678 (34 ms): -206.52.
Step 5715 (34 ms): -208.44.
Step 5753 (35 ms): -205.83.
Step 5790 (34 ms): -216.77.
Step 5828 (34 ms): -218.18.
Step 5866 (35 ms): -208.64.
Step 5903 (34 ms): -205.44.
Step 5941 (34 ms): -204.09.
Step 5978 (33 ms): -200.55.
Step 6016 (16 ms): -422.14.

Epoch 16 (12.7 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -210.41, ENRE: -203.01, KL: 7.4035.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 6054 (34 ms): -202.57.
Step 6091 (33 ms): -194.17.
Step 6129 (33 ms): -209.04.
Step 6166 (33 ms): -207.04.
Step 6204 (33 ms): -220.51.
Step 6242 (34 ms): -203.74.
Step 6279 (33 ms): -217.6.
Step 6317 (33 ms): -213.29.
Step 6354 (33 ms): -229.84.
Step 6392 (16 ms): -205.87.

Epoch 17 (12.6 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -209.13, ENRE: -201.87, KL: 7.2551.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 6430 (34 ms): -213.03.
Step 6467 (34 ms): -222.6.
Step 6505 (33 ms): -209.01.
Step 6542 (33 ms): -198.55.
Step 6580 (34 ms): -206.66.
Step 6618 (34 ms): -206.09.
Step 6655 (33 ms): -194.76.
Step 6693 (34 ms): -208.16.
Step 6730 (34 ms): -210.89.
Step 6768 (17 ms): -202.34.

Epoch 18 (12.5 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -208.07, ENRE: -200.88, KL: 7.1982.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 6806 (33 ms): -204.87.
Step 6843 (34 ms): -219.17.
Step 6881 (34 ms): -213.03.
Step 6918 (33 ms): -201.28.
Step 6956 (34 ms): -203.68.
Step 6994 (35 ms): -210.83.
Step 7031 (34 ms): -221.9.
Step 7069 (34 ms): -216.76.
Step 7106 (34 ms): -201.6.
Step 7144 (17 ms): -209.52.

Epoch 19 (12.7 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -207.73, ENRE: -200.64, KL: 7.0861.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 7182 (35 ms): -216.95.
Step 7219 (34 ms): -207.48.
Step 7257 (33 ms): -216.57.
Step 7294 (34 ms): -218.79.
Step 7332 (34 ms): -209.4.
Step 7370 (35 ms): -214.63.
Step 7407 (33 ms): -202.63.
Step 7445 (34 ms): -212.63.
Step 7482 (34 ms): -202.12.
Step 7520 (17 ms): -209.54.

Epoch 20 (12.8 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -208.06, ENRE: -200.95, KL: 7.1106.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 7558 (34 ms): -202.08.
Step 7595 (34 ms): -202.56.
Step 7633 (34 ms): -208.15.
Step 7670 (34 ms): -191.59.
Step 7708 (33 ms): -189.09.
Step 7746 (33 ms): -203.59.
Step 7783 (33 ms): -201.94.
Step 7821 (34 ms): -195.44.
Step 7858 (34 ms): -200.48.
Step 7896 (17 ms): -365.94.

Epoch 21 (12.8 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -207.19, ENRE: -200.1, KL: 7.0903.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 7934 (34 ms): -212.83.
Step 7971 (36 ms): -215.48.
Step 8009 (35 ms): -205.32.
Step 8046 (34 ms): -203.82.
Step 8084 (32 ms): -209.88.
Step 8122 (34 ms): -198.43.
Step 8159 (33 ms): -208.71.
Step 8197 (33 ms): -211.68.
Step 8234 (35 ms): -200.96.
Step 8272 (17 ms): -217.86.

Epoch 22 (12.7 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -206.72, ENRE: -199.6, KL: 7.1244.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 8310 (33 ms): -203.26.
Step 8347 (33 ms): -203.53.
Step 8385 (34 ms): -229.32.
Step 8422 (34 ms): -218.99.
Step 8460 (33 ms): -194.82.
Step 8498 (33 ms): -203.19.
Step 8535 (33 ms): -200.51.
Step 8573 (34 ms): -192.5.
Step 8610 (33 ms): -214.32.
Step 8648 (16 ms): -184.87.

Epoch 23 (12.6 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -206.02, ENRE: -198.94, KL: 7.0881.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 8686 (33 ms): -201.51.
Step 8723 (33 ms): -197.35.
Step 8761 (33 ms): -205.06.
Step 8798 (33 ms): -204.01.
Step 8836 (34 ms): -210.16.
Step 8874 (34 ms): -214.3.
Step 8911 (34 ms): -220.35.
Step 8949 (33 ms): -200.72.
Step 8986 (33 ms): -196.81.
Step 9024 (16 ms): -185.58.

Epoch 24 (12.6 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -206.38, ENRE: -199.26, KL: 7.1225.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 9062 (34 ms): -202.64.
Step 9099 (34 ms): -195.74.
Step 9137 (34 ms): -197.33.
Step 9174 (35 ms): -210.
Step 9212 (35 ms): -212.24.
Step 9250 (33 ms): -192.96.
Step 9287 (33 ms): -201.41.
Step 9325 (34 ms): -204.19.
Step 9362 (34 ms): -202.77.
Step 9400 (16 ms): -192.46.

Epoch 25 (12.7 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -205.28, ENRE: -198.26, KL: 7.0243.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 9438 (34 ms): -206.93.
Step 9475 (33 ms): -203.65.
Step 9513 (34 ms): -202.02.
Step 9550 (33 ms): -196.53.
Step 9588 (34 ms): -205.78.
Step 9626 (35 ms): -193.92.
Step 9663 (33 ms): -197.35.
Step 9701 (34 ms): -214.98.
Step 9738 (33 ms): -206.64.
Step 9776 (17 ms): -219.36.

Epoch 26 (12.8 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -204.98, ENRE: -197.94, KL: 7.0389.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 9814 (33 ms): -196.31.
Step 9851 (34 ms): -206.77.
Step 9889 (33 ms): -199.33.
Step 9926 (33 ms): -201.13.
Step 9964 (33 ms): -201.24.
Step 10002 (34 ms): -201.61.
Step 10039 (33 ms): -201.33.
Step 10077 (33 ms): -201.1.
Step 10114 (34 ms): -194.04.
Step 10152 (17 ms): -323.48.

Epoch 27 (12.8 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -205.37, ENRE: -198.22, KL: 7.1454.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 10190 (35 ms): -191.15.
Step 10227 (34 ms): -210.77.
Step 10265 (33 ms): -200.28.
Step 10302 (34 ms): -191.79.
Step 10340 (35 ms): -213.18.
Step 10378 (34 ms): -207.29.
Step 10415 (34 ms): -196.58.
Step 10453 (34 ms): -197.94.
Step 10490 (34 ms): -197.77.
Step 10528 (17 ms): -212.97.

Epoch 28 (12.7 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -204.2, ENRE: -197.16, KL: 7.0344.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 10566 (33 ms): -197.75.
Step 10603 (33 ms): -195.73.
Step 10641 (33 ms): -211.54.
Step 10678 (35 ms): -201.44.
Step 10716 (34 ms): -194.3.
Step 10754 (34 ms): -205.56.
Step 10791 (33 ms): -210.65.
Step 10829 (34 ms): -189.16.
Step 10866 (34 ms): -206.14.
Step 10904 (16 ms): -208.25.

Epoch 29 (12.6 s):
    Evaluating model.
    Full set (6 s): ELBO: -204.05, ENRE: -196.89, KL: 7.1588.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 10942 (33 ms): -211.27.
Step 10979 (33 ms): -203.91.
Step 11017 (33 ms): -198.58.
Step 11054 (34 ms): -208.97.
Step 11092 (33 ms): -210.54.
Step 11130 (33 ms): -203.87.
Step 11167 (33 ms): -192.53.
Step 11205 (33 ms): -205.26.
Step 11242 (34 ms): -200.04.
Step 11280 (17 ms): -246.01.

Epoch 30 (12.5 s):
    Evaluating model.
    Full set (6.11 s): ELBO: -203.43, ENRE: -196.38, KL: 7.0553.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 11318 (35 ms): -196.64.
Step 11355 (34 ms): -211.13.
Step 11393 (34 ms): -202.17.
Step 11430 (34 ms): -205.67.
Step 11468 (34 ms): -201.63.
Step 11506 (34 ms): -200.31.
Step 11543 (34 ms): -203.03.
Step 11581 (34 ms): -215.87.
Step 11618 (34 ms): -202.71.
Step 11656 (17 ms): -249.69.

Epoch 31 (12.8 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -203.73, ENRE: -196.58, KL: 7.148.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 11694 (33 ms): -213.66.
Step 11731 (33 ms): -208.24.
Step 11769 (33 ms): -201.4.
Step 11806 (34 ms): -229.91.
Step 11844 (34 ms): -206.26.
Step 11882 (34 ms): -194.56.
Step 11919 (34 ms): -211.88.
Step 11957 (33 ms): -197.75.
Step 11994 (34 ms): -207.2.
Step 12032 (17 ms): -232.96.

Epoch 32 (12.8 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -203.6, ENRE: -196.39, KL: 7.216.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 12070 (34 ms): -194.33.
Step 12107 (34 ms): -191.08.
Step 12145 (34 ms): -203.23.
Step 12182 (34 ms): -194.94.
Step 12220 (34 ms): -198.74.
Step 12258 (34 ms): -199.28.
Step 12295 (34 ms): -208.11.
Step 12333 (34 ms): -200.95.
Step 12370 (34 ms): -207.29.
Step 12408 (17 ms): -345.82.

Epoch 33 (12.8 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -202.38, ENRE: -195.2, KL: 7.1852.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 12446 (34 ms): -203.97.
Step 12483 (34 ms): -187.48.
Step 12521 (34 ms): -195.64.
Step 12558 (34 ms): -199.17.
Step 12596 (35 ms): -199.66.
Step 12634 (34 ms): -211.83.
Step 12671 (32 ms): -193.81.
Step 12709 (33 ms): -200.53.
Step 12746 (34 ms): -193.67.
Step 12784 (16 ms): -277.79.

Epoch 34 (12.7 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -202.16, ENRE: -194.93, KL: 7.2299.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 12822 (33 ms): -219.21.
Step 12859 (33 ms): -205.16.
Step 12897 (33 ms): -203.8.
Step 12934 (34 ms): -208.36.
Step 12972 (33 ms): -190.11.
Step 13010 (34 ms): -189.3.
Step 13047 (34 ms): -202.99.
Step 13085 (33 ms): -199.12.
Step 13122 (33 ms): -208.65.
Step 13160 (16 ms): -199.5.

Epoch 35 (12.6 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -202.04, ENRE: -194.89, KL: 7.1504.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 13198 (33 ms): -202.14.
Step 13235 (33 ms): -200.88.
Step 13273 (33 ms): -197.03.
Step 13310 (33 ms): -218.52.
Step 13348 (33 ms): -211.23.
Step 13386 (32 ms): -199.68.
Step 13423 (33 ms): -210.87.
Step 13461 (33 ms): -192.96.
Step 13498 (36 ms): -209.54.
Step 13536 (16 ms): -227.35.

Epoch 36 (12.5 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -201.99, ENRE: -194.68, KL: 7.3135.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 13574 (33 ms): -191.46.
Step 13611 (34 ms): -201.18.
Step 13649 (34 ms): -206.62.
Step 13686 (33 ms): -196.82.
Step 13724 (34 ms): -207.99.
Step 13762 (34 ms): -213.05.
Step 13799 (34 ms): -201.53.
Step 13837 (34 ms): -197.4.
Step 13874 (34 ms): -202.09.
Step 13912 (17 ms): -220.87.

Epoch 37 (12.7 s):
    Evaluating model.
    Full set (6.1 s): ELBO: -201.49, ENRE: -194.27, KL: 7.2127.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 13950 (33 ms): -204.45.
Step 13987 (33 ms): -217.
Step 14025 (36 ms): -199.49.
Step 14062 (35 ms): -196.86.
Step 14100 (34 ms): -206.12.
Step 14138 (34 ms): -204.57.
Step 14175 (34 ms): -198.9.
Step 14213 (34 ms): -203.35.
Step 14250 (34 ms): -218.03.
Step 14288 (17 ms): -224.41.

Epoch 38 (12.8 s):
    Evaluating model.
    Full set (6.1 s): ELBO: -201.96, ENRE: -194.63, KL: 7.333.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 14326 (33 ms): -205.53.
Step 14363 (33 ms): -197.33.
Step 14401 (34 ms): -202.77.
Step 14438 (34 ms): -196.83.
Step 14476 (34 ms): -200.56.
Step 14514 (34 ms): -203.4.
Step 14551 (34 ms): -188.12.
Step 14589 (34 ms): -195.07.
Step 14626 (34 ms): -188.51.
Step 14664 (17 ms): -282.42.

Epoch 39 (12.7 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -201.42, ENRE: -194.16, KL: 7.2613.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 14702 (34 ms): -203.91.
Step 14739 (34 ms): -196.
Step 14777 (34 ms): -218.5.
Step 14814 (34 ms): -202.61.
Step 14852 (35 ms): -230.25.
Step 14890 (34 ms): -206.16.
Step 14927 (34 ms): -199.79.
Step 14965 (33 ms): -196.91.
Step 15002 (33 ms): -203.22.
Step 15040 (16 ms): -202.58.

Epoch 40 (12.7 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -201.23, ENRE: -193.8, KL: 7.4263.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 15078 (33 ms): -195.8.
Step 15115 (33 ms): -195.35.
Step 15153 (33 ms): -201.03.
Step 15190 (34 ms): -202.42.
Step 15228 (34 ms): -213.14.
Step 15266 (33 ms): -204.31.
Step 15303 (33 ms): -190.81.
Step 15341 (33 ms): -197.97.
Step 15378 (33 ms): -203.78.
Step 15416 (16 ms): -405.19.

Epoch 41 (12.6 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -200.99, ENRE: -193.72, KL: 7.2705.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 15454 (34 ms): -201.18.
Step 15491 (33 ms): -203.88.
Step 15529 (34 ms): -208.12.
Step 15566 (33 ms): -200.7.
Step 15604 (33 ms): -192.79.
Step 15642 (33 ms): -190.38.
Step 15679 (33 ms): -201.72.
Step 15717 (34 ms): -201.1.
Step 15754 (33 ms): -205.46.
Step 15792 (17 ms): -225.69.

Epoch 42 (12.6 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -201.16, ENRE: -193.86, KL: 7.2998.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 15830 (33 ms): -211.04.
Step 15867 (33 ms): -214.65.
Step 15905 (33 ms): -204.32.
Step 15942 (34 ms): -207.86.
Step 15980 (34 ms): -202.61.
Step 16018 (33 ms): -195.47.
Step 16055 (33 ms): -215.47.
Step 16093 (33 ms): -194.79.
Step 16130 (34 ms): -202.81.
Step 16168 (16 ms): -183.95.

Epoch 43 (12.7 s):
    Evaluating model.
    Full set (6.1 s): ELBO: -201.08, ENRE: -193.77, KL: 7.3089.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 16206 (34 ms): -205.28.
Step 16243 (33 ms): -205.74.
Step 16281 (34 ms): -210.
Step 16318 (34 ms): -206.85.
Step 16356 (34 ms): -194.27.
Step 16394 (34 ms): -205.58.
Step 16431 (34 ms): -193.13.
Step 16469 (34 ms): -205.85.
Step 16506 (34 ms): -197.2.
Step 16544 (17 ms): -216.67.

Epoch 44 (12.8 s):
    Evaluating model.
    Full set (6.1 s): ELBO: -200.99, ENRE: -193.71, KL: 7.2773.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 16582 (34 ms): -202.87.
Step 16619 (33 ms): -194.47.
Step 16657 (34 ms): -202.6.
Step 16694 (35 ms): -207.65.
Step 16732 (34 ms): -205.51.
Step 16770 (35 ms): -194.36.
Step 16807 (36 ms): -200.12.
Step 16845 (34 ms): -211.23.
Step 16882 (34 ms): -204.48.
Step 16920 (17 ms): -292.41.

Epoch 45 (13 s):
    Evaluating model.
    Full set (6.19 s): ELBO: -200.44, ENRE: -193.13, KL: 7.3146.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 16958 (34 ms): -193.31.
Step 16995 (34 ms): -204.82.
Step 17033 (34 ms): -196.12.
Step 17070 (35 ms): -196.28.
Step 17108 (34 ms): -210.58.
Step 17146 (34 ms): -211.66.
Step 17183 (34 ms): -199.45.
Step 17221 (35 ms): -204.49.
Step 17258 (35 ms): -198.9.
Step 17296 (17 ms): -200.41.

Epoch 46 (13 s):
    Evaluating model.
    Full set (6.21 s): ELBO: -201.15, ENRE: -193.89, KL: 7.2566.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 17334 (34 ms): -198.68.
Step 17371 (34 ms): -196.22.
Step 17409 (34 ms): -201.17.
Step 17446 (34 ms): -208.94.
Step 17484 (34 ms): -203.26.
Step 17522 (34 ms): -200.03.
Step 17559 (34 ms): -202.15.
Step 17597 (34 ms): -194.8.
Step 17634 (34 ms): -204.35.
Step 17672 (16 ms): -297.47.

Epoch 47 (12.8 s):
    Evaluating model.
    Full set (6.12 s): ELBO: -200.35, ENRE: -192.98, KL: 7.3715.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 17710 (35 ms): -208.49.
Step 17747 (34 ms): -201.94.
Step 17785 (34 ms): -195.77.
Step 17822 (34 ms): -205.7.
Step 17860 (34 ms): -189.71.
Step 17898 (34 ms): -206.3.
Step 17935 (34 ms): -201.96.
Step 17973 (34 ms): -200.45.
Step 18010 (34 ms): -196.68.
Step 18048 (17 ms): -173.87.

Epoch 48 (12.8 s):
    Evaluating model.
    Full set (6.17 s): ELBO: -200.28, ENRE: -193.03, KL: 7.2445.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 18086 (35 ms): -208.98.
Step 18123 (34 ms): -200.3.
Step 18161 (35 ms): -199.57.
Step 18198 (35 ms): -204.83.
Step 18236 (35 ms): -197.55.
Step 18274 (35 ms): -191.16.
Step 18311 (34 ms): -191.75.
Step 18349 (35 ms): -218.26.
Step 18386 (34 ms): -203.17.
Step 18424 (17 ms): -190.5.

Epoch 49 (13 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -201, ENRE: -193.58, KL: 7.4173.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 18462 (34 ms): -195.29.
Step 18499 (34 ms): -210.6.
Step 18537 (32 ms): -198.53.
Step 18574 (33 ms): -199.06.
Step 18612 (35 ms): -200.22.
Step 18650 (35 ms): -207.98.
Step 18687 (33 ms): -200.34.
Step 18725 (34 ms): -203.95.
Step 18762 (36 ms): -194.3.
Step 18800 (17 ms): -179.59.

Epoch 50 (12.8 s):
    Evaluating model.
    Full set (6.14 s): ELBO: -200.05, ENRE: -192.67, KL: 7.3748.
    Saving model parameters.
    Model parameters saved (123 ms).

Model trained for 50 epochs (15m 52s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (16 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (873 ms).

Converting data set value array to sparse matrix.
Data set value array converted (283 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2.03 s):  ELBO: -427.35, ENRE: -419.98, KL: 7.3646.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (809 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 0.8596876239694685
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 26
kl weight: 0.8596876239694685
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (61 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.25 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.92 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 26
    hidden sizes: 164, 144, 51, 186, 162
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 0.8596876239694685
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 1 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 164)
    ENCODER/1/DENSE/biases:0             (164,)
    ENCODER/1/BATCH_NORM/beta:0          (164,)
    ENCODER/2/DENSE/weights:0            (164, 144)
    ENCODER/2/DENSE/biases:0             (144,)
    ENCODER/2/BATCH_NORM/beta:0          (144,)
    ENCODER/3/DENSE/weights:0            (144, 51)
    ENCODER/3/DENSE/biases:0             (51,)
    ENCODER/3/BATCH_NORM/beta:0          (51,)
    ENCODER/4/DENSE/weights:0            (51, 186)
    ENCODER/4/DENSE/biases:0             (186,)
    ENCODER/4/BATCH_NORM/beta:0          (186,)
    ENCODER/5/DENSE/weights:0            (186, 162)
    ENCODER/5/DENSE/biases:0             (162,)
    ENCODER/5/BATCH_NORM/beta:0          (162,)
    POSTERIOR/MU/DENSE/weights:0         (162, 26)
    POSTERIOR/MU/DENSE/biases:0          (26,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (162, 26)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (26,)
    DECODER/5/DENSE/weights:0            (26, 162)
    DECODER/5/DENSE/biases:0             (162,)
    DECODER/5/BATCH_NORM/beta:0          (162,)
    DECODER/4/DENSE/weights:0            (162, 186)
    DECODER/4/DENSE/biases:0             (186,)
    DECODER/4/BATCH_NORM/beta:0          (186,)
    DECODER/3/DENSE/weights:0            (186, 51)
    DECODER/3/DENSE/biases:0             (51,)
    DECODER/3/BATCH_NORM/beta:0          (51,)
    DECODER/2/DENSE/weights:0            (51, 144)
    DECODER/2/DENSE/biases:0             (144,)
    DECODER/2/BATCH_NORM/beta:0          (144,)
    DECODER/1/DENSE/weights:0            (144, 164)
    DECODER/1/DENSE/biases:0             (164,)
    DECODER/1/BATCH_NORM/beta:0          (164,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (164, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (552 ms).

Training model for 50 epochs on original values.

Step 38 (35 ms): -2083.8.
Step 75 (33 ms): -1730.6.
Step 113 (34 ms): -1465.
Step 150 (33 ms): -1302.5.
Step 188 (33 ms): -1053.6.
Step 226 (33 ms): -924.69.
Step 263 (33 ms): -880.12.
Step 301 (34 ms): -733.86.
Step 338 (33 ms): -658.99.
Step 376 (18 ms): -927.25.

Epoch 1 (15.4 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.47 s): ELBO: -1842, ENRE: -1835.1, KL: 6.8649.
    Saving model parameters.
    Model parameters saved (195 ms).

Step 414 (32 ms): -537.84.
Step 451 (32 ms): -496.6.
Step 489 (32 ms): -476.3.
Step 526 (32 ms): -449.32.
Step 564 (33 ms): -406.05.
Step 602 (32 ms): -395.82.
Step 639 (33 ms): -374.03.
Step 677 (32 ms): -344.94.
Step 714 (33 ms): -351.3.
Step 752 (16 ms): -433.28.

Epoch 2 (12.2 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -1064.3, ENRE: -1057.6, KL: 6.6915.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 790 (33 ms): -359.72.
Step 827 (34 ms): -320.16.
Step 865 (32 ms): -312.37.
Step 902 (32 ms): -320.01.
Step 940 (33 ms): -301.23.
Step 978 (33 ms): -276.56.
Step 1015 (33 ms): -292.69.
Step 1053 (32 ms): -287.3.
Step 1090 (32 ms): -296.08.
Step 1128 (17 ms): -298.79.

Epoch 3 (12.3 s):
    Evaluating model.
    Full set (5.76 s): ELBO: -612.86, ENRE: -606.7, KL: 6.1575.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 1166 (32 ms): -269.06.
Step 1203 (33 ms): -276.66.
Step 1241 (33 ms): -271.87.
Step 1278 (31 ms): -259.61.
Step 1316 (32 ms): -246.25.
Step 1354 (32 ms): -250.22.
Step 1391 (32 ms): -241.89.
Step 1429 (31 ms): -232.49.
Step 1466 (32 ms): -247.86.
Step 1504 (16 ms): -268.99.

Epoch 4 (12 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -407.41, ENRE: -401.37, KL: 6.041.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 1542 (32 ms): -238.67.
Step 1579 (32 ms): -239.96.
Step 1617 (32 ms): -243.45.
Step 1654 (33 ms): -232.05.
Step 1692 (33 ms): -241.52.
Step 1730 (32 ms): -235.83.
Step 1767 (32 ms): -230.92.
Step 1805 (32 ms): -230.17.
Step 1842 (32 ms): -228.52.
Step 1880 (16 ms): -293.49.

Epoch 5 (12.1 s):
    Evaluating model.
    Full set (5.73 s): ELBO: -314.94, ENRE: -308.89, KL: 6.0461.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 1918 (33 ms): -232.37.
Step 1955 (32 ms): -217.43.
Step 1993 (32 ms): -234.74.
Step 2030 (32 ms): -237.59.
Step 2068 (32 ms): -238.89.
Step 2106 (32 ms): -227.78.
Step 2143 (32 ms): -231.38.
Step 2181 (32 ms): -243.26.
Step 2218 (32 ms): -221.37.
Step 2256 (16 ms): -233.58.

Epoch 6 (12 s):
    Evaluating model.
    Full set (5.73 s): ELBO: -267.89, ENRE: -261.29, KL: 6.5994.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 2294 (32 ms): -224.35.
Step 2331 (32 ms): -216.19.
Step 2369 (32 ms): -222.
Step 2406 (31 ms): -221.95.
Step 2444 (32 ms): -247.96.
Step 2482 (32 ms): -226.42.
Step 2519 (32 ms): -227.98.
Step 2557 (32 ms): -215.87.
Step 2594 (32 ms): -213.95.
Step 2632 (16 ms): -330.41.

Epoch 7 (12 s):
    Evaluating model.
    Full set (5.67 s): ELBO: -244.57, ENRE: -237.79, KL: 6.7776.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 2670 (31 ms): -223.11.
Step 2707 (32 ms): -233.78.
Step 2745 (31 ms): -215.64.
Step 2782 (31 ms): -225.11.
Step 2820 (31 ms): -233.91.
Step 2858 (31 ms): -218.44.
Step 2895 (31 ms): -222.48.
Step 2933 (31 ms): -207.99.
Step 2970 (32 ms): -218.67.
Step 3008 (16 ms): -257.57.

Epoch 8 (11.8 s):
    Evaluating model.
    Full set (5.69 s): ELBO: -232.73, ENRE: -225.63, KL: 7.103.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 3046 (31 ms): -210.56.
Step 3083 (31 ms): -208.02.
Step 3121 (33 ms): -215.33.
Step 3158 (31 ms): -228.68.
Step 3196 (31 ms): -209.23.
Step 3234 (31 ms): -208.49.
Step 3271 (31 ms): -218.63.
Step 3309 (30 ms): -206.72.
Step 3346 (32 ms): -213.77.
Step 3384 (16 ms): -336.14.

Epoch 9 (11.9 s):
    Evaluating model.
    Full set (5.71 s): ELBO: -224.47, ENRE: -217.17, KL: 7.3055.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 3422 (31 ms): -218.45.
Step 3459 (31 ms): -237.22.
Step 3497 (32 ms): -211.22.
Step 3534 (32 ms): -224.19.
Step 3572 (32 ms): -225.23.
Step 3610 (32 ms): -219.74.
Step 3647 (32 ms): -205.01.
Step 3685 (32 ms): -209.91.
Step 3722 (32 ms): -214.76.
Step 3760 (16 ms): -382.26.

Epoch 10 (12 s):
    Evaluating model.
    Full set (5.72 s): ELBO: -218.55, ENRE: -211, KL: 7.55.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 3798 (32 ms): -221.63.
Step 3835 (32 ms): -215.47.
Step 3873 (32 ms): -218.78.
Step 3910 (32 ms): -212.19.
Step 3948 (32 ms): -225.09.
Step 3986 (33 ms): -221.05.
Step 4023 (31 ms): -207.62.
Step 4061 (32 ms): -210.08.
Step 4098 (32 ms): -208.74.
Step 4136 (16 ms): -195.54.

Epoch 11 (12 s):
    Evaluating model.
    Full set (5.71 s): ELBO: -216.98, ENRE: -209.75, KL: 7.2271.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 4174 (31 ms): -222.7.
Step 4211 (31 ms): -202.63.
Step 4249 (32 ms): -243.44.
Step 4286 (32 ms): -222.34.
Step 4324 (32 ms): -209.49.
Step 4362 (32 ms): -213.95.
Step 4399 (32 ms): -203.25.
Step 4437 (32 ms): -232.04.
Step 4474 (32 ms): -209.2.
Step 4512 (16 ms): -211.24.

Epoch 12 (12 s):
    Evaluating model.
    Full set (5.72 s): ELBO: -215.29, ENRE: -207.9, KL: 7.3839.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 4550 (32 ms): -224.14.
Step 4587 (32 ms): -215.44.
Step 4625 (31 ms): -224.06.
Step 4662 (32 ms): -218.46.
Step 4700 (32 ms): -208.53.
Step 4738 (32 ms): -205.03.
Step 4775 (32 ms): -225.26.
Step 4813 (31 ms): -208.97.
Step 4850 (32 ms): -209.77.
Step 4888 (16 ms): -282.99.

Epoch 13 (12 s):
    Evaluating model.
    Full set (5.65 s): ELBO: -213.39, ENRE: -206.16, KL: 7.2323.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 4926 (32 ms): -215.1.
Step 4963 (32 ms): -213.33.
Step 5001 (31 ms): -220.23.
Step 5038 (32 ms): -210.37.
Step 5076 (32 ms): -212.69.
Step 5114 (31 ms): -214.02.
Step 5151 (32 ms): -215.04.
Step 5189 (31 ms): -213.57.
Step 5226 (31 ms): -223.63.
Step 5264 (16 ms): -237.6.

Epoch 14 (11.9 s):
    Evaluating model.
    Full set (5.68 s): ELBO: -211.44, ENRE: -204.12, KL: 7.3234.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 5302 (32 ms): -213.87.
Step 5339 (32 ms): -200.14.
Step 5377 (31 ms): -204.8.
Step 5414 (31 ms): -203.05.
Step 5452 (32 ms): -205.3.
Step 5490 (32 ms): -204.78.
Step 5527 (31 ms): -205.45.
Step 5565 (31 ms): -216.23.
Step 5602 (32 ms): -205.08.
Step 5640 (16 ms): -231.66.

Epoch 15 (11.9 s):
    Evaluating model.
    Full set (5.66 s): ELBO: -210.76, ENRE: -203.5, KL: 7.2514.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 5678 (32 ms): -206.16.
Step 5715 (32 ms): -211.07.
Step 5753 (32 ms): -201.12.
Step 5790 (31 ms): -203.7.
Step 5828 (32 ms): -194.98.
Step 5866 (32 ms): -196.49.
Step 5903 (32 ms): -207.55.
Step 5941 (32 ms): -219.75.
Step 5978 (32 ms): -215.85.
Step 6016 (16 ms): -216.35.

Epoch 16 (12 s):
    Evaluating model.
    Full set (5.76 s): ELBO: -209.81, ENRE: -202.6, KL: 7.216.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 6054 (32 ms): -210.29.
Step 6091 (31 ms): -209.64.
Step 6129 (31 ms): -198.17.
Step 6166 (32 ms): -193.45.
Step 6204 (34 ms): -207.58.
Step 6242 (31 ms): -212.49.
Step 6279 (32 ms): -209.37.
Step 6317 (31 ms): -200.68.
Step 6354 (32 ms): -218.35.
Step 6392 (16 ms): -207.78.

Epoch 17 (12 s):
    Evaluating model.
    Full set (5.7 s): ELBO: -208.78, ENRE: -201.63, KL: 7.1434.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 6430 (32 ms): -228.26.
Step 6467 (33 ms): -213.7.
Step 6505 (31 ms): -209.06.
Step 6542 (31 ms): -216.16.
Step 6580 (32 ms): -202.09.
Step 6618 (32 ms): -211.54.
Step 6655 (34 ms): -215.62.
Step 6693 (32 ms): -224.33.
Step 6730 (31 ms): -206.65.
Step 6768 (17 ms): -240.92.

Epoch 18 (12 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -208.6, ENRE: -201.55, KL: 7.0561.
    Saving model parameters.
    Model parameters saved (127 ms).

Step 6806 (32 ms): -231.81.
Step 6843 (32 ms): -204.17.
Step 6881 (31 ms): -199.82.
Step 6918 (32 ms): -212.92.
Step 6956 (32 ms): -221.85.
Step 6994 (32 ms): -196.23.
Step 7031 (31 ms): -200.93.
Step 7069 (31 ms): -209.96.
Step 7106 (32 ms): -191.
Step 7144 (16 ms): -203.62.

Epoch 19 (11.9 s):
    Evaluating model.
    Full set (5.64 s): ELBO: -207.95, ENRE: -200.77, KL: 7.1738.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 7182 (31 ms): -196.32.
Step 7219 (31 ms): -194.89.
Step 7257 (31 ms): -214.15.
Step 7294 (32 ms): -201.09.
Step 7332 (31 ms): -220.77.
Step 7370 (32 ms): -202.35.
Step 7407 (31 ms): -203.94.
Step 7445 (31 ms): -219.95.
Step 7482 (32 ms): -213.03.
Step 7520 (15 ms): -226.01.

Epoch 20 (11.8 s):
    Evaluating model.
    Full set (5.65 s): ELBO: -207.32, ENRE: -200.5, KL: 6.8206.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 7558 (32 ms): -211.54.
Step 7595 (31 ms): -209.53.
Step 7633 (31 ms): -210.79.
Step 7670 (31 ms): -205.75.
Step 7708 (32 ms): -196.56.
Step 7746 (32 ms): -210.32.
Step 7783 (32 ms): -219.25.
Step 7821 (33 ms): -201.71.
Step 7858 (31 ms): -206.86.
Step 7896 (16 ms): -323.57.

Epoch 21 (11.9 s):
    Evaluating model.
    Full set (5.64 s): ELBO: -206.27, ENRE: -199.33, KL: 6.9395.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 7934 (32 ms): -203.75.
Step 7971 (31 ms): -203.29.
Step 8009 (32 ms): -209.18.
Step 8046 (32 ms): -215.39.
Step 8084 (31 ms): -206.37.
Step 8122 (32 ms): -204.41.
Step 8159 (32 ms): -206.51.
Step 8197 (32 ms): -202.99.
Step 8234 (31 ms): -196.27.
Step 8272 (17 ms): -255.57.

Epoch 22 (11.9 s):
    Evaluating model.
    Full set (5.71 s): ELBO: -206.42, ENRE: -199.53, KL: 6.895.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 8310 (32 ms): -210.63.
Step 8347 (34 ms): -188.86.
Step 8385 (31 ms): -189.51.
Step 8422 (32 ms): -201.94.
Step 8460 (32 ms): -193.38.
Step 8498 (31 ms): -207.85.
Step 8535 (32 ms): -204.38.
Step 8573 (32 ms): -202.64.
Step 8610 (33 ms): -211.1.
Step 8648 (16 ms): -525.67.

Epoch 23 (12 s):
    Evaluating model.
    Full set (5.73 s): ELBO: -205.44, ENRE: -198.53, KL: 6.911.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 8686 (33 ms): -212.92.
Step 8723 (32 ms): -206.62.
Step 8761 (32 ms): -209.01.
Step 8798 (32 ms): -196.64.
Step 8836 (32 ms): -200.53.
Step 8874 (31 ms): -194.97.
Step 8911 (32 ms): -202.74.
Step 8949 (32 ms): -206.3.
Step 8986 (32 ms): -221.48.
Step 9024 (16 ms): -370.32.

Epoch 24 (12 s):
    Evaluating model.
    Full set (5.72 s): ELBO: -205.3, ENRE: -198.42, KL: 6.8756.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 9062 (31 ms): -205.69.
Step 9099 (31 ms): -204.53.
Step 9137 (32 ms): -195.89.
Step 9174 (32 ms): -196.61.
Step 9212 (32 ms): -198.44.
Step 9250 (32 ms): -208.74.
Step 9287 (32 ms): -198.86.
Step 9325 (31 ms): -209.89.
Step 9362 (31 ms): -194.22.
Step 9400 (16 ms): -214.87.

Epoch 25 (11.9 s):
    Evaluating model.
    Full set (5.64 s): ELBO: -204.73, ENRE: -198.04, KL: 6.6904.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 9438 (33 ms): -205.41.
Step 9475 (31 ms): -203.34.
Step 9513 (31 ms): -211.96.
Step 9550 (32 ms): -217.95.
Step 9588 (31 ms): -206.43.
Step 9626 (31 ms): -202.08.
Step 9663 (31 ms): -193.86.
Step 9701 (31 ms): -201.35.
Step 9738 (32 ms): -217.05.
Step 9776 (16 ms): -217.98.

Epoch 26 (11.9 s):
    Evaluating model.
    Full set (5.7 s): ELBO: -205.12, ENRE: -198.29, KL: 6.8345.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 9814 (32 ms): -201.95.
Step 9851 (31 ms): -213.8.
Step 9889 (31 ms): -215.24.
Step 9926 (31 ms): -201.44.
Step 9964 (32 ms): -212.83.
Step 10002 (31 ms): -199.92.
Step 10039 (32 ms): -210.04.
Step 10077 (31 ms): -205.22.
Step 10114 (31 ms): -205.46.
Step 10152 (15 ms): -326.92.

Epoch 27 (11.8 s):
    Evaluating model.
    Full set (5.63 s): ELBO: -203.95, ENRE: -197.14, KL: 6.8108.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 10190 (32 ms): -210.2.
Step 10227 (31 ms): -203.13.
Step 10265 (32 ms): -203.5.
Step 10302 (32 ms): -211.8.
Step 10340 (32 ms): -207.7.
Step 10378 (33 ms): -211.21.
Step 10415 (32 ms): -198.02.
Step 10453 (32 ms): -190.
Step 10490 (32 ms): -205.54.
Step 10528 (16 ms): -286.12.

Epoch 28 (11.9 s):
    Evaluating model.
    Full set (5.72 s): ELBO: -204.31, ENRE: -197.19, KL: 7.1162.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 10566 (32 ms): -208.55.
Step 10603 (32 ms): -198.11.
Step 10641 (32 ms): -193.29.
Step 10678 (32 ms): -208.51.
Step 10716 (32 ms): -197.41.
Step 10754 (32 ms): -213.3.
Step 10791 (32 ms): -196.22.
Step 10829 (32 ms): -208.47.
Step 10866 (32 ms): -201.31.
Step 10904 (16 ms): -285.08.

Epoch 29 (12 s):
    Evaluating model.
    Full set (5.66 s): ELBO: -203.9, ENRE: -196.78, KL: 7.1212.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 10942 (31 ms): -198.74.
Step 10979 (32 ms): -200.87.
Step 11017 (32 ms): -197.84.
Step 11054 (31 ms): -197.51.
Step 11092 (32 ms): -193.4.
Step 11130 (32 ms): -200.34.
Step 11167 (32 ms): -199.1.
Step 11205 (32 ms): -199.16.
Step 11242 (32 ms): -204.92.
Step 11280 (16 ms): -247.24.

Epoch 30 (12 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -203.25, ENRE: -196.27, KL: 6.9833.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 11318 (32 ms): -202.22.
Step 11355 (32 ms): -200.63.
Step 11393 (32 ms): -205.85.
Step 11430 (32 ms): -198.69.
Step 11468 (32 ms): -207.79.
Step 11506 (31 ms): -193.05.
Step 11543 (32 ms): -200.48.
Step 11581 (32 ms): -215.31.
Step 11618 (31 ms): -200.03.
Step 11656 (16 ms): -196.67.

Epoch 31 (12 s):
    Evaluating model.
    Full set (5.68 s): ELBO: -202.98, ENRE: -196.02, KL: 6.9564.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 11694 (32 ms): -193.07.
Step 11731 (31 ms): -199.1.
Step 11769 (31 ms): -217.05.
Step 11806 (32 ms): -210.43.
Step 11844 (32 ms): -211.17.
Step 11882 (31 ms): -214.14.
Step 11919 (31 ms): -193.22.
Step 11957 (31 ms): -210.44.
Step 11994 (32 ms): -209.12.
Step 12032 (16 ms): -200.3.

Epoch 32 (11.8 s):
    Evaluating model.
    Full set (5.69 s): ELBO: -203.14, ENRE: -196.04, KL: 7.1027.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 12070 (32 ms): -214.02.
Step 12107 (31 ms): -208.41.
Step 12145 (33 ms): -203.16.
Step 12182 (32 ms): -192.58.
Step 12220 (31 ms): -203.01.
Step 12258 (32 ms): -192.16.
Step 12295 (31 ms): -199.45.
Step 12333 (31 ms): -209.26.
Step 12370 (31 ms): -190.33.
Step 12408 (16 ms): -258.28.

Epoch 33 (11.9 s):
    Evaluating model.
    Full set (5.66 s): ELBO: -202.94, ENRE: -195.78, KL: 7.158.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 12446 (32 ms): -220.11.
Step 12483 (31 ms): -206.04.
Step 12521 (32 ms): -207.93.
Step 12558 (31 ms): -199.71.
Step 12596 (32 ms): -196.86.
Step 12634 (31 ms): -207.12.
Step 12671 (31 ms): -215.34.
Step 12709 (31 ms): -203.61.
Step 12746 (33 ms): -196.75.
Step 12784 (16 ms): -228.37.

Epoch 34 (11.8 s):
    Evaluating model.
    Full set (5.71 s): ELBO: -202.7, ENRE: -195.68, KL: 7.02.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 12822 (32 ms): -185.41.
Step 12859 (32 ms): -212.58.
Step 12897 (32 ms): -202.08.
Step 12934 (32 ms): -206.59.
Step 12972 (32 ms): -206.53.
Step 13010 (32 ms): -200.86.
Step 13047 (32 ms): -203.17.
Step 13085 (32 ms): -195.63.
Step 13122 (32 ms): -196.54.
Step 13160 (16 ms): -201.25.

Epoch 35 (12.1 s):
    Evaluating model.
    Full set (5.71 s): ELBO: -202.47, ENRE: -195.48, KL: 6.9817.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 13198 (32 ms): -192.87.
Step 13235 (32 ms): -197.63.
Step 13273 (31 ms): -202.53.
Step 13310 (31 ms): -204.54.
Step 13348 (31 ms): -211.55.
Step 13386 (32 ms): -185.9.
Step 13423 (32 ms): -202.49.
Step 13461 (32 ms): -197.33.
Step 13498 (32 ms): -191.41.
Step 13536 (16 ms): -246.12.

Epoch 36 (12 s):
    Evaluating model.
    Full set (5.73 s): ELBO: -202.39, ENRE: -195.32, KL: 7.0756.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 13574 (32 ms): -196.96.
Step 13611 (32 ms): -196.63.
Step 13649 (31 ms): -197.74.
Step 13686 (32 ms): -210.84.
Step 13724 (32 ms): -194.13.
Step 13762 (32 ms): -194.
Step 13799 (32 ms): -200.65.
Step 13837 (32 ms): -190.87.
Step 13874 (31 ms): -215.
Step 13912 (17 ms): -233.75.

Epoch 37 (12.1 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -202.37, ENRE: -195.21, KL: 7.1609.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 13950 (32 ms): -198.32.
Step 13987 (31 ms): -192.36.
Step 14025 (31 ms): -202.16.
Step 14062 (32 ms): -205.12.
Step 14100 (31 ms): -199.45.
Step 14138 (32 ms): -190.5.
Step 14175 (32 ms): -205.74.
Step 14213 (32 ms): -210.67.
Step 14250 (32 ms): -208.76.
Step 14288 (16 ms): -471.63.

Epoch 38 (11.9 s):
    Evaluating model.
    Full set (5.7 s): ELBO: -202.12, ENRE: -195.01, KL: 7.1083.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 14326 (32 ms): -203.88.
Step 14363 (31 ms): -207.54.
Step 14401 (31 ms): -192.04.
Step 14438 (32 ms): -196.81.
Step 14476 (31 ms): -209.12.
Step 14514 (32 ms): -202.92.
Step 14551 (31 ms): -207.5.
Step 14589 (31 ms): -192.95.
Step 14626 (32 ms): -195.32.
Step 14664 (15 ms): -189.69.

Epoch 39 (11.9 s):
    Evaluating model.
    Full set (5.64 s): ELBO: -201.54, ENRE: -194.63, KL: 6.9113.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 14702 (32 ms): -210.21.
Step 14739 (32 ms): -197.06.
Step 14777 (32 ms): -199.89.
Step 14814 (31 ms): -218.89.
Step 14852 (33 ms): -191.6.
Step 14890 (31 ms): -208.6.
Step 14927 (31 ms): -215.39.
Step 14965 (31 ms): -199.7.
Step 15002 (31 ms): -203.07.
Step 15040 (16 ms): -278.26.

Epoch 40 (11.8 s):
    Evaluating model.
    Full set (5.68 s): ELBO: -201.92, ENRE: -194.85, KL: 7.0724.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 15078 (32 ms): -197.13.
Step 15115 (31 ms): -203.13.
Step 15153 (31 ms): -193.78.
Step 15190 (32 ms): -209.78.
Step 15228 (32 ms): -197.19.
Step 15266 (31 ms): -217.
Step 15303 (31 ms): -194.81.
Step 15341 (32 ms): -201.47.
Step 15378 (33 ms): -193.34.
Step 15416 (16 ms): -211.53.

Epoch 41 (11.9 s):
    Evaluating model.
    Full set (5.65 s): ELBO: -201.23, ENRE: -194.25, KL: 6.979.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 15454 (33 ms): -205.27.
Step 15491 (32 ms): -201.08.
Step 15529 (32 ms): -211.42.
Step 15566 (31 ms): -195.89.
Step 15604 (31 ms): -204.73.
Step 15642 (32 ms): -217.13.
Step 15679 (33 ms): -211.09.
Step 15717 (32 ms): -191.42.
Step 15754 (32 ms): -202.49.
Step 15792 (17 ms): -250.21.

Epoch 42 (12 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -201.2, ENRE: -194.24, KL: 6.9573.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 15830 (32 ms): -211.36.
Step 15867 (32 ms): -191.19.
Step 15905 (32 ms): -216.52.
Step 15942 (32 ms): -192.35.
Step 15980 (32 ms): -187.32.
Step 16018 (32 ms): -196.22.
Step 16055 (32 ms): -197.52.
Step 16093 (32 ms): -189.58.
Step 16130 (32 ms): -205.34.
Step 16168 (16 ms): -190.24.

Epoch 43 (12.1 s):
    Evaluating model.
    Full set (5.68 s): ELBO: -201.04, ENRE: -194.02, KL: 7.0163.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 16206 (32 ms): -190.27.
Step 16243 (31 ms): -203.57.
Step 16281 (31 ms): -203.02.
Step 16318 (32 ms): -201.44.
Step 16356 (32 ms): -194.97.
Step 16394 (31 ms): -202.21.
Step 16431 (31 ms): -204.13.
Step 16469 (32 ms): -203.56.
Step 16506 (33 ms): -193.16.
Step 16544 (16 ms): -272.92.

Epoch 44 (12 s):
    Evaluating model.
    Full set (5.75 s): ELBO: -200.9, ENRE: -193.92, KL: 6.9803.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 16582 (32 ms): -195.05.
Step 16619 (32 ms): -209.89.
Step 16657 (32 ms): -193.71.
Step 16694 (33 ms): -211.98.
Step 16732 (32 ms): -209.69.
Step 16770 (31 ms): -211.42.
Step 16807 (32 ms): -209.51.
Step 16845 (32 ms): -194.27.
Step 16882 (32 ms): -197.96.
Step 16920 (16 ms): -248.96.

Epoch 45 (12 s):
    Evaluating model.
    Full set (5.67 s): ELBO: -201.22, ENRE: -194.18, KL: 7.0466.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 16958 (31 ms): -197.76.
Step 16995 (32 ms): -195.89.
Step 17033 (31 ms): -194.64.
Step 17070 (31 ms): -205.67.
Step 17108 (31 ms): -205.33.
Step 17146 (31 ms): -195.2.
Step 17183 (31 ms): -192.01.
Step 17221 (31 ms): -207.74.
Step 17258 (31 ms): -200.08.
Step 17296 (15 ms): -186.42.

Epoch 46 (11.7 s):
    Evaluating model.
    Full set (5.67 s): ELBO: -200.63, ENRE: -193.67, KL: 6.9553.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 17334 (32 ms): -200.85.
Step 17371 (32 ms): -198.52.
Step 17409 (32 ms): -199.2.
Step 17446 (31 ms): -188.81.
Step 17484 (31 ms): -209.11.
Step 17522 (32 ms): -218.18.
Step 17559 (32 ms): -200.01.
Step 17597 (32 ms): -215.85.
Step 17634 (32 ms): -207.06.
Step 17672 (16 ms): -178.03.

Epoch 47 (11.9 s):
    Evaluating model.
    Full set (5.66 s): ELBO: -200.84, ENRE: -193.79, KL: 7.0509.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 17710 (32 ms): -207.08.
Step 17747 (32 ms): -189.78.
Step 17785 (32 ms): -197.32.
Step 17822 (32 ms): -214.12.
Step 17860 (33 ms): -191.88.
Step 17898 (31 ms): -208.69.
Step 17935 (31 ms): -204.93.
Step 17973 (31 ms): -209.92.
Step 18010 (32 ms): -198.32.
Step 18048 (16 ms): -208.47.

Epoch 48 (12 s):
    Evaluating model.
    Full set (5.74 s): ELBO: -200.65, ENRE: -193.69, KL: 6.9519.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 18086 (31 ms): -196.22.
Step 18123 (31 ms): -191.49.
Step 18161 (31 ms): -195.88.
Step 18198 (32 ms): -198.99.
Step 18236 (32 ms): -198.73.
Step 18274 (32 ms): -205.18.
Step 18311 (31 ms): -198.25.
Step 18349 (32 ms): -191.36.
Step 18386 (32 ms): -195.99.
Step 18424 (16 ms): -205.76.

Epoch 49 (12 s):
    Evaluating model.
    Full set (5.66 s): ELBO: -200.67, ENRE: -193.65, KL: 7.0219.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 18462 (31 ms): -207.03.
Step 18499 (32 ms): -194.08.
Step 18537 (31 ms): -192.29.
Step 18574 (33 ms): -211.62.
Step 18612 (32 ms): -207.15.
Step 18650 (32 ms): -196.79.
Step 18687 (32 ms): -214.35.
Step 18725 (31 ms): -200.44.
Step 18762 (32 ms): -202.
Step 18800 (16 ms): -177.74.

Epoch 50 (12 s):
    Evaluating model.
    Full set (5.73 s): ELBO: -200.33, ENRE: -193.43, KL: 6.908.
    Saving model parameters.
    Model parameters saved (116 ms).

Model trained for 50 epochs (14m 55s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (15 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (902 ms).

Converting data set value array to sparse matrix.
Data set value array converted (308 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2.14 s):  ELBO: -425.18, ENRE: -418.28, KL: 6.9.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (717 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 0.7865806133026494
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 24
kl weight: 0.7865806133026494
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (50 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.04 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.68 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 24
    hidden sizes: 136, 141, 66, 190, 184
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 0.7865806133026494
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 1 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 136)
    ENCODER/1/DENSE/biases:0             (136,)
    ENCODER/1/BATCH_NORM/beta:0          (136,)
    ENCODER/2/DENSE/weights:0            (136, 141)
    ENCODER/2/DENSE/biases:0             (141,)
    ENCODER/2/BATCH_NORM/beta:0          (141,)
    ENCODER/3/DENSE/weights:0            (141, 66)
    ENCODER/3/DENSE/biases:0             (66,)
    ENCODER/3/BATCH_NORM/beta:0          (66,)
    ENCODER/4/DENSE/weights:0            (66, 190)
    ENCODER/4/DENSE/biases:0             (190,)
    ENCODER/4/BATCH_NORM/beta:0          (190,)
    ENCODER/5/DENSE/weights:0            (190, 184)
    ENCODER/5/DENSE/biases:0             (184,)
    ENCODER/5/BATCH_NORM/beta:0          (184,)
    POSTERIOR/MU/DENSE/weights:0         (184, 24)
    POSTERIOR/MU/DENSE/biases:0          (24,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (184, 24)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (24,)
    DECODER/5/DENSE/weights:0            (24, 184)
    DECODER/5/DENSE/biases:0             (184,)
    DECODER/5/BATCH_NORM/beta:0          (184,)
    DECODER/4/DENSE/weights:0            (184, 190)
    DECODER/4/DENSE/biases:0             (190,)
    DECODER/4/BATCH_NORM/beta:0          (190,)
    DECODER/3/DENSE/weights:0            (190, 66)
    DECODER/3/DENSE/biases:0             (66,)
    DECODER/3/BATCH_NORM/beta:0          (66,)
    DECODER/2/DENSE/weights:0            (66, 141)
    DECODER/2/DENSE/biases:0             (141,)
    DECODER/2/BATCH_NORM/beta:0          (141,)
    DECODER/1/DENSE/weights:0            (141, 136)
    DECODER/1/DENSE/biases:0             (136,)
    DECODER/1/BATCH_NORM/beta:0          (136,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (136, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (544 ms).

Training model for 50 epochs on original values.

Step 38 (31 ms): -2237.3.
Step 75 (31 ms): -1934.6.
Step 113 (32 ms): -1655.2.
Step 150 (31 ms): -1425.6.
Step 188 (32 ms): -1292.1.
Step 226 (32 ms): -1182.9.
Step 263 (31 ms): -1081.7.
Step 301 (31 ms): -982.78.
Step 338 (31 ms): -926.98.
Step 376 (18 ms): -801.97.

Epoch 1 (14.8 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.28 s): ELBO: -1850.4, ENRE: -1845.2, KL: 5.2193.
    Saving model parameters.
    Model parameters saved (195 ms).

Step 414 (31 ms): -706.34.
Step 451 (31 ms): -596.73.
Step 489 (31 ms): -525.6.
Step 526 (32 ms): -497.79.
Step 564 (31 ms): -502.75.
Step 602 (31 ms): -431.37.
Step 639 (31 ms): -401.96.
Step 677 (31 ms): -408.3.
Step 714 (32 ms): -376.19.
Step 752 (17 ms): -374.84.

Epoch 2 (11.7 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -1090.4, ENRE: -1083, KL: 7.3605.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 790 (31 ms): -373.74.
Step 827 (32 ms): -350.1.
Step 865 (33 ms): -339.77.
Step 902 (31 ms): -369.99.
Step 940 (32 ms): -316.37.
Step 978 (32 ms): -308.71.
Step 1015 (34 ms): -296.32.
Step 1053 (32 ms): -315.23.
Step 1090 (31 ms): -295.84.
Step 1128 (16 ms): -466.57.

Epoch 3 (11.9 s):
    Evaluating model.
    Full set (5.55 s): ELBO: -617.59, ENRE: -610.37, KL: 7.2203.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 1166 (32 ms): -292.54.
Step 1203 (32 ms): -293.68.
Step 1241 (31 ms): -275.07.
Step 1278 (31 ms): -287.9.
Step 1316 (31 ms): -260.8.
Step 1354 (31 ms): -288.82.
Step 1391 (32 ms): -264.19.
Step 1429 (31 ms): -278.78.
Step 1466 (31 ms): -274.64.
Step 1504 (15 ms): -257.58.

Epoch 4 (11.8 s):
    Evaluating model.
    Full set (5.65 s): ELBO: -417.81, ENRE: -411.03, KL: 6.7769.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 1542 (31 ms): -247.12.
Step 1579 (32 ms): -260.47.
Step 1617 (32 ms): -253.42.
Step 1654 (32 ms): -245.87.
Step 1692 (32 ms): -237.35.
Step 1730 (32 ms): -233.8.
Step 1767 (32 ms): -235.57.
Step 1805 (32 ms): -261.61.
Step 1842 (31 ms): -231.51.
Step 1880 (16 ms): -345.08.

Epoch 5 (11.9 s):
    Evaluating model.
    Full set (5.59 s): ELBO: -331.99, ENRE: -325.67, KL: 6.3102.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 1918 (31 ms): -250.7.
Step 1955 (32 ms): -241.79.
Step 1993 (31 ms): -246.93.
Step 2030 (32 ms): -252.4.
Step 2068 (31 ms): -256.17.
Step 2106 (32 ms): -245.18.
Step 2143 (31 ms): -226.27.
Step 2181 (31 ms): -238.74.
Step 2218 (32 ms): -230.68.
Step 2256 (15 ms): -319.71.

Epoch 6 (11.8 s):
    Evaluating model.
    Full set (5.64 s): ELBO: -278.64, ENRE: -271.93, KL: 6.7063.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 2294 (31 ms): -228.71.
Step 2331 (31 ms): -224.63.
Step 2369 (31 ms): -233.6.
Step 2406 (31 ms): -219.43.
Step 2444 (31 ms): -232.07.
Step 2482 (32 ms): -221.82.
Step 2519 (31 ms): -242.06.
Step 2557 (31 ms): -224.12.
Step 2594 (31 ms): -228.87.
Step 2632 (15 ms): -468.49.

Epoch 7 (11.7 s):
    Evaluating model.
    Full set (5.54 s): ELBO: -252.88, ENRE: -245.94, KL: 6.94.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 2670 (31 ms): -232.16.
Step 2707 (32 ms): -231.57.
Step 2745 (31 ms): -229.08.
Step 2782 (32 ms): -230.64.
Step 2820 (31 ms): -210.02.
Step 2858 (31 ms): -217.95.
Step 2895 (31 ms): -218.79.
Step 2933 (31 ms): -210.11.
Step 2970 (31 ms): -217.88.
Step 3008 (15 ms): -220.65.

Epoch 8 (11.7 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -239.26, ENRE: -232.02, KL: 7.2373.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 3046 (31 ms): -227.76.
Step 3083 (31 ms): -218.11.
Step 3121 (31 ms): -215.04.
Step 3158 (31 ms): -204.11.
Step 3196 (31 ms): -218.56.
Step 3234 (32 ms): -215.29.
Step 3271 (31 ms): -219.04.
Step 3309 (31 ms): -236.87.
Step 3346 (32 ms): -218.05.
Step 3384 (15 ms): -251.98.

Epoch 9 (11.7 s):
    Evaluating model.
    Full set (5.56 s): ELBO: -232.51, ENRE: -225.35, KL: 7.1625.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 3422 (32 ms): -207.18.
Step 3459 (32 ms): -221.97.
Step 3497 (31 ms): -229.27.
Step 3534 (31 ms): -236.3.
Step 3572 (32 ms): -230.09.
Step 3610 (32 ms): -218.3.
Step 3647 (32 ms): -208.54.
Step 3685 (32 ms): -216.6.
Step 3722 (32 ms): -213.83.
Step 3760 (16 ms): -199.35.

Epoch 10 (11.9 s):
    Evaluating model.
    Full set (5.66 s): ELBO: -222.56, ENRE: -214.96, KL: 7.5964.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 3798 (32 ms): -204.87.
Step 3835 (31 ms): -210.52.
Step 3873 (32 ms): -221.38.
Step 3910 (31 ms): -223.87.
Step 3948 (31 ms): -228.65.
Step 3986 (32 ms): -213.75.
Step 4023 (32 ms): -203.82.
Step 4061 (31 ms): -231.61.
Step 4098 (32 ms): -217.56.
Step 4136 (16 ms): -274.2.

Epoch 11 (11.9 s):
    Evaluating model.
    Full set (5.59 s): ELBO: -218.4, ENRE: -210.72, KL: 7.6789.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 4174 (32 ms): -230.64.
Step 4211 (31 ms): -208.21.
Step 4249 (31 ms): -217.91.
Step 4286 (32 ms): -208.94.
Step 4324 (31 ms): -221.44.
Step 4362 (31 ms): -215.17.
Step 4399 (31 ms): -223.09.
Step 4437 (31 ms): -207.98.
Step 4474 (31 ms): -204.47.
Step 4512 (16 ms): -267.57.

Epoch 12 (11.8 s):
    Evaluating model.
    Full set (5.76 s): ELBO: -216.14, ENRE: -208.32, KL: 7.8222.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 4550 (32 ms): -210.11.
Step 4587 (32 ms): -214.05.
Step 4625 (31 ms): -211.76.
Step 4662 (31 ms): -212.16.
Step 4700 (31 ms): -213.41.
Step 4738 (32 ms): -204.65.
Step 4775 (31 ms): -225.91.
Step 4813 (32 ms): -215.6.
Step 4850 (31 ms): -210.64.
Step 4888 (15 ms): -193.11.

Epoch 13 (11.8 s):
    Evaluating model.
    Full set (5.53 s): ELBO: -214, ENRE: -206.5, KL: 7.4962.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 4926 (31 ms): -209.62.
Step 4963 (31 ms): -201.38.
Step 5001 (31 ms): -202.58.
Step 5038 (30 ms): -228.54.
Step 5076 (31 ms): -205.49.
Step 5114 (32 ms): -206.53.
Step 5151 (31 ms): -232.86.
Step 5189 (31 ms): -199.86.
Step 5226 (31 ms): -211.91.
Step 5264 (15 ms): -263.18.

Epoch 14 (11.6 s):
    Evaluating model.
    Full set (5.62 s): ELBO: -213.5, ENRE: -205.84, KL: 7.6691.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 5302 (31 ms): -202.1.
Step 5339 (31 ms): -215.12.
Step 5377 (32 ms): -213.74.
Step 5414 (31 ms): -212.52.
Step 5452 (31 ms): -207.61.
Step 5490 (31 ms): -206.52.
Step 5527 (31 ms): -214.22.
Step 5565 (31 ms): -199.71.
Step 5602 (31 ms): -200.28.
Step 5640 (15 ms): -251.36.

Epoch 15 (11.8 s):
    Evaluating model.
    Full set (5.53 s): ELBO: -212.35, ENRE: -204.8, KL: 7.5463.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 5678 (31 ms): -212.59.
Step 5715 (32 ms): -218.27.
Step 5753 (31 ms): -197.07.
Step 5790 (31 ms): -216.38.
Step 5828 (31 ms): -210.44.
Step 5866 (31 ms): -203.26.
Step 5903 (31 ms): -195.16.
Step 5941 (31 ms): -220.12.
Step 5978 (32 ms): -230.91.
Step 6016 (15 ms): -202.75.

Epoch 16 (11.7 s):
    Evaluating model.
    Full set (5.65 s): ELBO: -210.86, ENRE: -203.44, KL: 7.4245.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 6054 (31 ms): -207.37.
Step 6091 (33 ms): -200.26.
Step 6129 (32 ms): -213.32.
Step 6166 (31 ms): -206.02.
Step 6204 (31 ms): -200.34.
Step 6242 (31 ms): -201.96.
Step 6279 (31 ms): -213.12.
Step 6317 (32 ms): -216.72.
Step 6354 (32 ms): -210.39.
Step 6392 (16 ms): -198.61.

Epoch 17 (11.9 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -210.68, ENRE: -203.34, KL: 7.3439.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 6430 (32 ms): -194.76.
Step 6467 (31 ms): -209.21.
Step 6505 (32 ms): -202.64.
Step 6542 (32 ms): -207.77.
Step 6580 (31 ms): -203.79.
Step 6618 (31 ms): -213.91.
Step 6655 (32 ms): -209.83.
Step 6693 (32 ms): -205.57.
Step 6730 (32 ms): -220.46.
Step 6768 (16 ms): -179.37.

Epoch 18 (11.8 s):
    Evaluating model.
    Full set (5.69 s): ELBO: -211.37, ENRE: -204.03, KL: 7.3415.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 6806 (33 ms): -208.54.
Step 6843 (31 ms): -198.86.
Step 6881 (32 ms): -205.4.
Step 6918 (31 ms): -202.55.
Step 6956 (32 ms): -204.19.
Step 6994 (31 ms): -195.71.
Step 7031 (31 ms): -208.71.
Step 7069 (31 ms): -199.33.
Step 7106 (32 ms): -206.94.
Step 7144 (16 ms): -273.51.

Epoch 19 (11.9 s):
    Evaluating model.
    Full set (5.66 s): ELBO: -209.1, ENRE: -201.91, KL: 7.1823.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 7182 (31 ms): -204.64.
Step 7219 (32 ms): -206.22.
Step 7257 (31 ms): -209.41.
Step 7294 (31 ms): -229.68.
Step 7332 (30 ms): -212.46.
Step 7370 (31 ms): -203.27.
Step 7407 (31 ms): -200.98.
Step 7445 (31 ms): -197.16.
Step 7482 (32 ms): -203.9.
Step 7520 (15 ms): -254.22.

Epoch 20 (11.7 s):
    Evaluating model.
    Full set (5.64 s): ELBO: -208.83, ENRE: -201.68, KL: 7.148.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 7558 (31 ms): -217.1.
Step 7595 (31 ms): -208.85.
Step 7633 (31 ms): -202.31.
Step 7670 (31 ms): -199.43.
Step 7708 (31 ms): -200.66.
Step 7746 (30 ms): -207.77.
Step 7783 (31 ms): -206.28.
Step 7821 (31 ms): -195.91.
Step 7858 (33 ms): -211.32.
Step 7896 (15 ms): -213.5.

Epoch 21 (11.7 s):
    Evaluating model.
    Full set (5.53 s): ELBO: -206.74, ENRE: -199.78, KL: 6.9655.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 7934 (31 ms): -204.96.
Step 7971 (30 ms): -207.86.
Step 8009 (31 ms): -214.96.
Step 8046 (31 ms): -220.63.
Step 8084 (31 ms): -203.58.
Step 8122 (31 ms): -200.76.
Step 8159 (31 ms): -195.53.
Step 8197 (31 ms): -199.58.
Step 8234 (31 ms): -195.56.
Step 8272 (15 ms): -234.66.

Epoch 22 (11.7 s):
    Evaluating model.
    Full set (5.64 s): ELBO: -206.74, ENRE: -199.7, KL: 7.0462.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 8310 (31 ms): -217.18.
Step 8347 (31 ms): -207.12.
Step 8385 (31 ms): -209.49.
Step 8422 (31 ms): -201.9.
Step 8460 (32 ms): -207.51.
Step 8498 (32 ms): -206.98.
Step 8535 (31 ms): -192.06.
Step 8573 (32 ms): -201.12.
Step 8610 (33 ms): -212.55.
Step 8648 (16 ms): -209.98.

Epoch 23 (11.9 s):
    Evaluating model.
    Full set (5.57 s): ELBO: -206.78, ENRE: -199.68, KL: 7.1015.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 8686 (31 ms): -213.96.
Step 8723 (31 ms): -219.01.
Step 8761 (31 ms): -210.83.
Step 8798 (30 ms): -190.
Step 8836 (32 ms): -200.56.
Step 8874 (32 ms): -197.87.
Step 8911 (31 ms): -213.31.
Step 8949 (31 ms): -195.78.
Step 8986 (32 ms): -205.09.
Step 9024 (16 ms): -283.87.

Epoch 24 (11.8 s):
    Evaluating model.
    Full set (5.72 s): ELBO: -206.62, ENRE: -199.69, KL: 6.9319.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 9062 (31 ms): -211.52.
Step 9099 (32 ms): -207.82.
Step 9137 (32 ms): -200.96.
Step 9174 (32 ms): -201.96.
Step 9212 (31 ms): -212.42.
Step 9250 (31 ms): -204.97.
Step 9287 (34 ms): -212.93.
Step 9325 (32 ms): -206.98.
Step 9362 (32 ms): -193.88.
Step 9400 (16 ms): -232.47.

Epoch 25 (11.9 s):
    Evaluating model.
    Full set (5.6 s): ELBO: -206.12, ENRE: -199, KL: 7.1158.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 9438 (32 ms): -210.33.
Step 9475 (31 ms): -204.73.
Step 9513 (31 ms): -208.84.
Step 9550 (31 ms): -211.37.
Step 9588 (31 ms): -192.92.
Step 9626 (31 ms): -195.74.
Step 9663 (32 ms): -196.85.
Step 9701 (32 ms): -202.01.
Step 9738 (31 ms): -209.26.
Step 9776 (16 ms): -241.28.

Epoch 26 (11.8 s):
    Evaluating model.
    Full set (5.66 s): ELBO: -205.43, ENRE: -198.33, KL: 7.094.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 9814 (31 ms): -200.68.
Step 9851 (31 ms): -209.62.
Step 9889 (31 ms): -225.03.
Step 9926 (31 ms): -216.63.
Step 9964 (32 ms): -199.3.
Step 10002 (31 ms): -203.62.
Step 10039 (31 ms): -199.35.
Step 10077 (31 ms): -209.49.
Step 10114 (33 ms): -217.01.
Step 10152 (15 ms): -188.61.

Epoch 27 (11.8 s):
    Evaluating model.
    Full set (5.55 s): ELBO: -204.8, ENRE: -197.7, KL: 7.0951.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 10190 (31 ms): -208.16.
Step 10227 (31 ms): -202.84.
Step 10265 (32 ms): -192.46.
Step 10302 (30 ms): -198.91.
Step 10340 (32 ms): -208.45.
Step 10378 (31 ms): -210.24.
Step 10415 (31 ms): -203.84.
Step 10453 (31 ms): -201.95.
Step 10490 (31 ms): -212.74.
Step 10528 (15 ms): -229.82.

Epoch 28 (11.6 s):
    Evaluating model.
    Full set (5.64 s): ELBO: -204.22, ENRE: -197.08, KL: 7.1363.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 10566 (31 ms): -214.84.
Step 10603 (31 ms): -203.03.
Step 10641 (31 ms): -195.31.
Step 10678 (31 ms): -203.2.
Step 10716 (31 ms): -197.29.
Step 10754 (32 ms): -192.42.
Step 10791 (31 ms): -202.5.
Step 10829 (34 ms): -203.02.
Step 10866 (31 ms): -196.32.
Step 10904 (16 ms): -206.36.

Epoch 29 (11.8 s):
    Evaluating model.
    Full set (5.57 s): ELBO: -204.45, ENRE: -197.35, KL: 7.1082.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 10942 (32 ms): -200.4.
Step 10979 (31 ms): -206.43.
Step 11017 (31 ms): -202.59.
Step 11054 (31 ms): -203.71.
Step 11092 (31 ms): -202.76.
Step 11130 (31 ms): -196.03.
Step 11167 (31 ms): -206.5.
Step 11205 (31 ms): -198.1.
Step 11242 (33 ms): -202.75.
Step 11280 (16 ms): -303.5.

Epoch 30 (11.8 s):
    Evaluating model.
    Full set (5.67 s): ELBO: -203.52, ENRE: -196.44, KL: 7.0762.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 11318 (32 ms): -202.24.
Step 11355 (32 ms): -199.64.
Step 11393 (31 ms): -202.86.
Step 11430 (31 ms): -201.01.
Step 11468 (32 ms): -206.5.
Step 11506 (31 ms): -196.
Step 11543 (32 ms): -199.59.
Step 11581 (31 ms): -194.09.
Step 11618 (32 ms): -201.58.
Step 11656 (16 ms): -304.59.

Epoch 31 (11.9 s):
    Evaluating model.
    Full set (5.63 s): ELBO: -203.36, ENRE: -196.17, KL: 7.1922.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 11694 (32 ms): -204.22.
Step 11731 (31 ms): -207.53.
Step 11769 (32 ms): -215.59.
Step 11806 (31 ms): -209.66.
Step 11844 (32 ms): -198.71.
Step 11882 (31 ms): -213.57.
Step 11919 (32 ms): -196.44.
Step 11957 (32 ms): -198.84.
Step 11994 (31 ms): -204.68.
Step 12032 (16 ms): -229.14.

Epoch 32 (11.9 s):
    Evaluating model.
    Full set (5.66 s): ELBO: -203.45, ENRE: -196.21, KL: 7.2474.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 12070 (31 ms): -198.83.
Step 12107 (31 ms): -201.88.
Step 12145 (31 ms): -212.73.
Step 12182 (31 ms): -208.35.
Step 12220 (30 ms): -183.24.
Step 12258 (32 ms): -216.26.
Step 12295 (31 ms): -215.65.
Step 12333 (32 ms): -193.58.
Step 12370 (31 ms): -202.27.
Step 12408 (15 ms): -209.51.

Epoch 33 (11.8 s):
    Evaluating model.
    Full set (5.56 s): ELBO: -203.34, ENRE: -196.05, KL: 7.2902.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 12446 (31 ms): -189.57.
Step 12483 (31 ms): -194.61.
Step 12521 (31 ms): -195.42.
Step 12558 (31 ms): -220.11.
Step 12596 (31 ms): -209.42.
Step 12634 (31 ms): -219.08.
Step 12671 (31 ms): -207.85.
Step 12709 (31 ms): -198.15.
Step 12746 (31 ms): -189.22.
Step 12784 (15 ms): -266.07.

Epoch 34 (11.7 s):
    Evaluating model.
    Full set (5.65 s): ELBO: -203.37, ENRE: -196.14, KL: 7.2285.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 12822 (31 ms): -208.95.
Step 12859 (31 ms): -194.36.
Step 12897 (31 ms): -208.07.
Step 12934 (31 ms): -200.71.
Step 12972 (31 ms): -192.09.
Step 13010 (31 ms): -198.22.
Step 13047 (31 ms): -196.4.
Step 13085 (33 ms): -206.57.
Step 13122 (33 ms): -214.97.
Step 13160 (15 ms): -222.96.

Epoch 35 (11.7 s):
    Evaluating model.
    Full set (5.56 s): ELBO: -202.63, ENRE: -195.42, KL: 7.211.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 13198 (32 ms): -205.56.
Step 13235 (31 ms): -208.82.
Step 13273 (31 ms): -199.96.
Step 13310 (31 ms): -196.69.
Step 13348 (32 ms): -195.21.
Step 13386 (31 ms): -200.8.
Step 13423 (32 ms): -194.04.
Step 13461 (32 ms): -189.57.
Step 13498 (32 ms): -199.47.
Step 13536 (16 ms): -483.74.

Epoch 36 (11.9 s):
    Evaluating model.
    Full set (5.7 s): ELBO: -202.61, ENRE: -195.36, KL: 7.2523.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 13574 (32 ms): -189.53.
Step 13611 (32 ms): -196.03.
Step 13649 (31 ms): -213.36.
Step 13686 (32 ms): -203.53.
Step 13724 (32 ms): -198.9.
Step 13762 (32 ms): -200.56.
Step 13799 (32 ms): -194.37.
Step 13837 (32 ms): -197.56.
Step 13874 (32 ms): -202.07.
Step 13912 (16 ms): -203.53.

Epoch 37 (12 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -202.55, ENRE: -195.2, KL: 7.3517.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 13950 (32 ms): -217.74.
Step 13987 (31 ms): -205.45.
Step 14025 (32 ms): -202.13.
Step 14062 (31 ms): -192.78.
Step 14100 (31 ms): -210.13.
Step 14138 (31 ms): -217.45.
Step 14175 (31 ms): -195.4.
Step 14213 (32 ms): -201.07.
Step 14250 (32 ms): -190.53.
Step 14288 (16 ms): -206.79.

Epoch 38 (11.9 s):
    Evaluating model.
    Full set (5.71 s): ELBO: -201.67, ENRE: -194.39, KL: 7.2804.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 14326 (32 ms): -195.06.
Step 14363 (32 ms): -197.88.
Step 14401 (32 ms): -206.57.
Step 14438 (31 ms): -201.17.
Step 14476 (32 ms): -194.22.
Step 14514 (31 ms): -201.19.
Step 14551 (32 ms): -202.48.
Step 14589 (32 ms): -195.41.
Step 14626 (32 ms): -199.96.
Step 14664 (15 ms): -214.5.

Epoch 39 (11.9 s):
    Evaluating model.
    Full set (5.57 s): ELBO: -201.91, ENRE: -194.64, KL: 7.2725.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 14702 (31 ms): -193.96.
Step 14739 (31 ms): -196.47.
Step 14777 (31 ms): -199.28.
Step 14814 (32 ms): -194.82.
Step 14852 (31 ms): -206.84.
Step 14890 (32 ms): -199.56.
Step 14927 (31 ms): -180.76.
Step 14965 (30 ms): -197.13.
Step 15002 (32 ms): -213.74.
Step 15040 (15 ms): -280.41.

Epoch 40 (11.7 s):
    Evaluating model.
    Full set (5.62 s): ELBO: -201.98, ENRE: -194.6, KL: 7.3796.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 15078 (31 ms): -199.13.
Step 15115 (31 ms): -198.6.
Step 15153 (31 ms): -196.3.
Step 15190 (31 ms): -201.83.
Step 15228 (32 ms): -201.98.
Step 15266 (32 ms): -207.
Step 15303 (31 ms): -201.23.
Step 15341 (31 ms): -212.77.
Step 15378 (32 ms): -210.
Step 15416 (15 ms): -426.79.

Epoch 41 (11.8 s):
    Evaluating model.
    Full set (5.57 s): ELBO: -202.06, ENRE: -194.59, KL: 7.4747.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 15454 (31 ms): -200.98.
Step 15491 (31 ms): -214.32.
Step 15529 (31 ms): -207.67.
Step 15566 (31 ms): -187.24.
Step 15604 (32 ms): -199.26.
Step 15642 (31 ms): -194.37.
Step 15679 (31 ms): -212.6.
Step 15717 (31 ms): -212.23.
Step 15754 (31 ms): -201.59.
Step 15792 (16 ms): -261.19.

Epoch 42 (11.7 s):
    Evaluating model.
    Full set (5.66 s): ELBO: -201.44, ENRE: -194.08, KL: 7.3585.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 15830 (31 ms): -190.48.
Step 15867 (32 ms): -205.97.
Step 15905 (31 ms): -200.81.
Step 15942 (31 ms): -202.63.
Step 15980 (32 ms): -193.09.
Step 16018 (32 ms): -203.74.
Step 16055 (32 ms): -206.67.
Step 16093 (32 ms): -199.26.
Step 16130 (33 ms): -193.61.
Step 16168 (16 ms): -298.74.

Epoch 43 (12 s):
    Evaluating model.
    Full set (5.64 s): ELBO: -201.86, ENRE: -194.55, KL: 7.3177.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 16206 (32 ms): -194.75.
Step 16243 (31 ms): -195.75.
Step 16281 (32 ms): -200.57.
Step 16318 (32 ms): -199.53.
Step 16356 (32 ms): -199.61.
Step 16394 (32 ms): -198.58.
Step 16431 (31 ms): -192.88.
Step 16469 (32 ms): -201.44.
Step 16506 (32 ms): -195.13.
Step 16544 (16 ms): -201.16.

Epoch 44 (12 s):
    Evaluating model.
    Full set (5.71 s): ELBO: -200.97, ENRE: -193.62, KL: 7.3528.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 16582 (32 ms): -189.8.
Step 16619 (32 ms): -195.62.
Step 16657 (32 ms): -214.62.
Step 16694 (32 ms): -203.65.
Step 16732 (32 ms): -193.9.
Step 16770 (32 ms): -208.31.
Step 16807 (31 ms): -199.61.
Step 16845 (32 ms): -204.64.
Step 16882 (32 ms): -204.5.
Step 16920 (16 ms): -325.46.

Epoch 45 (12 s):
    Evaluating model.
    Full set (5.64 s): ELBO: -201.46, ENRE: -194.12, KL: 7.3358.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 16958 (32 ms): -193.81.
Step 16995 (32 ms): -199.4.
Step 17033 (32 ms): -211.04.
Step 17070 (31 ms): -207.39.
Step 17108 (31 ms): -196.24.
Step 17146 (31 ms): -199.2.
Step 17183 (31 ms): -190.7.
Step 17221 (31 ms): -200.52.
Step 17258 (32 ms): -217.41.
Step 17296 (15 ms): -381.01.

Epoch 46 (11.8 s):
    Evaluating model.
    Full set (5.65 s): ELBO: -201.32, ENRE: -193.98, KL: 7.3487.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 17334 (32 ms): -200.16.
Step 17371 (31 ms): -197.06.
Step 17409 (31 ms): -193.33.
Step 17446 (31 ms): -195.26.
Step 17484 (31 ms): -197.35.
Step 17522 (31 ms): -198.97.
Step 17559 (31 ms): -212.29.
Step 17597 (31 ms): -205.5.
Step 17634 (31 ms): -200.08.
Step 17672 (17 ms): -205.39.

Epoch 47 (11.8 s):
    Evaluating model.
    Full set (5.56 s): ELBO: -201.29, ENRE: -193.85, KL: 7.4353.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 17710 (31 ms): -209.05.
Step 17747 (32 ms): -204.22.
Step 17785 (31 ms): -197.9.
Step 17822 (30 ms): -194.67.
Step 17860 (31 ms): -194.21.
Step 17898 (32 ms): -198.68.
Step 17935 (31 ms): -202.33.
Step 17973 (32 ms): -212.38.
Step 18010 (31 ms): -202.71.
Step 18048 (15 ms): -195.59.

Epoch 48 (11.7 s):
    Evaluating model.
    Full set (5.66 s): ELBO: -200.77, ENRE: -193.47, KL: 7.2999.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 18086 (31 ms): -205.84.
Step 18123 (31 ms): -196.92.
Step 18161 (32 ms): -200.12.
Step 18198 (33 ms): -198.37.
Step 18236 (31 ms): -202.67.
Step 18274 (31 ms): -201.24.
Step 18311 (32 ms): -209.06.
Step 18349 (34 ms): -209.78.
Step 18386 (31 ms): -213.82.
Step 18424 (16 ms): -216.86.

Epoch 49 (11.8 s):
    Evaluating model.
    Full set (5.61 s): ELBO: -201, ENRE: -193.59, KL: 7.4068.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 18462 (31 ms): -193.
Step 18499 (32 ms): -200.34.
Step 18537 (32 ms): -191.9.
Step 18574 (33 ms): -203.91.
Step 18612 (32 ms): -207.63.
Step 18650 (32 ms): -209.04.
Step 18687 (32 ms): -198.62.
Step 18725 (32 ms): -199.66.
Step 18762 (32 ms): -204.4.
Step 18800 (16 ms): -243.16.

Epoch 50 (11.9 s):
    Evaluating model.
    Full set (5.73 s): ELBO: -200.61, ENRE: -193.21, KL: 7.4033.
    Saving model parameters.
    Model parameters saved (117 ms).

Model trained for 50 epochs (14m 43s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (13 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (910 ms).

Converting data set value array to sparse matrix.
Data set value array converted (315 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.88 s):  ELBO: -426.12, ENRE: -418.72, KL: 7.4041.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (723 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 0.5892157797890526
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 27
kl weight: 0.5892157797890526
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (49 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.26 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.89 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 27
    hidden sizes: 181, 108, 98, 136, 226
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 0.5892157797890526
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 2 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 181)
    ENCODER/1/DENSE/biases:0             (181,)
    ENCODER/1/BATCH_NORM/beta:0          (181,)
    ENCODER/2/DENSE/weights:0            (181, 108)
    ENCODER/2/DENSE/biases:0             (108,)
    ENCODER/2/BATCH_NORM/beta:0          (108,)
    ENCODER/3/DENSE/weights:0            (108, 98)
    ENCODER/3/DENSE/biases:0             (98,)
    ENCODER/3/BATCH_NORM/beta:0          (98,)
    ENCODER/4/DENSE/weights:0            (98, 136)
    ENCODER/4/DENSE/biases:0             (136,)
    ENCODER/4/BATCH_NORM/beta:0          (136,)
    ENCODER/5/DENSE/weights:0            (136, 226)
    ENCODER/5/DENSE/biases:0             (226,)
    ENCODER/5/BATCH_NORM/beta:0          (226,)
    POSTERIOR/MU/DENSE/weights:0         (226, 27)
    POSTERIOR/MU/DENSE/biases:0          (27,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (226, 27)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (27,)
    DECODER/5/DENSE/weights:0            (27, 226)
    DECODER/5/DENSE/biases:0             (226,)
    DECODER/5/BATCH_NORM/beta:0          (226,)
    DECODER/4/DENSE/weights:0            (226, 136)
    DECODER/4/DENSE/biases:0             (136,)
    DECODER/4/BATCH_NORM/beta:0          (136,)
    DECODER/3/DENSE/weights:0            (136, 98)
    DECODER/3/DENSE/biases:0             (98,)
    DECODER/3/BATCH_NORM/beta:0          (98,)
    DECODER/2/DENSE/weights:0            (98, 108)
    DECODER/2/DENSE/biases:0             (108,)
    DECODER/2/BATCH_NORM/beta:0          (108,)
    DECODER/1/DENSE/weights:0            (108, 181)
    DECODER/1/DENSE/biases:0             (181,)
    DECODER/1/BATCH_NORM/beta:0          (181,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (181, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (552 ms).

Training model for 50 epochs on original values.

Step 38 (35 ms): -2192.7.
Step 75 (34 ms): -1860.4.
Step 113 (35 ms): -1595.7.
Step 150 (34 ms): -1362.1.
Step 188 (34 ms): -1234.6.
Step 226 (34 ms): -1165.8.
Step 263 (34 ms): -1017.
Step 301 (34 ms): -957.11.
Step 338 (34 ms): -926.57.
Step 376 (19 ms): -799.43.

Epoch 1 (15.7 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.65 s): ELBO: -1812.6, ENRE: -1806.5, KL: 6.0258.
    Saving model parameters.
    Model parameters saved (200 ms).

Step 414 (34 ms): -737.27.
Step 451 (34 ms): -552.85.
Step 489 (36 ms): -496.42.
Step 526 (35 ms): -464.52.
Step 564 (34 ms): -416.71.
Step 602 (33 ms): -392.3.
Step 639 (34 ms): -391.02.
Step 677 (34 ms): -350.49.
Step 714 (34 ms): -338.77.
Step 752 (20 ms): -417.12.

Epoch 2 (12.8 s):
    Warm-up weight: 0.5
    Evaluating model.
    Full set (6.01 s): ELBO: -1065, ENRE: -1055, KL: 10.062.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 790 (33 ms): -330.01.
Step 827 (34 ms): -318.29.
Step 865 (34 ms): -338.36.
Step 902 (34 ms): -300.54.
Step 940 (34 ms): -283.05.
Step 978 (34 ms): -281.
Step 1015 (34 ms): -281.4.
Step 1053 (35 ms): -273.17.
Step 1090 (34 ms): -267.13.
Step 1128 (16 ms): -375.2.

Epoch 3 (12.7 s):
    Evaluating model.
    Full set (5.98 s): ELBO: -641.82, ENRE: -631.77, KL: 10.047.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 1166 (34 ms): -264.06.
Step 1203 (33 ms): -263.02.
Step 1241 (35 ms): -287.32.
Step 1278 (35 ms): -271.34.
Step 1316 (34 ms): -239.83.
Step 1354 (35 ms): -247.25.
Step 1391 (34 ms): -265.18.
Step 1429 (34 ms): -253.27.
Step 1466 (36 ms): -269.31.
Step 1504 (16 ms): -383.29.

Epoch 4 (12.9 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -443.14, ENRE: -434.36, KL: 8.7801.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 1542 (34 ms): -234.63.
Step 1579 (34 ms): -239.43.
Step 1617 (34 ms): -226.59.
Step 1654 (34 ms): -230.23.
Step 1692 (34 ms): -235.94.
Step 1730 (35 ms): -247.76.
Step 1767 (34 ms): -223.13.
Step 1805 (34 ms): -230.03.
Step 1842 (34 ms): -224.66.
Step 1880 (17 ms): -279.69.

Epoch 5 (12.9 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -336.92, ENRE: -328.71, KL: 8.2059.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 1918 (34 ms): -245.64.
Step 1955 (34 ms): -230.77.
Step 1993 (34 ms): -234.9.
Step 2030 (34 ms): -227.64.
Step 2068 (34 ms): -227.9.
Step 2106 (35 ms): -233.42.
Step 2143 (34 ms): -226.07.
Step 2181 (34 ms): -225.5.
Step 2218 (35 ms): -225.31.
Step 2256 (17 ms): -264.72.

Epoch 6 (12.9 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -278.74, ENRE: -270.73, KL: 8.0091.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 2294 (34 ms): -225.33.
Step 2331 (35 ms): -220.56.
Step 2369 (35 ms): -229.27.
Step 2406 (34 ms): -223.27.
Step 2444 (34 ms): -214.7.
Step 2482 (35 ms): -221.57.
Step 2519 (34 ms): -216.51.
Step 2557 (33 ms): -223.2.
Step 2594 (34 ms): -211.26.
Step 2632 (17 ms): -226.88.

Epoch 7 (12.9 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -247.79, ENRE: -239.44, KL: 8.345.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 2670 (35 ms): -218.03.
Step 2707 (33 ms): -241.37.
Step 2745 (34 ms): -217.72.
Step 2782 (34 ms): -230.85.
Step 2820 (34 ms): -234.73.
Step 2858 (34 ms): -218.9.
Step 2895 (34 ms): -216.31.
Step 2933 (34 ms): -223.48.
Step 2970 (34 ms): -209.53.
Step 3008 (16 ms): -339.92.

Epoch 8 (12.8 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -232.2, ENRE: -223.62, KL: 8.583.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 3046 (34 ms): -212.21.
Step 3083 (33 ms): -216.11.
Step 3121 (34 ms): -218.24.
Step 3158 (34 ms): -225.83.
Step 3196 (33 ms): -207.87.
Step 3234 (33 ms): -214.77.
Step 3271 (33 ms): -225.74.
Step 3309 (34 ms): -231.5.
Step 3346 (33 ms): -227.48.
Step 3384 (16 ms): -229.19.

Epoch 9 (12.7 s):
    Evaluating model.
    Full set (5.98 s): ELBO: -225.2, ENRE: -216.72, KL: 8.4864.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 3422 (34 ms): -226.6.
Step 3459 (34 ms): -202.36.
Step 3497 (34 ms): -209.76.
Step 3534 (34 ms): -208.66.
Step 3572 (34 ms): -224.56.
Step 3610 (34 ms): -215.09.
Step 3647 (34 ms): -210.6.
Step 3685 (33 ms): -202.95.
Step 3722 (34 ms): -204.53.
Step 3760 (17 ms): -254.1.

Epoch 10 (12.8 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -219.27, ENRE: -210.67, KL: 8.5953.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 3798 (34 ms): -247.22.
Step 3835 (35 ms): -212.6.
Step 3873 (34 ms): -210.99.
Step 3910 (36 ms): -216.94.
Step 3948 (34 ms): -212.34.
Step 3986 (34 ms): -235.87.
Step 4023 (34 ms): -212.19.
Step 4061 (34 ms): -229.62.
Step 4098 (37 ms): -203.78.
Step 4136 (17 ms): -201.63.

Epoch 11 (13 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -215.62, ENRE: -207.01, KL: 8.6141.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 4174 (35 ms): -219.97.
Step 4211 (35 ms): -217.46.
Step 4249 (36 ms): -211.87.
Step 4286 (34 ms): -214.13.
Step 4324 (34 ms): -198.27.
Step 4362 (34 ms): -226.98.
Step 4399 (34 ms): -210.26.
Step 4437 (34 ms): -207.43.
Step 4474 (34 ms): -208.49.
Step 4512 (16 ms): -239.28.

Epoch 12 (12.9 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -213.95, ENRE: -205.4, KL: 8.5477.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 4550 (34 ms): -203.08.
Step 4587 (34 ms): -218.85.
Step 4625 (35 ms): -211.61.
Step 4662 (34 ms): -214.95.
Step 4700 (34 ms): -205.9.
Step 4738 (34 ms): -212.46.
Step 4775 (34 ms): -204.71.
Step 4813 (33 ms): -196.15.
Step 4850 (34 ms): -220.49.
Step 4888 (16 ms): -271.06.

Epoch 13 (12.9 s):
    Evaluating model.
    Full set (6 s): ELBO: -212.02, ENRE: -203.46, KL: 8.5603.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 4926 (34 ms): -221.42.
Step 4963 (34 ms): -200.9.
Step 5001 (34 ms): -225.31.
Step 5038 (34 ms): -206.47.
Step 5076 (34 ms): -204.3.
Step 5114 (34 ms): -214.54.
Step 5151 (34 ms): -214.93.
Step 5189 (33 ms): -220.22.
Step 5226 (35 ms): -208.93.
Step 5264 (17 ms): -216.34.

Epoch 14 (12.8 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -212.33, ENRE: -203.77, KL: 8.5615.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 5302 (34 ms): -204.9.
Step 5339 (33 ms): -203.2.
Step 5377 (35 ms): -201.15.
Step 5414 (34 ms): -207.21.
Step 5452 (34 ms): -209.49.
Step 5490 (34 ms): -217.98.
Step 5527 (33 ms): -216.97.
Step 5565 (34 ms): -201.53.
Step 5602 (34 ms): -210.86.
Step 5640 (16 ms): -484.75.

Epoch 15 (12.8 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -210.14, ENRE: -201.67, KL: 8.4718.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 5678 (36 ms): -209.23.
Step 5715 (34 ms): -206.11.
Step 5753 (34 ms): -199.28.
Step 5790 (34 ms): -203.86.
Step 5828 (34 ms): -211.13.
Step 5866 (36 ms): -225.
Step 5903 (34 ms): -225.08.
Step 5941 (34 ms): -200.73.
Step 5978 (35 ms): -217.09.
Step 6016 (17 ms): -208.05.

Epoch 16 (12.9 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -209.25, ENRE: -200.82, KL: 8.4278.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 6054 (34 ms): -206.05.
Step 6091 (34 ms): -205.45.
Step 6129 (34 ms): -203.01.
Step 6166 (35 ms): -206.06.
Step 6204 (34 ms): -206.83.
Step 6242 (35 ms): -201.93.
Step 6279 (34 ms): -202.22.
Step 6317 (34 ms): -211.78.
Step 6354 (35 ms): -212.37.
Step 6392 (17 ms): -196.63.

Epoch 17 (13 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -208.96, ENRE: -200.47, KL: 8.4854.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 6430 (34 ms): -202.15.
Step 6467 (35 ms): -206.35.
Step 6505 (34 ms): -205.02.
Step 6542 (35 ms): -225.08.
Step 6580 (34 ms): -216.31.
Step 6618 (34 ms): -221.5.
Step 6655 (34 ms): -202.09.
Step 6693 (34 ms): -202.68.
Step 6730 (34 ms): -207.9.
Step 6768 (17 ms): -232.37.

Epoch 18 (12.9 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -209.19, ENRE: -200.82, KL: 8.3742.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 6806 (35 ms): -209.45.
Step 6843 (34 ms): -202.66.
Step 6881 (33 ms): -212.45.
Step 6918 (34 ms): -216.03.
Step 6956 (34 ms): -198.7.
Step 6994 (34 ms): -203.97.
Step 7031 (34 ms): -216.77.
Step 7069 (34 ms): -201.74.
Step 7106 (35 ms): -209.1.
Step 7144 (17 ms): -287.62.

Epoch 19 (12.9 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -207.23, ENRE: -198.99, KL: 8.2363.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 7182 (34 ms): -228.32.
Step 7219 (34 ms): -207.95.
Step 7257 (34 ms): -206.89.
Step 7294 (34 ms): -217.52.
Step 7332 (34 ms): -202.1.
Step 7370 (35 ms): -209.2.
Step 7407 (34 ms): -208.08.
Step 7445 (34 ms): -197.82.
Step 7482 (34 ms): -199.58.
Step 7520 (16 ms): -279.73.

Epoch 20 (12.7 s):
    Evaluating model.
    Full set (6 s): ELBO: -207.12, ENRE: -198.69, KL: 8.4377.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 7558 (34 ms): -213.89.
Step 7595 (34 ms): -195.64.
Step 7633 (33 ms): -205.65.
Step 7670 (34 ms): -194.67.
Step 7708 (34 ms): -183.71.
Step 7746 (34 ms): -195.85.
Step 7783 (33 ms): -215.28.
Step 7821 (33 ms): -207.58.
Step 7858 (34 ms): -199.17.
Step 7896 (16 ms): -191.3.

Epoch 21 (12.7 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -206.16, ENRE: -197.86, KL: 8.2989.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 7934 (35 ms): -204.59.
Step 7971 (34 ms): -200.41.
Step 8009 (34 ms): -208.25.
Step 8046 (34 ms): -202.6.
Step 8084 (34 ms): -200.1.
Step 8122 (33 ms): -199.73.
Step 8159 (34 ms): -189.55.
Step 8197 (34 ms): -194.44.
Step 8234 (34 ms): -204.94.
Step 8272 (16 ms): -1054.5.

Epoch 22 (12.9 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -205.89, ENRE: -197.5, KL: 8.3846.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 8310 (34 ms): -200.93.
Step 8347 (34 ms): -206.89.
Step 8385 (34 ms): -203.7.
Step 8422 (36 ms): -201.63.
Step 8460 (34 ms): -203.52.
Step 8498 (35 ms): -196.94.
Step 8535 (34 ms): -196.38.
Step 8573 (34 ms): -199.26.
Step 8610 (34 ms): -214.45.
Step 8648 (16 ms): -313.55.

Epoch 23 (12.9 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -205.23, ENRE: -196.67, KL: 8.5643.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 8686 (35 ms): -204.45.
Step 8723 (35 ms): -207.98.
Step 8761 (34 ms): -196.97.
Step 8798 (34 ms): -207.87.
Step 8836 (34 ms): -192.29.
Step 8874 (34 ms): -193.61.
Step 8911 (34 ms): -197.61.
Step 8949 (34 ms): -199.91.
Step 8986 (34 ms): -215.2.
Step 9024 (17 ms): -215.07.

Epoch 24 (13 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -205.54, ENRE: -197.11, KL: 8.4354.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 9062 (34 ms): -208.98.
Step 9099 (34 ms): -195.84.
Step 9137 (34 ms): -205.72.
Step 9174 (35 ms): -210.72.
Step 9212 (35 ms): -199.69.
Step 9250 (34 ms): -200.19.
Step 9287 (34 ms): -208.58.
Step 9325 (34 ms): -222.71.
Step 9362 (34 ms): -216.39.
Step 9400 (16 ms): -271.02.

Epoch 25 (12.9 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -204.12, ENRE: -195.81, KL: 8.3147.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 9438 (35 ms): -196.63.
Step 9475 (34 ms): -203.65.
Step 9513 (34 ms): -198.65.
Step 9550 (34 ms): -189.23.
Step 9588 (34 ms): -205.09.
Step 9626 (34 ms): -213.18.
Step 9663 (34 ms): -199.2.
Step 9701 (33 ms): -195.87.
Step 9738 (34 ms): -204.81.
Step 9776 (16 ms): -217.62.

Epoch 26 (12.8 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -203.81, ENRE: -195.49, KL: 8.3161.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 9814 (34 ms): -211.13.
Step 9851 (34 ms): -196.29.
Step 9889 (34 ms): -207.36.
Step 9926 (33 ms): -203.45.
Step 9964 (34 ms): -215.72.
Step 10002 (34 ms): -206.92.
Step 10039 (33 ms): -193.65.
Step 10077 (34 ms): -204.83.
Step 10114 (34 ms): -194.35.
Step 10152 (16 ms): -219.28.

Epoch 27 (12.7 s):
    Evaluating model.
    Full set (6.01 s): ELBO: -203.59, ENRE: -195.15, KL: 8.4348.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 10190 (34 ms): -204.46.
Step 10227 (34 ms): -217.56.
Step 10265 (33 ms): -199.33.
Step 10302 (34 ms): -191.03.
Step 10340 (34 ms): -195.86.
Step 10378 (34 ms): -203.61.
Step 10415 (34 ms): -217.66.
Step 10453 (33 ms): -201.96.
Step 10490 (34 ms): -206.92.
Step 10528 (17 ms): -249.16.

Epoch 28 (12.8 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -204.25, ENRE: -195.84, KL: 8.4116.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 10566 (35 ms): -222.25.
Step 10603 (36 ms): -194.73.
Step 10641 (36 ms): -208.9.
Step 10678 (35 ms): -201.4.
Step 10716 (34 ms): -203.44.
Step 10754 (35 ms): -193.7.
Step 10791 (34 ms): -197.11.
Step 10829 (34 ms): -202.96.
Step 10866 (34 ms): -198.61.
Step 10904 (17 ms): -187.79.

Epoch 29 (13 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -203.51, ENRE: -195.04, KL: 8.4723.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 10942 (34 ms): -194.36.
Step 10979 (35 ms): -191.38.
Step 11017 (34 ms): -199.8.
Step 11054 (35 ms): -196.04.
Step 11092 (36 ms): -217.38.
Step 11130 (35 ms): -192.09.
Step 11167 (36 ms): -206.24.
Step 11205 (35 ms): -202.4.
Step 11242 (34 ms): -197.63.
Step 11280 (17 ms): -205.7.

Epoch 30 (13 s):
    Evaluating model.
    Full set (6.13 s): ELBO: -203.05, ENRE: -194.69, KL: 8.3595.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 11318 (34 ms): -207.87.
Step 11355 (34 ms): -208.89.
Step 11393 (34 ms): -199.1.
Step 11430 (34 ms): -191.24.
Step 11468 (35 ms): -225.93.
Step 11506 (34 ms): -207.5.
Step 11543 (34 ms): -197.69.
Step 11581 (34 ms): -205.56.
Step 11618 (35 ms): -206.52.
Step 11656 (17 ms): -245.54.

Epoch 31 (13 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -202.77, ENRE: -194.43, KL: 8.3405.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 11694 (34 ms): -198.37.
Step 11731 (35 ms): -199.28.
Step 11769 (34 ms): -195.86.
Step 11806 (35 ms): -201.62.
Step 11844 (35 ms): -206.18.
Step 11882 (34 ms): -189.96.
Step 11919 (34 ms): -201.52.
Step 11957 (34 ms): -218.91.
Step 11994 (36 ms): -205.13.
Step 12032 (16 ms): -210.96.

Epoch 32 (12.8 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -203.19, ENRE: -194.69, KL: 8.5013.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 12070 (35 ms): -214.08.
Step 12107 (34 ms): -211.7.
Step 12145 (33 ms): -199.98.
Step 12182 (34 ms): -215.97.
Step 12220 (34 ms): -199.93.
Step 12258 (34 ms): -206.35.
Step 12295 (34 ms): -203.71.
Step 12333 (33 ms): -193.59.
Step 12370 (34 ms): -208.3.
Step 12408 (16 ms): -203.38.

Epoch 33 (12.7 s):
    Evaluating model.
    Full set (6 s): ELBO: -203.06, ENRE: -194.46, KL: 8.5974.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 12446 (34 ms): -211.17.
Step 12483 (34 ms): -202.27.
Step 12521 (34 ms): -198.14.
Step 12558 (33 ms): -206.9.
Step 12596 (34 ms): -196.56.
Step 12634 (34 ms): -197.41.
Step 12671 (33 ms): -197.81.
Step 12709 (34 ms): -191.72.
Step 12746 (34 ms): -192.73.
Step 12784 (17 ms): -312.58.

Epoch 34 (12.8 s):
    Evaluating model.
    Full set (6.04 s): ELBO: -202.17, ENRE: -193.71, KL: 8.461.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 12822 (34 ms): -200.09.
Step 12859 (34 ms): -209.09.
Step 12897 (34 ms): -206.4.
Step 12934 (34 ms): -199.61.
Step 12972 (34 ms): -196.76.
Step 13010 (35 ms): -197.92.
Step 13047 (34 ms): -206.82.
Step 13085 (35 ms): -202.83.
Step 13122 (34 ms): -206.21.
Step 13160 (17 ms): -303.93.

Epoch 35 (13 s):
    Evaluating model.
    Full set (6.03 s): ELBO: -202.59, ENRE: -194.03, KL: 8.5648.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 13198 (34 ms): -201.36.
Step 13235 (36 ms): -201.46.
Step 13273 (34 ms): -210.28.
Step 13310 (34 ms): -200.84.
Step 13348 (34 ms): -211.52.
Step 13386 (36 ms): -208.15.
Step 13423 (34 ms): -200.56.
Step 13461 (34 ms): -195.71.
Step 13498 (35 ms): -198.68.
Step 13536 (17 ms): -240.31.

Epoch 36 (12.9 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -201.97, ENRE: -193.52, KL: 8.4524.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 13574 (34 ms): -194.74.
Step 13611 (34 ms): -197.55.
Step 13649 (34 ms): -183.31.
Step 13686 (35 ms): -197.77.
Step 13724 (35 ms): -202.6.
Step 13762 (35 ms): -202.7.
Step 13799 (34 ms): -213.27.
Step 13837 (34 ms): -202.06.
Step 13874 (34 ms): -199.13.
Step 13912 (17 ms): -229.32.

Epoch 37 (12.9 s):
    Evaluating model.
    Full set (6.02 s): ELBO: -201.81, ENRE: -193.43, KL: 8.3743.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 13950 (34 ms): -201.73.
Step 13987 (34 ms): -197.74.
Step 14025 (34 ms): -208.44.
Step 14062 (34 ms): -201.32.
Step 14100 (34 ms): -194.9.
Step 14138 (34 ms): -202.09.
Step 14175 (33 ms): -201.63.
Step 14213 (34 ms): -196.82.
Step 14250 (34 ms): -199.07.
Step 14288 (17 ms): -225.17.

Epoch 38 (12.8 s):
    Evaluating model.
    Full set (6 s): ELBO: -201.92, ENRE: -193.27, KL: 8.6504.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 14326 (34 ms): -195.57.
Step 14363 (33 ms): -207.5.
Step 14401 (34 ms): -199.78.
Step 14438 (34 ms): -196.3.
Step 14476 (34 ms): -193.46.
Step 14514 (35 ms): -190.21.
Step 14551 (34 ms): -184.96.
Step 14589 (35 ms): -204.83.
Step 14626 (34 ms): -209.21.
Step 14664 (17 ms): -252.48.

Epoch 39 (12.8 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -201.25, ENRE: -192.77, KL: 8.48.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 14702 (34 ms): -203.5.
Step 14739 (34 ms): -198.58.
Step 14777 (34 ms): -204.3.
Step 14814 (35 ms): -207.07.
Step 14852 (34 ms): -202.17.
Step 14890 (34 ms): -206.81.
Step 14927 (36 ms): -211.01.
Step 14965 (35 ms): -197.79.
Step 15002 (34 ms): -196.12.
Step 15040 (17 ms): -275.3.

Epoch 40 (12.9 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -201.12, ENRE: -192.69, KL: 8.4287.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 15078 (34 ms): -190.04.
Step 15115 (34 ms): -202.77.
Step 15153 (34 ms): -202.94.
Step 15190 (34 ms): -188.35.
Step 15228 (34 ms): -200.89.
Step 15266 (33 ms): -213.58.
Step 15303 (34 ms): -194.85.
Step 15341 (34 ms): -208.03.
Step 15378 (35 ms): -201.91.
Step 15416 (16 ms): -214.84.

Epoch 41 (12.8 s):
    Evaluating model.
    Full set (6.06 s): ELBO: -201.03, ENRE: -192.59, KL: 8.4401.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 15454 (35 ms): -202.21.
Step 15491 (34 ms): -214.3.
Step 15529 (33 ms): -191.93.
Step 15566 (34 ms): -197.81.
Step 15604 (34 ms): -204.04.
Step 15642 (34 ms): -201.79.
Step 15679 (34 ms): -211.3.
Step 15717 (35 ms): -205.07.
Step 15754 (36 ms): -202.56.
Step 15792 (16 ms): -198.53.

Epoch 42 (12.8 s):
    Evaluating model.
    Full set (5.98 s): ELBO: -201.15, ENRE: -192.6, KL: 8.5502.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 15830 (34 ms): -200.16.
Step 15867 (34 ms): -222.24.
Step 15905 (33 ms): -196.61.
Step 15942 (34 ms): -207.45.
Step 15980 (34 ms): -190.29.
Step 16018 (35 ms): -196.37.
Step 16055 (35 ms): -191.74.
Step 16093 (35 ms): -207.36.
Step 16130 (35 ms): -196.22.
Step 16168 (17 ms): -218.14.

Epoch 43 (12.9 s):
    Evaluating model.
    Full set (6.19 s): ELBO: -201.33, ENRE: -192.73, KL: 8.5998.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 16206 (35 ms): -210.58.
Step 16243 (34 ms): -202.84.
Step 16281 (34 ms): -202.09.
Step 16318 (34 ms): -207.71.
Step 16356 (35 ms): -191.86.
Step 16394 (34 ms): -202.53.
Step 16431 (34 ms): -199.48.
Step 16469 (35 ms): -202.4.
Step 16506 (35 ms): -190.7.
Step 16544 (17 ms): -249.37.

Epoch 44 (13.1 s):
    Evaluating model.
    Full set (6.2 s): ELBO: -200.61, ENRE: -192.08, KL: 8.5305.
    Saving model parameters.
    Model parameters saved (129 ms).

Step 16582 (34 ms): -210.03.
Step 16619 (34 ms): -196.74.
Step 16657 (35 ms): -199.13.
Step 16694 (35 ms): -209.32.
Step 16732 (35 ms): -207.18.
Step 16770 (35 ms): -204.65.
Step 16807 (35 ms): -189.75.
Step 16845 (35 ms): -219.29.
Step 16882 (37 ms): -200.38.
Step 16920 (17 ms): -255.08.

Epoch 45 (13.2 s):
    Evaluating model.
    Full set (6.25 s): ELBO: -200.9, ENRE: -192.39, KL: 8.5026.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 16958 (36 ms): -211.95.
Step 16995 (36 ms): -199.18.
Step 17033 (35 ms): -209.87.
Step 17070 (37 ms): -197.51.
Step 17108 (36 ms): -204.3.
Step 17146 (36 ms): -202.34.
Step 17183 (36 ms): -203.85.
Step 17221 (34 ms): -208.33.
Step 17258 (35 ms): -198.5.
Step 17296 (17 ms): -246.69.

Epoch 46 (13.3 s):
    Evaluating model.
    Full set (6.23 s): ELBO: -200.5, ENRE: -192.05, KL: 8.444.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 17334 (35 ms): -186.4.
Step 17371 (35 ms): -190.96.
Step 17409 (35 ms): -206.89.
Step 17446 (36 ms): -211.96.
Step 17484 (36 ms): -201.49.
Step 17522 (36 ms): -193.03.
Step 17559 (35 ms): -207.29.
Step 17597 (34 ms): -202.16.
Step 17634 (36 ms): -201.03.
Step 17672 (17 ms): -561.7.

Epoch 47 (13.3 s):
    Evaluating model.
    Full set (6.18 s): ELBO: -200.46, ENRE: -192.07, KL: 8.3897.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 17710 (35 ms): -194.99.
Step 17747 (34 ms): -195.44.
Step 17785 (35 ms): -196.95.
Step 17822 (35 ms): -214.48.
Step 17860 (35 ms): -202.78.
Step 17898 (35 ms): -197.64.
Step 17935 (35 ms): -198.82.
Step 17973 (36 ms): -196.9.
Step 18010 (37 ms): -204.7.
Step 18048 (17 ms): -200.11.

Epoch 48 (13.3 s):
    Evaluating model.
    Full set (6.16 s): ELBO: -200.24, ENRE: -191.85, KL: 8.3846.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 18086 (34 ms): -185.5.
Step 18123 (35 ms): -202.24.
Step 18161 (34 ms): -203.83.
Step 18198 (34 ms): -202.39.
Step 18236 (34 ms): -197.21.
Step 18274 (34 ms): -207.29.
Step 18311 (35 ms): -198.07.
Step 18349 (35 ms): -210.22.
Step 18386 (34 ms): -200.32.
Step 18424 (17 ms): -224.46.

Epoch 49 (13.1 s):
    Evaluating model.
    Full set (6.18 s): ELBO: -200.42, ENRE: -191.81, KL: 8.604.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 18462 (34 ms): -197.73.
Step 18499 (34 ms): -211.84.
Step 18537 (35 ms): -205.62.
Step 18574 (34 ms): -202.31.
Step 18612 (35 ms): -196.38.
Step 18650 (35 ms): -196.55.
Step 18687 (35 ms): -205.09.
Step 18725 (35 ms): -207.52.
Step 18762 (35 ms): -197.44.
Step 18800 (16 ms): -217.65.

Epoch 50 (13 s):
    Evaluating model.
    Full set (6.19 s): ELBO: -200.01, ENRE: -191.65, KL: 8.3669.
    Saving model parameters.
    Model parameters saved (126 ms).

Model trained for 50 epochs (16m 0s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (15 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (912 ms).

Converting data set value array to sparse matrix.
Data set value array converted (324 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2.04 s):  ELBO: -427.41, ENRE: -419.05, KL: 8.3521.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (785 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 0.8306619259283472
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 22
kl weight: 0.8306619259283472
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (58 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.24 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.94 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 22
    hidden sizes: 109, 172, 116, 74
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 0.8306619259283472
    using analytical KL term
    using batch normalisation for minibatches
    using linear warm-up weighting for the first 1 epochs
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 109)
    ENCODER/1/DENSE/biases:0             (109,)
    ENCODER/1/BATCH_NORM/beta:0          (109,)
    ENCODER/2/DENSE/weights:0            (109, 172)
    ENCODER/2/DENSE/biases:0             (172,)
    ENCODER/2/BATCH_NORM/beta:0          (172,)
    ENCODER/3/DENSE/weights:0            (172, 116)
    ENCODER/3/DENSE/biases:0             (116,)
    ENCODER/3/BATCH_NORM/beta:0          (116,)
    ENCODER/4/DENSE/weights:0            (116, 74)
    ENCODER/4/DENSE/biases:0             (74,)
    ENCODER/4/BATCH_NORM/beta:0          (74,)
    POSTERIOR/MU/DENSE/weights:0         (74, 22)
    POSTERIOR/MU/DENSE/biases:0          (22,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (74, 22)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (22,)
    DECODER/4/DENSE/weights:0            (22, 74)
    DECODER/4/DENSE/biases:0             (74,)
    DECODER/4/BATCH_NORM/beta:0          (74,)
    DECODER/3/DENSE/weights:0            (74, 116)
    DECODER/3/DENSE/biases:0             (116,)
    DECODER/3/BATCH_NORM/beta:0          (116,)
    DECODER/2/DENSE/weights:0            (116, 172)
    DECODER/2/DENSE/biases:0             (172,)
    DECODER/2/BATCH_NORM/beta:0          (172,)
    DECODER/1/DENSE/weights:0            (172, 109)
    DECODER/1/DENSE/biases:0             (109,)
    DECODER/1/BATCH_NORM/beta:0          (109,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (109, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (472 ms).

Training model for 50 epochs on original values.

Step 38 (30 ms): -2283.1.
Step 75 (30 ms): -1968.
Step 113 (29 ms): -1742.1.
Step 150 (30 ms): -1552.9.
Step 188 (30 ms): -1366.5.
Step 226 (30 ms): -1240.5.
Step 263 (29 ms): -1130.8.
Step 301 (29 ms): -1087.5.
Step 338 (29 ms): -965.66.
Step 376 (18 ms): -1351.5.

Epoch 1 (13.8 s):
    Warm-up weight: 0
    Evaluating model.
    Full set (6.08 s): ELBO: -1869, ENRE: -1847.7, KL: 21.292.
    Saving model parameters.
    Model parameters saved (183 ms).

Step 414 (30 ms): -807.03.
Step 451 (29 ms): -689.83.
Step 489 (30 ms): -636.11.
Step 526 (30 ms): -611.32.
Step 564 (30 ms): -541.15.
Step 602 (30 ms): -534.45.
Step 639 (32 ms): -508.68.
Step 677 (31 ms): -448.51.
Step 714 (29 ms): -428.98.
Step 752 (14 ms): -538.75.

Epoch 2 (11.2 s):
    Evaluating model.
    Full set (5.55 s): ELBO: -1121.1, ENRE: -1109.4, KL: 11.694.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 790 (30 ms): -385.89.
Step 827 (30 ms): -384.77.
Step 865 (30 ms): -377.96.
Step 902 (30 ms): -362.89.
Step 940 (30 ms): -350.48.
Step 978 (30 ms): -342.03.
Step 1015 (30 ms): -342.47.
Step 1053 (30 ms): -337.96.
Step 1090 (30 ms): -325.19.
Step 1128 (14 ms): -299.95.

Epoch 3 (11.2 s):
    Evaluating model.
    Full set (5.55 s): ELBO: -661.02, ENRE: -649.64, KL: 11.376.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 1166 (30 ms): -312.21.
Step 1203 (29 ms): -295.66.
Step 1241 (30 ms): -287.53.
Step 1278 (30 ms): -282.98.
Step 1316 (29 ms): -275.09.
Step 1354 (30 ms): -283.8.
Step 1391 (30 ms): -286.61.
Step 1429 (30 ms): -272.25.
Step 1466 (31 ms): -275.31.
Step 1504 (15 ms): -235.03.

Epoch 4 (11.2 s):
    Evaluating model.
    Full set (5.58 s): ELBO: -445.11, ENRE: -435.06, KL: 10.049.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 1542 (29 ms): -271.95.
Step 1579 (30 ms): -271.29.
Step 1617 (30 ms): -302.01.
Step 1654 (30 ms): -313.86.
Step 1692 (29 ms): -254.24.
Step 1730 (29 ms): -255.03.
Step 1767 (30 ms): -257.25.
Step 1805 (29 ms): -252.3.
Step 1842 (29 ms): -252.89.
Step 1880 (14 ms): -327.82.

Epoch 5 (11.1 s):
    Evaluating model.
    Full set (5.55 s): ELBO: -340.86, ENRE: -331.73, KL: 9.1295.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 1918 (29 ms): -251.86.
Step 1955 (29 ms): -251.16.
Step 1993 (30 ms): -241.74.
Step 2030 (29 ms): -246.91.
Step 2068 (30 ms): -246.6.
Step 2106 (29 ms): -273.43.
Step 2143 (29 ms): -244.24.
Step 2181 (29 ms): -248.38.
Step 2218 (29 ms): -247.9.
Step 2256 (16 ms): -293.68.

Epoch 6 (11 s):
    Evaluating model.
    Full set (5.52 s): ELBO: -288.31, ENRE: -279.72, KL: 8.5899.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 2294 (29 ms): -231.12.
Step 2331 (31 ms): -262.3.
Step 2369 (30 ms): -228.82.
Step 2406 (30 ms): -235.75.
Step 2444 (30 ms): -231.02.
Step 2482 (30 ms): -251.31.
Step 2519 (30 ms): -240.97.
Step 2557 (30 ms): -244.46.
Step 2594 (29 ms): -242.34.
Step 2632 (15 ms): -224.64.

Epoch 7 (11.2 s):
    Evaluating model.
    Full set (5.52 s): ELBO: -259.32, ENRE: -251.15, KL: 8.1701.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 2670 (29 ms): -230.55.
Step 2707 (30 ms): -242.6.
Step 2745 (29 ms): -225.02.
Step 2782 (30 ms): -224.25.
Step 2820 (30 ms): -226.74.
Step 2858 (30 ms): -241.7.
Step 2895 (30 ms): -212.68.
Step 2933 (29 ms): -219.37.
Step 2970 (30 ms): -244.86.
Step 3008 (14 ms): -270.11.

Epoch 8 (11.1 s):
    Evaluating model.
    Full set (5.54 s): ELBO: -244.77, ENRE: -236.69, KL: 8.0798.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 3046 (30 ms): -220.61.
Step 3083 (30 ms): -221.02.
Step 3121 (30 ms): -224.64.
Step 3158 (29 ms): -221.12.
Step 3196 (29 ms): -238.25.
Step 3234 (28 ms): -225.68.
Step 3271 (28 ms): -218.52.
Step 3309 (29 ms): -224.44.
Step 3346 (29 ms): -222.17.
Step 3384 (14 ms): -217.23.

Epoch 9 (10.9 s):
    Evaluating model.
    Full set (5.49 s): ELBO: -234.04, ENRE: -226.04, KL: 7.9983.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 3422 (28 ms): -205.59.
Step 3459 (29 ms): -200.41.
Step 3497 (28 ms): -217.08.
Step 3534 (29 ms): -218.51.
Step 3572 (30 ms): -219.96.
Step 3610 (29 ms): -208.41.
Step 3647 (28 ms): -226.09.
Step 3685 (30 ms): -215.5.
Step 3722 (28 ms): -231.97.
Step 3760 (14 ms): -173.55.

Epoch 10 (10.7 s):
    Evaluating model.
    Full set (5.44 s): ELBO: -225.98, ENRE: -217.96, KL: 8.0183.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 3798 (29 ms): -229.74.
Step 3835 (29 ms): -222.52.
Step 3873 (28 ms): -220.64.
Step 3910 (28 ms): -206.05.
Step 3948 (28 ms): -215.06.
Step 3986 (28 ms): -208.63.
Step 4023 (28 ms): -211.58.
Step 4061 (28 ms): -224.43.
Step 4098 (29 ms): -214.08.
Step 4136 (14 ms): -246.28.

Epoch 11 (10.6 s):
    Evaluating model.
    Full set (5.4 s): ELBO: -223.14, ENRE: -214.89, KL: 8.2451.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 4174 (28 ms): -215.23.
Step 4211 (28 ms): -215.5.
Step 4249 (28 ms): -210.61.
Step 4286 (27 ms): -214.03.
Step 4324 (28 ms): -236.39.
Step 4362 (29 ms): -208.69.
Step 4399 (28 ms): -211.83.
Step 4437 (29 ms): -209.97.
Step 4474 (28 ms): -209.28.
Step 4512 (14 ms): -207.68.

Epoch 12 (10.6 s):
    Evaluating model.
    Full set (5.43 s): ELBO: -219.92, ENRE: -211.67, KL: 8.2478.
    Saving model parameters.
    Model parameters saved (108 ms).

Step 4550 (28 ms): -213.45.
Step 4587 (28 ms): -215.38.
Step 4625 (28 ms): -226.94.
Step 4662 (27 ms): -218.33.
Step 4700 (28 ms): -218.51.
Step 4738 (28 ms): -238.17.
Step 4775 (28 ms): -217.74.
Step 4813 (28 ms): -224.67.
Step 4850 (28 ms): -210.89.
Step 4888 (14 ms): -202.49.

Epoch 13 (10.5 s):
    Evaluating model.
    Full set (5.43 s): ELBO: -217.47, ENRE: -209.35, KL: 8.1263.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 4926 (28 ms): -221.36.
Step 4963 (30 ms): -216.11.
Step 5001 (28 ms): -216.34.
Step 5038 (30 ms): -206.13.
Step 5076 (28 ms): -209.99.
Step 5114 (29 ms): -231.95.
Step 5151 (28 ms): -217.88.
Step 5189 (28 ms): -202.85.
Step 5226 (28 ms): -211.89.
Step 5264 (14 ms): -186.54.

Epoch 14 (10.6 s):
    Evaluating model.
    Full set (5.48 s): ELBO: -215.17, ENRE: -206.99, KL: 8.1847.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 5302 (28 ms): -227.28.
Step 5339 (30 ms): -214.78.
Step 5377 (29 ms): -222.16.
Step 5414 (31 ms): -214.2.
Step 5452 (28 ms): -217.83.
Step 5490 (30 ms): -208.3.
Step 5527 (29 ms): -210.62.
Step 5565 (29 ms): -207.93.
Step 5602 (30 ms): -206.79.
Step 5640 (14 ms): -191.99.

Epoch 15 (10.7 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -214.06, ENRE: -205.81, KL: 8.2498.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 5678 (28 ms): -212.39.
Step 5715 (29 ms): -217.73.
Step 5753 (29 ms): -201.25.
Step 5790 (28 ms): -217.11.
Step 5828 (28 ms): -204.6.
Step 5866 (28 ms): -214.79.
Step 5903 (29 ms): -230.04.
Step 5941 (29 ms): -215.77.
Step 5978 (29 ms): -210.1.
Step 6016 (14 ms): -367.85.

Epoch 16 (10.7 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -212.57, ENRE: -204.47, KL: 8.0965.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 6054 (28 ms): -218.13.
Step 6091 (29 ms): -209.33.
Step 6129 (27 ms): -209.25.
Step 6166 (28 ms): -206.25.
Step 6204 (29 ms): -213.95.
Step 6242 (28 ms): -207.1.
Step 6279 (28 ms): -216.5.
Step 6317 (28 ms): -225.54.
Step 6354 (29 ms): -209.91.
Step 6392 (14 ms): -186.16.

Epoch 17 (10.7 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -211.85, ENRE: -203.65, KL: 8.1945.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 6430 (28 ms): -209.86.
Step 6467 (28 ms): -193.15.
Step 6505 (28 ms): -205.13.
Step 6542 (29 ms): -212.48.
Step 6580 (28 ms): -210.04.
Step 6618 (28 ms): -215.95.
Step 6655 (29 ms): -212.3.
Step 6693 (29 ms): -217.6.
Step 6730 (28 ms): -214.43.
Step 6768 (14 ms): -211.09.

Epoch 18 (10.7 s):
    Evaluating model.
    Full set (5.43 s): ELBO: -210.5, ENRE: -202.16, KL: 8.344.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 6806 (29 ms): -207.49.
Step 6843 (28 ms): -204.45.
Step 6881 (28 ms): -220.94.
Step 6918 (28 ms): -199.74.
Step 6956 (28 ms): -214.09.
Step 6994 (28 ms): -214.48.
Step 7031 (28 ms): -212.11.
Step 7069 (28 ms): -200.4.
Step 7106 (27 ms): -207.51.
Step 7144 (14 ms): -214.02.

Epoch 19 (10.6 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -209.95, ENRE: -201.54, KL: 8.4075.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 7182 (28 ms): -194.96.
Step 7219 (28 ms): -199.67.
Step 7257 (28 ms): -202.87.
Step 7294 (29 ms): -197.7.
Step 7332 (28 ms): -241.61.
Step 7370 (28 ms): -206.82.
Step 7407 (28 ms): -215.74.
Step 7445 (28 ms): -204.39.
Step 7482 (27 ms): -196.19.
Step 7520 (14 ms): -354.79.

Epoch 20 (10.5 s):
    Evaluating model.
    Full set (5.41 s): ELBO: -208.86, ENRE: -200.69, KL: 8.1704.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 7558 (28 ms): -216.36.
Step 7595 (28 ms): -212.22.
Step 7633 (28 ms): -205.5.
Step 7670 (28 ms): -207.7.
Step 7708 (28 ms): -192.72.
Step 7746 (28 ms): -209.3.
Step 7783 (28 ms): -207.74.
Step 7821 (28 ms): -201.06.
Step 7858 (27 ms): -215.03.
Step 7896 (14 ms): -188.19.

Epoch 21 (10.5 s):
    Evaluating model.
    Full set (5.42 s): ELBO: -208.72, ENRE: -200.66, KL: 8.0614.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 7934 (27 ms): -211.44.
Step 7971 (28 ms): -215.72.
Step 8009 (28 ms): -212.55.
Step 8046 (27 ms): -203.37.
Step 8084 (28 ms): -209.2.
Step 8122 (29 ms): -200.84.
Step 8159 (30 ms): -204.7.
Step 8197 (29 ms): -207.02.
Step 8234 (28 ms): -205.74.
Step 8272 (15 ms): -286.45.

Epoch 22 (10.6 s):
    Evaluating model.
    Full set (5.51 s): ELBO: -207.87, ENRE: -199.81, KL: 8.0668.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 8310 (29 ms): -225.
Step 8347 (28 ms): -193.31.
Step 8385 (28 ms): -203.14.
Step 8422 (31 ms): -207.01.
Step 8460 (30 ms): -207.26.
Step 8498 (28 ms): -222.07.
Step 8535 (30 ms): -207.28.
Step 8573 (31 ms): -212.13.
Step 8610 (28 ms): -207.43.
Step 8648 (14 ms): -248.67.

Epoch 23 (10.7 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -207.81, ENRE: -199.6, KL: 8.2178.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 8686 (28 ms): -195.93.
Step 8723 (29 ms): -200.38.
Step 8761 (28 ms): -212.93.
Step 8798 (29 ms): -209.68.
Step 8836 (29 ms): -222.49.
Step 8874 (29 ms): -217.29.
Step 8911 (29 ms): -214.03.
Step 8949 (29 ms): -210.89.
Step 8986 (28 ms): -208.31.
Step 9024 (16 ms): -276.31.

Epoch 24 (10.7 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -206.78, ENRE: -198.57, KL: 8.2094.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 9062 (28 ms): -207.36.
Step 9099 (29 ms): -209.91.
Step 9137 (28 ms): -212.68.
Step 9174 (28 ms): -204.86.
Step 9212 (29 ms): -201.25.
Step 9250 (29 ms): -202.41.
Step 9287 (28 ms): -196.71.
Step 9325 (28 ms): -209.76.
Step 9362 (29 ms): -208.41.
Step 9400 (14 ms): -172.19.

Epoch 25 (10.7 s):
    Evaluating model.
    Full set (5.5 s): ELBO: -206.59, ENRE: -198.58, KL: 8.015.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 9438 (28 ms): -208.62.
Step 9475 (28 ms): -198.87.
Step 9513 (29 ms): -201.99.
Step 9550 (28 ms): -196.37.
Step 9588 (28 ms): -207.14.
Step 9626 (28 ms): -201.5.
Step 9663 (28 ms): -194.77.
Step 9701 (28 ms): -193.37.
Step 9738 (29 ms): -214.85.
Step 9776 (14 ms): -257.8.

Epoch 26 (10.6 s):
    Evaluating model.
    Full set (5.43 s): ELBO: -205.78, ENRE: -197.78, KL: 8.0061.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 9814 (28 ms): -202.99.
Step 9851 (28 ms): -192.44.
Step 9889 (29 ms): -212.59.
Step 9926 (27 ms): -209.33.
Step 9964 (28 ms): -215.67.
Step 10002 (29 ms): -212.26.
Step 10039 (28 ms): -196.83.
Step 10077 (28 ms): -201.36.
Step 10114 (28 ms): -216.87.
Step 10152 (14 ms): -169.62.

Epoch 27 (10.7 s):
    Evaluating model.
    Full set (5.48 s): ELBO: -205.64, ENRE: -197.74, KL: 7.9003.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 10190 (28 ms): -202.34.
Step 10227 (29 ms): -212.96.
Step 10265 (28 ms): -194.61.
Step 10302 (28 ms): -196.82.
Step 10340 (28 ms): -195.95.
Step 10378 (28 ms): -211.38.
Step 10415 (28 ms): -210.55.
Step 10453 (29 ms): -200.34.
Step 10490 (29 ms): -195.11.
Step 10528 (15 ms): -177.98.

Epoch 28 (10.7 s):
    Evaluating model.
    Full set (5.5 s): ELBO: -205.22, ENRE: -197.26, KL: 7.958.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 10566 (28 ms): -203.48.
Step 10603 (29 ms): -206.1.
Step 10641 (29 ms): -202.42.
Step 10678 (29 ms): -204.45.
Step 10716 (29 ms): -222.8.
Step 10754 (28 ms): -213.
Step 10791 (28 ms): -201.7.
Step 10829 (29 ms): -207.52.
Step 10866 (29 ms): -193.01.
Step 10904 (15 ms): -194.51.

Epoch 29 (10.7 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -204.91, ENRE: -197, KL: 7.91.
    Saving model parameters.
    Model parameters saved (110 ms).

Step 10942 (28 ms): -203.99.
Step 10979 (29 ms): -194.4.
Step 11017 (29 ms): -212.21.
Step 11054 (29 ms): -196.5.
Step 11092 (29 ms): -201.89.
Step 11130 (29 ms): -206.68.
Step 11167 (29 ms): -207.46.
Step 11205 (29 ms): -198.1.
Step 11242 (29 ms): -210.12.
Step 11280 (14 ms): -189.34.

Epoch 30 (10.8 s):
    Evaluating model.
    Full set (5.51 s): ELBO: -204.36, ENRE: -196.53, KL: 7.8314.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 11318 (28 ms): -203.44.
Step 11355 (30 ms): -209.42.
Step 11393 (29 ms): -206.48.
Step 11430 (29 ms): -233.09.
Step 11468 (29 ms): -210.08.
Step 11506 (29 ms): -204.31.
Step 11543 (28 ms): -199.31.
Step 11581 (30 ms): -213.
Step 11618 (28 ms): -204.23.
Step 11656 (14 ms): -213.55.

Epoch 31 (10.7 s):
    Evaluating model.
    Full set (5.51 s): ELBO: -204.22, ENRE: -196.33, KL: 7.8841.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 11694 (29 ms): -202.38.
Step 11731 (28 ms): -199.33.
Step 11769 (28 ms): -211.56.
Step 11806 (29 ms): -211.18.
Step 11844 (28 ms): -209.28.
Step 11882 (27 ms): -198.89.
Step 11919 (29 ms): -202.21.
Step 11957 (28 ms): -209.77.
Step 11994 (28 ms): -218.14.
Step 12032 (15 ms): -214.07.

Epoch 32 (10.7 s):
    Evaluating model.
    Full set (5.5 s): ELBO: -204.12, ENRE: -196.25, KL: 7.8751.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 12070 (29 ms): -208.67.
Step 12107 (28 ms): -208.86.
Step 12145 (28 ms): -200.11.
Step 12182 (29 ms): -206.21.
Step 12220 (29 ms): -212.47.
Step 12258 (28 ms): -203.25.
Step 12295 (29 ms): -210.59.
Step 12333 (28 ms): -199.31.
Step 12370 (28 ms): -202.47.
Step 12408 (14 ms): -251.86.

Epoch 33 (10.7 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -203.48, ENRE: -195.68, KL: 7.7993.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 12446 (28 ms): -200.9.
Step 12483 (28 ms): -221.82.
Step 12521 (28 ms): -204.1.
Step 12558 (28 ms): -218.27.
Step 12596 (28 ms): -208.18.
Step 12634 (28 ms): -210.46.
Step 12671 (28 ms): -207.87.
Step 12709 (28 ms): -199.52.
Step 12746 (28 ms): -219.95.
Step 12784 (14 ms): -213.78.

Epoch 34 (10.6 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -203.43, ENRE: -195.68, KL: 7.7532.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 12822 (29 ms): -206.08.
Step 12859 (28 ms): -203.32.
Step 12897 (28 ms): -197.44.
Step 12934 (28 ms): -204.86.
Step 12972 (28 ms): -206.19.
Step 13010 (28 ms): -194.18.
Step 13047 (29 ms): -202.58.
Step 13085 (29 ms): -217.02.
Step 13122 (29 ms): -198.39.
Step 13160 (14 ms): -220.67.

Epoch 35 (10.8 s):
    Evaluating model.
    Full set (5.51 s): ELBO: -202.92, ENRE: -195.15, KL: 7.7738.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 13198 (28 ms): -209.99.
Step 13235 (29 ms): -212.75.
Step 13273 (29 ms): -200.67.
Step 13310 (29 ms): -200.91.
Step 13348 (29 ms): -210.
Step 13386 (28 ms): -201.75.
Step 13423 (29 ms): -201.89.
Step 13461 (29 ms): -198.34.
Step 13498 (29 ms): -196.96.
Step 13536 (14 ms): -199.71.

Epoch 36 (10.8 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -202.77, ENRE: -195.03, KL: 7.7394.
    Saving model parameters.
    Model parameters saved (109 ms).

Step 13574 (29 ms): -218.66.
Step 13611 (29 ms): -217.93.
Step 13649 (28 ms): -204.52.
Step 13686 (28 ms): -186.05.
Step 13724 (29 ms): -195.69.
Step 13762 (29 ms): -205.42.
Step 13799 (29 ms): -205.47.
Step 13837 (28 ms): -196.22.
Step 13874 (29 ms): -189.19.
Step 13912 (14 ms): -566.51.

Epoch 37 (10.7 s):
    Evaluating model.
    Full set (5.51 s): ELBO: -202.83, ENRE: -195.05, KL: 7.78.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 13950 (29 ms): -206.53.
Step 13987 (28 ms): -203.44.
Step 14025 (29 ms): -198.81.
Step 14062 (29 ms): -201.98.
Step 14100 (29 ms): -204.36.
Step 14138 (28 ms): -213.67.
Step 14175 (28 ms): -197.42.
Step 14213 (29 ms): -200.74.
Step 14250 (30 ms): -189.
Step 14288 (14 ms): -225.23.

Epoch 38 (10.8 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -202.39, ENRE: -194.57, KL: 7.8189.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 14326 (28 ms): -212.56.
Step 14363 (29 ms): -196.16.
Step 14401 (29 ms): -219.76.
Step 14438 (29 ms): -209.03.
Step 14476 (28 ms): -192.7.
Step 14514 (29 ms): -217.43.
Step 14551 (28 ms): -193.33.
Step 14589 (28 ms): -202.51.
Step 14626 (29 ms): -220.81.
Step 14664 (14 ms): -213.58.

Epoch 39 (10.7 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -202.25, ENRE: -194.5, KL: 7.7473.
    Saving model parameters.
    Model parameters saved (111 ms).

Step 14702 (28 ms): -196.12.
Step 14739 (28 ms): -197.23.
Step 14777 (28 ms): -198.68.
Step 14814 (28 ms): -198.28.
Step 14852 (28 ms): -209.98.
Step 14890 (28 ms): -197.02.
Step 14927 (29 ms): -208.17.
Step 14965 (28 ms): -197.51.
Step 15002 (28 ms): -206.04.
Step 15040 (14 ms): -301.29.

Epoch 40 (10.7 s):
    Evaluating model.
    Full set (5.5 s): ELBO: -202.13, ENRE: -194.42, KL: 7.7162.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 15078 (28 ms): -213.81.
Step 15115 (27 ms): -199.73.
Step 15153 (28 ms): -216.78.
Step 15190 (28 ms): -196.7.
Step 15228 (27 ms): -219.41.
Step 15266 (28 ms): -205.96.
Step 15303 (27 ms): -197.56.
Step 15341 (27 ms): -201.01.
Step 15378 (28 ms): -197.17.
Step 15416 (14 ms): -183.45.

Epoch 41 (10.5 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -201.79, ENRE: -194, KL: 7.7993.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 15454 (28 ms): -204.38.
Step 15491 (28 ms): -197.29.
Step 15529 (28 ms): -189.45.
Step 15566 (28 ms): -197.48.
Step 15604 (28 ms): -196.64.
Step 15642 (28 ms): -230.36.
Step 15679 (29 ms): -203.1.
Step 15717 (28 ms): -201.27.
Step 15754 (28 ms): -212.95.
Step 15792 (14 ms): -272.73.

Epoch 42 (10.6 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -201.74, ENRE: -193.88, KL: 7.8541.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 15830 (30 ms): -198.91.
Step 15867 (29 ms): -191.86.
Step 15905 (28 ms): -188.57.
Step 15942 (28 ms): -200.2.
Step 15980 (29 ms): -202.17.
Step 16018 (29 ms): -200.53.
Step 16055 (29 ms): -196.21.
Step 16093 (29 ms): -194.29.
Step 16130 (29 ms): -192.31.
Step 16168 (14 ms): -281.57.

Epoch 43 (10.8 s):
    Evaluating model.
    Full set (5.5 s): ELBO: -201.6, ENRE: -193.86, KL: 7.7385.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 16206 (29 ms): -206.47.
Step 16243 (29 ms): -198.46.
Step 16281 (28 ms): -208.34.
Step 16318 (28 ms): -198.97.
Step 16356 (28 ms): -201.55.
Step 16394 (29 ms): -217.51.
Step 16431 (29 ms): -196.77.
Step 16469 (29 ms): -218.91.
Step 16506 (29 ms): -203.99.
Step 16544 (14 ms): -217.49.

Epoch 44 (10.8 s):
    Evaluating model.
    Full set (5.47 s): ELBO: -201.29, ENRE: -193.54, KL: 7.7576.
    Saving model parameters.
    Model parameters saved (113 ms).

Step 16582 (28 ms): -210.21.
Step 16619 (29 ms): -192.18.
Step 16657 (29 ms): -200.05.
Step 16694 (28 ms): -205.37.
Step 16732 (29 ms): -213.47.
Step 16770 (29 ms): -200.88.
Step 16807 (29 ms): -191.53.
Step 16845 (29 ms): -209.93.
Step 16882 (29 ms): -199.04.
Step 16920 (15 ms): -195.38.

Epoch 45 (10.8 s):
    Evaluating model.
    Full set (5.52 s): ELBO: -201.18, ENRE: -193.45, KL: 7.727.
    Saving model parameters.
    Model parameters saved (115 ms).

Step 16958 (28 ms): -197.98.
Step 16995 (29 ms): -208.71.
Step 17033 (29 ms): -189.75.
Step 17070 (28 ms): -212.25.
Step 17108 (29 ms): -202.5.
Step 17146 (28 ms): -190.03.
Step 17183 (28 ms): -203.83.
Step 17221 (29 ms): -195.71.
Step 17258 (28 ms): -195.8.
Step 17296 (14 ms): -211.21.

Epoch 46 (10.7 s):
    Evaluating model.
    Full set (5.48 s): ELBO: -201.27, ENRE: -193.49, KL: 7.7813.
    Saving model parameters.
    Model parameters saved (112 ms).

Step 17334 (29 ms): -197.39.
Step 17371 (28 ms): -198.25.
Step 17409 (29 ms): -196.67.
Step 17446 (28 ms): -208.87.
Step 17484 (28 ms): -192.01.
Step 17522 (28 ms): -196.8.
Step 17559 (28 ms): -201.16.
Step 17597 (29 ms): -203.79.
Step 17634 (28 ms): -194.28.
Step 17672 (14 ms): -183.58.

Epoch 47 (10.7 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -201.07, ENRE: -193.28, KL: 7.7871.
    Saving model parameters.
    Model parameters saved (114 ms).

Step 17710 (28 ms): -195.
Step 17747 (28 ms): -189.
Step 17785 (28 ms): -197.51.
Step 17822 (27 ms): -192.21.
Step 17860 (29 ms): -202.82.
Step 17898 (28 ms): -205.85.
Step 17935 (29 ms): -204.67.
Step 17973 (29 ms): -202.61.
Step 18010 (28 ms): -203.15.
Step 18048 (14 ms): -203.51.

Epoch 48 (10.6 s):
    Evaluating model.
    Full set (5.45 s): ELBO: -200.8, ENRE: -193.14, KL: 7.6539.
    Saving model parameters.
    Model parameters saved (107 ms).

Step 18086 (28 ms): -191.67.
Step 18123 (28 ms): -210.29.
Step 18161 (28 ms): -187.65.
Step 18198 (28 ms): -190.15.
Step 18236 (28 ms): -202.9.
Step 18274 (28 ms): -213.3.
Step 18311 (28 ms): -202.82.
Step 18349 (28 ms): -209.71.
Step 18386 (28 ms): -199.8.
Step 18424 (13 ms): -213.92.

Epoch 49 (10.5 s):
    Evaluating model.
    Full set (5.46 s): ELBO: -200.81, ENRE: -193.2, KL: 7.6102.
    Saving model parameters.
    Model parameters saved (116 ms).

Step 18462 (28 ms): -204.13.
Step 18499 (28 ms): -212.2.
Step 18537 (29 ms): -205.4.
Step 18574 (29 ms): -213.23.
Step 18612 (29 ms): -198.81.
Step 18650 (28 ms): -189.31.
Step 18687 (27 ms): -187.9.
Step 18725 (29 ms): -201.85.
Step 18762 (28 ms): -197.1.
Step 18800 (15 ms): -200.93.

Epoch 50 (10.7 s):
    Evaluating model.
    Full set (5.5 s): ELBO: -200.69, ENRE: -192.97, KL: 7.7208.
    Saving model parameters.
    Model parameters saved (117 ms).

Model trained for 50 epochs (13m 42s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (16 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (873 ms).

Converting data set value array to sparse matrix.
Data set value array converted (280 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2.03 s):  ELBO: -425.71, ENRE: -417.98, KL: 7.7227.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (656 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.1251801831228931
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 15
kl weight: 1.1251801831228931
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (58 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.33 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.95 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 15
    hidden sizes: 161, 185, 51, 194, 155
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.1251801831228931
    using analytical KL term
    using batch normalisation for minibatches
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 161)
    ENCODER/1/DENSE/biases:0             (161,)
    ENCODER/1/BATCH_NORM/beta:0          (161,)
    ENCODER/2/DENSE/weights:0            (161, 185)
    ENCODER/2/DENSE/biases:0             (185,)
    ENCODER/2/BATCH_NORM/beta:0          (185,)
    ENCODER/3/DENSE/weights:0            (185, 51)
    ENCODER/3/DENSE/biases:0             (51,)
    ENCODER/3/BATCH_NORM/beta:0          (51,)
    ENCODER/4/DENSE/weights:0            (51, 194)
    ENCODER/4/DENSE/biases:0             (194,)
    ENCODER/4/BATCH_NORM/beta:0          (194,)
    ENCODER/5/DENSE/weights:0            (194, 155)
    ENCODER/5/DENSE/biases:0             (155,)
    ENCODER/5/BATCH_NORM/beta:0          (155,)
    POSTERIOR/MU/DENSE/weights:0         (155, 15)
    POSTERIOR/MU/DENSE/biases:0          (15,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (155, 15)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (15,)
    DECODER/5/DENSE/weights:0            (15, 155)
    DECODER/5/DENSE/biases:0             (155,)
    DECODER/5/BATCH_NORM/beta:0          (155,)
    DECODER/4/DENSE/weights:0            (155, 194)
    DECODER/4/DENSE/biases:0             (194,)
    DECODER/4/BATCH_NORM/beta:0          (194,)
    DECODER/3/DENSE/weights:0            (194, 51)
    DECODER/3/DENSE/biases:0             (51,)
    DECODER/3/BATCH_NORM/beta:0          (51,)
    DECODER/2/DENSE/weights:0            (51, 185)
    DECODER/2/DENSE/biases:0             (185,)
    DECODER/2/BATCH_NORM/beta:0          (185,)
    DECODER/1/DENSE/weights:0            (185, 161)
    DECODER/1/DENSE/biases:0             (161,)
    DECODER/1/BATCH_NORM/beta:0          (161,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (161, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (560 ms).

Training model for 50 epochs on original values.

Step 38 (35 ms): -2098.1.
Step 75 (35 ms): -1744.4.
Step 113 (35 ms): -1500.5.
Step 150 (33 ms): -1257.2.
Step 188 (34 ms): -1092.1.
Step 226 (35 ms): -965.67.
Step 263 (34 ms): -805.84.
Step 301 (34 ms): -732.49.
Step 338 (35 ms): -687.74.
Step 376 (20 ms): -558.42.

Epoch 1 (16 s):
    Evaluating model.
    Full set (6.88 s): ELBO: -1769.6, ENRE: -1766.5, KL: 3.0703.
    Saving model parameters.
    Model parameters saved (204 ms).

Step 414 (35 ms): -553.81.
Step 451 (35 ms): -502.24.
Step 489 (35 ms): -454.09.
Step 526 (34 ms): -426.7.
Step 564 (35 ms): -421.73.
Step 602 (35 ms): -367.98.
Step 639 (35 ms): -354.39.
Step 677 (35 ms): -354.83.
Step 714 (34 ms): -330.63.
Step 752 (18 ms): -350.7.

Epoch 2 (13.1 s):
    Evaluating model.
    Full set (6.05 s): ELBO: -977.86, ENRE: -974.12, KL: 3.7345.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 790 (36 ms): -299.55.
Step 827 (34 ms): -304.27.
Step 865 (35 ms): -309.14.
Step 902 (34 ms): -288.86.
Step 940 (34 ms): -276.93.
Step 978 (35 ms): -276.05.
Step 1015 (34 ms): -274.27.
Step 1053 (34 ms): -268.79.
Step 1090 (33 ms): -264.52.
Step 1128 (17 ms): -264.39.

Epoch 3 (13 s):
    Evaluating model.
    Full set (6.18 s): ELBO: -566.83, ENRE: -563.04, KL: 3.7832.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 1166 (35 ms): -269.05.
Step 1203 (34 ms): -256.69.
Step 1241 (35 ms): -251.57.
Step 1278 (34 ms): -258.39.
Step 1316 (35 ms): -250.72.
Step 1354 (35 ms): -248.56.
Step 1391 (36 ms): -259.47.
Step 1429 (34 ms): -246.82.
Step 1466 (35 ms): -245.97.
Step 1504 (17 ms): -326.12.

Epoch 4 (13.1 s):
    Evaluating model.
    Full set (6.08 s): ELBO: -385.75, ENRE: -381.82, KL: 3.933.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 1542 (33 ms): -234.14.
Step 1579 (34 ms): -262.04.
Step 1617 (34 ms): -233.07.
Step 1654 (33 ms): -229.45.
Step 1692 (35 ms): -235.08.
Step 1730 (33 ms): -223.34.
Step 1767 (35 ms): -233.92.
Step 1805 (35 ms): -211.64.
Step 1842 (36 ms): -217.63.
Step 1880 (17 ms): -220.12.

Epoch 5 (13 s):
    Evaluating model.
    Full set (6.21 s): ELBO: -306.89, ENRE: -302.77, KL: 4.1127.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 1918 (34 ms): -225.43.
Step 1955 (35 ms): -244.9.
Step 1993 (34 ms): -246.21.
Step 2030 (34 ms): -226.51.
Step 2068 (35 ms): -228.23.
Step 2106 (35 ms): -231.86.
Step 2143 (35 ms): -229.68.
Step 2181 (35 ms): -232.38.
Step 2218 (35 ms): -229.22.
Step 2256 (17 ms): -328.16.

Epoch 6 (13.1 s):
    Evaluating model.
    Full set (6.15 s): ELBO: -264.47, ENRE: -259.73, KL: 4.743.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 2294 (35 ms): -209.11.
Step 2331 (34 ms): -211.59.
Step 2369 (34 ms): -217.72.
Step 2406 (35 ms): -212.19.
Step 2444 (34 ms): -233.93.
Step 2482 (34 ms): -238.72.
Step 2519 (35 ms): -226.53.
Step 2557 (34 ms): -216.38.
Step 2594 (36 ms): -223.19.
Step 2632 (16 ms): -211.8.

Epoch 7 (13 s):
    Evaluating model.
    Full set (6.18 s): ELBO: -241.32, ENRE: -236.16, KL: 5.1568.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 2670 (34 ms): -223.18.
Step 2707 (35 ms): -215.43.
Step 2745 (35 ms): -221.18.
Step 2782 (35 ms): -225.35.
Step 2820 (34 ms): -227.22.
Step 2858 (35 ms): -227.41.
Step 2895 (35 ms): -214.65.
Step 2933 (34 ms): -219.05.
Step 2970 (34 ms): -216.36.
Step 3008 (17 ms): -241.12.

Epoch 8 (13.1 s):
    Evaluating model.
    Full set (6.11 s): ELBO: -229.15, ENRE: -223.57, KL: 5.5792.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 3046 (34 ms): -213.92.
Step 3083 (35 ms): -211.83.
Step 3121 (34 ms): -196.84.
Step 3158 (35 ms): -235.5.
Step 3196 (35 ms): -221.02.
Step 3234 (34 ms): -201.28.
Step 3271 (36 ms): -210.32.
Step 3309 (34 ms): -217.45.
Step 3346 (34 ms): -208.43.
Step 3384 (16 ms): -225.08.

Epoch 9 (12.9 s):
    Evaluating model.
    Full set (6.2 s): ELBO: -222.26, ENRE: -216.78, KL: 5.4843.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 3422 (34 ms): -225.65.
Step 3459 (34 ms): -209.71.
Step 3497 (35 ms): -209.59.
Step 3534 (35 ms): -218.71.
Step 3572 (34 ms): -224.58.
Step 3610 (37 ms): -217.44.
Step 3647 (34 ms): -222.99.
Step 3685 (35 ms): -224.34.
Step 3722 (35 ms): -216.78.
Step 3760 (17 ms): -211.23.

Epoch 10 (13.1 s):
    Evaluating model.
    Full set (6.19 s): ELBO: -217.91, ENRE: -212.3, KL: 5.6119.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 3798 (34 ms): -214.82.
Step 3835 (35 ms): -216.58.
Step 3873 (36 ms): -202.59.
Step 3910 (34 ms): -213.2.
Step 3948 (34 ms): -214.27.
Step 3986 (35 ms): -216.32.
Step 4023 (34 ms): -223.88.
Step 4061 (36 ms): -206.56.
Step 4098 (35 ms): -211.65.
Step 4136 (16 ms): -228.39.

Epoch 11 (13.1 s):
    Evaluating model.
    Full set (6.23 s): ELBO: -214.78, ENRE: -209.25, KL: 5.5254.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 4174 (35 ms): -201.
Step 4211 (36 ms): -211.4.
Step 4249 (36 ms): -210.79.
Step 4286 (35 ms): -200.85.
Step 4324 (34 ms): -213.23.
Step 4362 (34 ms): -211.62.
Step 4399 (38 ms): -221.21.
Step 4437 (34 ms): -224.96.
Step 4474 (35 ms): -220.86.
Step 4512 (17 ms): -264.25.

Epoch 12 (13.2 s):
    Evaluating model.
    Full set (6.14 s): ELBO: -213.67, ENRE: -208.12, KL: 5.5474.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 4550 (35 ms): -210.55.
Step 4587 (37 ms): -207.31.
Step 4625 (34 ms): -202.58.
Step 4662 (35 ms): -212.46.
Step 4700 (35 ms): -202.69.
Step 4738 (35 ms): -202.11.
Step 4775 (34 ms): -203.1.
Step 4813 (34 ms): -208.99.
Step 4850 (35 ms): -206.42.
Step 4888 (17 ms): -271.27.

Epoch 13 (13.1 s):
    Evaluating model.
    Full set (6.18 s): ELBO: -211.97, ENRE: -206.41, KL: 5.5634.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 4926 (35 ms): -218.41.
Step 4963 (35 ms): -206.7.
Step 5001 (35 ms): -215.18.
Step 5038 (36 ms): -225.36.
Step 5076 (34 ms): -203.17.
Step 5114 (35 ms): -198.21.
Step 5151 (35 ms): -204.18.
Step 5189 (34 ms): -223.25.
Step 5226 (35 ms): -209.5.
Step 5264 (17 ms): -219.3.

Epoch 14 (13.2 s):
    Evaluating model.
    Full set (6.11 s): ELBO: -210.71, ENRE: -205.28, KL: 5.4315.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 5302 (35 ms): -212.09.
Step 5339 (34 ms): -213.48.
Step 5377 (34 ms): -210.55.
Step 5414 (34 ms): -210.78.
Step 5452 (34 ms): -204.79.
Step 5490 (34 ms): -220.35.
Step 5527 (34 ms): -202.95.
Step 5565 (34 ms): -224.82.
Step 5602 (34 ms): -207.59.
Step 5640 (16 ms): -239.66.

Epoch 15 (13 s):
    Evaluating model.
    Full set (6.21 s): ELBO: -209.54, ENRE: -204.06, KL: 5.4797.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 5678 (35 ms): -196.34.
Step 5715 (34 ms): -204.52.
Step 5753 (37 ms): -193.64.
Step 5790 (34 ms): -201.39.
Step 5828 (35 ms): -204.23.
Step 5866 (35 ms): -199.69.
Step 5903 (36 ms): -225.85.
Step 5941 (35 ms): -199.54.
Step 5978 (35 ms): -198.07.
Step 6016 (16 ms): -275.37.

Epoch 16 (13.1 s):
    Evaluating model.
    Full set (6.14 s): ELBO: -209.34, ENRE: -203.89, KL: 5.4562.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 6054 (37 ms): -201.83.
Step 6091 (35 ms): -200.37.
Step 6129 (35 ms): -202.19.
Step 6166 (35 ms): -203.51.
Step 6204 (35 ms): -207.11.
Step 6242 (36 ms): -204.67.
Step 6279 (35 ms): -199.38.
Step 6317 (34 ms): -189.85.
Step 6354 (35 ms): -210.5.
Step 6392 (17 ms): -219.58.

Epoch 17 (13.2 s):
    Evaluating model.
    Full set (6.23 s): ELBO: -209.23, ENRE: -203.7, KL: 5.529.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 6430 (35 ms): -195.7.
Step 6467 (35 ms): -209.94.
Step 6505 (36 ms): -199.69.
Step 6542 (37 ms): -220.98.
Step 6580 (34 ms): -203.04.
Step 6618 (34 ms): -210.36.
Step 6655 (34 ms): -199.3.
Step 6693 (35 ms): -206.85.
Step 6730 (35 ms): -204.75.
Step 6768 (17 ms): -211.51.

Epoch 18 (13.2 s):
    Evaluating model.
    Full set (6.15 s): ELBO: -207.37, ENRE: -201.81, KL: 5.564.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 6806 (34 ms): -215.39.
Step 6843 (36 ms): -210.2.
Step 6881 (34 ms): -205.04.
Step 6918 (35 ms): -209.65.
Step 6956 (34 ms): -201.27.
Step 6994 (35 ms): -215.74.
Step 7031 (35 ms): -197.17.
Step 7069 (35 ms): -219.65.
Step 7106 (36 ms): -197.73.
Step 7144 (16 ms): -205.89.

Epoch 19 (13.1 s):
    Evaluating model.
    Full set (6.24 s): ELBO: -208.16, ENRE: -202.55, KL: 5.6095.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 7182 (35 ms): -198.47.
Step 7219 (34 ms): -205.12.
Step 7257 (34 ms): -211.25.
Step 7294 (35 ms): -203.62.
Step 7332 (35 ms): -218.87.
Step 7370 (35 ms): -230.34.
Step 7407 (35 ms): -211.14.
Step 7445 (34 ms): -195.42.
Step 7482 (35 ms): -206.93.
Step 7520 (16 ms): -214.76.

Epoch 20 (13.1 s):
    Evaluating model.
    Full set (6.07 s): ELBO: -206.77, ENRE: -201.11, KL: 5.6556.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 7558 (34 ms): -205.57.
Step 7595 (34 ms): -216.83.
Step 7633 (34 ms): -221.44.
Step 7670 (34 ms): -209.62.
Step 7708 (34 ms): -202.1.
Step 7746 (35 ms): -202.02.
Step 7783 (34 ms): -211.49.
Step 7821 (33 ms): -200.92.
Step 7858 (35 ms): -206.18.
Step 7896 (17 ms): -275.77.

Epoch 21 (12.9 s):
    Evaluating model.
    Full set (6.23 s): ELBO: -205.81, ENRE: -200.15, KL: 5.6656.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 7934 (35 ms): -195.53.
Step 7971 (35 ms): -206.11.
Step 8009 (34 ms): -200.34.
Step 8046 (34 ms): -205.55.
Step 8084 (35 ms): -200.02.
Step 8122 (35 ms): -205.86.
Step 8159 (35 ms): -196.54.
Step 8197 (34 ms): -195.12.
Step 8234 (35 ms): -205.13.
Step 8272 (17 ms): -446.2.

Epoch 22 (13.1 s):
    Evaluating model.
    Full set (6.18 s): ELBO: -206.54, ENRE: -200.94, KL: 5.6003.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 8310 (35 ms): -200.77.
Step 8347 (35 ms): -197.73.
Step 8385 (35 ms): -211.39.
Step 8422 (35 ms): -203.15.
Step 8460 (34 ms): -205.83.
Step 8498 (36 ms): -195.68.
Step 8535 (37 ms): -202.24.
Step 8573 (35 ms): -195.29.
Step 8610 (34 ms): -186.39.
Step 8648 (18 ms): -245.64.

Epoch 23 (13.1 s):
    Evaluating model.
    Full set (6.29 s): ELBO: -205.66, ENRE: -200.16, KL: 5.4966.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 8686 (35 ms): -199.84.
Step 8723 (35 ms): -188.28.
Step 8761 (36 ms): -207.99.
Step 8798 (35 ms): -207.11.
Step 8836 (36 ms): -193.18.
Step 8874 (35 ms): -211.35.
Step 8911 (34 ms): -209.86.
Step 8949 (36 ms): -205.87.
Step 8986 (35 ms): -216.36.
Step 9024 (17 ms): -260.7.

Epoch 24 (13.2 s):
    Evaluating model.
    Full set (6.11 s): ELBO: -205.07, ENRE: -199.45, KL: 5.6133.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 9062 (34 ms): -198.98.
Step 9099 (35 ms): -197.21.
Step 9137 (35 ms): -208.73.
Step 9174 (35 ms): -188.52.
Step 9212 (35 ms): -191.55.
Step 9250 (37 ms): -203.67.
Step 9287 (35 ms): -193.43.
Step 9325 (35 ms): -197.45.
Step 9362 (34 ms): -213.13.
Step 9400 (16 ms): -531.95.

Epoch 25 (13.1 s):
    Evaluating model.
    Full set (6.2 s): ELBO: -204.63, ENRE: -198.99, KL: 5.6475.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 9438 (35 ms): -212.88.
Step 9475 (35 ms): -189.57.
Step 9513 (35 ms): -197.6.
Step 9550 (36 ms): -213.57.
Step 9588 (34 ms): -201.48.
Step 9626 (35 ms): -202.21.
Step 9663 (35 ms): -201.5.
Step 9701 (34 ms): -199.84.
Step 9738 (35 ms): -195.23.
Step 9776 (17 ms): -330.33.

Epoch 26 (13.1 s):
    Evaluating model.
    Full set (6.1 s): ELBO: -204.81, ENRE: -199.18, KL: 5.6373.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 9814 (34 ms): -207.5.
Step 9851 (35 ms): -204.69.
Step 9889 (35 ms): -198.23.
Step 9926 (34 ms): -203.69.
Step 9964 (34 ms): -214.57.
Step 10002 (34 ms): -203.74.
Step 10039 (34 ms): -217.55.
Step 10077 (34 ms): -190.54.
Step 10114 (33 ms): -197.69.
Step 10152 (17 ms): -193.44.

Epoch 27 (12.9 s):
    Evaluating model.
    Full set (6.22 s): ELBO: -204.61, ENRE: -198.95, KL: 5.6644.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 10190 (35 ms): -194.38.
Step 10227 (34 ms): -206.87.
Step 10265 (35 ms): -211.06.
Step 10302 (34 ms): -208.56.
Step 10340 (36 ms): -198.59.
Step 10378 (35 ms): -205.71.
Step 10415 (35 ms): -195.12.
Step 10453 (34 ms): -209.65.
Step 10490 (35 ms): -209.19.
Step 10528 (17 ms): -187.51.

Epoch 28 (13.2 s):
    Evaluating model.
    Full set (6.14 s): ELBO: -203.75, ENRE: -197.97, KL: 5.7843.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 10566 (35 ms): -199.38.
Step 10603 (35 ms): -195.96.
Step 10641 (34 ms): -198.49.
Step 10678 (35 ms): -195.54.
Step 10716 (35 ms): -194.36.
Step 10754 (34 ms): -221.39.
Step 10791 (35 ms): -201.9.
Step 10829 (34 ms): -197.75.
Step 10866 (34 ms): -215.63.
Step 10904 (17 ms): -335.85.

Epoch 29 (13.1 s):
    Evaluating model.
    Full set (6.23 s): ELBO: -203.37, ENRE: -197.56, KL: 5.8109.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 10942 (36 ms): -203.17.
Step 10979 (35 ms): -209.69.
Step 11017 (35 ms): -210.03.
Step 11054 (35 ms): -207.51.
Step 11092 (36 ms): -202.17.
Step 11130 (36 ms): -206.77.
Step 11167 (35 ms): -218.73.
Step 11205 (36 ms): -224.09.
Step 11242 (35 ms): -194.52.
Step 11280 (17 ms): -220.06.

Epoch 30 (13.3 s):
    Evaluating model.
    Full set (6.14 s): ELBO: -202.89, ENRE: -197.11, KL: 5.7831.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 11318 (36 ms): -203.81.
Step 11355 (37 ms): -212.9.
Step 11393 (36 ms): -200.35.
Step 11430 (34 ms): -205.75.
Step 11468 (34 ms): -196.06.
Step 11506 (35 ms): -198.74.
Step 11543 (35 ms): -194.99.
Step 11581 (35 ms): -198.75.
Step 11618 (34 ms): -201.22.
Step 11656 (17 ms): -187.88.

Epoch 31 (13.1 s):
    Evaluating model.
    Full set (6.22 s): ELBO: -203.21, ENRE: -197.34, KL: 5.8724.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 11694 (35 ms): -194.35.
Step 11731 (35 ms): -196.23.
Step 11769 (35 ms): -191.1.
Step 11806 (34 ms): -194.95.
Step 11844 (35 ms): -208.19.
Step 11882 (35 ms): -197.52.
Step 11919 (35 ms): -210.8.
Step 11957 (34 ms): -209.76.
Step 11994 (35 ms): -198.61.
Step 12032 (17 ms): -201.01.

Epoch 32 (13.1 s):
    Evaluating model.
    Full set (6.13 s): ELBO: -202.66, ENRE: -196.85, KL: 5.8093.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 12070 (33 ms): -195.08.
Step 12107 (34 ms): -198.92.
Step 12145 (35 ms): -196.52.
Step 12182 (34 ms): -201.3.
Step 12220 (35 ms): -196.03.
Step 12258 (34 ms): -180.66.
Step 12295 (35 ms): -191.33.
Step 12333 (33 ms): -212.61.
Step 12370 (34 ms): -210.83.
Step 12408 (17 ms): -273.22.

Epoch 33 (12.9 s):
    Evaluating model.
    Full set (6.21 s): ELBO: -203.04, ENRE: -197.23, KL: 5.8046.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 12446 (34 ms): -205.61.
Step 12483 (35 ms): -200.93.
Step 12521 (34 ms): -201.71.
Step 12558 (34 ms): -200.97.
Step 12596 (35 ms): -209.93.
Step 12634 (34 ms): -215.1.
Step 12671 (35 ms): -209.38.
Step 12709 (34 ms): -193.83.
Step 12746 (36 ms): -203.95.
Step 12784 (17 ms): -306.82.

Epoch 34 (13.1 s):
    Evaluating model.
    Full set (6.17 s): ELBO: -202.1, ENRE: -196.34, KL: 5.7674.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 12822 (36 ms): -205.2.
Step 12859 (35 ms): -195.82.
Step 12897 (35 ms): -200.82.
Step 12934 (36 ms): -193.19.
Step 12972 (35 ms): -201.59.
Step 13010 (35 ms): -195.12.
Step 13047 (35 ms): -216.47.
Step 13085 (34 ms): -194.76.
Step 13122 (34 ms): -193.93.
Step 13160 (17 ms): -250.22.

Epoch 35 (13.1 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -201.89, ENRE: -196.02, KL: 5.8725.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 13198 (35 ms): -211.44.
Step 13235 (35 ms): -203.88.
Step 13273 (36 ms): -195.64.
Step 13310 (35 ms): -223.43.
Step 13348 (35 ms): -206.26.
Step 13386 (36 ms): -203.58.
Step 13423 (36 ms): -192.49.
Step 13461 (36 ms): -206.52.
Step 13498 (35 ms): -199.67.
Step 13536 (17 ms): -212.37.

Epoch 36 (13.2 s):
    Evaluating model.
    Full set (6.15 s): ELBO: -201.99, ENRE: -196.17, KL: 5.8187.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 13574 (34 ms): -201.94.
Step 13611 (35 ms): -195.95.
Step 13649 (34 ms): -193.46.
Step 13686 (35 ms): -190.73.
Step 13724 (36 ms): -205.48.
Step 13762 (35 ms): -214.39.
Step 13799 (35 ms): -205.42.
Step 13837 (35 ms): -209.65.
Step 13874 (34 ms): -210.7.
Step 13912 (17 ms): -212.1.

Epoch 37 (13.2 s):
    Evaluating model.
    Full set (6.23 s): ELBO: -201.46, ENRE: -195.65, KL: 5.806.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 13950 (35 ms): -190.59.
Step 13987 (34 ms): -213.46.
Step 14025 (35 ms): -218.24.
Step 14062 (34 ms): -215.67.
Step 14100 (34 ms): -204.36.
Step 14138 (35 ms): -206.02.
Step 14175 (35 ms): -203.51.
Step 14213 (36 ms): -197.51.
Step 14250 (34 ms): -192.13.
Step 14288 (17 ms): -208.1.

Epoch 38 (13.1 s):
    Evaluating model.
    Full set (6.12 s): ELBO: -201.74, ENRE: -195.89, KL: 5.852.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 14326 (36 ms): -222.33.
Step 14363 (34 ms): -203.47.
Step 14401 (34 ms): -205.12.
Step 14438 (34 ms): -205.17.
Step 14476 (35 ms): -197.14.
Step 14514 (35 ms): -196.2.
Step 14551 (35 ms): -198.57.
Step 14589 (34 ms): -193.93.
Step 14626 (35 ms): -215.36.
Step 14664 (16 ms): -254.74.

Epoch 39 (12.9 s):
    Evaluating model.
    Full set (6.21 s): ELBO: -201.54, ENRE: -195.64, KL: 5.905.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 14702 (35 ms): -201.13.
Step 14739 (35 ms): -193.17.
Step 14777 (34 ms): -192.19.
Step 14814 (35 ms): -200.41.
Step 14852 (35 ms): -204.
Step 14890 (33 ms): -204.78.
Step 14927 (34 ms): -199.68.
Step 14965 (35 ms): -218.27.
Step 15002 (34 ms): -199.23.
Step 15040 (17 ms): -182.79.

Epoch 40 (13.1 s):
    Evaluating model.
    Full set (6.13 s): ELBO: -201.43, ENRE: -195.64, KL: 5.7851.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 15078 (35 ms): -197.77.
Step 15115 (35 ms): -196.89.
Step 15153 (35 ms): -197.56.
Step 15190 (35 ms): -200.2.
Step 15228 (35 ms): -201.21.
Step 15266 (35 ms): -200.93.
Step 15303 (35 ms): -205.99.
Step 15341 (35 ms): -213.
Step 15378 (35 ms): -196.11.
Step 15416 (17 ms): -331.72.

Epoch 41 (13.2 s):
    Evaluating model.
    Full set (6.23 s): ELBO: -201.36, ENRE: -195.44, KL: 5.9188.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 15454 (35 ms): -198.51.
Step 15491 (35 ms): -193.94.
Step 15529 (35 ms): -197.15.
Step 15566 (35 ms): -206.61.
Step 15604 (35 ms): -205.67.
Step 15642 (35 ms): -210.87.
Step 15679 (35 ms): -204.51.
Step 15717 (35 ms): -196.99.
Step 15754 (35 ms): -201.33.
Step 15792 (17 ms): -232.06.

Epoch 42 (13.2 s):
    Evaluating model.
    Full set (6.13 s): ELBO: -200.99, ENRE: -195.01, KL: 5.9848.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 15830 (34 ms): -201.78.
Step 15867 (35 ms): -206.46.
Step 15905 (35 ms): -195.47.
Step 15942 (36 ms): -193.82.
Step 15980 (35 ms): -194.09.
Step 16018 (34 ms): -201.83.
Step 16055 (35 ms): -192.03.
Step 16093 (36 ms): -204.21.
Step 16130 (34 ms): -193.01.
Step 16168 (17 ms): -299.82.

Epoch 43 (13.2 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -201, ENRE: -195.04, KL: 5.957.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 16206 (35 ms): -193.76.
Step 16243 (35 ms): -190.69.
Step 16281 (34 ms): -204.28.
Step 16318 (34 ms): -216.96.
Step 16356 (35 ms): -200.47.
Step 16394 (35 ms): -191.85.
Step 16431 (35 ms): -206.86.
Step 16469 (34 ms): -204.54.
Step 16506 (35 ms): -199.31.
Step 16544 (16 ms): -239.03.

Epoch 44 (13.1 s):
    Evaluating model.
    Full set (6.12 s): ELBO: -200.78, ENRE: -194.89, KL: 5.8898.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 16582 (35 ms): -203.72.
Step 16619 (34 ms): -196.14.
Step 16657 (34 ms): -212.78.
Step 16694 (34 ms): -207.11.
Step 16732 (33 ms): -199.71.
Step 16770 (34 ms): -195.1.
Step 16807 (33 ms): -203.8.
Step 16845 (34 ms): -207.91.
Step 16882 (35 ms): -195.09.
Step 16920 (16 ms): -222.48.

Epoch 45 (12.9 s):
    Evaluating model.
    Full set (6.27 s): ELBO: -201.01, ENRE: -195.01, KL: 6.0041.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 16958 (36 ms): -193.19.
Step 16995 (35 ms): -206.46.
Step 17033 (35 ms): -199.45.
Step 17070 (34 ms): -212.73.
Step 17108 (35 ms): -203.68.
Step 17146 (36 ms): -197.85.
Step 17183 (35 ms): -224.02.
Step 17221 (35 ms): -205.91.
Step 17258 (35 ms): -218.46.
Step 17296 (17 ms): -202.76.

Epoch 46 (13.2 s):
    Evaluating model.
    Full set (6.13 s): ELBO: -200.49, ENRE: -194.59, KL: 5.9023.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 17334 (35 ms): -206.81.
Step 17371 (34 ms): -192.5.
Step 17409 (35 ms): -200.89.
Step 17446 (35 ms): -211.03.
Step 17484 (35 ms): -197.07.
Step 17522 (35 ms): -201.77.
Step 17559 (36 ms): -207.54.
Step 17597 (35 ms): -200.11.
Step 17634 (33 ms): -205.29.
Step 17672 (17 ms): -239.49.

Epoch 47 (13.1 s):
    Evaluating model.
    Full set (6.3 s): ELBO: -200.51, ENRE: -194.54, KL: 5.964.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 17710 (36 ms): -210.21.
Step 17747 (35 ms): -203.72.
Step 17785 (35 ms): -192.81.
Step 17822 (36 ms): -215.21.
Step 17860 (35 ms): -198.65.
Step 17898 (35 ms): -188.7.
Step 17935 (35 ms): -207.52.
Step 17973 (35 ms): -210.58.
Step 18010 (35 ms): -201.87.
Step 18048 (17 ms): -253.56.

Epoch 48 (13.2 s):
    Evaluating model.
    Full set (6.15 s): ELBO: -200.76, ENRE: -194.78, KL: 5.9785.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 18086 (36 ms): -198.03.
Step 18123 (35 ms): -203.45.
Step 18161 (35 ms): -204.97.
Step 18198 (35 ms): -197.14.
Step 18236 (35 ms): -198.91.
Step 18274 (35 ms): -207.12.
Step 18311 (34 ms): -195.16.
Step 18349 (34 ms): -190.16.
Step 18386 (34 ms): -204.27.
Step 18424 (17 ms): -207.08.

Epoch 49 (13.1 s):
    Evaluating model.
    Full set (6.19 s): ELBO: -200.69, ENRE: -194.83, KL: 5.8561.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 18462 (34 ms): -206.95.
Step 18499 (35 ms): -195.31.
Step 18537 (35 ms): -204.4.
Step 18574 (35 ms): -210.64.
Step 18612 (35 ms): -196.42.
Step 18650 (35 ms): -186.07.
Step 18687 (35 ms): -195.85.
Step 18725 (35 ms): -198.03.
Step 18762 (34 ms): -200.66.
Step 18800 (17 ms): -199.24.

Epoch 50 (13.1 s):
    Evaluating model.
    Full set (6.09 s): ELBO: -200.48, ENRE: -194.64, KL: 5.8388.
    Saving model parameters.
    Model parameters saved (121 ms).

Model trained for 50 epochs (16m 15s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (15 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (915 ms).

Converting data set value array to sparse matrix.
Data set value array converted (322 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (2 s):  ELBO: -420.71, ENRE: -414.87, KL: 5.8469.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (775 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>

tuning kl weight

kl weight in args dict: 1.071688500758202
model type: VAE
data set file name: ../../Data/PBMC/upto_tp0/train_data.mtx
preprocessed values shape: (48005, 2000)
latent size: 14
kl weight: 1.071688500758202
Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (57 ms).

Loading original data set.
Num of cells = 48005 | Num of genes = 2000
Original data set loaded (4.25 s).

Converting data set value array to sparse matrix.
Data set value array converted (1.93 s).

Model
═════

Model setup:
    type: VAE
    feature size: 2000
    latent size: 14
    hidden sizes: 140, 106, 66, 187, 156
    latent distribution: gaussian
    reconstruction distribution: poisson
    Monte Carlo samples: 1
    importance samples: 1
    KL weigth: 1.071688500758202
    using analytical KL term
    using batch normalisation for minibatches
    early stopping: after 10 epoch with no improvements

Trainable parameters
    ENCODER/1/DENSE/weights:0            (2000, 140)
    ENCODER/1/DENSE/biases:0             (140,)
    ENCODER/1/BATCH_NORM/beta:0          (140,)
    ENCODER/2/DENSE/weights:0            (140, 106)
    ENCODER/2/DENSE/biases:0             (106,)
    ENCODER/2/BATCH_NORM/beta:0          (106,)
    ENCODER/3/DENSE/weights:0            (106, 66)
    ENCODER/3/DENSE/biases:0             (66,)
    ENCODER/3/BATCH_NORM/beta:0          (66,)
    ENCODER/4/DENSE/weights:0            (66, 187)
    ENCODER/4/DENSE/biases:0             (187,)
    ENCODER/4/BATCH_NORM/beta:0          (187,)
    ENCODER/5/DENSE/weights:0            (187, 156)
    ENCODER/5/DENSE/biases:0             (156,)
    ENCODER/5/BATCH_NORM/beta:0          (156,)
    POSTERIOR/MU/DENSE/weights:0         (156, 14)
    POSTERIOR/MU/DENSE/biases:0          (14,)
    POSTERIOR/LOG_SIGMA/DENSE/weights:0  (156, 14)
    POSTERIOR/LOG_SIGMA/DENSE/biases:0   (14,)
    DECODER/5/DENSE/weights:0            (14, 156)
    DECODER/5/DENSE/biases:0             (156,)
    DECODER/5/BATCH_NORM/beta:0          (156,)
    DECODER/4/DENSE/weights:0            (156, 187)
    DECODER/4/DENSE/biases:0             (187,)
    DECODER/4/BATCH_NORM/beta:0          (187,)
    DECODER/3/DENSE/weights:0            (187, 66)
    DECODER/3/DENSE/biases:0             (66,)
    DECODER/3/BATCH_NORM/beta:0          (66,)
    DECODER/2/DENSE/weights:0            (66, 106)
    DECODER/2/DENSE/biases:0             (106,)
    DECODER/2/BATCH_NORM/beta:0          (106,)
    DECODER/1/DENSE/weights:0            (106, 140)
    DECODER/1/DENSE/biases:0             (140,)
    DECODER/1/BATCH_NORM/beta:0          (140,)
    X_TILDE/LOG_LAMBDA/DENSE/weights:0   (140, 2000)
    X_TILDE/LOG_LAMBDA/DENSE/biases:0    (2000,)

Training
────────

validation set given?: False
training set shape: (48005, 2000)
Preparing data.
training_set.values type: <class 'data.sparse.SparseRowMatrix'>
training_set.preprocessed_values type: <class 'scipy.sparse.csc.csc_matrix'>
Data prepared (<1 ms).

Initialising model parameters.
Model parameters initialised (588 ms).

Training model for 50 epochs on original values.

Step 38 (34 ms): -2131.2.
Step 75 (34 ms): -1809.5.
Step 113 (32 ms): -1560.7.
Step 150 (33 ms): -1341.8.
Step 188 (33 ms): -1169.2.
Step 226 (32 ms): -1024.
Step 263 (32 ms): -897.77.
Step 301 (33 ms): -825.28.
Step 338 (33 ms): -732.09.
Step 376 (20 ms): -625.

Epoch 1 (15.4 s):
    Evaluating model.
    Full set (6.56 s): ELBO: -1884.1, ENRE: -1880.7, KL: 3.3477.
    Saving model parameters.
    Model parameters saved (206 ms).

Step 414 (34 ms): -609.78.
Step 451 (33 ms): -565.26.
Step 489 (32 ms): -533.91.
Step 526 (34 ms): -476.81.
Step 564 (33 ms): -458.25.
Step 602 (32 ms): -432.46.
Step 639 (33 ms): -409.31.
Step 677 (33 ms): -380.33.
Step 714 (34 ms): -385.87.
Step 752 (17 ms): -302.36.

Epoch 2 (12.3 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -1106.8, ENRE: -1102.5, KL: 4.3186.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 790 (34 ms): -377.31.
Step 827 (32 ms): -335.1.
Step 865 (33 ms): -337.3.
Step 902 (33 ms): -315.96.
Step 940 (32 ms): -293.33.
Step 978 (33 ms): -289.28.
Step 1015 (33 ms): -303.17.
Step 1053 (33 ms): -312.39.
Step 1090 (33 ms): -274.93.
Step 1128 (16 ms): -252.48.

Epoch 3 (12.2 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -648.73, ENRE: -644.06, KL: 4.6626.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 1166 (32 ms): -262.11.
Step 1203 (33 ms): -260.13.
Step 1241 (32 ms): -316.38.
Step 1278 (32 ms): -253.57.
Step 1316 (32 ms): -252.82.
Step 1354 (33 ms): -265.31.
Step 1391 (33 ms): -244.24.
Step 1429 (33 ms): -264.5.
Step 1466 (32 ms): -238.56.
Step 1504 (16 ms): -312.65.

Epoch 4 (12.2 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -423.67, ENRE: -418.81, KL: 4.8523.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 1542 (32 ms): -267.6.
Step 1579 (32 ms): -250.99.
Step 1617 (32 ms): -235.67.
Step 1654 (31 ms): -269.03.
Step 1692 (32 ms): -250.37.
Step 1730 (32 ms): -242.
Step 1767 (31 ms): -245.22.
Step 1805 (32 ms): -239.65.
Step 1842 (32 ms): -224.36.
Step 1880 (16 ms): -231.65.

Epoch 5 (12 s):
    Evaluating model.
    Full set (5.78 s): ELBO: -319.39, ENRE: -314.3, KL: 5.0893.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 1918 (31 ms): -233.38.
Step 1955 (32 ms): -216.59.
Step 1993 (32 ms): -230.98.
Step 2030 (30 ms): -244.43.
Step 2068 (32 ms): -236.06.
Step 2106 (33 ms): -228.65.
Step 2143 (33 ms): -251.69.
Step 2181 (33 ms): -245.55.
Step 2218 (32 ms): -269.12.
Step 2256 (16 ms): -202.04.

Epoch 6 (12.1 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -271.13, ENRE: -265.6, KL: 5.5348.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 2294 (32 ms): -237.57.
Step 2331 (32 ms): -256.88.
Step 2369 (31 ms): -236.73.
Step 2406 (32 ms): -215.7.
Step 2444 (32 ms): -223.57.
Step 2482 (32 ms): -223.76.
Step 2519 (32 ms): -233.49.
Step 2557 (33 ms): -225.15.
Step 2594 (33 ms): -236.72.
Step 2632 (16 ms): -204.23.

Epoch 7 (12.2 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -246.25, ENRE: -240.44, KL: 5.8076.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 2670 (33 ms): -243.37.
Step 2707 (32 ms): -212.27.
Step 2745 (34 ms): -207.37.
Step 2782 (32 ms): -222.51.
Step 2820 (33 ms): -209.18.
Step 2858 (33 ms): -219.4.
Step 2895 (33 ms): -218.1.
Step 2933 (32 ms): -222.17.
Step 2970 (33 ms): -249.09.
Step 3008 (16 ms): -222.66.

Epoch 8 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -234.31, ENRE: -228.4, KL: 5.912.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 3046 (32 ms): -213.34.
Step 3083 (34 ms): -211.17.
Step 3121 (32 ms): -224.21.
Step 3158 (33 ms): -239.08.
Step 3196 (33 ms): -212.57.
Step 3234 (32 ms): -219.77.
Step 3271 (33 ms): -245.88.
Step 3309 (31 ms): -226.35.
Step 3346 (32 ms): -224.06.
Step 3384 (17 ms): -232.79.

Epoch 9 (12.2 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -224.64, ENRE: -218.55, KL: 6.0973.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 3422 (32 ms): -221.45.
Step 3459 (31 ms): -214.57.
Step 3497 (32 ms): -210.8.
Step 3534 (31 ms): -213.15.
Step 3572 (32 ms): -217.57.
Step 3610 (32 ms): -217.67.
Step 3647 (33 ms): -219.67.
Step 3685 (32 ms): -217.24.
Step 3722 (33 ms): -220.81.
Step 3760 (16 ms): -222.78.

Epoch 10 (12.1 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -220.37, ENRE: -214.3, KL: 6.0672.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 3798 (32 ms): -219.07.
Step 3835 (32 ms): -222.78.
Step 3873 (32 ms): -226.32.
Step 3910 (32 ms): -216.59.
Step 3948 (33 ms): -208.34.
Step 3986 (31 ms): -237.39.
Step 4023 (32 ms): -210.33.
Step 4061 (32 ms): -209.22.
Step 4098 (32 ms): -210.66.
Step 4136 (16 ms): -214.19.

Epoch 11 (12 s):
    Evaluating model.
    Full set (5.79 s): ELBO: -216.45, ENRE: -210.36, KL: 6.0953.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 4174 (31 ms): -220.25.
Step 4211 (31 ms): -214.69.
Step 4249 (32 ms): -210.4.
Step 4286 (32 ms): -195.06.
Step 4324 (32 ms): -242.35.
Step 4362 (31 ms): -205.97.
Step 4399 (31 ms): -211.4.
Step 4437 (32 ms): -205.42.
Step 4474 (31 ms): -219.97.
Step 4512 (16 ms): -279.32.

Epoch 12 (11.9 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -214.48, ENRE: -208.32, KL: 6.1643.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 4550 (33 ms): -238.19.
Step 4587 (31 ms): -223.07.
Step 4625 (32 ms): -220.49.
Step 4662 (32 ms): -217.34.
Step 4700 (32 ms): -210.79.
Step 4738 (32 ms): -212.89.
Step 4775 (31 ms): -215.71.
Step 4813 (32 ms): -220.24.
Step 4850 (33 ms): -217.57.
Step 4888 (16 ms): -268.91.

Epoch 13 (12.2 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -212.72, ENRE: -206.68, KL: 6.0481.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 4926 (32 ms): -207.3.
Step 4963 (32 ms): -201.31.
Step 5001 (32 ms): -218.28.
Step 5038 (31 ms): -200.95.
Step 5076 (32 ms): -229.05.
Step 5114 (32 ms): -203.21.
Step 5151 (31 ms): -209.52.
Step 5189 (32 ms): -211.76.
Step 5226 (32 ms): -211.27.
Step 5264 (16 ms): -227.38.

Epoch 14 (12.2 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -211.13, ENRE: -205.02, KL: 6.1141.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 5302 (33 ms): -209.87.
Step 5339 (33 ms): -204.11.
Step 5377 (33 ms): -227.71.
Step 5414 (32 ms): -205.1.
Step 5452 (33 ms): -200.95.
Step 5490 (33 ms): -206.19.
Step 5527 (32 ms): -212.92.
Step 5565 (32 ms): -200.57.
Step 5602 (32 ms): -203.33.
Step 5640 (16 ms): -230.91.

Epoch 15 (12.2 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -210.29, ENRE: -204.11, KL: 6.1712.
    Saving model parameters.
    Model parameters saved (126 ms).

Step 5678 (32 ms): -192.7.
Step 5715 (33 ms): -214.01.
Step 5753 (31 ms): -220.5.
Step 5790 (32 ms): -204.62.
Step 5828 (32 ms): -197.88.
Step 5866 (32 ms): -210.39.
Step 5903 (32 ms): -205.32.
Step 5941 (32 ms): -199.9.
Step 5978 (32 ms): -205.51.
Step 6016 (16 ms): -220.44.

Epoch 16 (12.1 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -209.84, ENRE: -203.75, KL: 6.0945.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 6054 (32 ms): -208.89.
Step 6091 (31 ms): -196.69.
Step 6129 (32 ms): -217.47.
Step 6166 (31 ms): -204.66.
Step 6204 (34 ms): -210.14.
Step 6242 (32 ms): -207.96.
Step 6279 (32 ms): -217.41.
Step 6317 (31 ms): -205.82.
Step 6354 (32 ms): -201.48.
Step 6392 (16 ms): -206.1.

Epoch 17 (12 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -208.82, ENRE: -202.83, KL: 5.9872.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 6430 (31 ms): -214.34.
Step 6467 (31 ms): -221.51.
Step 6505 (32 ms): -209.95.
Step 6542 (32 ms): -200.87.
Step 6580 (32 ms): -215.26.
Step 6618 (32 ms): -222.58.
Step 6655 (31 ms): -201.22.
Step 6693 (32 ms): -210.77.
Step 6730 (33 ms): -218.62.
Step 6768 (16 ms): -799.47.

Epoch 18 (12 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -207.97, ENRE: -202.01, KL: 5.956.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 6806 (32 ms): -216.56.
Step 6843 (32 ms): -209.86.
Step 6881 (33 ms): -196.79.
Step 6918 (34 ms): -205.97.
Step 6956 (33 ms): -210.85.
Step 6994 (32 ms): -213.48.
Step 7031 (32 ms): -203.26.
Step 7069 (32 ms): -205.68.
Step 7106 (31 ms): -209.85.
Step 7144 (16 ms): -216.21.

Epoch 19 (12.1 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -207.18, ENRE: -201.32, KL: 5.8584.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 7182 (33 ms): -208.
Step 7219 (34 ms): -211.18.
Step 7257 (33 ms): -208.09.
Step 7294 (33 ms): -203.06.
Step 7332 (33 ms): -198.7.
Step 7370 (32 ms): -212.68.
Step 7407 (33 ms): -201.5.
Step 7445 (32 ms): -210.6.
Step 7482 (33 ms): -211.65.
Step 7520 (16 ms): -259.29.

Epoch 20 (12.3 s):
    Evaluating model.
    Full set (5.9 s): ELBO: -207.23, ENRE: -201.35, KL: 5.883.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 7558 (33 ms): -201.69.
Step 7595 (32 ms): -197.1.
Step 7633 (32 ms): -214.65.
Step 7670 (34 ms): -204.39.
Step 7708 (33 ms): -204.09.
Step 7746 (33 ms): -209.17.
Step 7783 (32 ms): -198.9.
Step 7821 (32 ms): -201.01.
Step 7858 (33 ms): -208.75.
Step 7896 (16 ms): -257.98.

Epoch 21 (12.2 s):
    Evaluating model.
    Full set (5.85 s): ELBO: -206.45, ENRE: -200.43, KL: 6.0138.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 7934 (32 ms): -219.85.
Step 7971 (32 ms): -221.03.
Step 8009 (32 ms): -217.09.
Step 8046 (32 ms): -207.73.
Step 8084 (33 ms): -214.53.
Step 8122 (31 ms): -213.73.
Step 8159 (34 ms): -192.63.
Step 8197 (32 ms): -210.56.
Step 8234 (32 ms): -210.89.
Step 8272 (17 ms): -195.05.

Epoch 22 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -206.4, ENRE: -200.5, KL: 5.8942.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 8310 (32 ms): -208.59.
Step 8347 (32 ms): -196.04.
Step 8385 (31 ms): -205.25.
Step 8422 (31 ms): -206.03.
Step 8460 (32 ms): -201.53.
Step 8498 (32 ms): -208.39.
Step 8535 (31 ms): -200.49.
Step 8573 (32 ms): -203.78.
Step 8610 (32 ms): -206.49.
Step 8648 (16 ms): -216.74.

Epoch 23 (12 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -205.47, ENRE: -199.5, KL: 5.9724.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 8686 (33 ms): -202.72.
Step 8723 (31 ms): -207.01.
Step 8761 (32 ms): -185.73.
Step 8798 (31 ms): -218.35.
Step 8836 (32 ms): -190.5.
Step 8874 (32 ms): -210.3.
Step 8911 (32 ms): -209.99.
Step 8949 (30 ms): -199.59.
Step 8986 (32 ms): -215.42.
Step 9024 (15 ms): -180.04.

Epoch 24 (11.9 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -205.04, ENRE: -199.13, KL: 5.9011.
    Saving model parameters.
    Model parameters saved (130 ms).

Step 9062 (32 ms): -203.39.
Step 9099 (33 ms): -216.37.
Step 9137 (32 ms): -193.45.
Step 9174 (32 ms): -204.29.
Step 9212 (34 ms): -189.7.
Step 9250 (33 ms): -204.75.
Step 9287 (32 ms): -210.78.
Step 9325 (32 ms): -207.85.
Step 9362 (32 ms): -202.21.
Step 9400 (16 ms): -268.07.

Epoch 25 (12.1 s):
    Evaluating model.
    Full set (5.82 s): ELBO: -205.06, ENRE: -199.16, KL: 5.9041.
    Saving model parameters.
    Model parameters saved (118 ms).

Step 9438 (32 ms): -202.67.
Step 9475 (32 ms): -220.49.
Step 9513 (34 ms): -208.19.
Step 9550 (33 ms): -205.
Step 9588 (33 ms): -196.3.
Step 9626 (33 ms): -203.34.
Step 9663 (32 ms): -196.07.
Step 9701 (33 ms): -230.84.
Step 9738 (32 ms): -211.42.
Step 9776 (16 ms): -252.63.

Epoch 26 (12.2 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -205.06, ENRE: -199.09, KL: 5.9728.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 9814 (33 ms): -213.32.
Step 9851 (33 ms): -194.38.
Step 9889 (32 ms): -200.02.
Step 9926 (32 ms): -215.05.
Step 9964 (32 ms): -201.86.
Step 10002 (33 ms): -197.69.
Step 10039 (32 ms): -206.73.
Step 10077 (33 ms): -202.92.
Step 10114 (32 ms): -200.38.
Step 10152 (18 ms): -229.31.

Epoch 27 (12.2 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -204.67, ENRE: -198.64, KL: 6.0305.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 10190 (32 ms): -216.31.
Step 10227 (32 ms): -225.21.
Step 10265 (33 ms): -205.51.
Step 10302 (33 ms): -211.06.
Step 10340 (32 ms): -203.38.
Step 10378 (32 ms): -195.21.
Step 10415 (31 ms): -202.26.
Step 10453 (32 ms): -193.06.
Step 10490 (32 ms): -220.97.
Step 10528 (17 ms): -259.12.

Epoch 28 (12.2 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -204.33, ENRE: -198.31, KL: 6.0209.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 10566 (32 ms): -207.62.
Step 10603 (32 ms): -208.27.
Step 10641 (32 ms): -208.38.
Step 10678 (32 ms): -216.41.
Step 10716 (32 ms): -206.45.
Step 10754 (32 ms): -200.25.
Step 10791 (32 ms): -204.38.
Step 10829 (33 ms): -202.89.
Step 10866 (32 ms): -203.71.
Step 10904 (16 ms): -278.6.

Epoch 29 (12.1 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -203.93, ENRE: -197.71, KL: 6.2174.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 10942 (34 ms): -199.41.
Step 10979 (32 ms): -201.34.
Step 11017 (32 ms): -194.78.
Step 11054 (32 ms): -199.52.
Step 11092 (32 ms): -216.75.
Step 11130 (31 ms): -195.91.
Step 11167 (32 ms): -207.36.
Step 11205 (32 ms): -195.48.
Step 11242 (31 ms): -205.19.
Step 11280 (16 ms): -213.88.

Epoch 30 (12 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -203.37, ENRE: -197.1, KL: 6.2781.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 11318 (32 ms): -198.69.
Step 11355 (32 ms): -198.64.
Step 11393 (32 ms): -197.81.
Step 11430 (32 ms): -204.32.
Step 11468 (32 ms): -206.44.
Step 11506 (32 ms): -208.7.
Step 11543 (32 ms): -214.67.
Step 11581 (32 ms): -203.2.
Step 11618 (33 ms): -199.91.
Step 11656 (15 ms): -215.8.

Epoch 31 (12 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -203.22, ENRE: -196.93, KL: 6.2938.
    Saving model parameters.
    Model parameters saved (125 ms).

Step 11694 (34 ms): -199.92.
Step 11731 (33 ms): -223.64.
Step 11769 (33 ms): -201.19.
Step 11806 (32 ms): -209.32.
Step 11844 (33 ms): -192.28.
Step 11882 (34 ms): -208.71.
Step 11919 (33 ms): -221.04.
Step 11957 (33 ms): -203.66.
Step 11994 (33 ms): -204.82.
Step 12032 (17 ms): -247.58.

Epoch 32 (12.2 s):
    Evaluating model.
    Full set (5.88 s): ELBO: -203.16, ENRE: -196.91, KL: 6.2501.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 12070 (32 ms): -205.75.
Step 12107 (32 ms): -201.89.
Step 12145 (32 ms): -206.05.
Step 12182 (32 ms): -206.56.
Step 12220 (32 ms): -202.46.
Step 12258 (33 ms): -209.09.
Step 12295 (32 ms): -210.14.
Step 12333 (32 ms): -195.16.
Step 12370 (33 ms): -199.63.
Step 12408 (16 ms): -225.18.

Epoch 33 (12.2 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -202.98, ENRE: -196.88, KL: 6.1042.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 12446 (33 ms): -212.5.
Step 12483 (33 ms): -196.01.
Step 12521 (33 ms): -218.64.
Step 12558 (31 ms): -199.37.
Step 12596 (32 ms): -199.37.
Step 12634 (31 ms): -212.81.
Step 12671 (33 ms): -205.67.
Step 12709 (32 ms): -198.42.
Step 12746 (33 ms): -208.42.
Step 12784 (16 ms): -202.99.

Epoch 34 (12.2 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -202.74, ENRE: -196.57, KL: 6.1646.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 12822 (33 ms): -211.1.
Step 12859 (33 ms): -195.31.
Step 12897 (33 ms): -202.14.
Step 12934 (32 ms): -196.47.
Step 12972 (32 ms): -206.03.
Step 13010 (32 ms): -207.43.
Step 13047 (32 ms): -205.08.
Step 13085 (32 ms): -202.98.
Step 13122 (32 ms): -206.93.
Step 13160 (17 ms): -178.93.

Epoch 35 (12.1 s):
    Evaluating model.
    Full set (5.8 s): ELBO: -202.5, ENRE: -196.22, KL: 6.2845.
    Saving model parameters.
    Model parameters saved (119 ms).

Step 13198 (31 ms): -202.
Step 13235 (32 ms): -211.74.
Step 13273 (32 ms): -210.74.
Step 13310 (31 ms): -210.09.
Step 13348 (32 ms): -224.37.
Step 13386 (33 ms): -211.26.
Step 13423 (32 ms): -195.44.
Step 13461 (32 ms): -201.35.
Step 13498 (34 ms): -192.3.
Step 13536 (16 ms): -191.4.

Epoch 36 (12 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -202.22, ENRE: -195.98, KL: 6.2436.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 13574 (32 ms): -197.03.
Step 13611 (31 ms): -199.
Step 13649 (32 ms): -205.31.
Step 13686 (32 ms): -191.32.
Step 13724 (31 ms): -200.72.
Step 13762 (32 ms): -199.1.
Step 13799 (31 ms): -214.75.
Step 13837 (32 ms): -201.26.
Step 13874 (31 ms): -207.49.
Step 13912 (16 ms): -348.78.

Epoch 37 (11.9 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -202.26, ENRE: -196, KL: 6.2661.
    Saving model parameters.
    Model parameters saved (212 ms).

Step 13950 (33 ms): -195.85.
Step 13987 (31 ms): -191.13.
Step 14025 (32 ms): -204.47.
Step 14062 (32 ms): -198.8.
Step 14100 (32 ms): -193.74.
Step 14138 (31 ms): -196.11.
Step 14175 (32 ms): -199.
Step 14213 (33 ms): -205.22.
Step 14250 (32 ms): -199.99.
Step 14288 (16 ms): -186.

Epoch 38 (12 s):
    Evaluating model.
    Full set (5.89 s): ELBO: -202.07, ENRE: -195.82, KL: 6.2499.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 14326 (33 ms): -201.33.
Step 14363 (33 ms): -201.32.
Step 14401 (33 ms): -198.8.
Step 14438 (34 ms): -204.65.
Step 14476 (33 ms): -216.18.
Step 14514 (32 ms): -206.21.
Step 14551 (33 ms): -193.05.
Step 14589 (32 ms): -199.78.
Step 14626 (33 ms): -197.06.
Step 14664 (17 ms): -184.59.

Epoch 39 (12.3 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -201.82, ENRE: -195.52, KL: 6.2944.
    Saving model parameters.
    Model parameters saved (117 ms).

Step 14702 (33 ms): -212.08.
Step 14739 (34 ms): -204.34.
Step 14777 (33 ms): -197.43.
Step 14814 (32 ms): -199.96.
Step 14852 (32 ms): -205.53.
Step 14890 (32 ms): -197.36.
Step 14927 (32 ms): -190.52.
Step 14965 (32 ms): -207.74.
Step 15002 (33 ms): -201.66.
Step 15040 (17 ms): -252.24.

Epoch 40 (12.2 s):
    Evaluating model.
    Full set (5.91 s): ELBO: -201.6, ENRE: -195.28, KL: 6.32.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 15078 (33 ms): -202.25.
Step 15115 (33 ms): -195.66.
Step 15153 (32 ms): -215.4.
Step 15190 (32 ms): -191.1.
Step 15228 (32 ms): -209.83.
Step 15266 (33 ms): -197.87.
Step 15303 (33 ms): -212.62.
Step 15341 (32 ms): -197.98.
Step 15378 (33 ms): -192.83.
Step 15416 (16 ms): -218.46.

Epoch 41 (12.2 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -201.32, ENRE: -195.12, KL: 6.1958.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 15454 (33 ms): -201.71.
Step 15491 (32 ms): -198.04.
Step 15529 (32 ms): -205.16.
Step 15566 (33 ms): -209.79.
Step 15604 (33 ms): -214.59.
Step 15642 (31 ms): -196.87.
Step 15679 (31 ms): -195.64.
Step 15717 (32 ms): -205.27.
Step 15754 (32 ms): -201.94.
Step 15792 (16 ms): -515.59.

Epoch 42 (12.1 s):
    Evaluating model.
    Full set (5.84 s): ELBO: -201.45, ENRE: -195.28, KL: 6.1669.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 15830 (31 ms): -206.66.
Step 15867 (33 ms): -208.45.
Step 15905 (31 ms): -195.58.
Step 15942 (31 ms): -197.6.
Step 15980 (32 ms): -196.86.
Step 16018 (32 ms): -198.25.
Step 16055 (32 ms): -201.81.
Step 16093 (32 ms): -188.88.
Step 16130 (32 ms): -190.67.
Step 16168 (16 ms): -222.53.

Epoch 43 (12 s):
    Evaluating model.
    Full set (5.81 s): ELBO: -201.25, ENRE: -194.96, KL: 6.2898.
    Saving model parameters.
    Model parameters saved (128 ms).

Step 16206 (32 ms): -186.94.
Step 16243 (32 ms): -206.77.
Step 16281 (31 ms): -195.39.
Step 16318 (32 ms): -198.58.
Step 16356 (32 ms): -198.06.
Step 16394 (32 ms): -189.
Step 16431 (31 ms): -205.8.
Step 16469 (34 ms): -220.73.
Step 16506 (32 ms): -192.48.
Step 16544 (16 ms): -251.32.

Epoch 44 (12 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -201.07, ENRE: -194.75, KL: 6.3209.
    Saving model parameters.
    Model parameters saved (122 ms).

Step 16582 (33 ms): -204.75.
Step 16619 (33 ms): -192.88.
Step 16657 (32 ms): -196.94.
Step 16694 (34 ms): -203.65.
Step 16732 (33 ms): -190.31.
Step 16770 (32 ms): -205.73.
Step 16807 (31 ms): -195.41.
Step 16845 (32 ms): -209.83.
Step 16882 (31 ms): -182.26.
Step 16920 (16 ms): -197.35.

Epoch 45 (12.2 s):
    Evaluating model.
    Full set (5.83 s): ELBO: -201, ENRE: -194.62, KL: 6.3805.
    Saving model parameters.
    Model parameters saved (124 ms).

Step 16958 (32 ms): -192.13.
Step 16995 (32 ms): -195.57.
Step 17033 (32 ms): -201.01.
Step 17070 (33 ms): -205.58.
Step 17108 (32 ms): -194.18.
Step 17146 (32 ms): -207.26.
Step 17183 (32 ms): -209.18.
Step 17221 (33 ms): -204.14.
Step 17258 (33 ms): -202.96.
Step 17296 (17 ms): -233.18.

Epoch 46 (12.2 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -201.02, ENRE: -194.63, KL: 6.3875.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 17334 (32 ms): -207.59.
Step 17371 (32 ms): -196.08.
Step 17409 (32 ms): -206.36.
Step 17446 (32 ms): -213.38.
Step 17484 (33 ms): -203.14.
Step 17522 (32 ms): -212.35.
Step 17559 (33 ms): -211.01.
Step 17597 (33 ms): -199.25.
Step 17634 (33 ms): -201.57.
Step 17672 (17 ms): -231.47.

Epoch 47 (12.1 s):
    Evaluating model.
    Full set (5.86 s): ELBO: -201.01, ENRE: -194.57, KL: 6.4417.
    Saving model parameters.
    Model parameters saved (120 ms).

Step 17710 (32 ms): -207.07.
Step 17747 (32 ms): -196.72.
Step 17785 (32 ms): -194.05.
Step 17822 (32 ms): -197.19.
Step 17860 (32 ms): -199.5.
Step 17898 (32 ms): -213.76.
Step 17935 (32 ms): -206.34.
Step 17973 (32 ms): -193.66.
Step 18010 (32 ms): -192.23.
Step 18048 (15 ms): -205.74.

Epoch 48 (12.1 s):
    Evaluating model.
    Full set (5.87 s): ELBO: -200.74, ENRE: -194.31, KL: 6.433.
    Saving model parameters.
    Model parameters saved (121 ms).

Step 18086 (32 ms): -202.47.
Step 18123 (32 ms): -211.77.
Step 18161 (32 ms): -199.69.
Step 18198 (32 ms): -203.12.
Step 18236 (32 ms): -188.62.
Step 18274 (31 ms): -197.89.
Step 18311 (32 ms): -217.34.
Step 18349 (31 ms): -197.95.
Step 18386 (32 ms): -202.59.
Step 18424 (16 ms): -322.24.

Epoch 49 (12 s):
    Evaluating model.
    Full set (5.77 s): ELBO: -200.91, ENRE: -194.51, KL: 6.3962.
    Saving model parameters.
    Model parameters saved (123 ms).

Step 18462 (34 ms): -201.06.
Step 18499 (31 ms): -195.56.
Step 18537 (31 ms): -210.83.
Step 18574 (32 ms): -204.43.
Step 18612 (31 ms): -195.6.
Step 18650 (32 ms): -202.18.
Step 18687 (32 ms): -197.28.
Step 18725 (33 ms): -214.66.
Step 18762 (31 ms): -199.36.
Step 18800 (16 ms): -240.14.

Epoch 50 (12 s):
    Evaluating model.
    Full set (5.92 s): ELBO: -200.54, ENRE: -194.05, KL: 6.4846.
    Saving model parameters.
    Model parameters saved (124 ms).

Model trained for 50 epochs (15m 10s).

Data
════

Data Format: mtx_fbe
before commented code in data/data_set.py
self.preprocessed_values is defined
Copying values for full set.
Data set copied (15 ms).

Loading original data set.
Num of cells = 10286 | Num of genes = 2000
Original data set loaded (866 ms).

Converting data set value array to sparse matrix.
Data set value array converted (284 ms).

Model
═════

Analysis
────────

Results
═══════

Evaluation set: full set.
Model version: end of training.

End of training
───────────────

End-of-training evaluation
--------------------------

Evaluating trained model on original values.
    Full set (1.97 s):  ELBO: -424.7, ENRE: -418.22, KL: 6.473.

End-of-training sampling
------------------------

sample size in sample method: 10288
Sampling 10288 examples from model.
Examples sampled (768 ms).

test preds shape: (10288, 2000)
test preds type: <class 'numpy.ndarray'>
test labels shape: (10288, 2000)
test labels type: <class 'numpy.ndarray'>
======================================================================
Found best params : {'model_type': 'VAE', 'reconstruction_distribution': 'poisson', 'latent_size': 42, 'num_hidden_layers': 4, 'size of hidden layer 1': 157, 'size of hidden layer 2': 276, 'size of hidden layer 3': 54, 'size of hidden layer 4': 296, 'number_of_warm_up_epochs': 1, 'kl_weight': 1.3311389120122017} | Best test score = 0.7186741835147745
